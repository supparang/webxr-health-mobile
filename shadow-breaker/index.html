<script>
  let I18N=null, CUR=localStorage.getItem('sb_lang')||'th';
  const $ = (id)=>document.getElementById(id);
  const T = (k,def)=> (I18N && I18N[CUR] && I18N[CUR][k]) || def || k;

  async function loadI18n(){ const r=await fetch('src/i18n.json'); I18N=await r.json(); applyTexts(); }
  function setLang(v){ CUR=v; localStorage.setItem('sb_lang',v); applyTexts(); }
  function applyTexts(){
    $('titleMain').textContent   = T('title','SHADOW BREAKER');
    $('subtitle').textContent    = T('subtitle','Neo Anime Tech • Training Hub');
    $('lblTraining').textContent = T('training','Training');
    $('btnCombat').textContent   = T('modeCombat','Arcane Combat');
    $('btnDash').textContent     = T('modeDash','Rift Dash');
    $('btnImpact').textContent   = T('modeImpact','Impact Breaker');
    $('btnFlow').textContent     = T('modeFlow','Spirit Flow');
    $('lblDiff').textContent     = T('difficulty','Difficulty');
    $('optEasy').textContent     = T('easy','Easy');
    $('optNormal').textContent   = T('normal','Normal');
    $('optHard').textContent     = T('hard','Hard');
    $('btnTH').textContent='ไทย'; $('btnEN').textContent='English';
  }

  function start(game){
    const diff=$('selDiff').value;
    const mode='timed';
    location.href=`play.html?game=${game}&mode=${mode}&diff=${diff}&map=city`;
  }
  window.addEventListener('DOMContentLoaded', loadI18n);
</script>

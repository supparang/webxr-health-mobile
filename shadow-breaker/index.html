<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>EXO Training Protocol — Hub</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="core/exo-ui.css">
  <style>
    .grid{max-width:980px;margin:84px auto 40px;padding:0 16px;display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:14px}
    .card{background:rgba(14,20,36,.85);border:1px solid #112848;border-radius:12px;padding:14px}
    .card h3{margin:.2rem 0 .6rem 0}
    .row{display:flex;gap:8px;align-items:center;margin:.35rem 0}
    select,input[type="number"],input[type="text"]{flex:1;padding:8px;border-radius:8px;border:1px solid #1a315a;background:#0b1325;color:#e6f2ff}
    .muted{color:#7f8ea3;font-size:12px}
    .btn.wide{width:100%;text-align:center}
    .hint{font-size:12px;color:#a7c5ff;margin-top:6px}
    label{min-width:94px}
  </style>
</head>
<body>

  <header class="hud">
    <div class="box"><strong>EXO TRAINING PROTOCOL</strong></div>
  </header>

  <main class="grid">
    <!-- 1) Combat Reflex -->
    <section class="card" id="cardCombat">
      <h3>Combat Reflex</h3>
      <p class="muted">เกม 1 — ตอบสนองไว ตีเป้าเข้า Hit Line (มี Decoy, Hit Window)</p>

      <div class="row">
        <label>Difficulty</label>
        <select id="combatDiff">
          <option value="easy">Easy</option>
          <option value="normal" selected>Normal</option>
          <option value="hard">Hard</option>
        </select>
      </div>

      <div class="row">
        <label>Time (s)</label>
        <input id="combatTime" type="number" value="60" min="10" max="600" step="5">
      </div>

      <div class="row" style="margin-top:.6rem">
        <button id="btnCombat" class="btn wide">▶ Play Combat Reflex</button>
      </div>
    </section>

    <!-- 2) Rhythm Sync -->
    <section class="card" id="cardRhythm">
      <h3>Rhythm Sync</h3>
      <p class="muted">เกม 2 — ตามจังหวะ BPM + Chart (จบทันทีเมื่อโน้ตหมด)</p>

      <div class="row">
        <label>Difficulty</label>
        <select id="rhythmDiff">
          <option value="easy">Easy</option>
          <option value="normal" selected>Normal</option>
          <option value="hard">Hard</option>
        </select>
      </div>

      <div class="row">
        <label>BPM</label>
        <input id="rhythmBpm" type="number" value="110" min="60" max="220" step="1">
      </div>

      <div class="row">
        <label>Chart</label>
        <select id="chartPreset">
          <option value="">(ใช้ชาร์ตเริ่มต้นตามโหมด)</option>
          <option value="rhythm-rider/charts/easy.json">charts/easy.json</option>
          <option value="rhythm-rider/charts/normal.json">charts/normal.json</option>
          <option value="rhythm-rider/charts/hard.json">charts/hard.json</option>
          <option value="__custom__">Custom URL…</option>
        </select>
      </div>

      <div class="row" id="customWrap" style="display:none">
        <label>URL</label>
        <input id="chartUrl" type="text" placeholder="https://your.host/chart.json">
      </div>

      <div class="hint">* Rhythm จะจบทันทีเมื่อโน้ตหมด (ตัวจับเวลายังแสดง แต่ไม่ใช้ตัดสินจบ)</div>

      <div class="row" style="margin-top:.6rem">
        <button id="btnRhythm" class="btn wide">▶ Play Rhythm Sync</button>
      </div>
    </section>

    <!-- 3) Mobility Dash -->
    <section class="card" id="cardDash">
      <h3>Mobility Dash</h3>
      <p class="muted">เกม 3 — สลับเลนหลบสิ่งกีดขวาง (Agility)</p>

      <div class="row">
        <label>Difficulty</label>
        <select id="dashDiff">
          <option value="easy">Easy</option>
          <option value="normal" selected>Normal</option>
          <option value="hard">Hard</option>
        </select>
      </div>

      <div class="row">
        <label>Time (s)</label>
        <input id="dashTime" type="number" value="60" min="10" max="600" step="5">
      </div>

      <div class="row" style="margin-top:.6rem">
        <button id="btnDash" class="btn wide">▶ Play Mobility Dash</button>
      </div>
    </section>

    <!-- 4) Power Control -->
    <section class="card" id="cardPower">
      <h3>Power Control</h3>
      <p class="muted">เกม 4 — ย่อ/ยืน ผ่านวงแหวนให้ถูก (Hold/Release)</p>

      <div class="row">
        <label>Difficulty</label>
        <select id="powerDiff">
          <option value="easy">Easy</option>
          <option value="normal" selected>Normal</option>
          <option value="hard">Hard</option>
        </select>
      </div>

      <div class="row">
        <label>Time (s)</label>
        <input id="powerTime" type="number" value="60" min="10" max="600" step="5">
      </div>

      <div class="row" style="margin-top:.6rem">
        <button id="btnPower" class="btn wide">▶ Play Power Control</button>
      </div>
    </section>
  </main>

  <script>
    // --- Rhythm ---
    const rhythmDiff   = document.getElementById('rhythmDiff');
    const rhythmBpm    = document.getElementById('rhythmBpm');
    const chartPreset  = document.getElementById('chartPreset');
    const customWrap   = document.getElementById('customWrap');
    const chartUrl     = document.getElementById('chartUrl');
    document.getElementById('btnRhythm').addEventListener('click', () => {
      const diff = (rhythmDiff.value || 'normal').toLowerCase();
      const bpm  = Math.max(60, Math.min(220, parseInt(rhythmBpm.value || '110', 10)));
      let url = 'rhythm-rider/play.html?diff=' + encodeURIComponent(diff) + '&bpm=' + encodeURIComponent(bpm);
      const preset = chartPreset.value;
      if (preset) {
        if (preset === '__custom__') {
          const cu = chartUrl.value.trim();
          if (cu) url += '&chart=' + encodeURIComponent(cu);
        } else {
          url += '&chart=' + encodeURIComponent(preset);
        }
      }
      location.href = url;
    });
    chartPreset.addEventListener('change', () => {
      customWrap.style.display = (chartPreset.value === '__custom__') ? 'flex' : 'none';
    });

    // --- Combat ---
    const combatDiff = document.getElementById('combatDiff');
    const combatTime = document.getElementById('combatTime');
    document.getElementById('btnCombat').addEventListener('click', () => {
      const diff = (combatDiff.value || 'normal').toLowerCase();
      const t = Math.max(10, Math.min(600, parseInt(combatTime.value || '60', 10)));
      const url = `shadow-breaker/play.html?diff=${encodeURIComponent(diff)}&time=${encodeURIComponent(t)}`;
      location.href = url;
    });

    // --- Dash ---
    const dashDiff = document.getElementById('dashDiff');
    const dashTime = document.getElementById('dashTime');
    document.getElementById('btnDash').addEventListener('click', () => {
      const diff = (dashDiff.value || 'normal').toLowerCase();
      const t = Math.max(10, Math.min(600, parseInt(dashTime.value || '60', 10)));
      const url = `cardio-sprint/play.html?diff=${encodeURIComponent(diff)}&time=${encodeURIComponent(t)}`;
      location.href = url;
    });

    // --- Power ---
    const powerDiff = document.getElementById('powerDiff');
    const powerTime = document.getElementById('powerTime');
    document.getElementById('btnPower').addEventListener('click', () => {
      const diff = (powerDiff.value || 'normal').toLowerCase();
      const t = Math.max(10, Math.min(600, parseInt(powerTime.value || '60', 10)));
      const url = `sky-squats/play.html?diff=${encodeURIComponent(diff)}&time=${encodeURIComponent(t)}`;
      location.href = url;
    });
  </script>

  <p style="text-align:center;color:#6d7a8a;font-size:12px;margin-top:10px;">
    Prototype WebXR Fitness System – EXO Training Protocol
  </p>
</body>
</html>

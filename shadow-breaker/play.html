<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Play – Shadow Breaker</title>

  <!-- Styles -->
  <link rel="stylesheet" href="src/styles.css"/>

  <!-- A-Frame -->
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>

  <!-- ✅ โหลด components.js แบบ Fallback ป้องกันพาธผิด -->
  <script>
  (function(){
    const paths = [
      'src/components.js?v=1',
      './src/components.js?v=1',
      '../src/components.js?v=1',
      '/src/components.js?v=1'
    ];
    function loadScript(i){
      if(i >= paths.length){
        console.error("❌ ไม่พบ components.js ในพาธที่ลองทั้งหมด");
        const box = document.createElement('div');
        Object.assign(box.style,{position:'fixed',left:'10px',top:'10px',padding:'10px',background:'red',color:'#fff',zIndex:99999});
        box.textContent = 'ERROR: ไม่พบ src/components.js – ตรวจสอบพาธไฟล์!';
        document.body.appendChild(box);
        return;
      }
      const s = document.createElement('script');
      s.src = paths[i];
      s.defer = true;
      s.onload = () => console.log('✅ Loaded:', paths[i]);
      s.onerror = () => {
        console.warn('⚠️ Failed:', paths[i]);
        loadScript(i+1);
      };
      document.head.appendChild(s);
    }
    loadScript(0);
  })();
  </script>

</head>
<body>

  <!-- HUD TOP -->
  <div class="hud" id="hudTop">
    <div class="badge" id="hudGame">Shadow Breaker</div>
    <div class="badge" id="hudScore">Score: 0</div>
    <div class="badge" id="hudCombo">Combo: x1</div>
    <div class="badge" id="hudTime">Time: 60</div>
    <div class="badge" id="hudArcane">Arcane: 0%</div>
    <div class="badge" id="hudCal">Cal: 0.0</div>
    <div class="badge" id="hudLvl">Lv.1</div>
    <div class="badge interactive">
      <a href="index.html" style="color:#8bd8ff;text-decoration:none" id="backLink">Back</a>
    </div>
    <div class="badge interactive">
      <button id="btnTH" class="mini">ไทย</button>
      <button id="btnEN" class="mini">English</button>
    </div>
    <div class="badge" id="hudDBG">DBG</div>
  </div>

  <!-- HUD BOTTOM -->
  <div class="hud bottom">
    <div class="badge" id="hudHP">ENERGY: 100</div>
    <div class="badge" id="hudOverload">Overload: 0%</div>
    <div class="badge" id="hudBoss">Boss HP: —</div>
    <div class="badge interactive"><button id="btnSkillWheel">Skill Wheel (Q)</button></div>
  </div>

  <div id="toast" class="toast"></div>
  <div id="objective" class="objective"></div>

  <!-- GAME SCENE -->
  <a-scene renderer="colorManagement: true" shadow-breaker-game>
    <a-assets>
      <img id="bg" src="https://images.unsplash.com/photo-1499346030926-9a72daac6c63?q=80" crossorigin="anonymous">
    </a-assets>
    <a-sky src="#bg"></a-sky>
    <a-entity id="spawner"></a-entity>
    <a-entity id="rig" position="0 1.6 0">
      <a-camera id="camera" wasd-controls-enabled="false"></a-camera>
      <a-entity cursor="rayOrigin: mouse"></a-entity>
    </a-entity>
  </a-scene>

</body>
</html>

<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Rhythm Boxer · VR Fitness</title>

  <meta name="asset-base" content="/webxr-health-mobile/vr-fitness">

  <script src="https://aframe.io/releases/1.5.0/aframe.min.js" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="/webxr-health-mobile/vr-fitness/core/themes/sport-tech.css"/>

  <style>
    body{margin:0;background:#070b10;color:#e6f7ff;font:14px/1.4 system-ui}
    #hud{position:fixed;left:8px;top:8px;background:rgba(0,0,0,.35);color:#e6f7ff;padding:6px 10px;border-radius:10px;font:600 13px system-ui;z-index:10010}
    .btn{padding:8px 12px;border:0;border-radius:10px;background:#0e2233;color:#e6f7ff;cursor:pointer}
    .card{background:#0b1118;border:1px solid #203446;border-radius:12px;padding:14px 16px}
  </style>
</head>
<body>
  <a-scene renderer="colorManagement:true">
    <a-entity id="arena" position="0 0 0"></a-entity>
    <a-entity position="0 1.5 -3">
      <a-plane width="6" height="3" color="#0a0f14" opacity="0.65"></a-plane>
    </a-entity>
  </a-scene>

  <div id="hud">
    <div>Score: <span id="score">0</span></div>
    <div>Combo: <span id="combo">0</span></div>
    <div>Time: <span id="time">60</span>s</div>
  </div>

  <div style="position:fixed;left:12px;bottom:12px;display:flex;gap:8px;z-index:10040">
    <button class="btn" id="startBtn">Start</button>
    <button class="btn" id="pauseBtn">Pause</button>
    <button class="btn" id="bankBtn">Bank</button>
  </div>

  <section id="results" style="display:none;position:fixed;inset:0;z-index:10035;align-items:center;justify-content:center;background:rgba(0,0,0,.6);color:#e6f7ff">
    <div class="card" style="min-width:300px">
      <h3 style="margin:0 0 8px">RESULTS</h3>
      <div>Diff: <b id="rDiff">NORMAL</b></div>
      <div>Score: <b id="rScore">0</b></div>
      <div>Max Combo: <b id="rMaxCombo">0</b></div>
      <div>Accuracy: <b id="rAcc">0%</b></div>
      <div style="margin-top:10px;display:flex;gap:8px">
        <button class="btn" id="replayBtn">Replay</button>
        <button class="btn" id="backBtn">Back to Hub</button>
      </div>
    </div>
  </section>

  <div id="diffDock" style="
    position:fixed; right:12px; bottom:12px; z-index:1000;
    display:flex; align-items:center; gap:8px;
    background:rgba(10,16,24,.75); backdrop-filter:saturate(1.1) blur(4px);
    border:1px solid rgba(255,255,255,.08); border-radius:12px;
    padding:8px 10px; color:#e6f7ff; font:600 12px system-ui;">
    <label for="diffSel" style="opacity:.9; letter-spacing:.3px;">Difficulty</label>
    <select id="diffSel" style="
      appearance:none; background:#0e2233; color:#e6f7ff;
      border:1px solid rgba(255,255,255,.12);
      border-radius:10px; padding:6px 28px 6px 10px; font:600 12px system-ui; cursor:pointer;">
      <option value="easy">Easy</option>
      <option value="normal" selected>Normal</option>
      <option value="hard">Hard</option>
      <option value="final">Final</option>
    </select>
    <span aria-hidden="true" style="margin-left:-22px; pointer-events:none;">▼</span>
  </div>

  <script src="/webxr-health-mobile/vr-fitness/games/rhythm-boxer/game.js" defer></script>

  <script>
    (function(){
      const getQ=(k)=>new URLSearchParams(location.search).get(k);
      const sel=document.getElementById('diffSel');
      const q=getQ('diff')||localStorage.getItem('rb_diff')||'normal';
      sel.value = ({easy:1,normal:1,hard:1,final:1}[q]?q:'normal');
      sel.addEventListener('change', e=>{
        const v=e.target.value;
        try{ localStorage.setItem('rb_diff', v); }catch(_){}
        const url=new URL(location.href); url.searchParams.set('diff', v);
        location.href = url.pathname + '?' + url.searchParams.toString();
      });
    })();
  </script>
</body>
</html>

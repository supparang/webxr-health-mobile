<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8"/>
  <title>Rhythm Boxer — เล่นเกม</title>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
  <link rel="stylesheet" href="./rhythm-boxer.css"/>
</head>
<body>

<div id="rb-stage"></div>

<div class="sb-hud">
  <div>⏱ <b id="hud-time">60</b>s</div>
  <div>💯 <b id="hud-score">0</b></div>
  <div>🔥 <b id="hud-combo">x0</b></div>
  <button id="btn-pause" class="sb-btn-ghost">⏸ พัก</button>
</div>

<div id="rb-msg" class="sb-msg"></div>

<!-- Leaderboard -->
<aside id="rb-leaderboard" class="sb-leaderboard"></aside>
<button id="lb-toggle" class="sb-lb-toggle">📊</button>

<!-- Result Modal -->
<div id="result-box" class="sb-result-backdrop">
  <div class="sb-result-card">
    <h2>🏁 ผลการเล่น Rhythm Boxer</h2>
    <p>คะแนน: <b id="res-score">0</b></p>
    <p>โดนเป้า: <b id="res-hits">0</b> / พลาด: <b id="res-miss">0</b></p>
    <p>ความแม่นยำ: <b id="res-acc">0%</b></p>
    <p>คอมโบสูงสุด: <b id="res-best">x0</b></p>
    <p>ระดับ (Rank): <b id="res-rank">C</b></p>
    <hr/>
    <button id="btn-pdf" class="sb-btn-primary">📄 ดาวน์โหลด PDF</button>

    <div class="sb-result-actions">
      <button id="btn-retry" class="sb-btn-secondary">🔁 เล่นอีกครั้ง</button>
      <button id="btn-home" class="sb-btn-ghost">🏠 เมนู</button>
    </div>
  </div>
</div>

<script type="module">
import { RhythmBoxer } from './rhythm-boxer.js';

const game = new RhythmBoxer({
  stage: document.querySelector('#rb-stage'),
  hud: {
    time:  document.querySelector('#hud-time'),
    score: document.querySelector('#hud-score'),
    combo: document.querySelector('#hud-combo')
  },
  result: {
    box:   document.querySelector('#result-box'),
    score: document.querySelector('#res-score'),
    hits:  document.querySelector('#res-hits'),
    miss:  document.querySelector('#res-miss'),
    acc:   document.querySelector('#res-acc'),
    best:  document.querySelector('#res-best'),
    rank:  document.querySelector('#res-rank')
  },
  msgBox: document.querySelector('#rb-msg'),
  lbBox:  document.querySelector('#rb-leaderboard'),
  pdfBtn: document.querySelector('#btn-pdf'),
});

const btnPause = document.querySelector('#btn-pause');
const btnRetry = document.querySelector('#btn-retry');
const btnHome  = document.querySelector('#btn-home');

let isPaused = false;
btnPause.onclick = () => {
  isPaused = !isPaused;
  isPaused ? game.pause(true) : game.pause(false);
  btnPause.textContent = isPaused ? '▶ ต่อ' : '⏸ พัก';
};

btnRetry.onclick = () => { location.reload(); };
btnHome.onclick  = () => { location.href = './index.html'; };

// Leaderboard toggle + auto-hide
const lb = document.querySelector('#rb-leaderboard');
const lbToggle = document.querySelector('#lb-toggle');

lb.classList.add('hidden');
lbToggle.textContent = '📊';

lbToggle.onclick = () => {
  const hidden = lb.classList.toggle('hidden');
  lbToggle.textContent = hidden ? '📊' : '❌';
};

game.start();
</script>

</body>
</html>
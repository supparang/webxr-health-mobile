<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Jump–Duck — Play</title>
  <meta name="color-scheme" content="dark light"/>
  <style>
    html,body{margin:0;height:100%;background:#000;color:#fff;font:16px/1.4 system-ui,Segoe UI,Inter,Arial}
    #boot{position:fixed;inset:0;display:grid;place-items:center;background:radial-gradient(ellipse at top,#0f1220 0%,#000 60%);z-index:10}
    #boot .box{background:#121528;padding:18px 20px;border-radius:14px;border:1px solid #2a2f4a;box-shadow:0 10px 30px rgba(0,0,0,.35);max-width:min(92vw,560px)}
    #boot h1{margin:0 0 6px 0;font-size:18px}
    #boot p{margin:6px 0;color:#d7def0}
    #boot .log{margin-top:10px;background:#0a0d1f;border:1px solid #243;min-height:60px;max-height:200px;overflow:auto;border-radius:10px;padding:8px;font-family:ui-monospace,Menlo,Consolas,mono;font-size:12px;white-space:pre-wrap}
    #err{position:fixed;left:12px;bottom:12px;max-width:min(92vw,720px);display:none;background:#2a2f4a;border:1px solid #445;border-radius:12px;padding:10px 12px;font-size:13px;line-height:1.45;z-index:11}
    #err b{color:#fff}
  </style>
</head>
<body>
  <div id="boot">
    <div class="box">
      <h1>Loading Jump–Duck…</h1>
      <p>กำลังโหลด <code>game.js</code> และ <code>hub-adapter.js</code></p>
      <div class="log" id="bootLog">• start</div>
      <p style="opacity:.8;font-size:12px">ถ้าค้างนาน ตรวจ Console/Network ดูพาธไฟล์ผิดตัวพิมพ์หรือไม่</p>
    </div>
  </div>
  <div id="err"></div>

  <script>
    (function(){
      const u=new URL(location.href);
      window.HubLaunch={
        game:u.searchParams.get("game")||"jump-duck",
        mode:u.searchParams.get("mode")||"timed",
        diff:u.searchParams.get("diff")||"easy",
        time:Math.max(45,Math.min(180,+(u.searchParams.get("time")||80)))
      };
    })();

    const logEl=document.getElementById('bootLog'); const errEl=document.getElementById('err'); const boot=document.getElementById('boot');
    let gotGame=false, gotAdapter=false;
    const log=(s)=>{logEl.textContent+="\n• "+s; logEl.scrollTop=logEl.scrollHeight;};
    const showErr=(m)=>{errEl.style.display='block'; errEl.innerHTML="<b>⚠️ Error:</b> "+m; console.error(m);};

    window.addEventListener('error',(e)=>showErr((e.error&&e.error.stack)||e.message||String(e)),true);
    window.addEventListener('unhandledrejection',(e)=>showErr((e.reason&&(e.reason.stack||e.reason.message))||String(e.reason)),true);

    function maybeStart(){ if(gotGame&&gotAdapter){ log('both scripts loaded ✓'); boot.style.display='none'; } }

    (function(){
      const s=document.createElement('script'); s.src='/webxr-health-mobile/vr-fitness/hub-adapter.js';
      s.onload=()=>{ gotAdapter=true; log('hub-adapter.js loaded ✓'); maybeStart(); };
      s.onerror=()=>{ showErr('โหลด hub-adapter.js ไม่สำเร็จ'); log('hub-adapter.js FAILED'); };
      document.head.appendChild(s);
    })();

    (function(){
      const s=document.createElement('script'); s.type='module'; s.src='./game.js';
      s.onload=()=>{ gotGame=true; log('game.js loaded ✓'); maybeStart(); };
      s.onerror=()=>{ showErr('โหลด game.js ไม่สำเร็จ'); log('game.js FAILED'); };
      document.head.appendChild(s);
    })();

    setTimeout(()=>{ if(!(gotGame&&gotAdapter)) log('still loading… (check Network)'); },4000);
  </script>
</body>
</html>

<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>VR Fitness ‚Äî Shadow Breaker</title>
  <meta name="color-scheme" content="dark" />
  <link rel="icon" href="../../favicon.ico" />

  <!-- Shadow Breaker CSS -->
  <link rel="stylesheet" href="./shadow-breaker.css" />

  <style>
    /* fallback tiny helpers (safe even if CSS already has it) */
    .hidden{ display:none !important; }
  </style>
</head>

<body class="mode-play">
  <!-- =========================
       HUD (fixed) ‚Äî pointer-events none
  ========================== -->
  <div class="hud sb-hud" id="hud">
    <div class="card">
      <div style="display:flex;gap:10px;align-items:center;justify-content:space-between;flex-wrap:wrap">
        <div style="display:flex;gap:10px;align-items:center;flex-wrap:wrap">
          <div><span style="opacity:.7;font-weight:800">TIME</span> <span id="timeVal">60</span></div>
          <div><span style="opacity:.7;font-weight:800">SCORE</span> <span id="scoreVal">0</span></div>
          <div><span style="opacity:.7;font-weight:800">HIT</span> <span id="hitVal">0</span></div>
          <div><span style="opacity:.7;font-weight:800">MISS</span> <span id="missVal">0</span></div>
          <div><span style="opacity:.7;font-weight:800">COMBO</span> <span id="comboVal">x0</span></div>
        </div>

        <div class="lang-toggle" style="pointer-events:auto">
          <button class="lang-btn active" data-lang="th" type="button">TH</button>
          <button class="lang-btn" data-lang="en" type="button">EN</button>
        </div>
      </div>
      <div id="coachLine" style="margin-top:6px">‡πÇ‡∏Ñ‡πâ‡∏ä‡∏û‡∏∏‡πà‡∏á: ‡πÄ‡∏•‡πá‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏à‡∏≠‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏ï‡∏∞/‡∏¢‡∏¥‡∏á‡πÉ‡∏´‡πâ‡πÇ‡∏î‡∏ô! üëä</div>
    </div>
  </div>

  <!-- =========================
       TOP / META (hidden when .play-only)
       (‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö research mode ‡πÑ‡∏î‡πâ)
  ========================== -->
  <div class="top-panel card" style="position:fixed;left:10px;bottom:10px;right:10px;z-index:20;max-width:980px;margin:0 auto;">
    <div style="display:flex;gap:10px;align-items:center;justify-content:space-between;flex-wrap:wrap">
      <div>
        <div style="font-weight:900">Shadow Breaker ü•ä</div>
        <div id="tagGoal" style="opacity:.75;font-weight:700;font-size:.85rem">
          ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢: ‡∏ï‡πà‡∏≠‡∏¢/‡∏¢‡∏¥‡∏á‡πÄ‡∏õ‡πâ‡∏≤ emoji ‡πÉ‡∏´‡πâ‡∏ó‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤ ‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏Ñ‡∏≠‡∏°‡πÇ‡∏ö ‡πÅ‡∏•‡∏∞‡∏û‡∏¥‡∏ä‡∏¥‡∏ï‡∏ö‡∏≠‡∏™‡∏ó‡∏±‡πâ‡∏á 4 ‡∏ï‡∏±‡∏ß.
        </div>
      </div>
      <button id="startBtn" class="primary" type="button" style="pointer-events:auto">
        <span id="startLabel">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô</span>
      </button>
    </div>

    <div class="meta-panel" style="margin-top:10px;opacity:.95">
      <div style="display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:8px 10px">
        <label style="display:flex;flex-direction:column;gap:4px">
          <span style="opacity:.7;font-weight:800">Student ID</span>
          <input id="studentId" placeholder="‡πÄ‡∏ä‡πà‡∏ô 65001" style="pointer-events:auto" />
        </label>

        <label style="display:flex;flex-direction:column;gap:4px">
          <span style="opacity:.7;font-weight:800">School</span>
          <input id="schoolName" placeholder="‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô..." style="pointer-events:auto" />
        </label>

        <label style="display:flex;flex-direction:column;gap:4px">
          <span style="opacity:.7;font-weight:800">Classroom</span>
          <input id="classRoom" placeholder="‡∏õ.5/1" style="pointer-events:auto" />
        </label>

        <label style="display:flex;flex-direction:column;gap:4px">
          <span style="opacity:.7;font-weight:800">Group Code</span>
          <input id="groupCode" placeholder="A/B/C..." style="pointer-events:auto" />
        </label>

        <label style="display:flex;flex-direction:column;gap:4px">
          <span style="opacity:.7;font-weight:800">Device</span>
          <select id="deviceType" style="pointer-events:auto">
            <option value="auto">auto</option>
            <option value="pc">pc</option>
            <option value="mobile">mobile</option>
            <option value="vrHeadset">vrHeadset</option>
          </select>
        </label>

        <label style="display:flex;flex-direction:column;gap:4px">
          <span style="opacity:.7;font-weight:800">Note</span>
          <input id="note" placeholder="‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å..." style="pointer-events:auto" />
        </label>
      </div>

      <div style="margin-top:8px;opacity:.7;font-weight:700;font-size:.8rem">
        * ‡πÇ‡∏´‡∏°‡∏î‡∏ß‡∏¥‡∏à‡∏±‡∏¢ (research=1 ‡∏´‡∏£‡∏∑‡∏≠‡∏°‡∏µ studyId/log) ‡∏à‡∏∞‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏Å‡∏£‡∏≠‡∏Å Student ID ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°
      </div>
    </div>
  </div>

  <!-- =========================
       PLAY AREA
  ========================== -->
  <div id="gameArea" aria-label="Shadow Breaker Play Area"></div>

  <!-- feedback pop -->
  <div id="feedback" class="feedback" style="display:none"></div>

  <!-- =========================
       RESULT OVERLAY
  ========================== -->
  <div id="resultOverlay" class="hidden">
    <div class="card">
      <div style="font-weight:1000;font-size:1.2rem;margin-bottom:10px">‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏• Shadow Breaker</div>

      <div style="display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:8px 10px;font-weight:900">
        <div>Score: <span id="rScore">0</span></div>
        <div>Accuracy: <span id="rAcc">0%</span></div>
        <div>Hit: <span id="rHit">0</span></div>
        <div>Miss: <span id="rMiss">0</span></div>
        <div>Perfect: <span id="rPerfect">0</span></div>
        <div>Good: <span id="rGood">0</span></div>
        <div>Max Combo: <span id="rCombo">x0</span></div>
        <div>Time Used: <span id="rTimeUsed">0s</span></div>
      </div>

      <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:14px">
        <button id="playAgainBtn" class="primary" type="button">‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
        <button id="downloadCsvBtn" type="button">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î CSV</button>
        <button id="backHubBtn" type="button">‡∏Å‡∏•‡∏±‡∏ö HUB</button>
      </div>

      <div style="margin-top:10px;opacity:.7;font-weight:700;font-size:.8rem">
        ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: CSV ‡πÄ‡∏õ‡πá‡∏ô log ‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á (localStorage) ‚Äî Apps Script ‡∏¢‡∏±‡∏á ‚Äú‡∏û‡∏±‡∏Å‡πÑ‡∏ß‡πâ‡∏Å‡πà‡∏≠‡∏ô‚Äù ‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏¢
      </div>
    </div>
  </div>

  <!-- =========================
       HeroHealth Universal VR UI
       (‡∏¢‡∏¥‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏à‡∏≠ / tap-to-shoot -> hha:shoot)
  ========================== -->
  <script src="../../../herohealth/vr/vr-ui.js"></script>

  <!-- Shadow Breaker Game Script -->
  <script src="./shadow-breaker.js"></script>
</body>
</html>
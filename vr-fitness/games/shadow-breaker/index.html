<!-- === vr-fitness/games/shadow-breaker/index.html ===
Shadow Breaker (Production v1.1.0)
‚úÖ Loads: shadow-breaker.css + shadow-breaker.js
‚úÖ Optional: HeroHealth vr-ui.js for crosshair/tap-to-shoot => hha:shoot
‚úÖ Research meta + play mode auto-hide
‚úÖ Result overlay + CSV export
-->
<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>VR Fitness ‚Äî Shadow Breaker</title>
  <meta name="color-scheme" content="dark" />
  <meta name="theme-color" content="#020617" />
  <link rel="icon" href="../../assets/favicon.ico" />

  <link rel="stylesheet" href="./shadow-breaker.css" />

  <style>
    /* Minimal safety if CSS missing */
    .hidden{ display:none !important; }
  </style>
</head>

<body>
  <div class="page">

    <!-- ===== TOP / META PANEL (Research) ===== -->
    <div class="card research-card meta-panel" id="metaPanel">
      <div class="card-header">
        <div class="title">
          <div class="icon">ü•ä</div>
          <div>
            <h1>Shadow Breaker</h1>
            <p>VR Fitness mini-game ‚Äî timed/endless + bosses</p>
          </div>
        </div>

        <div class="lang-toggle" role="group" aria-label="Language">
          <button class="lang-btn active" data-lang="th" type="button">TH</button>
          <button class="lang-btn" data-lang="en" type="button">EN</button>
        </div>
      </div>

      <div class="hint">
        <span id="tagGoal">
          ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢: ‡∏ï‡πà‡∏≠‡∏¢/‡∏¢‡∏¥‡∏á‡πÄ‡∏õ‡πâ‡∏≤ emoji ‡πÉ‡∏´‡πâ‡∏ó‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤ ‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏Ñ‡∏≠‡∏°‡πÇ‡∏ö ‡πÅ‡∏•‡∏∞‡∏û‡∏¥‡∏ä‡∏¥‡∏ï‡∏ö‡∏≠‡∏™‡∏ó‡∏±‡πâ‡∏á 4 ‡∏ï‡∏±‡∏ß.
        </span>
      </div>

      <div class="research-grid">
        <label>
          <span>Student ID</span>
          <input id="studentId" type="text" placeholder="‡πÄ‡∏ä‡πà‡∏ô 65012345" inputmode="numeric" />
        </label>

        <label>
          <span>School</span>
          <input id="schoolName" type="text" placeholder="‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô..." />
        </label>

        <label>
          <span>Class/Room</span>
          <input id="classRoom" type="text" placeholder="‡∏õ.5/1" />
        </label>

        <label>
          <span>Group Code</span>
          <input id="groupCode" type="text" placeholder="A / B / C ..." />
        </label>

        <label>
          <span>Device</span>
          <select id="deviceType">
            <option value="auto" selected>auto</option>
            <option value="pc">pc</option>
            <option value="mobile">mobile</option>
            <option value="vrHeadset">vrHeadset</option>
          </select>
        </label>

        <label>
          <span>Note</span>
          <input id="note" type="text" placeholder="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ (optional)" />
        </label>
      </div>

      <div class="hint small" id="metaPDPA">
        * ‡πÇ‡∏´‡∏°‡∏î‡∏ß‡∏¥‡∏à‡∏±‡∏¢ (research=1 ‡∏´‡∏£‡∏∑‡∏≠‡∏°‡∏µ studyId/log) ‡∏à‡∏∞‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏Å‡∏£‡∏≠‡∏Å Student ID ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô
      </div>
    </div>

    <!-- ===== GAME CARD ===== -->
    <div class="card game-card top-panel">
      <div class="hud" id="hud">
        <div class="hud-block">
          <span class="label">TIME</span>
          <span class="value" id="timeVal">60</span>
        </div>
        <div class="hud-block">
          <span class="label">SCORE</span>
          <span class="value" id="scoreVal">0</span>
        </div>
        <div class="hud-block">
          <span class="label">HIT</span>
          <span class="value" id="hitVal">0</span>
        </div>
        <div class="hud-block">
          <span class="label">MISS</span>
          <span class="value" id="missVal">0</span>
        </div>
        <div class="hud-block">
          <span class="label">COMBO</span>
          <span class="value" id="comboVal">x0</span>
        </div>
      </div>

      <p class="coach" id="coachLine">‡πÇ‡∏Ñ‡πâ‡∏ä‡∏û‡∏∏‡πà‡∏á: ‡πÄ‡∏•‡πá‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏à‡∏≠‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏ï‡∏∞/‡∏¢‡∏¥‡∏á‡πÉ‡∏´‡πâ‡πÇ‡∏î‡∏ô! üëä</p>

      <div class="start-row">
        <button class="btn btn-main" id="startBtn" type="button">
          <span id="startLabel">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô</span>
        </button>
      </div>

      <div class="controls">
        <h2>How to play</h2>
        <ul>
          <li>‡πÅ‡∏ï‡∏∞/‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏õ‡πâ‡∏≤ emoji ‡πÉ‡∏´‡πâ‡πÄ‡∏£‡πá‡∏ß (‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏¥‡∏á‡∏î‡πâ‡∏ß‡∏¢ crosshair ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ vr-ui.js)</li>
          <li>‡∏Ñ‡∏≠‡∏°‡πÇ‡∏ö ‚â• 5 ‡∏à‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤ FEVER (‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÅ‡∏£‡∏á‡∏Ç‡∏∂‡πâ‡∏ô)</li>
          <li>‡∏ö‡∏≠‡∏™‡∏°‡∏µ HP ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏î‡∏´‡∏•‡∏≤‡∏¢‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÉ‡∏´‡πâ‡∏•‡πâ‡∏°</li>
          <li>PC: ‡∏Å‡∏î Space ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏¥‡∏á‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á‡πÑ‡∏î‡πâ</li>
        </ul>
        <div class="hint small">
          Tip: ‡πÉ‡∏™‡πà <code>view=cvr</code> + ‡πÉ‡∏ä‡πâ <code>vr-ui.js</code> ‡∏à‡∏∞‡πÄ‡∏•‡πà‡∏ô‡πÅ‡∏ö‡∏ö ‚Äú‡πÄ‡∏•‡πá‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏à‡∏≠‡πÅ‡∏•‡πâ‡∏ß‡∏¢‡∏¥‡∏á‚Äù ‡πÑ‡∏î‡πâ‡∏•‡∏∑‡πà‡∏ô‡∏°‡∏≤‡∏Å
        </div>
      </div>
    </div>

    <!-- ===== GAME PANEL ===== -->
    <div class="game-panel">
      <div id="gameArea" aria-label="Play Area"></div>
      <div id="feedback" class="feedback" aria-live="polite"></div>
    </div>

    <!-- ===== RESULT OVERLAY ===== -->
    <div class="overlay hidden" id="resultOverlay">
      <div class="overlay-box">
        <h2>Result</h2>

        <div class="result-grid">
          <div><span class="label">Score</span><span class="value" id="rScore">0</span></div>
          <div><span class="label">Accuracy</span><span class="value" id="rAcc">0%</span></div>
          <div><span class="label">Hit</span><span class="value" id="rHit">0</span></div>
          <div><span class="label">Miss</span><span class="value" id="rMiss">0</span></div>
          <div><span class="label">Perfect</span><span class="value" id="rPerfect">0</span></div>
          <div><span class="label">Good</span><span class="value" id="rGood">0</span></div>
          <div><span class="label">Max Combo</span><span class="value" id="rCombo">x0</span></div>
          <div><span class="label">Time Used</span><span class="value" id="rTimeUsed">0s</span></div>
        </div>

        <div class="overlay-actions">
          <button class="btn btn-main" id="playAgainBtn" type="button">Play again</button>
          <button class="btn btn-secondary" id="backHubBtn" type="button">Back to HUB</button>
          <button class="btn btn-secondary" id="downloadCsvBtn" type="button">Download CSV</button>
        </div>

        <div class="hint small">
          CSV ‡∏à‡∏∞‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å localStorage (ShadowBreakerSessions_v1)
        </div>
      </div>
    </div>

  </div><!-- /.page -->

  <!-- ===== Optional: HeroHealth Universal VR UI =====
       IMPORTANT: ‡πÅ‡∏Å‡πâ path ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö repo ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏à‡∏£‡∏¥‡∏á ‡πÜ
       - ‡∏ñ‡πâ‡∏≤‡πÑ‡∏ü‡∏•‡πå‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà /herohealth/vr/vr-ui.js ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ ../../../../herohealth/vr/vr-ui.js (‡∏Ç‡∏∂‡πâ‡∏ô‡∏Å‡∏±‡∏ö‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á)
       - ‡∏ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì copy ‡∏°‡∏≤‡πÑ‡∏ß‡πâ‡πÉ‡∏ô vr-fitness/shared/vr-ui.js ‡∏Å‡πá‡∏ä‡∏µ‡πâ‡∏ï‡∏≤‡∏°‡∏ô‡∏±‡πâ‡∏ô
  -->
  <script>
    // auto hide research form for play mode (no research)
    (function(){
      const qs = (k,d=null)=>{ try{ return new URL(location.href).searchParams.get(k) ?? d; }catch{ return d; } };
      const r = (qs('research','')||'').toLowerCase();
      const isResearch = r==='1' || r==='true' || r==='on' || !!qs('studyId','') || !!qs('log','');
      if(!isResearch){
        document.body.classList.add('mode-play');
      }
    })();
  </script>

  <!-- If you have the universal VR UI module, enable it:
  <script src="../../../../herohealth/vr/vr-ui.js"></script>
  -->

  <!-- Game logic -->
  <script src="./shadow-breaker.js"></script>
</body>
</html>
<!-- === vr-fitness/games/shadow-breaker/index.html ===
Shadow Breaker ‚Äî Run (PRODUCTION)
‚úÖ Uses shadow-breaker.js v1.1.0-prod
‚úÖ Uses shadow-breaker.css (safe top zone + boss bar + feedback)
‚úÖ Optional: include /herohealth/vr/vr-ui.js for crosshair + tap-to-shoot => hha:shoot
‚úÖ Pass-through: hub/view/diff/time/seed/research/studyId/log/phase/mode
‚úÖ Play mode default: hides research form (CSS uses body.mode-play)
‚úÖ Research mode: requires Student ID
-->
<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>VR Fitness ‚Äî Shadow Breaker</title>
  <meta name="color-scheme" content="dark" />
  <link rel="icon" href="../../favicon.ico" />

  <!-- Styles -->
  <link rel="stylesheet" href="./shadow-breaker.css" />

  <style>
    /* Minimal hardening: prevent selection/scroll bounce */
    html,body{ height:100%; }
    body{ overscroll-behavior:none; -webkit-user-select:none; user-select:none; }
  </style>
</head>
<body>

  <!-- =====================================================
       TOP: Meta / Research Card (hidden in play mode via CSS)
  ====================================================== -->
  <div class="page">
    <div class="card research-card meta-panel">
      <div class="card-header">
        <div class="title">
          <div class="icon">ü•ä</div>
          <div>
            <h1>Shadow Breaker</h1>
            <p id="tagGoal">‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢: ‡∏ï‡πà‡∏≠‡∏¢/‡∏¢‡∏¥‡∏á‡πÄ‡∏õ‡πâ‡∏≤ emoji ‡πÉ‡∏´‡πâ‡∏ó‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤ ‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏Ñ‡∏≠‡∏°‡πÇ‡∏ö ‡πÅ‡∏•‡∏∞‡∏û‡∏¥‡∏ä‡∏¥‡∏ï‡∏ö‡∏≠‡∏™‡∏ó‡∏±‡πâ‡∏á 4 ‡∏ï‡∏±‡∏ß.</p>
          </div>
        </div>

        <div class="lang-toggle">
          <button class="lang-btn active" data-lang="th" type="button">TH</button>
          <button class="lang-btn" data-lang="en" type="button">EN</button>
        </div>
      </div>

      <div class="research-grid">
        <label>
          <span>Student ID</span>
          <input id="studentId" placeholder="‡πÄ‡∏ä‡πà‡∏ô S12345" autocomplete="off" />
        </label>

        <label>
          <span>School</span>
          <input id="schoolName" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô" autocomplete="off" />
        </label>

        <label>
          <span>Class</span>
          <input id="classRoom" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏õ.5/1" autocomplete="off" />
        </label>

        <label>
          <span>Group Code</span>
          <input id="groupCode" placeholder="‡πÄ‡∏ä‡πà‡∏ô A / B / C" autocomplete="off" />
        </label>

        <label>
          <span>Device</span>
          <select id="deviceType">
            <option value="auto">auto</option>
            <option value="pc">pc</option>
            <option value="mobile">mobile</option>
            <option value="vrHeadset">vrHeadset</option>
          </select>
        </label>

        <label>
          <span>Note</span>
          <input id="note" placeholder="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)" autocomplete="off" />
        </label>
      </div>

      <p class="hint" id="metaPDPA">
        * ‡πÇ‡∏´‡∏°‡∏î‡∏ß‡∏¥‡∏à‡∏±‡∏¢ (research=1 / ‡∏°‡∏µ studyId / ‡∏°‡∏µ log) ‡∏à‡∏∞‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÉ‡∏´‡πâ‡∏Å‡∏£‡∏≠‡∏Å Student ID ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô
      </p>
    </div>

    <!-- =====================================================
         HUD + Start + Game Area
    ====================================================== -->
    <div class="card game-card top-panel">
      <div class="hud sb-hud" id="hud">
        <div class="hud-block">
          <span class="label">TIME</span>
          <span class="value" id="timeVal">60</span>
        </div>
        <div class="hud-block">
          <span class="label">SCORE</span>
          <span class="value" id="scoreVal">0</span>
        </div>
        <div class="hud-block">
          <span class="label">HIT</span>
          <span class="value" id="hitVal">0</span>
        </div>
        <div class="hud-block">
          <span class="label">MISS</span>
          <span class="value" id="missVal">0</span>
        </div>
        <div class="hud-block">
          <span class="label">COMBO</span>
          <span class="value" id="comboVal">x0</span>
        </div>
      </div>

      <p class="coach" id="coachLine">‡πÇ‡∏Ñ‡πâ‡∏ä‡∏û‡∏∏‡πà‡∏á: ‡πÄ‡∏•‡πá‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏à‡∏≠‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏ï‡∏∞/‡∏¢‡∏¥‡∏á‡πÉ‡∏´‡πâ‡πÇ‡∏î‡∏ô! üëä</p>

      <div class="start-row">
        <button class="btn btn-main" id="startBtn" type="button">
          <span id="startLabel">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô</span> üöÄ
        </button>
      </div>

      <div class="game-panel">
        <div id="gameArea" aria-label="Shadow Breaker Game Area"></div>

        <!-- Feedback popup -->
        <div id="feedback" class="feedback" style="display:none"></div>
      </div>

      <div class="controls">
        <h2>Controls</h2>
        <ul>
          <li>Mobile: ‡πÅ‡∏ï‡∏∞‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πâ‡∏≤</li>
          <li>PC: ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πâ‡∏≤ ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏î Space ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏¥‡∏á‡∏à‡∏≤‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏à‡∏≠</li>
          <li>VR/cVR: ‡πÄ‡∏•‡πá‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏à‡∏≠‡πÅ‡∏•‡πâ‡∏ß ‚Äú‡∏¢‡∏¥‡∏á/‡πÅ‡∏ï‡∏∞‚Äù (‡∏ú‡πà‡∏≤‡∏ô vr-ui.js ‚Üí hha:shoot)</li>
        </ul>
        <p class="hint small">
          * ‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ Enter VR/Exit/Recenter + crosshair/tap-to-shoot ‡πÉ‡∏´‡πâ include vr-ui.js (‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á)
        </p>
      </div>
    </div>
  </div>

  <!-- =====================================================
       RESULT OVERLAY
  ====================================================== -->
  <div id="resultOverlay" class="overlay hidden" aria-hidden="true">
    <div class="overlay-box">
      <h2>Result</h2>

      <div class="result-grid">
        <div><span class="label">Score</span><span class="value" id="rScore">0</span></div>
        <div><span class="label">Accuracy</span><span class="value" id="rAcc">0%</span></div>

        <div><span class="label">Hit</span><span class="value" id="rHit">0</span></div>
        <div><span class="label">Miss</span><span class="value" id="rMiss">0</span></div>

        <div><span class="label">Perfect</span><span class="value" id="rPerfect">0</span></div>
        <div><span class="label">Good</span><span class="value" id="rGood">0</span></div>

        <div><span class="label">Max Combo</span><span class="value" id="rCombo">x0</span></div>
        <div><span class="label">Time Used</span><span class="value" id="rTimeUsed">0s</span></div>
      </div>

      <div class="overlay-actions">
        <button id="playAgainBtn" class="btn btn-main" type="button">Play Again</button>
        <button id="backHubBtn" class="btn btn-secondary" type="button">Back to HUB</button>
        <button id="downloadCsvBtn" class="btn btn-secondary" type="button">Download CSV</button>
      </div>

      <p class="hint small">
        * ‡πÇ‡∏´‡∏°‡∏î play ‡∏à‡∏∞‡∏ã‡πà‡∏≠‡∏ô‡∏õ‡∏∏‡πà‡∏° Download CSV ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
      </p>
    </div>
  </div>

  <!-- =====================================================
       OPTIONAL: HeroHealth Universal VR UI (Enter VR/Exit/Recenter + crosshair shoot)
       IMPORTANT: path ‡∏ï‡πâ‡∏≠‡∏á‡∏ä‡∏µ‡πâ‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡∏≤‡∏° repo ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
  ====================================================== -->
  <script>
    // If you already use HeroHealth Universal VR UI:
    // window.HHA_VRUI_CONFIG = { lockPx: 28, cooldownMs: 90 };
  </script>
  <script src="../../herohealth/vr/vr-ui.js"></script>

  <!-- Game logic -->
  <script src="./shadow-breaker.js"></script>

  <!-- Small helper: set document language + pass-through note -->
  <script>
    // No override policy: we do NOT change URL params here.
    // Only set language attribute if user taps toggle (handled in JS).
    try{
      const params = new URL(location.href).searchParams;
      const isResearch =
        (params.get('research')||'').toLowerCase()==='1' ||
        (params.get('research')||'').toLowerCase()==='true' ||
        (params.get('research')||'').toLowerCase()==='on' ||
        !!params.get('studyId') || !!params.get('log');

      // play mode default if not research
      if(!isResearch) document.body.classList.add('mode-play');
    }catch(_){}
  </script>

</body>
</html>
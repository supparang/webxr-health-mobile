<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>VR Fitness ‚Äî Shadow Breaker (Play)</title>
  <meta name="color-scheme" content="dark" />
  <style>
    :root{
      color-scheme:dark;
      --bg:#020617;
      --bg-soft:#020617;
      --card:#020617;
      --card-soft:#020617;
      --border:#1e293b;
      --text:#e5e7eb;
      --muted:#9ca3af;
      --accent:#38bdf8;
      --accent2:#22c55e;
      --danger:#f97373;
      --surface:#020617;
    }
    *{box-sizing:border-box;margin:0;padding:0;}
    body{
      margin:0;
      min-height:100vh;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,sans-serif;
      background:
        radial-gradient(circle at top left,rgba(56,189,248,.18),transparent 55%),
        radial-gradient(circle at bottom right,rgba(34,197,94,.2),transparent 55%),
        #020617;
      color:var(--text);
    }
    .game-shell{
      max-width:960px;
      margin:16px auto 32px;
      padding:0 12px 32px;
    }

    /* --- research card --- */
    .research-card{
      background:radial-gradient(circle at top left,rgba(56,189,248,.1),transparent 55%),
                 #020617;
      border:1px solid rgba(15,23,42,.9);
      border-radius:18px;
      padding:16px 16px 12px;
      margin-bottom:16px;
      box-shadow:0 22px 45px rgba(15,23,42,.85);
    }
    .research-header{
      display:flex;
      align-items:flex-start;
      gap:10px;
      margin-bottom:12px;
    }
    .research-header .icon{
      width:32px;height:32px;border-radius:999px;
      background:rgba(56,189,248,.16);
      display:flex;align-items:center;justify-content:center;
      font-size:18px;
    }
    .research-header h2{
      font-size:17px;
      font-weight:600;
      margin-bottom:2px;
    }
    .research-header .sub{
      font-size:12px;
      color:var(--muted);
    }
    .research-grid{
      display:grid;
      grid-template-columns:repeat(2,minmax(0,1fr));
      gap:10px 12px;
      margin-top:6px;
    }
    .research-grid .field.full{grid-column:1/3;}
    .field label{
      display:block;
      font-size:12px;
      color:var(--muted);
      margin-bottom:3px;
    }
    .field input,
    .field select{
      width:100%;
      border-radius:999px;
      border:1px solid #1e293b;
      padding:8px 12px;
      font-size:13px;
      background:rgba(15,23,42,.92);
      color:var(--text);
      outline:none;
    }
    .field input::placeholder{color:#64748b;}

    /* --- main card --- */
    .shadow-card{
      margin-top:14px;
      background:radial-gradient(circle at top left,rgba(56,189,248,.1),transparent 55%),
                radial-gradient(circle at bottom right,rgba(34,197,94,.1),transparent 55%),
                #020617;
      border-radius:22px;
      border:1px solid rgba(15,23,42,.95);
      padding:16px 14px 18px;
      box-shadow:0 26px 60px rgba(15,23,42,.9);
    }

    .hud{
      display:flex;
      flex-wrap:wrap;
      justify-content:space-between;
      gap:10px;
      align-items:center;
      margin-bottom:10px;
    }
    .hud-row{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      flex:1 1 auto;
    }
    .hud-box{
      min-width:72px;
      padding:6px 10px;
      border-radius:14px;
      border:1px solid #1e293b;
      background:radial-gradient(circle at top,rgba(15,23,42,.96),rgba(15,23,42,.9));
      text-align:center;
    }
    .hud-box .label{
      font-size:11px;
      letter-spacing:.02em;
      color:var(--muted);
      margin-bottom:2px;
    }
    .hud-box .value{
      font-size:15px;
      font-weight:600;
    }

    .lang-switch{
      display:flex;
      align-items:center;
      gap:4px;
    }
    .lang-label{
      font-size:11px;
      color:var(--muted);
      margin-right:4px;
    }
    .lang-btn{
      border-radius:999px;
      border:1px solid #1f2937;
      background:#020617;
      color:var(--text);
      font-size:12px;
      padding:5px 10px;
      cursor:pointer;
      min-width:40px;
    }
    .lang-btn.active{
      background:#38bdf8;
      color:#0b1120;
      border-color:#38bdf8;
      font-weight:600;
    }

    .start-row{
      margin:4px 0 10px;
      display:flex;
      justify-content:center;
    }
    .btn{
      border:none;
      cursor:pointer;
      border-radius:999px;
      padding:10px 26px;
      font-size:15px;
      font-weight:600;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:6px;
      transition:transform .1s ease,box-shadow .1s ease,background .1s ease,opacity .1s ease;
    }
    .btn-primary{
      background:linear-gradient(135deg,#facc15,#f97316);
      color:#0b1120;
      box-shadow:0 14px 30px rgba(248,181,0,.45);
      width:100%;
      max-width:480px;
    }
    .btn-primary:active{
      transform:translateY(1px) scale(.99);
      box-shadow:0 8px 20px rgba(248,181,0,.3);
    }
    .btn-secondary{
      background:#0f172a;
      color:var(--text);
      border:1px solid #1f2937;
    }

    .game-panel{
      position:relative;
      border-radius:20px;
      border:1px solid #1e293b;
      background:radial-gradient(circle at top,#0b1220,#020617);
      padding:10px 10px 16px;
      margin-bottom:10px;
      overflow:hidden;
    }

    /* boss hud */
    .boss-barbox{
      position:relative;
      z-index:2;
      display:flex;
      align-items:center;
      gap:8px;
      margin-bottom:6px;
    }
    .boss-face{
      width:32px;height:32px;
      border-radius:999px;
      background:rgba(15,23,42,.9);
      display:flex;align-items:center;justify-content:center;
      box-shadow:0 0 12px rgba(148,163,184,.6);
      font-size:18px;
    }
    .boss-info{flex:1 1 auto;}
    .boss-label{
      font-size:11px;
      color:var(--muted);
      margin-bottom:3px;
    }
    .boss-bar{
      width:100%;
      height:8px;
      border-radius:999px;
      background:rgba(15,23,42,.9);
      overflow:hidden;
      border:1px solid rgba(30,64,175,.8);
    }
    .boss-bar-fill{
      width:100%;height:100%;
      background:linear-gradient(90deg,#22c55e,#facc15,#f97316);
      transform-origin:left center;
      transform:scaleX(1);
      transition:transform .15s ease-out;
    }

    #gameArena{
      position:relative;
      width:100%;
      height:290px;
      border-radius:14px;
      background:radial-gradient(circle at top,#020617,#020617 55%,#000814 100%);
      border:1px solid rgba(15,23,42,.95);
      overflow:hidden;
      touch-action:none;
    }
    @media (min-width:768px){
      #gameArena{height:340px;}
    }
    .hit-line{
      margin-top:8px;
      height:4px;
      border-radius:999px;
      background:linear-gradient(90deg,#22c55e,#38bdf8);
      box-shadow:0 0 14px rgba(56,189,248,.8);
    }
    #flashMsg{
      position:absolute;
      left:50%;top:50%;
      transform:translate(-50%,-20px);
      pointer-events:none;
      font-size:20px;
      font-weight:700;
      opacity:0;
      text-shadow:0 0 14px rgba(15,23,42,.85);
    }
    .flash-show{
      animation:flash-pop .4s ease-out;
    }
    @keyframes flash-pop{
      0%{opacity:0;transform:translate(-50%,-10px) scale(.9);}
      15%{opacity:1;transform:translate(-50%,-18px) scale(1.05);}
      100%{opacity:0;transform:translate(-50%,-26px) scale(.9);}
    }

    /* targets */
    .sb-target{
      will-change:transform,opacity;
    }

    .coach{
      font-size:13px;
      margin-top:4px;
      color:#e5e7eb;
    }

    .guide{
      margin-top:10px;
      padding:10px 10px 8px;
      border-radius:16px;
      border:1px solid #1f2937;
      background:rgba(15,23,42,.88);
    }
    .guide h3{
      font-size:14px;
      margin-bottom:6px;
    }
    .guide ul{
      margin-left:18px;
      margin-bottom:4px;
      font-size:13px;
      color:var(--muted);
    }
    .guide li{margin-bottom:3px;}
    .guide-sub{
      font-size:12px;
      color:var(--muted);
    }
    .hint{
      font-size:11px;
      color:#6b7280;
      margin-top:4px;
    }

    /* overlay */
    .overlay{
      position:fixed;
      inset:0;
      background:rgba(15,23,42,.90);
      display:flex;
      align-items:center;
      justify-content:center;
      z-index:50;
    }
    .overlay.hidden{display:none;}
    .overlay-box{
      width:100%;
      max-width:420px;
      padding:18px 16px 16px;
      border-radius:18px;
      background:#020617;
      border:1px solid #1f2937;
      box-shadow:0 22px 60px rgba(15,23,42,.95);
    }
    .overlay-box h2{
      font-size:17px;
      margin-bottom:10px;
    }
    .overlay-box p{
      font-size:13px;
      margin-bottom:4px;
    }
    .overlay-actions{
      margin-top:10px;
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      justify-content:flex-end;
    }
  </style>
</head>
<body>
  <div class="game-shell">

    <!-- ===== ‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ß‡∏¥‡∏à‡∏±‡∏¢‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô ===== -->
    <section class="research-card">
      <header class="research-header">
        <div class="icon">üìä</div>
        <div>
          <h2 id="researchTitle">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô‡∏ß‡∏¥‡∏à‡∏±‡∏¢</h2>
          <p id="researchSub" class="sub">
            ‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏£‡∏≠‡∏ö‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏õ‡πá‡∏ô 1 session
          </p>
        </div>
      </header>

      <div class="research-grid">
        <div class="field">
          <label for="stuId">Student ID</label>
          <input id="stuId" type="text" placeholder="‡πÄ‡∏ä‡πà‡∏ô 65001" />
        </div>

        <div class="field">
          <label for="deviceSel">Device</label>
          <select id="deviceSel">
            <option value="auto">Auto detect</option>
            <option value="mobile">Mobile / Tablet</option>
            <option value="pc">PC / Notebook</option>
            <option value="vr">VR Headset</option>
          </select>
        </div>

        <div class="field full">
          <label for="school">School</label>
          <input id="school" type="text" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô / ‡∏™‡∏ñ‡∏≤‡∏ö‡∏±‡∏ô" />
        </div>

        <div class="field">
          <label for="classRoom">Class / Room</label>
          <input id="classRoom" type="text" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏õ.5/1" />
        </div>

        <div class="field">
          <label for="note">Note (optional)</label>
          <input id="note" type="text" placeholder="‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏à‡∏£‡∏¥‡∏á / ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° ‡∏Ø‡∏•‡∏Ø" />
        </div>
      </div>
    </section>

    <!-- ===== ‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô Shadow Breaker ===== -->
    <section class="shadow-card">
      <div class="hud">
        <div class="hud-row">
          <div class="hud-box">
            <div class="label">TIME</div>
            <div class="value"><span id="timeVal">0</span>s</div>
          </div>
          <div class="hud-box">
            <div class="label">SCORE</div>
            <div class="value" id="scoreVal">0</div>
          </div>
          <div class="hud-box">
            <div class="label">HIT</div>
            <div class="value" id="hitVal">0</div>
          </div>
          <div class="hud-box">
            <div class="label">MISS</div>
            <div class="value" id="missVal">0</div>
          </div>
          <div class="hud-box">
            <div class="label">COMBO</div>
            <div class="value" id="comboVal">x0</div>
          </div>
        </div>

        <div class="lang-switch">
          <span class="lang-label">Language:</span>
          <button id="langTh" class="lang-btn active" type="button">TH</button>
          <button id="langEn" class="lang-btn" type="button">EN</button>
        </div>
      </div>

      <div class="start-row">
        <button id="startBtn" class="btn btn-primary">
          ‚ñ∂ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô
        </button>
      </div>

      <div class="game-panel">
        <div class="boss-barbox">
          <div class="boss-face" id="bossFace">üü¶</div>
          <div class="boss-info">
            <div class="boss-label">
              BOSS <span id="bossIndexVal">1/4</span>
            </div>
            <div class="boss-bar">
              <div class="boss-bar-fill" id="bossHpBar"></div>
            </div>
          </div>
        </div>

        <div id="gameArena"></div>
        <div class="hit-line"></div>
        <div id="flashMsg"></div>
      </div>

      <p id="coachLine" class="coach">
        ‡πÇ‡∏Ñ‡πâ‡∏ä‡∏û‡∏∏‡πà‡∏á: ‡∏ü‡∏±‡∏á‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏∞ ‡πÅ‡∏•‡πâ‡∏ß‡∏ï‡πà‡∏≠‡∏¢‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡πÅ‡∏ñ‡∏ö‡πÑ‡∏ü! üî•ü•ä
      </p>

      <section class="guide">
        <h3>‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏•‡πà‡∏ô / Controls</h3>
        <ul>
          <li><b>PC / Notebook:</b> ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏°‡∏≤‡∏™‡πå‡∏ö‡∏ô‡πÄ‡∏õ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÇ‡∏ú‡∏•‡πà‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤</li>
          <li><b>Mobile / Tablet:</b> ‡πÅ‡∏ï‡∏∞‡∏ô‡∏¥‡πâ‡∏ß‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πâ‡∏≤‡πÉ‡∏´‡πâ‡∏ó‡∏±‡∏ô</li>
          <li><b>VR Headset:</b> ‡πÉ‡∏ä‡πâ pointer / controller ‡πÄ‡∏•‡πá‡∏á‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î trigger ‡πÉ‡∏´‡πâ‡πÇ‡∏î‡∏ô</li>
        </ul>
        <p class="guide-sub">
          ‡∏ï‡πà‡∏≠‡∏¢‡πÄ‡∏õ‡πâ‡∏≤‡πÉ‡∏´‡πâ‡∏ó‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤ ‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô ‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ö‡∏≠‡∏™‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏±‡πâ‡∏á 4 ‡∏ï‡∏±‡∏ß‡πÉ‡∏ô‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏£‡∏≠‡∏ö
        </p>
        <p class="hint">
          Hint: ‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô‡πÉ‡∏ô VR ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏õ‡∏¥‡∏î‡πÇ‡∏´‡∏°‡∏î‡πÄ‡∏ï‡πá‡∏°‡∏à‡∏≠ (fullscreen) ‡πÉ‡∏ô‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏Ç‡∏≠‡∏á‡πÅ‡∏ß‡πà‡∏ô
        </p>
      </section>
    </section>
  </div>

  <!-- ===== Overlay ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏• ===== -->
  <div id="resultOverlay" class="overlay hidden">
    <div class="overlay-box">
      <h2>üèÅ ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô Shadow Breaker</h2>
      <p><b>Score:</b> <span id="rScore">0</span></p>
      <p><b>‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏•‡πà‡∏ô:</b> <span id="rTimeUsed">0s</span></p>
      <p><b>Max Combo:</b> <span id="rMaxCombo">x0</span></p>
      <p><b>‡∏ö‡∏≠‡∏™‡∏ó‡∏µ‡πà‡∏•‡πâ‡∏°‡πÑ‡∏î‡πâ:</b> <span id="rBossCleared">0/4</span></p>

      <div class="overlay-actions">
        <button id="playAgainBtn" class="btn btn-primary">‚ñ∂ ‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
        <button id="backBtn" class="btn btn-secondary">üè† ‡πÄ‡∏°‡∏ô‡∏π Shadow Breaker</button>
      </div>
    </div>
  </div>

  <!-- ‡πÄ‡∏Å‡∏°‡∏´‡∏•‡∏±‡∏Å -->
  <script type="module" src="./shadow-breaker.js"></script>

  <!-- script ‡∏¢‡πà‡∏≠‡∏¢: detect device + toggle ‡∏†‡∏≤‡∏©‡∏≤ -->
  <script>
    (function(){
      const deviceSel = document.getElementById('deviceSel');
      const ua = navigator.userAgent || '';
      if (/Quest|Oculus|Valve|Vive|Mixed Reality/i.test(ua)) {
        deviceSel.value = 'vr';
      } else if (/Android|iPhone|iPad|Mobile/i.test(ua)) {
        deviceSel.value = 'mobile';
      } else {
        deviceSel.value = 'pc';
      }

      const langTh = document.getElementById('langTh');
      const langEn = document.getElementById('langEn');
      const researchTitle = document.getElementById('researchTitle');
      const researchSub = document.getElementById('researchSub');
      const startBtn = document.getElementById('startBtn');
      const coachLine = document.getElementById('coachLine');
      const stuId = document.getElementById('stuId');
      const school = document.getElementById('school');
      const classRoom = document.getElementById('classRoom');
      const note = document.getElementById('note');

      const text = {
        th:{
          researchTitle:'‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô‡∏ß‡∏¥‡∏à‡∏±‡∏¢',
          researchSub:'‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏£‡∏≠‡∏ö‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏õ‡πá‡∏ô 1 session',
          start:'‚ñ∂ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô',
          coach:'‡πÇ‡∏Ñ‡πâ‡∏ä‡∏û‡∏∏‡πà‡∏á: ‡∏ü‡∏±‡∏á‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏∞ ‡πÅ‡∏•‡πâ‡∏ß‡∏ï‡πà‡∏≠‡∏¢‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡πÅ‡∏ñ‡∏ö‡πÑ‡∏ü! üî•ü•ä',
          stuPh:'‡πÄ‡∏ä‡πà‡∏ô 65001',
          schoolPh:'‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô / ‡∏™‡∏ñ‡∏≤‡∏ö‡∏±‡∏ô',
          classPh:'‡πÄ‡∏ä‡πà‡∏ô ‡∏õ.5/1',
          notePh:'‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏à‡∏£‡∏¥‡∏á / ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° ‡∏Ø‡∏•‡∏Ø'
        },
        en:{
          researchTitle:'Research Information',
          researchSub:'Fill once before playing; each run counts as 1 session.',
          start:'‚ñ∂ Start',
          coach:'Coach Pung: Listen to the beat and punch right on the line! üî•ü•ä',
          stuPh:'e.g. 65001',
          schoolPh:'School / Institute',
          classPh:'e.g. Grade 5/1',
          notePh:'Pilot / control group etc.'
        }
      };

      function setLang(code){
        const t = text[code];
        document.documentElement.lang = code === 'th' ? 'th' : 'en';
        researchTitle.textContent = t.researchTitle;
        researchSub.textContent = t.researchSub;
        startBtn.textContent = t.start;
        coachLine.textContent = t.coach;
        stuId.placeholder = t.stuPh;
        school.placeholder = t.schoolPh;
        classRoom.placeholder = t.classPh;
        note.placeholder = t.notePh;
      }

      langTh.addEventListener('click',()=>{
        langTh.classList.add('active');
        langEn.classList.remove('active');
        setLang('th');
      });
      langEn.addEventListener('click',()=>{
        langEn.classList.add('active');
        langTh.classList.remove('active');
        setLang('en');
      });

      setLang('th');
    })();
  </script>
</body>
</html>
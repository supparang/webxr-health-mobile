<script type="module">
import { ShadowBreaker } from './shadow-breaker.js';

const game = new ShadowBreaker({
  stage: document.querySelector('#sb-stage'),
  hud: {
    time:  document.querySelector('#hud-time'),
    score: document.querySelector('#hud-score'),
    combo: document.querySelector('#hud-combo'),
  },
  result: {
    box:   document.querySelector('#result-box'),
    score: document.querySelector('#res-score'),
    hits:  document.querySelector('#res-hits'),
    miss:  document.querySelector('#res-miss'),
    acc:   document.querySelector('#res-acc'),
    best:  document.querySelector('#res-best'),
    rank:  document.querySelector('#res-rank'),
  },
  msgBox: document.querySelector('#sb-msg'),
  lbBox:  document.querySelector('#sb-leaderboard'),
  pdfBtn: document.querySelector('#btn-pdf'),
});

// à¸›à¸¸à¹ˆà¸¡ pause / resume / retry / home
const btnPause = document.querySelector('#btn-pause');
const btnRetry = document.querySelector('#btn-retry');
const btnHome  = document.querySelector('#btn-home');

let isPaused = false;
btnPause?.addEventListener('click', ()=>{
  isPaused = !isPaused;
  if (isPaused){
    game.pause(true);
    btnPause.textContent = 'â–¶ à¸•à¹ˆà¸­';
  } else {
    game.pause(false);
    btnPause.textContent = 'â¸ à¸à¸±à¸';
  }
});

btnRetry?.addEventListener('click', ()=>{
  isPaused = false;
  btnPause.textContent = 'â¸ à¸à¸±à¸';
  game.start();
});

btnHome?.addEventListener('click', ()=>{
  location.href = './index.html';
});

// ===== Leaderboard toggle + auto-hide à¹à¸šà¸šà¸‚à¹‰à¸­ 2 =====
const lb       = document.querySelector('#sb-leaderboard');
const lbToggle = document.querySelector('#lb-toggle');

// à¸‹à¹ˆà¸­à¸™ leaderboard à¸•à¸±à¹‰à¸‡à¹à¸•à¹ˆà¹€à¸£à¸´à¹ˆà¸¡à¹€à¸‚à¹‰à¸²à¹€à¸à¸¡
if (lb && lbToggle) {
  lb.classList.add('hidden');   // à¹ƒà¸Šà¹‰à¸„à¸¥à¸²à¸ªà¸ˆà¸²à¸ CSS à¸—à¸µà¹ˆà¹ƒà¸ªà¹ˆà¹„à¸›à¹à¸¥à¹‰à¸§
  lbToggle.textContent = 'ğŸ“Š';  // à¹à¸ªà¸”à¸‡à¹€à¸›à¹‡à¸™à¸›à¸¸à¹ˆà¸¡à¹€à¸›à¸´à¸”

  lbToggle.addEventListener('click', ()=>{
    const isHidden = lb.classList.toggle('hidden');
    lbToggle.textContent = isHidden ? 'ğŸ“Š' : 'âŒ';
  });
}

// à¹€à¸£à¸´à¹ˆà¸¡à¹€à¸à¸¡à¸—à¸±à¸™à¸—à¸µà¹€à¸¡à¸·à¹ˆà¸­à¹‚à¸«à¸¥à¸”à¸«à¸™à¹‰à¸²
game.start();
</script>
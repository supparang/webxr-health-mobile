<!-- === /herohealth/germ-detective.html ===
Germ Detective Launcher ‚Äî PC/Mobile/Cardboard
‚úÖ Query passthrough to run file
‚úÖ Presets: case/diff/time/view
‚úÖ Seed + PID + AI toggle
‚úÖ Back to HUB support (?hub=...)
-->
<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>HeroHealth ‚Äî Germ Detective (Launcher)</title>
  <meta name="color-scheme" content="dark light" />
  <style>
    :root{
      --bg:#050814;
      --panel: rgba(2,6,23,.72);
      --line: rgba(148,163,184,.18);
      --txt: rgba(229,231,235,.95);
      --mut: rgba(148,163,184,.95);
      --acc: rgba(34,211,238,.95);
      --ok: rgba(16,185,129,.95);
      --warn: rgba(251,191,36,.95);
    }
    *{ box-sizing:border-box; }
    html,body{ height:100%; margin:0; background:
      radial-gradient(1200px 800px at 20% 0%, rgba(99,102,241,.18), transparent 55%),
      radial-gradient(900px 700px at 90% 20%, rgba(34,211,238,.14), transparent 55%),
      var(--bg);
      color:var(--txt);
      font-family:system-ui,-apple-system,"Noto Sans Thai",Segoe UI,Roboto,sans-serif;
    }
    .wrap{ max-width:980px; margin:0 auto; padding:16px; }
    .hero{
      border:1px solid var(--line);
      background: var(--panel);
      border-radius:18px;
      padding:16px;
      box-shadow: 0 20px 60px rgba(0,0,0,.35);
      backdrop-filter: blur(10px);
    }
    .title{ font-size:22px; font-weight:1000; }
    .sub{ color:var(--mut); margin-top:4px; }
    .grid{ display:grid; grid-template-columns:1.15fr .85fr; gap:14px; margin-top:14px; }
    @media (max-width:860px){ .grid{ grid-template-columns:1fr; } }

    .card{
      border:1px solid var(--line);
      background: rgba(2,6,23,.58);
      border-radius:16px;
      padding:14px;
    }
    .card h3{ margin:0 0 10px; font-size:15px; }
    .row{ display:grid; grid-template-columns:150px 1fr; gap:10px; align-items:center; margin-bottom:10px; }
    .row label{ color:var(--mut); font-weight:700; }
    @media (max-width:640px){ .row{ grid-template-columns:1fr; gap:6px; } }

    input,select{
      width:100%;
      border-radius:12px;
      border:1px solid var(--line);
      background: rgba(15,23,42,.8);
      color:var(--txt);
      padding:10px 12px;
      font:inherit;
    }
    .seg{ display:flex; gap:8px; flex-wrap:wrap; }
    .seg button{
      border:1px solid var(--line);
      background: rgba(15,23,42,.7);
      color:var(--txt);
      border-radius:999px;
      padding:8px 12px;
      cursor:pointer;
      font-weight:800;
    }
    .seg button.on{ border-color: rgba(34,211,238,.45); box-shadow: 0 0 0 2px rgba(34,211,238,.12) inset; }

    .views{ display:grid; grid-template-columns:repeat(3,1fr); gap:10px; }
    .viewBtn{
      border:1px solid var(--line); border-radius:14px; padding:12px; cursor:pointer;
      background: rgba(15,23,42,.65); text-align:left;
    }
    .viewBtn.on{ border-color: rgba(34,211,238,.45); background: rgba(2,6,23,.85); }
    .viewBtn .t{ font-weight:900; }
    .viewBtn .m{ font-size:12px; color:var(--mut); margin-top:4px; }

    .actions{ display:flex; gap:10px; flex-wrap:wrap; margin-top:12px; }
    .btn{
      appearance:none; border:none; cursor:pointer;
      border-radius:12px; padding:12px 14px; font-weight:1000; font-size:14px;
      background: rgba(2,6,23,.72); color:var(--txt);
      border:1px solid var(--line);
    }
    .btn.primary{ background: linear-gradient(180deg, rgba(34,211,238,.20), rgba(34,211,238,.08)); border-color: rgba(34,211,238,.35); }
    .btn.success{ background: linear-gradient(180deg, rgba(16,185,129,.18), rgba(16,185,129,.08)); border-color: rgba(16,185,129,.35); }

    .tips{ font-size:13px; color:var(--mut); line-height:1.45; }
    .pill{
      display:inline-flex; align-items:center; gap:6px;
      border:1px solid var(--line); border-radius:999px;
      padding:6px 10px; font-size:12px; font-weight:800;
      background: rgba(15,23,42,.55);
    }
    .preview{
      border-radius:14px; border:1px dashed var(--line); padding:12px; margin-top:10px;
      background: rgba(2,6,23,.35); font-size:13px;
      word-break: break-all;
    }
    .mut{ color:var(--mut); }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="hero">
      <div class="title">üïµÔ∏è Germ Detective ‚Äî Launcher</div>
      <div class="sub">‡∏™‡∏∑‡∏ö‡∏´‡∏≤‡∏à‡∏∏‡∏î‡πÅ‡∏û‡∏£‡πà‡πÄ‡∏ä‡∏∑‡πâ‡∏≠ ‚Ä¢ ‡πÄ‡∏Å‡πá‡∏ö‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô ‚Ä¢ ‡∏ï‡πà‡∏≠ chain ‚Ä¢ Triage cleaning ‚Ä¢ ‡∏Å‡∏î R‚ÇÄ ‡πÉ‡∏´‡πâ‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ 1</div>

      <div class="grid">
        <section class="card">
          <h3>‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏Å‡∏°</h3>

          <div class="row">
            <label for="caseId">Case</label>
            <select id="caseId">
              <option value="classroom">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô (Classroom)</option>
              <option value="home">‡∏ö‡πâ‡∏≤‡∏ô (Home)</option>
            </select>
          </div>

          <div class="row">
            <label>Difficulty</label>
            <div class="seg" id="diffSeg">
              <button type="button" data-v="easy">Easy</button>
              <button type="button" data-v="normal" class="on">Normal</button>
              <button type="button" data-v="hard">Hard</button>
            </div>
          </div>

          <div class="row">
            <label for="timeSec">‡πÄ‡∏ß‡∏•‡∏≤ (‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ)</label>
            <input id="timeSec" type="number" min="90" max="480" step="10" value="240" />
          </div>

          <div class="row">
            <label for="seed">Seed</label>
            <input id="seed" type="text" placeholder="auto" />
          </div>

          <div class="row">
            <label for="pid">Participant ID</label>
            <input id="pid" type="text" value="anon" />
          </div>

          <div class="row">
            <label for="ai">AI Coach</label>
            <select id="ai">
              <option value="1" selected>‡πÄ‡∏õ‡∏¥‡∏î (Heuristic Prediction)</option>
              <option value="0">‡∏õ‡∏¥‡∏î</option>
            </select>
          </div>
        </section>

        <section class="card">
          <h3>‡πÇ‡∏´‡∏°‡∏î‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</h3>
          <div class="views" id="viewGrid">
            <button type="button" class="viewBtn on" data-v="pc">
              <div class="t">üíª PC</div>
              <div class="m">WASD + ‡πÄ‡∏°‡∏≤‡∏™‡πå / ‡∏Ñ‡∏µ‡∏¢‡πå 1-4</div>
            </button>
            <button type="button" class="viewBtn" data-v="mobile">
              <div class="t">üì± Mobile</div>
              <div class="m">‡∏à‡∏≠‡∏¢‡πÄ‡∏™‡∏°‡∏∑‡∏≠‡∏ô + ‡πÅ‡∏ï‡∏∞‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</div>
            </button>
            <button type="button" class="viewBtn" data-v="cvr">
              <div class="t">üï∂ Cardboard</div>
              <div class="m">crosshair + tap-to-shoot + teleport + aim-assist</div>
            </button>
          </div>

          <div class="actions">
            <button id="btnPlay" class="btn primary">‚ñ∂ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°</button>
            <button id="btnQuick" class="btn success">‚ö° Quick Start (Recommended)</button>
            <button id="btnHub" class="btn">üè† ‡∏Å‡∏•‡∏±‡∏ö HUB</button>
          </div>

          <div style="margin-top:12px; display:flex; gap:8px; flex-wrap:wrap;">
            <span class="pill">‚úÖ PC / Mobile / cVR</span>
            <span class="pill">‚úÖ AI Prediction (L1)</span>
            <span class="pill">‚úÖ Offline (no App Script)</span>
          </div>

          <div class="preview" id="previewUrl"></div>

          <div class="tips" style="margin-top:10px;">
            <b>Tip:</b> ‡∏•‡∏≥‡∏î‡∏±‡∏ö‡πÄ‡∏•‡πà‡∏ô‡πÉ‡∏´‡πâ‡πÅ‡∏£‡∏á‡πÅ‡∏•‡∏∞‡∏™‡∏ô‡∏∏‡∏Å‡∏™‡∏∏‡∏î ‚Üí <span class="mut">‡πÄ‡∏Å‡πá‡∏ö‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô ‚Üí ‡∏ï‡πà‡∏≠ Chain ‚Üí Triage ‚Üí ‡∏ï‡∏µ Boss ‚Üí Submit</span>
          </div>
        </section>
      </div>
    </div>
  </div>

  <script>
    (function(){
      'use strict';

      function q(k, def=''){
        try { return new URL(location.href).searchParams.get(k) ?? def; }
        catch { return def; }
      }
      function clamp(v,a,b){
        v = Number(v); if(!Number.isFinite(v)) v = a;
        return Math.max(a, Math.min(b, v));
      }
      function nowSeed(){ return String(Date.now()); }

      const els = {
        caseId: document.getElementById('caseId'),
        timeSec: document.getElementById('timeSec'),
        seed: document.getElementById('seed'),
        pid: document.getElementById('pid'),
        ai: document.getElementById('ai'),
        diffSeg: document.getElementById('diffSeg'),
        viewGrid: document.getElementById('viewGrid'),
        btnPlay: document.getElementById('btnPlay'),
        btnQuick: document.getElementById('btnQuick'),
        btnHub: document.getElementById('btnHub'),
        previewUrl: document.getElementById('previewUrl'),
      };

      // incoming passthrough defaults
      const ctx = {
        hub: q('hub', './hub.html'),
        run: q('run', 'play'),
        caseId: q('caseId', 'classroom'),
        diff: q('diff', 'normal'),
        time: q('time', '240'),
        seed: q('seed', ''),
        pid: q('pid', 'anon'),
        ai: q('ai', '1'),
        view: q('view', 'pc'),
      };

      els.caseId.value = (ctx.caseId === 'home') ? 'home' : 'classroom';
      els.timeSec.value = String(clamp(ctx.time, 90, 480));
      els.seed.value = ctx.seed || '';
      els.pid.value = ctx.pid || 'anon';
      els.ai.value = (ctx.ai === '0') ? '0' : '1';

      let selDiff = ['easy','normal','hard'].includes(ctx.diff) ? ctx.diff : 'normal';
      let selView = ['pc','mobile','cvr'].includes(ctx.view) ? ctx.view : 'pc';

      [...els.diffSeg.querySelectorAll('button')].forEach(b=>{
        b.classList.toggle('on', b.dataset.v === selDiff);
        b.addEventListener('click', ()=>{
          selDiff = b.dataset.v;
          [...els.diffSeg.querySelectorAll('button')].forEach(x=>x.classList.toggle('on', x===b));
          refreshPreview();
        });
      });

      [...els.viewGrid.querySelectorAll('.viewBtn')].forEach(b=>{
        b.classList.toggle('on', b.dataset.v === selView);
        b.addEventListener('click', ()=>{
          selView = b.dataset.v;
          [...els.viewGrid.querySelectorAll('.viewBtn')].forEach(x=>x.classList.toggle('on', x===b));
          refreshPreview();
        });
      });

      [els.caseId, els.timeSec, els.seed, els.pid, els.ai].forEach(inp=>{
        inp.addEventListener('input', refreshPreview, false);
        inp.addEventListener('change', refreshPreview, false);
      });

      function buildRunUrl(useQuick){
        const p = new URLSearchParams();
        p.set('hub', ctx.hub || './hub.html');
        p.set('run', 'play');

        const caseId = els.caseId.value || 'classroom';
        const diff = selDiff || 'normal';
        const timeSec = String(clamp(els.timeSec.value || 240, 90, 480));
        const pid = (els.pid.value || 'anon').trim() || 'anon';
        const ai = els.ai.value === '0' ? '0' : '1';
        const seed = ((els.seed.value || '').trim() || nowSeed());

        p.set('caseId', caseId);
        p.set('diff', diff);
        p.set('time', timeSec);
        p.set('pid', pid);
        p.set('ai', ai);
        p.set('seed', seed);
        p.set('view', selView);

        // optional quality-of-life flags
        if (useQuick) p.set('quick', '1');

        return './germ-detective/germ-detective.html?' + p.toString();
      }

      function refreshPreview(){
        els.previewUrl.textContent = buildRunUrl(false);
      }

      els.btnPlay.addEventListener('click', ()=>{
        location.href = buildRunUrl(false);
      }, false);

      els.btnQuick.addEventListener('click', ()=>{
        // Recommended quick profile
        if (!els.seed.value.trim()) els.seed.value = nowSeed();
        if (!els.pid.value.trim()) els.pid.value = 'anon';
        if (!['normal','hard'].includes(selDiff)) {
          selDiff = 'normal';
          [...els.diffSeg.querySelectorAll('button')].forEach(x=>x.classList.toggle('on', x.dataset.v===selDiff));
        }
        refreshPreview();
        location.href = buildRunUrl(true);
      }, false);

      els.btnHub.addEventListener('click', ()=>{
        location.href = ctx.hub || './hub.html';
      }, false);

      refreshPreview();
    })();
  </script>
</body>
</html>
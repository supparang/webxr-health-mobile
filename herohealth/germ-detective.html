<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>HeroHealth ‚Ä¢ Germ Detective (Launcher)</title>
  <style>
    :root{
      color-scheme: dark;
      --bg:#020617;
      --bg2:#0b1220;
      --panel: rgba(2,6,23,.72);
      --line: rgba(148,163,184,.18);
      --txt: rgba(241,245,249,.96);
      --mut: rgba(148,163,184,.95);
      --acc: rgba(34,211,238,.95);
      --good: rgba(16,185,129,.95);
      --warn: rgba(251,191,36,.95);
      --bad: rgba(244,63,94,.95);

      --sat: env(safe-area-inset-top, 0px);
      --sar: env(safe-area-inset-right, 0px);
      --sab: env(safe-area-inset-bottom, 0px);
      --sal: env(safe-area-inset-left, 0px);
    }
    *{box-sizing:border-box}
    html,body{
      margin:0; height:100%;
      background:
        radial-gradient(1000px 700px at 10% 0%, rgba(99,102,241,.12), transparent 60%),
        radial-gradient(700px 500px at 100% 0%, rgba(34,211,238,.10), transparent 60%),
        linear-gradient(180deg, var(--bg2), var(--bg));
      color:var(--txt);
      font-family: system-ui,-apple-system,"Noto Sans Thai","Segoe UI",Roboto,sans-serif;
    }
    .page{
      min-height:100%;
      padding:
        calc(max(14px,var(--sat)) + 4px)
        calc(max(14px,var(--sar)) + 4px)
        calc(max(14px,var(--sab)) + 4px)
        calc(max(14px,var(--sal)) + 4px);
      display:grid;
      grid-template-rows:auto auto 1fr auto;
      gap:12px;
    }
    .hero{
      border:1px solid var(--line);
      border-radius:18px;
      background:linear-gradient(180deg, rgba(2,6,23,.78), rgba(2,6,23,.60));
      box-shadow:0 20px 60px rgba(0,0,0,.28);
      padding:14px;
    }
    .hero h1{
      margin:0;
      font-size: clamp(20px, 3.6vw, 30px);
      line-height:1.1;
      display:flex; align-items:center; gap:10px; flex-wrap:wrap;
    }
    .hero p{
      margin:8px 0 0;
      color:var(--mut);
      line-height:1.4;
      font-size:13px;
    }
    .grid{
      display:grid;
      grid-template-columns: 1.1fr .9fr;
      gap:12px;
      align-items:start;
    }
    .card{
      border:1px solid var(--line);
      border-radius:16px;
      background:linear-gradient(180deg, rgba(2,6,23,.72), rgba(2,6,23,.58));
      box-shadow:0 14px 40px rgba(0,0,0,.22);
      padding:12px;
    }
    .card h2{
      margin:0 0 8px;
      font-size:14px;
      color:var(--txt);
    }
    .mut{ color:var(--mut); font-size:12px; }

    .form-grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
    }
    .field{
      display:grid;
      gap:6px;
    }
    .field label{
      font-size:12px;
      color:var(--mut);
      font-weight:700;
    }
    .field input,.field select{
      width:100%;
      appearance:none;
      border-radius:12px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.02);
      color:var(--txt);
      padding:10px 12px;
      font:700 13px/1 system-ui,-apple-system,"Noto Sans Thai",sans-serif;
      outline:none;
    }

    .view-cards{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:10px;
      margin-top:10px;
    }
    .view-card{
      border:1px solid var(--line);
      border-radius:14px;
      background:rgba(255,255,255,.02);
      padding:10px;
      cursor:pointer;
      text-align:left;
      display:grid;
      gap:6px;
      min-height:92px;
      transition: transform .12s ease, border-color .12s ease, box-shadow .12s ease;
    }
    .view-card:hover{ transform:translateY(-1px); }
    .view-card.active{
      border-color: rgba(34,211,238,.32);
      box-shadow: inset 0 0 0 1px rgba(34,211,238,.10), 0 0 18px rgba(34,211,238,.08);
      background: linear-gradient(180deg, rgba(34,211,238,.10), rgba(34,211,238,.04));
    }
    .view-card .t1{ font-weight:900; font-size:13px; }
    .view-card .t2{ font-size:11px; color:var(--mut); line-height:1.35; }

    .scene-list{
      display:grid;
      gap:8px;
    }
    .scene-item{
      border:1px solid var(--line);
      border-radius:12px;
      padding:10px;
      background:rgba(255,255,255,.02);
      display:flex;
      justify-content:space-between;
      gap:10px;
      align-items:center;
    }
    .scene-item strong{ font-size:13px; }
    .scene-item small{ color:var(--mut); display:block; margin-top:2px; }

    .actions{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      justify-content:flex-end;
      align-items:center;
      margin-top:12px;
    }
    .btn{
      appearance:none;
      border:1px solid var(--line);
      border-radius:999px;
      padding:10px 14px;
      cursor:pointer;
      background:rgba(2,6,23,.62);
      color:var(--txt);
      font:900 13px/1 system-ui,-apple-system,"Noto Sans Thai",sans-serif;
    }
    .btn.primary{
      border-color: rgba(34,211,238,.28);
      background: linear-gradient(180deg, rgba(34,211,238,.14), rgba(34,211,238,.06));
    }
    .btn.good{
      border-color: rgba(16,185,129,.24);
      background: linear-gradient(180deg, rgba(16,185,129,.12), rgba(16,185,129,.05));
    }
    .btn.warn{
      border-color: rgba(251,191,36,.24);
      background: linear-gradient(180deg, rgba(251,191,36,.12), rgba(251,191,36,.05));
    }

    .preview{
      border:1px dashed rgba(148,163,184,.24);
      border-radius:12px;
      padding:10px;
      background: rgba(255,255,255,.01);
      font-size:12px;
      line-height:1.45;
      word-break:break-word;
    }
    code{
      color: rgba(241,245,249,.98);
      font-family: ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;
      font-size:12px;
    }

    .footer{
      color:var(--mut);
      font-size:12px;
      text-align:center;
      padding:4px 0 2px;
    }

    @media (max-width: 980px){
      .grid{ grid-template-columns: 1fr; }
      .view-cards{ grid-template-columns: 1fr; }
      .form-grid{ grid-template-columns: 1fr; }
      .actions{ justify-content:stretch; }
      .actions .btn{ flex:1 1 auto; }
    }
  </style>
</head>
<body>
  <div class="page">
    <section class="hero">
      <h1>üïµÔ∏è Germ Detective <span style="font-size:.55em;color:var(--mut);font-weight:800">HeroHealth ‚Ä¢ Launcher</span></h1>
      <p>
        ‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏à‡∏∏‡∏î‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á ‚Ä¢ ‡πÄ‡∏Å‡πá‡∏ö‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô (UV / Swab / Camera) ‚Ä¢ ‡∏ï‡πà‡∏≠ chain ‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏£‡πà ‚Ä¢ ‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡∏•‡∏î exposure ‡∏†‡∏≤‡∏¢‡πÉ‡∏ï‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏•‡∏∞‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏à‡∏≥‡∏Å‡∏±‡∏î
      </p>
    </section>

    <div class="grid">
      <section class="card">
        <h2>‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏Å‡∏°</h2>

        <div class="form-grid">
          <div class="field">
            <label for="scene">Scene</label>
            <select id="scene">
              <option value="classroom">Classroom (‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô)</option>
              <option value="home">Home (‡∏ö‡πâ‡∏≤‡∏ô)</option>
              <option value="canteen">Canteen (‡πÇ‡∏£‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£)</option>
            </select>
          </div>

          <div class="field">
            <label for="run">Mode</label>
            <select id="run">
              <option value="play">Play</option>
              <option value="research">Research</option>
            </select>
          </div>

          <div class="field">
            <label for="diff">Difficulty</label>
            <select id="diff">
              <option value="easy">Easy</option>
              <option value="normal" selected>Normal</option>
              <option value="hard">Hard</option>
            </select>
          </div>

          <div class="field">
            <label for="time">Time (seconds)</label>
            <input id="time" type="number" min="45" max="600" step="5" value="180" />
          </div>

          <div class="field">
            <label for="pid">PID (optional)</label>
            <input id="pid" type="text" placeholder="anon" />
          </div>

          <div class="field">
            <label for="seed">Seed (optional)</label>
            <input id="seed" type="text" placeholder="auto" />
          </div>
        </div>

        <h2 style="margin-top:12px">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏´‡∏°‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• / Device</h2>
        <div class="view-cards" id="viewCards">
          <button type="button" class="view-card active" data-view="pc">
            <div class="t1">üñ•Ô∏è PC</div>
            <div class="t2">‡∏Ñ‡∏•‡∏¥‡∏Å hotspot ‡πÑ‡∏î‡πâ‡∏ï‡∏£‡∏á ‡πÜ ‚Ä¢ ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏µ‡∏¢‡πå 1/2/3 ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠</div>
          </button>
          <button type="button" class="view-card" data-view="mobile">
            <div class="t1">üì± Mobile</div>
            <div class="t2">‡πÅ‡∏ï‡∏∞ hotspot ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á ‚Ä¢ UI compact ‚Ä¢ ‡∏¢‡∏±‡∏á‡πÄ‡∏•‡πà‡∏ô‡πÑ‡∏î‡πâ‡∏•‡∏∑‡πà‡∏ô</div>
          </button>
          <button type="button" class="view-card" data-view="cvr">
            <div class="t1">ü•Ω Cardboard (cVR)</div>
            <div class="t2">‡∏¢‡∏¥‡∏á‡∏à‡∏≤‡∏Å crosshair ‡∏Å‡∏•‡∏≤‡∏á‡∏à‡∏≠‡∏ú‡πà‡∏≤‡∏ô hha:shoot ‚Ä¢ ‡πÉ‡∏ä‡πâ /herohealth/vr/vr-ui.js</div>
          </button>
        </div>

        <div class="actions">
          <button class="btn" id="btnRandomSeed">‡∏™‡∏∏‡πà‡∏° Seed</button>
          <button class="btn warn" id="btnReset">‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï</button>
          <button class="btn primary" id="btnPreview">‡∏î‡∏π URL</button>
          <button class="btn good" id="btnStart">‚ñ∂ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô Germ Detective</button>
        </div>
      </section>

      <section class="card">
        <h2>Quick Guide</h2>

        <div class="scene-list" style="margin-bottom:10px">
          <div class="scene-item">
            <div>
              <strong>1) ‡∏™‡∏≥‡∏£‡∏ß‡∏à</strong>
              <small>‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏î‡πâ‡∏ß‡∏¢ UV ‡∏ó‡∏µ‡πà‡∏à‡∏∏‡∏î‡∏™‡∏±‡∏°‡∏ú‡∏±‡∏™‡∏™‡∏π‡∏á ‡πÄ‡∏ä‡πà‡∏ô ‡∏•‡∏π‡∏Å‡∏ö‡∏¥‡∏î ‡∏Å‡πä‡∏≠‡∏Å‡∏ô‡πâ‡∏≥ ‡∏£‡∏≤‡∏ß‡∏à‡∏±‡∏ö</small>
            </div>
            <span>üî¶</span>
          </div>
          <div class="scene-item">
            <div>
              <strong>2) ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô</strong>
              <small>‡πÉ‡∏ä‡πâ Swab / Camera ‡∏Å‡∏±‡∏ö‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏ô‡πà‡∏≤‡∏™‡∏á‡∏™‡∏±‡∏¢ (verification ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç)</small>
            </div>
            <span>üß™üì∑</span>
          </div>
          <div class="scene-item">
            <div>
              <strong>3) ‡∏ï‡πà‡∏≠ Chain & ‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à</strong>
              <small>‡∏à‡∏±‡∏î‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏£‡πà + ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏Å‡πâ‡∏à‡∏∏‡∏î‡∏Ñ‡∏∏‡πâ‡∏°‡∏™‡∏∏‡∏î‡∏†‡∏≤‡∏¢‡πÉ‡∏ï‡πâ‡πÄ‡∏ß‡∏•‡∏≤</small>
            </div>
            <span>üß†</span>
          </div>
          <div class="scene-item">
            <div>
              <strong>4) ‡∏£‡∏±‡∏ö‡∏°‡∏∑‡∏≠ Event</strong>
              <small>Outbreak Surge / False Clue / Time Pressure ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡∏°‡∏ó‡πâ‡∏≤‡∏ó‡∏≤‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô</small>
            </div>
            <span>üî•</span>
          </div>
        </div>

        <h2>Preview URL</h2>
        <div class="preview">
          <code id="urlPreview">-</code>
        </div>

        <h2 style="margin-top:12px">Notes</h2>
        <div class="mut">
          ‚Ä¢ Root launcher: <code>/herohealth/germ-detective.html</code><br>
          ‚Ä¢ Run page: <code>/herohealth/germ-detective/germ-detective.html</code><br>
          ‚Ä¢ ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ App Script / online logging (‡πÇ‡∏´‡∏°‡∏î local-first)
        </div>
      </section>
    </div>

    <div class="footer">HeroHealth ‚Ä¢ Germ Detective Launcher ‚Ä¢ PC / Mobile / Cardboard(cVR)</div>
  </div>

  <script>
    (function(){
      'use strict';

      const RUN_PATH = '/herohealth/germ-detective/germ-detective.html';

      const $ = (s)=>document.querySelector(s);
      const $$ = (s)=>Array.from(document.querySelectorAll(s));
      const params = new URL(location.href).searchParams;

      const elScene = $('#scene');
      const elRun   = $('#run');
      const elDiff  = $('#diff');
      const elTime  = $('#time');
      const elPid   = $('#pid');
      const elSeed  = $('#seed');
      const elUrl   = $('#urlPreview');

      let selectedView = 'pc';

      function clamp(v,a,b){
        v = Number(v);
        if(!Number.isFinite(v)) v = a;
        return Math.max(a, Math.min(b, v));
      }

      function nowSeed(){
        return String(Date.now());
      }

      function pickView(v){
        selectedView = (v === 'mobile' || v === 'cvr') ? v : 'pc';
        $$('#viewCards .view-card').forEach(b => {
          b.classList.toggle('active', b.dataset.view === selectedView);
        });
        renderURL();
      }

      function inferDefaultView(){
        const qv = String(params.get('view') || '').toLowerCase();
        if (['pc','mobile','cvr'].includes(qv)) return qv;

        // rough device detection
        const ua = navigator.userAgent || '';
        const isMobile = /Android|iPhone|iPad|iPod/i.test(ua);
        return isMobile ? 'mobile' : 'pc';
      }

      function loadFromQuery(){
        const q = params;

        if(q.get('scene')) elScene.value = q.get('scene');
        if(q.get('run'))   elRun.value   = q.get('run');
        if(q.get('diff'))  elDiff.value  = q.get('diff');
        if(q.get('time'))  elTime.value  = clamp(q.get('time'), 45, 600);
        if(q.get('pid'))   elPid.value   = q.get('pid');
        if(q.get('seed'))  elSeed.value  = q.get('seed');

        pickView(inferDefaultView());
      }

      function buildRunURL(){
        const u = new URL(RUN_PATH, location.origin);

        const scene = String(elScene.value || 'classroom');
        const run   = String(elRun.value || 'play');
        const diff  = String(elDiff.value || 'normal');
        const time  = String(clamp(elTime.value || 180, 45, 600));
        const pid   = String(elPid.value || '').trim() || 'anon';
        const seed  = String(elSeed.value || '').trim() || nowSeed();
        const view  = selectedView || 'pc';

        u.searchParams.set('scene', scene);
        u.searchParams.set('run', run);
        u.searchParams.set('diff', diff);
        u.searchParams.set('time', time);
        u.searchParams.set('pid', pid);
        u.searchParams.set('seed', seed);
        u.searchParams.set('view', view);

        // pass through hub link if present
        const hub = params.get('hub');
        if(hub) u.searchParams.set('hub', hub);

        // pass through any optional study params if present
        ['gid','phase','cond','group','api'].forEach(k=>{
          const v = params.get(k);
          if(v != null && v !== '') u.searchParams.set(k, v);
        });

        return u;
      }

      function renderURL(){
        const u = buildRunURL();
        elUrl.textContent = u.pathname + u.search;
      }

      function resetForm(){
        elScene.value = 'classroom';
        elRun.value = 'play';
        elDiff.value = 'normal';
        elTime.value = 180;
        elPid.value = '';
        elSeed.value = '';
        pickView(inferDefaultView());
      }

      // wire
      $$('#viewCards .view-card').forEach(btn=>{
        btn.addEventListener('click', ()=> pickView(btn.dataset.view), { passive:true });
      });

      [elScene, elRun, elDiff, elTime, elPid, elSeed].forEach(n=>{
        n.addEventListener('input', renderURL, { passive:true });
        n.addEventListener('change', renderURL, { passive:true });
      });

      $('#btnRandomSeed').addEventListener('click', ()=>{
        elSeed.value = nowSeed();
        renderURL();
      }, { passive:true });

      $('#btnReset').addEventListener('click', ()=>{
        resetForm();
        renderURL();
      }, { passive:true });

      $('#btnPreview').addEventListener('click', ()=>{
        renderURL();
        try{
          navigator.clipboard?.writeText(elUrl.textContent || '');
        }catch{}
      }, { passive:true });

      $('#btnStart').addEventListener('click', ()=>{
        const u = buildRunURL();
        location.href = u.pathname + u.search;
      }, { passive:true });

      // init
      loadFromQuery();
      renderURL();
    })();
  </script>
</body>
</html>
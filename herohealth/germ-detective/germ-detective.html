<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
  <title>HeroHealth — Germ Detective (Run)</title>
  <meta name="color-scheme" content="dark light"/>
  <link rel="icon" href="../favicon.ico"/>

  <link rel="stylesheet" href="./germ-detective.css?v=20260218a"/>
</head>
<body>
  <!-- ✅ Universal VR UI (ENTER VR / EXIT / RECENTER + crosshair shoot) -->
  <script src="../vr/vr-ui.js?v=20260216a"></script>

  <!-- Mount -->
  <div id="gdApp"></div>

  <!-- Core -->
  <script type="module">
    import Game from './germ-detective.js?v=20260218a';

    function qs(k, def=''){
      try{ return new URL(location.href).searchParams.get(k) ?? def; }
      catch{ return def; }
    }
    function clamp(v,a,b){
      v = Number(v); if(!Number.isFinite(v)) v=a;
      return Math.max(a, Math.min(b,v));
    }

    const ctx = {
      game: 'germ-detective',
      hub: qs('hub','../hub.html'),
      run: String(qs('run','play')).toLowerCase(),
      caseId: String(qs('case','classroom')).toLowerCase(),
      view: String(qs('view','pc')).toLowerCase(),
      diff: String(qs('diff','normal')).toLowerCase(),
      timeSec: clamp(qs('time','240'), 90, 480),
      pid: String(qs('pid','anon')),
      seed: String(qs('seed', String(Date.now()))),
      ai: clamp(qs('ai','1'), 0, 1),
      gate: clamp(qs('gate','1'), 1, 2)
    };

    // optional: tune VR UI for cVR
    window.HHA_VRUI_CONFIG = window.HHA_VRUI_CONFIG || {};
    window.HHA_VRUI_CONFIG.cvrStrict = true;
    window.HHA_VRUI_CONFIG.lockPx = 28;
    window.HHA_VRUI_CONFIG.cooldownMs = 90;

    const app = Game({ mountId:'gdApp', ctx });
    app.init();
  </script>
</body>
</html>
<!-- === /herohealth/hub.html ===
HeroHealth ‚Äî Hub (3 Zones) ‚Äî PRODUCTION (401/403-safe + Offline fallback)
PACK v20260216e (ALL + Heatmap7 + QuestDirector)
‚úÖ Quick Play (random game)
‚úÖ Zone done pills + Zone progress (plays today)
‚úÖ Daily streak + daily missions panel
‚úÖ Weekly heatmap 7 days (calendar-like)
‚úÖ Quest Director (daily quests + bonus) deterministic by day+pid
‚úÖ Last summary panel (HHA_LAST_SUMMARY) + clear
‚úÖ API banner probe (401/403 latch per-tab) + retry + reset today
‚úÖ Pass-through hub/run/diff/time/seed/studyId/phase/conditionGroup/log/view/pid/api
+ ‚úÖ PATCH: Toast + Daily Badges (Quest UX)
-->
<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>HeroHealth ‚Äî Hub</title>
  <meta name="color-scheme" content="dark light" />
  <link rel="icon" href="./favicon.ico" />
  <style>
    :root{
      --bg:#020617;
      --panel: rgba(2,6,23,.72);
      --panel2: rgba(15,23,42,.55);
      --stroke: rgba(148,163,184,.18);
      --text:#e5e7eb;
      --muted:#94a3b8;
      --good:#22c55e;
      --warn:#f59e0b;
      --bad:#ef4444;
      --cyan:#22d3ee;
      --violet:#a78bfa;
      --sat: env(safe-area-inset-top, 0px);
      --sar: env(safe-area-inset-right, 0px);
      --sab: env(safe-area-inset-bottom, 0px);
      --sal: env(safe-area-inset-left, 0px);
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans Thai",sans-serif}
    a{color:inherit;text-decoration:none}
    .wrap{min-height:100%;padding:calc(16px + var(--sat)) calc(14px + var(--sar)) calc(18px + var(--sab)) calc(14px + var(--sal));max-width:980px;margin:0 auto}
    header{display:flex;gap:12px;align-items:center;justify-content:space-between;flex-wrap:wrap}
    .brand{display:flex;gap:10px;align-items:center}
    .logo{width:44px;height:44px;border-radius:14px;background:linear-gradient(135deg, rgba(34,211,238,.25), rgba(167,139,250,.18));border:1px solid var(--stroke);display:grid;place-items:center;font-weight:1000}
    .title{font-weight:1000;letter-spacing:.2px}
    .sub{color:var(--muted);font-size:12px;font-weight:800;margin-top:2px}

    .chiprow{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
    .chip{border:1px solid var(--stroke);background:rgba(2,6,23,.35);border-radius:999px;padding:7px 10px;font-size:12px;font-weight:900;color:rgba(229,231,235,.92)}
    .chip b{color:#fff}

    .grid{margin-top:14px;display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:12px}
    @media (max-width: 860px){ .grid{grid-template-columns:repeat(2,minmax(0,1fr));} }
    @media (max-width: 560px){ .grid{grid-template-columns:1fr;} }

    .card{border:1px solid var(--stroke);background:linear-gradient(180deg, rgba(2,6,23,.86), rgba(2,6,23,.55));border-radius:20px;padding:14px;box-shadow:0 14px 50px rgba(0,0,0,.35)}
    .card h3{margin:0;font-size:14px;font-weight:1000;display:flex;gap:8px;align-items:center;justify-content:space-between}
    .card p{margin:6px 0 0 0;color:rgba(229,231,235,.78);font-weight:750;font-size:12px;line-height:1.35}

    .pill{
      display:inline-flex;align-items:center;gap:6px;
      border:1px solid var(--stroke);
      border-radius:999px;
      padding:5px 9px;
      font-size:11px;font-weight:1000;
      color:rgba(229,231,235,.9);
      background:rgba(2,6,23,.32);
      white-space:nowrap;
    }
    .pill.ok{border-color:rgba(34,197,94,.35);background:rgba(34,197,94,.14)}
    .pill.warn{border-color:rgba(245,158,11,.35);background:rgba(245,158,11,.12)}
    .pill.bad{border-color:rgba(239,68,68,.35);background:rgba(239,68,68,.12)}

    .progress{
      margin-top:10px;
      border:1px solid var(--stroke);
      border-radius:14px;
      padding:10px;
      background:rgba(2,6,23,.28);
    }
    .prow{display:flex;align-items:center;justify-content:space-between;gap:10px}
    .pname{font-size:12px;font-weight:1000;color:rgba(229,231,235,.92)}
    .pmeta{font-size:11px;font-weight:900;color:rgba(229,231,235,.75)}
    .bar{margin-top:8px;height:10px;border-radius:999px;background:rgba(148,163,184,.14);overflow:hidden}
    .fill{height:100%;width:0%;background:linear-gradient(90deg, rgba(34,211,238,.45), rgba(34,197,94,.45));}

    .btnrow{margin-top:12px;display:flex;gap:10px;flex-wrap:wrap}
    .btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:10px 12px;border-radius:14px;border:1px solid var(--stroke);background:rgba(2,6,23,.35);font-weight:1000;font-size:13px}
    .btn.primary{border-color:rgba(34,197,94,.35);background:rgba(34,197,94,.16)}
    .btn.warn{border-color:rgba(245,158,11,.35);background:rgba(245,158,11,.14)}
    .btn.ghost{background:rgba(2,6,23,.18)}
    .btn--disabled{opacity:.55;filter:saturate(.7);pointer-events:none}
    .small{font-size:12px;color:var(--muted);font-weight:850;margin-top:10px}

    .banner{margin-top:14px;border:1px solid var(--stroke);border-radius:18px;padding:12px 12px;background:rgba(2,6,23,.35);display:flex;gap:10px;align-items:flex-start}
    .dot{width:10px;height:10px;border-radius:999px;margin-top:5px}
    .dot.ok{background:var(--good)}
    .dot.warn{background:var(--warn)}
    .dot.bad{background:var(--bad)}
    .banner h4{margin:0;font-size:13px;font-weight:1000}
    .banner p{margin:4px 0 0 0;font-size:12px;color:rgba(229,231,235,.78);font-weight:750;line-height:1.35}
    .banner .actions{margin-left:auto;display:flex;gap:8px;flex-wrap:wrap}

    .panel{margin-top:14px;border:1px solid var(--stroke);border-radius:18px;padding:12px;background:rgba(2,6,23,.35)}
    .panelhead{display:flex;align-items:flex-start;justify-content:space-between;gap:10px;flex-wrap:wrap}
    .panel h4{margin:0;font-size:13px;font-weight:1000}
    .panel .meta{margin-top:4px;font-size:12px;color:rgba(229,231,235,.78);font-weight:750;line-height:1.35}
    .panel .actions{display:flex;gap:8px;flex-wrap:wrap}
    .kpirow{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
    .kpi{border:1px solid var(--stroke);border-radius:14px;padding:8px 10px;background:rgba(2,6,23,.28);min-width:160px}
    .kpi .k{font-size:11px;color:rgba(229,231,235,.72);font-weight:900}
    .kpi .v{margin-top:4px;font-size:14px;font-weight:1100}

    /* heatmap */
    .heatwrap{margin-top:10px;border:1px solid var(--stroke);border-radius:14px;background:rgba(2,6,23,.28);padding:10px}
    .heathead{display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap}
    .heathead .t{font-size:12px;font-weight:1000;color:rgba(229,231,235,.92)}
    .heathead .m{font-size:11px;font-weight:900;color:rgba(229,231,235,.75)}
    .heat{margin-top:10px;display:grid;grid-template-columns:repeat(7,minmax(0,1fr));gap:8px}
    .cell{
      border:1px solid var(--stroke);
      border-radius:12px;
      padding:10px 8px;
      background:rgba(2,6,23,.22);
      text-align:center;
      user-select:none;
    }
    .cell .d{font-size:11px;font-weight:1000;color:rgba(229,231,235,.88)}
    .cell .s{margin-top:6px;font-size:12px;font-weight:1100}
    .cell.off{opacity:.55}
    .cell.none{background:rgba(148,163,184,.08)}
    .cell.part{background:rgba(245,158,11,.10);border-color:rgba(245,158,11,.25)}
    .cell.full{background:rgba(34,197,94,.12);border-color:rgba(34,197,94,.28)}
    .cell.today{box-shadow:0 0 0 2px rgba(34,211,238,.18) inset}

    /* quests */
    .qwrap{margin-top:10px;border:1px solid var(--stroke);border-radius:14px;background:rgba(2,6,23,.28);padding:10px}
    .qgrid{margin-top:10px;display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:10px}
    @media (max-width: 560px){ .qgrid{grid-template-columns:1fr;} }
    .qcard{
      border:1px solid var(--stroke);
      border-radius:14px;
      background:rgba(2,6,23,.22);
      padding:10px;
    }
    .qtop{display:flex;align-items:flex-start;justify-content:space-between;gap:10px}
    .qtitle{font-size:12px;font-weight:1100}
    .qdesc{margin-top:6px;font-size:12px;color:rgba(229,231,235,.78);font-weight:750;line-height:1.35}
    .qstatus{font-size:11px;font-weight:1000;padding:4px 8px;border-radius:999px;border:1px solid var(--stroke);background:rgba(2,6,23,.25);white-space:nowrap}
    .qstatus.ok{border-color:rgba(34,197,94,.35);background:rgba(34,197,94,.14)}
    .qstatus.warn{border-color:rgba(245,158,11,.35);background:rgba(245,158,11,.12)}
    .qstatus.bad{border-color:rgba(239,68,68,.35);background:rgba(239,68,68,.12)}
    .qactions{margin-top:10px;display:flex;gap:8px;flex-wrap:wrap}

    /* ===== PATCH: Toast + Daily Badges ===== */
    .hh-toast-wrap{
      position: fixed;
      left: 50%;
      top: calc(10px + var(--sat));
      transform: translateX(-50%);
      z-index: 9999;
      width: min(760px, calc(100vw - 20px));
      display: grid;
      gap: 8px;
      pointer-events: none;
    }
    .hh-toast{
      border: 1px solid var(--stroke);
      background: rgba(2,6,23,.86);
      border-radius: 14px;
      padding: 10px 12px;
      box-shadow: 0 10px 30px rgba(0,0,0,.35);
      display: flex;
      gap: 10px;
      align-items: flex-start;
      opacity: 0;
      transform: translateY(-8px);
      transition: opacity .16s ease, transform .16s ease;
      pointer-events: auto;
    }
    .hh-toast.show{ opacity: 1; transform: translateY(0); }
    .hh-toast.ok{ border-color: rgba(34,197,94,.35); background: rgba(2,6,23,.9); }
    .hh-toast.warn{ border-color: rgba(245,158,11,.35); }
    .hh-toast .icon{
      width: 24px; height: 24px; border-radius: 999px;
      display: grid; place-items: center;
      font-size: 14px; font-weight: 1000;
      background: rgba(34,197,94,.14);
      border: 1px solid rgba(34,197,94,.25);
      flex: 0 0 auto;
    }
    .hh-toast .txt{ min-width: 0; }
    .hh-toast .t{ font-size: 12px; font-weight: 1100; }
    .hh-toast .m{ margin-top: 2px; font-size: 12px; color: rgba(229,231,235,.8); font-weight: 800; line-height: 1.3; }
    .hh-toast .x{
      margin-left: auto;
      border: 1px solid var(--stroke);
      background: rgba(2,6,23,.25);
      border-radius: 10px;
      padding: 4px 8px;
      font-size: 11px;
      font-weight: 1000;
      cursor: pointer;
    }

    .badgewrap{
      margin-top:10px;
      border:1px solid var(--stroke);
      border-radius:14px;
      background:rgba(2,6,23,.28);
      padding:10px;
    }
    .badgegrid{
      margin-top:10px;
      display:grid;
      grid-template-columns:repeat(3,minmax(0,1fr));
      gap:10px;
    }
    @media (max-width: 700px){ .badgegrid{ grid-template-columns:1fr; } }

    .badgecard{
      border:1px solid var(--stroke);
      border-radius:14px;
      background:rgba(2,6,23,.22);
      padding:10px;
      display:flex;
      gap:10px;
      align-items:flex-start;
    }
    .badgecard.locked{ opacity:.65; }
    .badgeicon{
      width:34px; height:34px; border-radius:12px;
      display:grid; place-items:center;
      border:1px solid var(--stroke);
      background:rgba(148,163,184,.10);
      font-size:18px;
      flex:0 0 auto;
    }
    .badgecard.ok .badgeicon{
      border-color: rgba(34,197,94,.35);
      background: rgba(34,197,94,.14);
    }
    .badgetxt .name{
      font-size:12px; font-weight:1100;
    }
    .badgetxt .meta{
      margin-top:4px;
      font-size:11px; color:rgba(229,231,235,.78); font-weight:800; line-height:1.3;
    }
    .badgepill{
      margin-top:6px;
      display:inline-flex; align-items:center; gap:6px;
      border:1px solid var(--stroke);
      border-radius:999px;
      padding:4px 8px;
      font-size:10px; font-weight:1000;
    }
    .badgepill.ok{ border-color:rgba(34,197,94,.35); background:rgba(34,197,94,.12); }
    .badgepill.lock{ border-color:rgba(148,163,184,.2); background:rgba(148,163,184,.08); }
  </style>
</head>

<body>
  <!-- ‚úÖ PATCH: Toast container -->
  <div class="hh-toast-wrap" id="hhToastWrap" aria-live="polite" aria-atomic="false"></div>

  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo">HH</div>
        <div>
          <div class="title">HeroHealth ‚Äî Hub</div>
          <div class="sub">‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏•‡πà‡∏ô‡πÑ‡∏î‡πâ‡∏ó‡∏∏‡∏Å‡πÄ‡∏Å‡∏° ‚Ä¢ ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÅ‡∏°‡πâ API ‡∏ï‡∏≠‡∏ö 401/403</div>
        </div>
      </div>

      <div class="chiprow" id="chipRow">
        <div class="chip">run: <b id="cRun">play</b></div>
        <div class="chip">diff: <b id="cDiff">normal</b></div>
        <div class="chip">time: <b id="cTime">80</b>s</div>
        <div class="chip">pid: <b id="cPid">anon</b></div>

        <a class="btn ghost" id="goQuickPlay" href="#">üé≤ Quick Play</a>
        <a class="btn ghost" id="goBadges" href="./badges.html">üèÖ Badges</a>
        <a class="btn ghost" id="goCheckin" href="./checkin.html">‚úÖ Check-in</a>
      </div>
    </header>

    <!-- API status banner -->
    <div class="banner" id="apiBanner" aria-live="polite">
      <div class="dot warn" id="apiDot"></div>
      <div>
        <h4 id="apiTitle">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‚Ä¶</h4>
        <p id="apiMsg">‡∏ñ‡πâ‡∏≤ API ‡∏•‡πà‡∏°/401/403 ‡∏´‡∏ô‡πâ‡∏≤ HUB ‡∏à‡∏∞‡∏¢‡∏±‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏õ‡∏Å‡∏ï‡∏¥ (‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏Å‡∏°‡πÑ‡∏î‡πâ‡∏ó‡∏∏‡∏Å‡πÄ‡∏Å‡∏°)</p>
      </div>
      <div class="actions">
        <a class="btn warn" href="#" id="btnRetry">Retry</a>
        <a class="btn" href="#" id="btnResetToday">Reset today</a>
      </div>
    </div>

    <!-- Daily missions + streak + heatmap -->
    <div class="panel" id="dailyPanel">
      <div class="panelhead">
        <div>
          <h4>Daily Mission</h4>
          <div class="meta" id="dailyMeta">‡∏ó‡∏≥‡∏Ñ‡∏£‡∏ö 3 ‡πÇ‡∏ã‡∏ô‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏Å‡∏©‡∏≤ streak üî•</div>
        </div>
        <div class="actions">
          <a class="btn" href="#" id="btnRefreshDaily">Refresh</a>
        </div>
      </div>

      <div class="kpirow">
        <div class="kpi">
          <div class="k">Streak</div>
          <div class="v" id="kStreak">0 üî•</div>
        </div>
        <div class="kpi">
          <div class="k">Today Completed</div>
          <div class="v" id="kTodayDone">0 / 3</div>
        </div>
        <div class="kpi">
          <div class="k">Plays Today</div>
          <div class="v" id="kPlaysToday">0</div>
        </div>
      </div>

      <div class="heatwrap">
        <div class="heathead">
          <div class="t">Weekly Heatmap (7 days)</div>
          <div class="m" id="heatMeta">‚Äî</div>
        </div>
        <div class="heat" id="heatGrid">
          <!-- JS render 7 cells -->
        </div>
      </div>

      <div class="qwrap">
        <div class="heathead">
          <div class="t">Quest Director (Today)</div>
          <div class="m" id="qMeta">‚Äî</div>
        </div>
        <div class="qgrid" id="qGrid">
          <!-- JS render quests -->
        </div>
      </div>

      <!-- ‚úÖ PATCH: Daily Badges -->
      <div class="badgewrap">
        <div class="heathead">
          <div class="t">Daily Badges</div>
          <div class="m" id="badgeMeta">‚Äî</div>
        </div>
        <div class="badgegrid" id="badgeGrid">
          <!-- JS render -->
        </div>
      </div>
    </div>

    <!-- Last summary -->
    <div class="panel" id="lastSummary" style="display:none">
      <div class="panelhead">
        <div>
          <h4 id="lsTitle">‡∏™‡∏£‡∏∏‡∏õ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h4>
          <div class="meta" id="lsBody">‚Äî</div>
        </div>
        <div class="actions">
          <a class="btn" href="#" id="btnClearSummary">Clear summary</a>
        </div>
      </div>
    </div>

    <div class="grid">
      <div class="card">
        <h3>
          <span>ü•ó Nutrition Zone</span>
          <span class="pill warn" id="zNutrition">Today: ‚Äî</span>
        </h3>
        <p>GoodJunk ‚Ä¢ Food Groups ‚Ä¢ Hydration ‚Ä¢ Balanced Plate</p>

        <div class="progress">
          <div class="prow">
            <div class="pname">Progress ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>
            <div class="pmeta" id="pNutritionMeta">0 play ‚Ä¢ 0%</div>
          </div>
          <div class="bar"><div class="fill" id="pNutritionFill"></div></div>
        </div>

        <div class="btnrow">
          <a class="btn primary" id="goGoodJunk" href="./goodjunk-vr.html">GoodJunkVR</a>
          <a class="btn" id="goGroups" href="./groups-vr.html">GroupsVR</a>
          <a class="btn" id="goHydration" href="./hydration-vr.html">HydrationVR</a>
          <a class="btn" id="goPlate" href="./plate-vr.html">PlateVR</a>
        </div>
        <div class="small">* ‡∏™‡πà‡∏á‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå run/diff/time/seed/pid/hub/api ‡∏ï‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡∏°‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</div>
      </div>

      <div class="card">
        <h3>
          <span>üßº Hygiene Zone</span>
          <span class="pill warn" id="zHygiene">Today: ‚Äî</span>
        </h3>
        <p><b>Handwash</b> ‚Ä¢ Brush ‚Ä¢ Mask &amp; Cough ‚Ä¢ Germ Detective</p>

        <div class="progress">
          <div class="prow">
            <div class="pname">Progress ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>
            <div class="pmeta" id="pHygieneMeta">0 play ‚Ä¢ 0%</div>
          </div>
          <div class="bar"><div class="fill" id="pHygieneFill"></div></div>
        </div>

        <div class="btnrow">
          <a class="btn primary" id="goHandwash" href="./hygiene-vr.html">Handwash</a>
          <a class="btn" id="goBrush" href="./brush-vr.html">Brush</a>
          <a class="btn" id="goMaskCough" href="./maskcough-vr.html">MaskCough</a>
          <a class="btn" id="goGermDetective" href="#" aria-disabled="true">Germ Detective</a>
        </div>
        <div class="small">* Germ Detective: coming soon (‡πÑ‡∏°‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ 404)</div>
      </div>

      <div class="card">
        <h3>
          <span>üèÉ Fitness Zone</span>
          <span class="pill warn" id="zFitness">Today: ‚Äî</span>
        </h3>
        <p>Planner ‚Ä¢ Shadow Breaker ‚Ä¢ Rhythm Boxer ‚Ä¢ Jump-Duck ‚Ä¢ Balance Hold</p>

        <div class="progress">
          <div class="prow">
            <div class="pname">Progress ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>
            <div class="pmeta" id="pFitnessMeta">0 play ‚Ä¢ 0%</div>
          </div>
          <div class="bar"><div class="fill" id="pFitnessFill"></div></div>
        </div>

        <div class="btnrow">
          <a class="btn primary" id="goPlanner" href="./fitness-planner-vr.html">Fitness Planner</a>
          <a class="btn" id="goShadow" href="../fitness/shadow-breaker.html">Shadow Breaker</a>
          <a class="btn" id="goRhythm" href="../fitness/rhythm-boxer.html">Rhythm Boxer</a>
          <a class="btn" id="goJumpDuck" href="./jump-duck-vr.html">Jump-Duck</a>
          <a class="btn" id="goBalanceHold" href="./balance-hold-vr.html">Balance Hold</a>
        </div>
        <div class="small">* Jump-Duck/Balance Hold ‡πÉ‡∏ä‡πâ launcher ‡∏ó‡∏µ‡πà root</div>
      </div>
    </div>
  </div>

  <script type="module" src="./hub.boot.js"></script>
</body>
</html>
<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Hero Health ‚Äî VR Nutrition Hub</title>
  <meta name="color-scheme" content="light dark" />
  <link rel="icon" href="./favicon.ico" type="image/x-icon">

  <style>
    :root{
      color-scheme: dark;
      --bg-main:#020617;
      --panel:#020617;
      --panel-soft:#0b1120;
      --accent:#22c55e;
      --accent-soft:rgba(34,197,94,0.18);
      --accent-blue:#38bdf8;
      --danger:#f97316;
      --text-main:#e5e7eb;
      --text-soft:#9ca3af;
      --radius-lg:18px;
      --radius-pill:999px;
    }
    *{ box-sizing:border-box; }

    body{
      margin:0;
      min-height:100vh;
      font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
      background:
        radial-gradient(circle at top left, rgba(56,189,248,0.16), transparent 55%),
        radial-gradient(circle at bottom right, rgba(34,197,94,0.22), transparent 55%),
        var(--bg-main);
      color:var(--text-main);
      padding:16px 10px 24px;
    }

    .shell{ max-width:1120px; margin:0 auto; }

    header{
      display:flex;
      flex-wrap:wrap;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
      margin-bottom:16px;
    }
    .title-wrap{ display:flex; flex-direction:column; gap:4px; }
    .title{
      font-size:clamp(1.5rem, 3vw, 1.9rem);
      font-weight:800;
      letter-spacing:.04em;
      text-transform:uppercase;
    }
    .subtitle{ font-size:13px; color:var(--text-soft); }

    .badge-strip{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      align-items:center;
    }
    .pill{
      font-size:11px;
      padding:4px 10px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,0.45);
      background:rgba(15,23,42,0.9);
      display:inline-flex;
      align-items:center;
      gap:6px;
      color:var(--text-soft);
    }
    .pill span.emoji{ font-size:16px; }

    .card{
      background:linear-gradient(135deg, rgba(15,23,42,0.96), rgba(15,23,42,0.9));
      border-radius:var(--radius-lg);
      border:1px solid rgba(148,163,184,0.26);
      box-shadow:0 20px 40px rgba(15,23,42,0.9);
      padding:14px 16px;
      margin-bottom:14px;
    }

    .profile-grid{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(170px,1fr));
      gap:10px 14px;
      margin-top:10px;
    }
    label{
      display:block;
      font-size:11px;
      text-transform:uppercase;
      letter-spacing:.12em;
      color:var(--text-soft);
      margin-bottom:2px;
    }
    input, select{
      width:100%;
      border-radius:12px;
      border:1px solid rgba(30,64,175,0.6);
      background:rgba(15,23,42,0.9);
      padding:6px 9px;
      color:var(--text-main);
      font-size:13px;
      outline:none;
    }
    input:focus, select:focus{
      border-color:var(--accent);
      box-shadow:0 0 0 1px rgba(34,197,94,0.35);
    }

    .row2{
      display:grid;
      grid-template-columns: 1fr 180px;
      gap:10px;
      margin-top:10px;
    }
    @media (max-width:640px){
      .row2{ grid-template-columns: 1fr; }
    }

    .profile-footer{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-top:10px;
      gap:10px;
      flex-wrap:wrap;
      font-size:12px;
      color:var(--text-soft);
    }

    .btn{
      border-radius:999px;
      border:1px solid rgba(148,163,184,0.6);
      padding:7px 14px;
      font-size:12px;
      font-weight:600;
      cursor:pointer;
      background:rgba(15,23,42,0.9);
      color:var(--text-main);
      display:inline-flex;
      align-items:center;
      gap:6px;
      transition:background .15s ease, box-shadow .15s ease, transform .1s ease;
    }
    .btn span.emoji{ font-size:15px; }
    .btn:hover{
      background:rgba(15,23,42,1);
      box-shadow:0 12px 26px rgba(15,23,42,0.9);
      transform:translateY(-1px);
    }
    .btn:active{ transform:translateY(0); box-shadow:0 8px 18px rgba(15,23,42,0.8); }

    .btn-outline{
      border-style:dashed;
      border-color:rgba(148,163,184,0.7);
      background:rgba(15,23,42,0.7);
      color:var(--text-soft);
    }

    .zones{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(280px,1fr));
      gap:14px;
      margin-top:10px;
    }

    .zone-header{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:8px;
      margin-bottom:10px;
    }
    .zone-title{
      font-size:13px;
      text-transform:uppercase;
      letter-spacing:.16em;
      color:var(--text-soft);
    }
    .zone-tag{
      font-size:11px;
      padding:3px 9px;
      border-radius:999px;
      border:1px solid rgba(34,197,94,0.7);
      background:rgba(22,163,74,0.16);
      color:#bbf7d0;
      display:inline-flex;
      align-items:center;
      gap:4px;
    }
    .zone-tag.research{
      border-color:rgba(59,130,246,0.8);
      background:rgba(37,99,235,0.18);
      color:#bfdbfe;
    }

    .game-list{ display:flex; flex-direction:column; gap:10px; }

    .game-card{
      border-radius:16px;
      border:1px solid rgba(148,163,184,0.3);
      background:radial-gradient(circle at top left, rgba(34,197,94,0.16), transparent 55%),
                 rgba(15,23,42,0.95);
      padding:8px 10px;
      display:grid;
      grid-template-columns:minmax(0,1.4fr) minmax(0,1.2fr);
      gap:6px 10px;
      align-items:center;
    }
    .game-card.research{
      background:radial-gradient(circle at top left, rgba(59,130,246,0.2), transparent 55%),
                 rgba(15,23,42,0.95);
    }

    .game-main{ display:flex; flex-direction:column; gap:2px; }
    .game-name{ font-size:13px; font-weight:600; display:flex; align-items:center; gap:6px; }
    .game-name span.emoji{ font-size:18px; }
    .game-desc{ font-size:11px; color:var(--text-soft); }

    .game-controls{
      display:flex;
      flex-direction:column;
      align-items:flex-end;
      gap:4px;
      font-size:11px;
    }
    .game-row{
      display:flex;
      gap:6px;
      align-items:center;
      justify-content:flex-end;
      flex-wrap:wrap;
    }
    .pill-small{
      font-size:10px;
      padding:2px 7px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,0.45);
      color:var(--text-soft);
      background:rgba(15,23,42,0.9);
    }
    .select-small{
      width:auto;
      min-width:90px;
      max-width:120px;
      font-size:11px;
      padding:4px 8px;
      border-radius:999px;
    }
    .btn-xs{
      padding:5px 10px;
      font-size:11px;
      border-radius:999px;
    }
    .btn-primary{
      border-color:rgba(34,197,94,0.9);
      background:linear-gradient(135deg,#22c55e,#16a34a);
      color:#022c22;
    }
    .btn-primary:hover{ background:linear-gradient(135deg,#4ade80,#22c55e); }
    .btn-research{
      border-color:rgba(59,130,246,0.9);
      background:linear-gradient(135deg,#38bdf8,#2563eb);
      color:#011627;
    }
    .btn-research:hover{ background:linear-gradient(135deg,#7dd3fc,#38bdf8); }

    .hint-text{ font-size:11px; color:var(--text-soft); margin-top:4px; }
    .footer-note{ margin-top:14px; font-size:10px; color:var(--text-soft); text-align:right; }

    @media (max-width:640px){
      .game-card{ grid-template-columns:1fr; align-items:flex-start; }
      .game-controls{ align-items:flex-start; }
    }
  </style>
</head>

<body>
<div class="shell">

  <header>
    <div class="title-wrap">
      <div class="title">Hero Health ‚Äî VR Nutrition Hub</div>
      <div class="subtitle">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏Å‡∏° ‚Ä¢ ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏Å ‚Ä¢ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‚Ä¢ ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Logger Endpoint ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô</div>
    </div>
    <div class="badge-strip">
      <div class="pill"><span class="emoji">ü•¶</span><span>Good vs Junk ‚Ä¢ Hydration ‚Ä¢ Plate ‚Ä¢ Groups</span></div>
      <div class="pill"><span class="emoji">üìä</span><span>Research-ready (‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ Google Sheet)</span></div>
    </div>
  </header>

  <!-- LOGGER CARD -->
  <section class="card">
    <div style="display:flex;justify-content:space-between;align-items:center;gap:8px;flex-wrap:wrap;">
      <div style="font-size:13px;font-weight:600;display:flex;align-items:center;gap:6px;">
        <span>üîó Logger Endpoint</span>
      </div>
      <button type="button" class="btn btn-outline" id="btn-load-endpoint">
        <span class="emoji">üîÑ</span> ‡πÇ‡∏´‡∏•‡∏î Endpoint ‡πÄ‡∏î‡∏¥‡∏°
      </button>
    </div>

    <div class="row2">
      <div>
        <label for="p-endpoint">Google Apps Script WebApp URL (/exec)</label>
        <input id="p-endpoint" placeholder="https://script.google.com/macros/s/XXXXX/exec" autocomplete="off" />
        <div class="hint-text">
          * Hub ‡∏à‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏õ‡πá‡∏ô <code>sessionStorage.HHA_LOG_ENDPOINT</code> ‡πÅ‡∏•‡πâ‡∏ß‡∏ó‡∏∏‡∏Å‡πÄ‡∏Å‡∏°‡∏à‡∏∞‡∏≠‡πà‡∏≤‡∏ô‡πÄ‡∏≠‡∏á (GoodJunk/Hydration/Plate/Groups)
        </div>
      </div>
      <div style="display:flex;align-items:flex-end;">
        <button type="button" class="btn btn-primary" id="btn-save-endpoint" style="width:100%;justify-content:center;">
          <span class="emoji">üíæ</span> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Endpoint
        </button>
      </div>
    </div>
  </section>

  <!-- PROFILE CARD -->
  <section class="card">
    <div style="display:flex;justify-content:space-between;align-items:center;gap:8px;flex-wrap:wrap;">
      <div style="font-size:13px;font-weight:600;display:flex;align-items:center;gap:6px;">
        <span>üìã ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</span>
      </div>
      <button type="button" class="btn btn-outline" id="btn-load-profile">
        <span class="emoji">üîÑ</span> ‡πÇ‡∏´‡∏•‡∏î‡∏à‡∏≤‡∏Å‡∏£‡∏≠‡∏ö‡∏Å‡πà‡∏≠‡∏ô
      </button>
    </div>

    <div class="profile-grid">
      <div>
        <label for="p-student-id">‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô / Student ID</label>
        <input id="p-student-id" autocomplete="off" />
      </div>
      <div>
        <label for="p-name">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô / Nickname</label>
        <input id="p-name" autocomplete="off" />
      </div>
      <div>
        <label for="p-grade">‡∏ä‡∏±‡πâ‡∏ô / Grade</label>
        <input id="p-grade" placeholder="‡∏õ.5 / Grade 5" autocomplete="off" />
      </div>
      <div>
        <label for="p-class">‡∏´‡πâ‡∏≠‡∏á / Room</label>
        <input id="p-class" placeholder="‡πÄ‡∏ä‡πà‡∏ô 5/1" autocomplete="off" />
      </div>
      <div>
        <label for="p-school">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô / School</label>
        <input id="p-school" autocomplete="off" />
      </div>
      <div>
        <label for="p-group">‡∏Å‡∏•‡∏∏‡πà‡∏° / Group (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)</label>
        <input id="p-group" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡∏•‡∏∏‡πà‡∏° A / ‡∏ó‡∏µ‡∏° 1" autocomplete="off" />
      </div>
    </div>

    <div class="profile-footer">
      <div>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏µ‡πâ‡πÉ‡∏ô <code>sessionStorage.HHA_STUDENT_PROFILE</code> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡πÄ‡∏Å‡∏° VR</div>
      <button type="button" class="btn btn-primary" id="btn-save-profile">
        <span class="emoji">üíæ</span> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå
      </button>
    </div>
  </section>

  <div class="zones">

    <!-- PLAY MODE -->
    <section class="card">
      <div class="zone-header">
        <div class="zone-title">Play Mode</div>
        <div class="zone-tag"><span class="emoji">üéÆ</span>‡πÄ‡∏•‡πà‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥</div>
      </div>

      <div class="game-list">
        <div class="game-card">
          <div class="game-main">
            <div class="game-name"><span class="emoji">ü•¶</span><span>Good vs Junk VR</span></div>
            <div class="game-desc">‡πÅ‡∏ï‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏î‡∏µ ‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏Ç‡∏≠‡∏á‡∏Ç‡∏¢‡∏∞ + Fever/Quest/Grade</div>
          </div>
          <div class="game-controls">
            <div class="game-row">
              <span class="pill-small">‡∏£‡∏∞‡∏î‡∏±‡∏ö</span>
              <select class="select-small" data-game="goodjunk" data-role="diff">
                <option value="easy">‡∏á‡πà‡∏≤‡∏¢</option>
                <option value="normal" selected>‡∏õ‡∏Å‡∏ï‡∏¥</option>
                <option value="hard">‡∏¢‡∏≤‡∏Å</option>
              </select>
            </div>
            <div class="game-row"><span class="pill-small" id="time-label-goodjunk">‡πÄ‡∏ß‡∏•‡∏≤‡πÇ‡∏î‡∏¢‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì: 60 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</span></div>
            <div class="game-row">
              <button type="button" class="btn btn-xs btn-primary" data-game="goodjunk" data-run="play">
                <span class="emoji">‚ñ∂Ô∏è</span> ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô
              </button>
            </div>
          </div>
        </div>

        <div class="game-card">
          <div class="game-main">
            <div class="game-name"><span class="emoji">üíß</span><span>Hydration VR</span></div>
            <div class="game-desc">‡∏£‡∏±‡∏Å‡∏©‡∏≤ Water Gauge ‡πÉ‡∏´‡πâ‡∏™‡∏°‡∏î‡∏∏‡∏•</div>
          </div>
          <div class="game-controls">
            <div class="game-row">
              <span class="pill-small">‡∏£‡∏∞‡∏î‡∏±‡∏ö</span>
              <select class="select-small" data-game="hydration" data-role="diff">
                <option value="easy">‡∏á‡πà‡∏≤‡∏¢</option>
                <option value="normal" selected>‡∏õ‡∏Å‡∏ï‡∏¥</option>
                <option value="hard">‡∏¢‡∏≤‡∏Å</option>
              </select>
            </div>
            <div class="game-row"><span class="pill-small" id="time-label-hydration">‡πÄ‡∏ß‡∏•‡∏≤‡πÇ‡∏î‡∏¢‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì: 70 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</span></div>
            <div class="game-row">
              <button type="button" class="btn btn-xs btn-primary" data-game="hydration" data-run="play">
                <span class="emoji">‚ñ∂Ô∏è</span> ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô
              </button>
            </div>
          </div>
        </div>

        <div class="game-card">
          <div class="game-main">
            <div class="game-name"><span class="emoji">üçΩÔ∏è</span><span>Healthy Plate VR</span></div>
            <div class="game-desc">‡∏à‡∏±‡∏î‡∏à‡∏≤‡∏ô‡∏™‡∏°‡∏î‡∏∏‡∏• + Perfect Plate + Mini quest + Grade</div>
          </div>
          <div class="game-controls">
            <div class="game-row">
              <span class="pill-small">‡∏£‡∏∞‡∏î‡∏±‡∏ö</span>
              <select class="select-small" data-game="plate" data-role="diff">
                <option value="easy">‡∏á‡πà‡∏≤‡∏¢</option>
                <option value="normal" selected>‡∏õ‡∏Å‡∏ï‡∏¥</option>
                <option value="hard">‡∏¢‡∏≤‡∏Å</option>
              </select>
            </div>
            <div class="game-row"><span class="pill-small" id="time-label-plate">‡πÄ‡∏ß‡∏•‡∏≤‡πÇ‡∏î‡∏¢‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì: 70 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</span></div>
            <div class="game-row">
              <button type="button" class="btn btn-xs btn-primary" data-game="plate" data-run="play">
                <span class="emoji">‚ñ∂Ô∏è</span> ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô
              </button>
            </div>
          </div>
        </div>

        <div class="game-card">
          <div class="game-main">
            <div class="game-name"><span class="emoji">üß©</span><span>Food Groups VR</span></div>
            <div class="game-desc">‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏´‡∏°‡∏ß‡∏î</div>
          </div>
          <div class="game-controls">
            <div class="game-row">
              <span class="pill-small">‡∏£‡∏∞‡∏î‡∏±‡∏ö</span>
              <select class="select-small" data-game="groups" data-role="diff">
                <option value="easy">‡∏á‡πà‡∏≤‡∏¢</option>
                <option value="normal" selected>‡∏õ‡∏Å‡∏ï‡∏¥</option>
                <option value="hard">‡∏¢‡∏≤‡∏Å</option>
              </select>
            </div>
            <div class="game-row"><span class="pill-small" id="time-label-groups">‡πÄ‡∏ß‡∏•‡∏≤‡πÇ‡∏î‡∏¢‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì: 70 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</span></div>
            <div class="game-row">
              <button type="button" class="btn btn-xs btn-primary" data-game="groups" data-run="play">
                <span class="emoji">‚ñ∂Ô∏è</span> ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô
              </button>
            </div>
          </div>
        </div>
      </div>

      <div class="hint-text">* ‡πÇ‡∏´‡∏°‡∏î Play ‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏¥‡∏à‡∏±‡∏¢ ‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡πÉ‡∏ä‡πâ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÑ‡∏î‡πâ</div>
    </section>

    <!-- RESEARCH MODE -->
    <section class="card">
      <div class="zone-header">
        <div class="zone-title">Research Mode</div>
        <div class="zone-tag research"><span class="emoji">üß™</span>‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á Google Sheet</div>
      </div>

      <div class="game-list">
        <div class="game-card research">
          <div class="game-main">
            <div class="game-name"><span class="emoji">ü•¶</span><span>Good vs Junk ‚Äî Research</span></div>
            <div class="game-desc">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Session + Event (RT/Quest/Fever/spawnX ‡∏Ø‡∏•‡∏Ø)</div>
          </div>
          <div class="game-controls">
            <div class="game-row">
              <span class="pill-small">‡∏£‡∏∞‡∏î‡∏±‡∏ö</span>
              <select class="select-small" data-game="goodjunk" data-role="diff-r">
                <option value="easy">‡∏á‡πà‡∏≤‡∏¢</option>
                <option value="normal" selected>‡∏õ‡∏Å‡∏ï‡∏¥</option>
                <option value="hard">‡∏¢‡∏≤‡∏Å</option>
              </select>
            </div>
            <div class="game-row"><span class="pill-small" id="time-label-goodjunk-r">‡πÄ‡∏ß‡∏•‡∏≤‡πÇ‡∏î‡∏¢‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì: 60 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</span></div>
            <div class="game-row">
              <button type="button" class="btn btn-xs btn-research" data-game="goodjunk" data-run="research">
                <span class="emoji">üß™</span> ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÇ‡∏´‡∏°‡∏î‡∏ß‡∏¥‡∏à‡∏±‡∏¢
              </button>
            </div>
          </div>
        </div>

        <div class="game-card research">
          <div class="game-main">
            <div class="game-name"><span class="emoji">üíß</span><span>Hydration ‚Äî Research</span></div>
            <div class="game-desc">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Session + Event (Water Gauge/Fever/Quest)</div>
          </div>
          <div class="game-controls">
            <div class="game-row">
              <span class="pill-small">‡∏£‡∏∞‡∏î‡∏±‡∏ö</span>
              <select class="select-small" data-game="hydration" data-role="diff-r">
                <option value="easy">‡∏á‡πà‡∏≤‡∏¢</option>
                <option value="normal" selected>‡∏õ‡∏Å‡∏ï‡∏¥</option>
                <option value="hard">‡∏¢‡∏≤‡∏Å</option>
              </select>
            </div>
            <div class="game-row"><span class="pill-small" id="time-label-hydration-r">‡πÄ‡∏ß‡∏•‡∏≤‡πÇ‡∏î‡∏¢‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì: 70 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</span></div>
            <div class="game-row">
              <button type="button" class="btn btn-xs btn-research" data-game="hydration" data-run="research">
                <span class="emoji">üß™</span> ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÇ‡∏´‡∏°‡∏î‡∏ß‡∏¥‡∏à‡∏±‡∏¢
              </button>
            </div>
          </div>
        </div>

        <div class="game-card research">
          <div class="game-main">
            <div class="game-name"><span class="emoji">üçΩÔ∏è</span><span>Plate ‚Äî Research</span></div>
            <div class="game-desc">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Perfect Plate + Goal/Mini + RT</div>
          </div>
          <div class="game-controls">
            <div class="game-row">
              <span class="pill-small">‡∏£‡∏∞‡∏î‡∏±‡∏ö</span>
              <select class="select-small" data-game="plate" data-role="diff-r">
                <option value="easy">‡∏á‡πà‡∏≤‡∏¢</option>
                <option value="normal" selected>‡∏õ‡∏Å‡∏ï‡∏¥</option>
                <option value="hard">‡∏¢‡∏≤‡∏Å</option>
              </select>
            </div>
            <div class="game-row"><span class="pill-small" id="time-label-plate-r">‡πÄ‡∏ß‡∏•‡∏≤‡πÇ‡∏î‡∏¢‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì: 70 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</span></div>
            <div class="game-row">
              <button type="button" class="btn btn-xs btn-research" data-game="plate" data-run="research">
                <span class="emoji">üß™</span> ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÇ‡∏´‡∏°‡∏î‡∏ß‡∏¥‡∏à‡∏±‡∏¢
              </button>
            </div>
          </div>
        </div>

        <div class="game-card research">
          <div class="game-main">
            <div class="game-name"><span class="emoji">üß©</span><span>Food Groups ‚Äî Research</span></div>
            <div class="game-desc">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Session + Event (Quest/spawnX ‡∏Ø‡∏•‡∏Ø)</div>
          </div>
          <div class="game-controls">
            <div class="game-row">
              <span class="pill-small">‡∏£‡∏∞‡∏î‡∏±‡∏ö</span>
              <select class="select-small" data-game="groups" data-role="diff-r">
                <option value="easy">‡∏á‡πà‡∏≤‡∏¢</option>
                <option value="normal" selected>‡∏õ‡∏Å‡∏ï‡∏¥</option>
                <option value="hard">‡∏¢‡∏≤‡∏Å</option>
              </select>
            </div>
            <div class="game-row"><span class="pill-small" id="time-label-groups-r">‡πÄ‡∏ß‡∏•‡∏≤‡πÇ‡∏î‡∏¢‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì: 70 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</span></div>
            <div class="game-row">
              <button type="button" class="btn btn-xs btn-research" data-game="groups" data-run="research">
                <span class="emoji">üß™</span> ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÇ‡∏´‡∏°‡∏î‡∏ß‡∏¥‡∏à‡∏±‡∏¢
              </button>
            </div>
          </div>
        </div>
      </div>

      <div class="hint-text">
        * ‡πÇ‡∏´‡∏°‡∏î‡∏ß‡∏¥‡∏à‡∏±‡∏¢‡∏à‡∏∞‡∏™‡πà‡∏á <code>run=research</code> ‡πÅ‡∏•‡∏∞‡∏≠‡πà‡∏≤‡∏ô <code>HHA_LOG_ENDPOINT</code> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á‡∏ä‡∏µ‡∏ï
      </div>
    </section>

  </div>

  <div class="footer-note">Hero Health VR Hub ‚Ä¢ Hub-2025-12-16 ‚Ä¢ ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö GoodJunkVR + Hydration + Plate + Groups</div>
</div>

<script>
  const DIFF_TIME = {
    goodjunk:  { easy: 80, normal: 60, hard: 45 },
    hydration: { easy: 90, normal: 70, hard: 50 },
    plate:     { easy: 90, normal: 70, hard: 50 },
    groups:    { easy: 90, normal: 70, hard: 50 }
  };

  function $(sel){ return document.querySelector(sel); }
  function $all(sel){ return document.querySelectorAll(sel); }

  // ----- Endpoint -----
  function readEndpoint(){
    return ($('#p-endpoint')?.value || '').trim();
  }
  function applyEndpoint(v){
    if ($('#p-endpoint')) $('#p-endpoint').value = v || '';
  }
  function saveEndpoint(){
    const ep = readEndpoint();
    if (!ep){
      alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà Logger Endpoint ‡∏Å‡πà‡∏≠‡∏ô');
      return;
    }
    try{
      sessionStorage.setItem('HHA_LOG_ENDPOINT', ep);
      alert('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Logger Endpoint ‚úÖ');
    }catch(e){
      alert('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Endpoint ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
    }
  }
  function loadEndpoint(){
    try{
      const ep = sessionStorage.getItem('HHA_LOG_ENDPOINT') || '';
      if (!ep){
        alert('‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏û‡∏ö Endpoint ‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ');
        return;
      }
      applyEndpoint(ep);
      alert('‡πÇ‡∏´‡∏•‡∏î Endpoint ‡πÄ‡∏î‡∏¥‡∏° ‚úÖ');
    }catch(e){
      alert('‡πÇ‡∏´‡∏•‡∏î Endpoint ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
    }
  }

  // ----- ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô -----
  function readProfileFromForm(){
    const id     = $('#p-student-id')?.value.trim() || '';
    const name   = $('#p-name')?.value.trim() || '';
    const grade  = $('#p-grade')?.value.trim() || '';
    const room   = $('#p-class')?.value.trim() || '';
    const school = $('#p-school')?.value.trim() || '';
    const group  = $('#p-group')?.value.trim() || '';

    const studentKey = [school, grade, room, id || name].filter(Boolean).join('-') || null;

    return { studentId:id, name, grade, classRoom:room, school, group, studentKey };
  }

  function applyProfileToForm(profile){
    if (!profile) return;
    if ($('#p-student-id')) $('#p-student-id').value = profile.studentId || '';
    if ($('#p-name'))       $('#p-name').value       = profile.name || '';
    if ($('#p-grade'))      $('#p-grade').value      = profile.grade || '';
    if ($('#p-class'))      $('#p-class').value      = profile.classRoom || '';
    if ($('#p-school'))     $('#p-school').value     = profile.school || '';
    if ($('#p-group'))      $('#p-group').value      = profile.group || '';
  }

  function hasProfile(profile){
    if (!profile || typeof profile !== 'object') return false;
    if (!profile.studentId && !profile.name) return false;
    return true;
  }

  function saveProfileToSession(){
    const profile = readProfileFromForm();
    try{
      sessionStorage.setItem('HHA_STUDENT_PROFILE', JSON.stringify(profile));
      alert('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‚úÖ');
    }catch(err){
      alert('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
    }
  }

  function loadProfileFromSession(){
    try{
      const raw = sessionStorage.getItem('HHA_STUDENT_PROFILE');
      if (!raw){
        alert('‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ');
        return;
      }
      applyProfileToForm(JSON.parse(raw));
      alert('‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏î‡∏¥‡∏° ‚úÖ');
    }catch(err){
      alert('‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
    }
  }

  // ----- ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï label ‡πÄ‡∏ß‡∏•‡∏≤ ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô diff -----
  function updateTimeLabel(gameKey, mode){
    const map = DIFF_TIME[gameKey] || DIFF_TIME.goodjunk;
    const diffSel = document.querySelector(
      mode === 'research'
        ? 'select[data-game="' + gameKey + '"][data-role="diff-r"]'
        : 'select[data-game="' + gameKey + '"][data-role="diff"]'
    );
    if (!diffSel) return;
    const diff = diffSel.value || 'normal';
    const t = map[diff] || map.normal || 60;

    const idSuffix = (mode === 'research') ? '-r' : '';
    const labelEl = document.getElementById('time-label-' + gameKey + idSuffix);
    if (labelEl){
      labelEl.textContent = '‡πÄ‡∏ß‡∏•‡∏≤‡πÇ‡∏î‡∏¢‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì: ' + t + ' ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ';
    }
    return t;
  }

  function initDiffListeners(){
    const games = ['goodjunk','hydration','plate','groups'];
    games.forEach(function(g){
      updateTimeLabel(g,'play');
      updateTimeLabel(g,'research');
    });

    $all('select[data-role="diff"]').forEach(function(sel){
      sel.addEventListener('change', function(){
        updateTimeLabel(sel.getAttribute('data-game'), 'play');
      });
    });
    $all('select[data-role="diff-r"]').forEach(function(sel){
      sel.addEventListener('change', function(){
        updateTimeLabel(sel.getAttribute('data-game'), 'research');
      });
    });
  }

  // ----- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å URL ‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÄ‡∏Å‡∏° -----
  function getGameUrl(gameKey){
    switch(gameKey){
      case 'goodjunk':  return './goodjunk-vr.html';
      case 'hydration': return './hydration-vr.html';
      case 'plate':     return './plate-vr.html';
      case 'groups':    return './groups-vr.html';
      default:          return './goodjunk-vr.html';
    }
  }

  // ----- ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏Å‡∏° -----
  function launchGame(gameKey, runMode){
    const isResearch = (runMode === 'research');

    // autosave endpoint (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
    const ep = readEndpoint();
    try{
      if (ep) sessionStorage.setItem('HHA_LOG_ENDPOINT', ep);
    }catch(e){}

    // ‡∏≠‡πà‡∏≤‡∏ô‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏à‡∏≤‡∏Å‡∏ü‡∏≠‡∏£‡πå‡∏°
    const profile = readProfileFromForm();

    // ‚úÖ ‡πÇ‡∏´‡∏°‡∏î‡∏ß‡∏¥‡∏à‡∏±‡∏¢‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå
    if (isResearch && !hasProfile(profile)){
      alert(
        '‡πÇ‡∏´‡∏°‡∏î‡∏ß‡∏¥‡∏à‡∏±‡∏¢: ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô\n' +
        '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ "‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô" ‡∏´‡∏£‡∏∑‡∏≠ "‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô" ‡∏Å‡πà‡∏≠‡∏ô'
      );
      return;
    }

    // autosave ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå
    try{ sessionStorage.setItem('HHA_STUDENT_PROFILE', JSON.stringify(profile)); }catch(e){}

    // ‡∏≠‡πà‡∏≤‡∏ô diff ‡∏ï‡∏≤‡∏°‡πÇ‡∏´‡∏°‡∏î
    const diffSel = document.querySelector(
      isResearch
        ? 'select[data-game="' + gameKey + '"][data-role="diff-r"]'
        : 'select[data-game="' + gameKey + '"][data-role="diff"]'
    );
    const diff = diffSel ? diffSel.value : 'normal';

    // ‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏¥‡∏á‡∏à‡∏≤‡∏Å DIFF_TIME mapping
    const map = DIFF_TIME[gameKey] || DIFF_TIME.goodjunk;
    let time = map[diff] || map.normal || 60;
    if (time < 20) time = 20;
    if (time > 180) time = 180;

    const base = getGameUrl(gameKey);
    const url =
      base +
      '?diff=' + encodeURIComponent(diff) +
      '&time=' + encodeURIComponent(String(time)) +
      '&run=' + encodeURIComponent(runMode);

    window.location.href = url;
  }

  window.addEventListener('DOMContentLoaded', function(){
    // buttons endpoint
    const btnSaveEP = document.getElementById('btn-save-endpoint');
    const btnLoadEP = document.getElementById('btn-load-endpoint');
    if (btnSaveEP) btnSaveEP.addEventListener('click', saveEndpoint);
    if (btnLoadEP) btnLoadEP.addEventListener('click', loadEndpoint);

    // buttons profile
    const btnSave = document.getElementById('btn-save-profile');
    const btnLoad = document.getElementById('btn-load-profile');
    if (btnSave) btnSave.addEventListener('click', saveProfileToSession);
    if (btnLoad) btnLoad.addEventListener('click', loadProfileFromSession);

    initDiffListeners();

    // ‡∏õ‡∏∏‡πà‡∏°‡∏ó‡∏∏‡∏Å‡πÄ‡∏Å‡∏°
    $all('button[data-game][data-run]').forEach(function(btn){
      btn.addEventListener('click', function(){
        launchGame(btn.getAttribute('data-game'), btn.getAttribute('data-run') || 'play');
      });
    });

    // prefill endpoint
    try{
      const ep = sessionStorage.getItem('HHA_LOG_ENDPOINT') || '';
      if (ep) applyEndpoint(ep);
    }catch(e){}

    // prefill profile
    try{
      const raw = sessionStorage.getItem('HHA_STUDENT_PROFILE');
      if (raw) applyProfileToForm(JSON.parse(raw));
    }catch(e){}
  });
</script>

</body>
</html>
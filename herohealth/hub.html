<!-- === /herohealth/hub.html ===
HeroHealth HUB (PRODUCTION ++ HISTORY + CSV) ‚Äî PATH FIXED
‚úÖ ‡πÉ‡∏ä‡πâ hub.safe.js (path mapping ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á)
‚úÖ Plate -> /herohealth/plate-vr.html
‚úÖ GoodJunk -> /herohealth/goodjunk-vr.html
‚úÖ Hydration -> /herohealth/hydration-vr.html
‚úÖ Groups -> /herohealth/vr-groups/groups-vr.html
‚úÖ ‡πÅ‡∏ï‡∏∞ 1=Copy / 2=Play (‡∏ó‡∏±‡πâ‡∏á‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏°‡πÅ‡∏•‡∏∞‡πÅ‡∏ñ‡∏ß history)
‚úÖ Export CSV (last / recent4)
-->

<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>HeroHealth ‚Äî HUB</title>
  <meta name="color-scheme" content="dark" />
  <link rel="icon" href="./favicon.ico" type="image/x-icon" />

  <style>
    :root{
      color-scheme: dark;
      --bg:#020617;
      --panel:rgba(2,6,23,.70);
      --panel2:rgba(15,23,42,.62);
      --stroke:rgba(148,163,184,.18);
      --text:#e5e7eb;
      --muted:#94a3b8;
      --good:#22c55e;
      --warn:#f59e0b;
      --bad:#ef4444;
      --gold:#facc15;
      --radius:18px;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans Thai",sans-serif;
    }
    html,body{height:100%; margin:0; background:var(--bg); color:var(--text);}
    .wrap{max-width:1000px; margin:0 auto; padding:14px 12px 28px;}
    .topbar{
      display:flex; gap:10px; align-items:center; justify-content:space-between;
      padding:12px;
      border:1px solid var(--stroke);
      border-radius:22px;
      background:linear-gradient(180deg, rgba(15,23,42,.55), rgba(2,6,23,.55));
      box-shadow:0 22px 70px rgba(0,0,0,.40);
      backdrop-filter: blur(10px);
    }
    .brand{display:flex; gap:10px; align-items:center;}
    .logo{
      width:44px; height:44px; border-radius:14px;
      background:rgba(34,197,94,.14);
      border:1px solid rgba(34,197,94,.25);
      display:grid; place-items:center;
      font-weight:1100;
      box-shadow:0 16px 40px rgba(0,0,0,.35);
    }
    .title{font-size:16px; font-weight:1100; line-height:1.1;}
    .sub{color:rgba(148,163,184,.95); font-weight:900; font-size:12px; margin-top:2px;}
    .pill{
      display:inline-flex; gap:8px; align-items:center;
      padding:8px 12px; border-radius:999px;
      background:rgba(15,23,42,.58);
      border:1px solid rgba(148,163,184,.16);
      font-weight:1000;
      white-space:nowrap;
    }
    .k{color:var(--muted); font-weight:900; font-size:11px;}
    .v{font-weight:1100;}
    .grid{
      margin-top:12px;
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap:12px;
    }
    @media (max-width:900px){
      .grid{grid-template-columns:1fr; }
    }
    .card{
      background:var(--panel);
      border:1px solid var(--stroke);
      border-radius:var(--radius);
      padding:12px;
      box-shadow:0 20px 60px rgba(0,0,0,.35);
      backdrop-filter: blur(10px);
    }
    .card h3{
      margin:0 0 8px 0;
      font-size:14px;
      font-weight:1100;
      letter-spacing:.2px;
    }
    .row{display:flex; gap:10px; flex-wrap:wrap; align-items:center;}
    .row + .row{margin-top:10px;}
    .btn{
      background:rgba(2,6,23,.70);
      border:1px solid rgba(148,163,184,.20);
      color:var(--text);
      border-radius:14px;
      padding:10px 12px;
      font-weight:1100;
      user-select:none;
      -webkit-tap-highlight-color:transparent;
      box-shadow:0 16px 40px rgba(0,0,0,.32);
      backdrop-filter: blur(10px);
      cursor:pointer;
    }
    .btn:active{transform:translateY(1px);}
    .btn.primary{
      background:rgba(34,197,94,.14);
      border-color:rgba(34,197,94,.30);
    }
    .btn.warn{
      background:rgba(250,204,21,.12);
      border-color:rgba(250,204,21,.30);
    }
    .btn.danger{
      background:rgba(239,68,68,.12);
      border-color:rgba(239,68,68,.28);
    }
    select,input{
      background:rgba(15,23,42,.62);
      border:1px solid rgba(148,163,184,.20);
      color:var(--text);
      border-radius:14px;
      padding:10px 12px;
      font-weight:1000;
      outline:none;
    }
    input{width:140px;}
    .miniGrid{
      display:grid;
      grid-template-columns: repeat(3, minmax(0,1fr));
      gap:10px;
      margin-top:10px;
    }
    @media (max-width:720px){
      .miniGrid{grid-template-columns: repeat(2, minmax(0,1fr));}
    }
    .kv{
      background:rgba(15,23,42,.55);
      border:1px solid rgba(148,163,184,.16);
      border-radius:16px;
      padding:10px 12px;
    }
    .kv .k{display:block; margin-bottom:4px;}
    .kv .v{font-size:16px;}
    .badge{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 12px; border-radius:999px;
      border:1px solid rgba(148,163,184,.18);
      background:rgba(15,23,42,.55);
      font-weight:1100;
    }
    .badge.good{border-color:rgba(34,197,94,.28); background:rgba(34,197,94,.10);}
    .badge.warn{border-color:rgba(250,204,21,.30); background:rgba(250,204,21,.10);}
    .badge.bad{border-color:rgba(239,68,68,.28); background:rgba(239,68,68,.10);}
    .muted{color:rgba(148,163,184,.95); font-weight:900;}
    details{
      margin-top:10px;
      background:rgba(15,23,42,.42);
      border:1px solid rgba(148,163,184,.14);
      border-radius:16px;
      padding:10px 12px;
    }
    pre{
      margin:8px 0 0 0;
      white-space:pre-wrap;
      word-break:break-word;
      font-size:12px;
      color:rgba(229,231,235,.92);
    }
    .games{
      display:grid;
      grid-template-columns:repeat(2,minmax(0,1fr));
      gap:10px;
      margin-top:10px;
    }
    @media (max-width:720px){
      .games{grid-template-columns:1fr;}
    }
    .gameBtn{
      display:flex; justify-content:space-between; align-items:center;
      padding:12px; border-radius:18px;
      background:rgba(2,6,23,.58);
      border:1px solid rgba(148,163,184,.18);
      box-shadow:0 18px 44px rgba(0,0,0,.28);
      cursor:pointer;
      user-select:none;
      -webkit-tap-highlight-color:transparent;
    }
    .gameBtn:active{transform:translateY(1px);}
    .gameName{font-weight:1100;}
    .gameHint{color:rgba(148,163,184,.95); font-weight:900; font-size:12px; margin-top:4px;}
    .rightTag{
      font-weight:1100;
      padding:8px 10px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,.18);
      background:rgba(15,23,42,.52);
      white-space:nowrap;
    }

    /* ===== Recent table ===== */
    .tableWrap{
      margin-top:10px;
      border:1px solid rgba(148,163,184,.14);
      border-radius:16px;
      overflow:hidden;
      background:rgba(15,23,42,.40);
    }
    table{width:100%; border-collapse:collapse; font-size:12px;}
    thead th{
      text-align:left;
      padding:10px 10px;
      background:rgba(2,6,23,.62);
      color:rgba(148,163,184,.98);
      font-weight:1100;
      border-bottom:1px solid rgba(148,163,184,.14);
      white-space:nowrap;
    }
    tbody td{
      padding:10px 10px;
      border-bottom:1px solid rgba(148,163,184,.10);
      color:rgba(229,231,235,.92);
      font-weight:900;
      vertical-align:top;
    }
    tbody tr:last-child td{border-bottom:none;}
    .tdGame{font-weight:1100;}
    .gradeTag{
      display:inline-flex; align-items:center; justify-content:center;
      min-width:44px;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,.16);
      background:rgba(2,6,23,.52);
      font-weight:1100;
    }
    .gradeTag.good{border-color:rgba(34,197,94,.26); background:rgba(34,197,94,.10);}
    .gradeTag.warn{border-color:rgba(250,204,21,.28); background:rgba(250,204,21,.10);}
    .gradeTag.bad{border-color:rgba(239,68,68,.26); background:rgba(239,68,68,.10);}

    /* ===== Tap Feedback FX ===== */
    .gameBtn, .btn { touch-action: manipulation; }
    .gameBtn.pulseGood, tr.pulseGood { animation:hhaPulseGood .42s ease-out; }
    .gameBtn.pulseWarn, tr.pulseWarn { animation:hhaPulseWarn .42s ease-out; }
    .gameBtn.pulseBad,  tr.pulseBad  { animation:hhaPulseBad  .42s ease-out; }

    @keyframes hhaPulseGood{
      0%{ box-shadow:0 0 0 rgba(34,197,94,0); transform:translateY(0); }
      35%{ box-shadow:0 0 0 6px rgba(34,197,94,.18), 0 18px 44px rgba(0,0,0,.28); }
      100%{ box-shadow:0 18px 44px rgba(0,0,0,.28); transform:translateY(0); }
    }
    @keyframes hhaPulseWarn{
      0%{ box-shadow:0 0 0 rgba(250,204,21,0); transform:translateY(0); }
      35%{ box-shadow:0 0 0 6px rgba(250,204,21,.18), 0 18px 44px rgba(0,0,0,.28); }
      100%{ box-shadow:0 18px 44px rgba(0,0,0,.28); transform:translateY(0); }
    }
    @keyframes hhaPulseBad{
      0%{ box-shadow:0 0 0 rgba(239,68,68,0); transform:translateY(0); }
      35%{ box-shadow:0 0 0 6px rgba(239,68,68,.16), 0 18px 44px rgba(0,0,0,.28); }
      100%{ box-shadow:0 18px 44px rgba(0,0,0,.28); transform:translateY(0); }
    }

    /* ===== Make history rows clickable ===== */
    tbody tr[data-i]{ cursor:pointer; }
    tbody tr[data-i]:hover td{ background:rgba(34,197,94,.05); }

    /* ===== history action buttons ===== */
    .actWrap{display:flex; gap:8px; align-items:center;}
    .actBtn{
      display:inline-flex; align-items:center; justify-content:center;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,.18);
      background:rgba(2,6,23,.52);
      color:rgba(229,231,235,.92);
      font-weight:1100;
      cursor:pointer;
      user-select:none;
      -webkit-tap-highlight-color:transparent;
    }
    .actBtn:active{transform:translateY(1px);}
    .actBtn.play{
      border-color:rgba(250,204,21,.28);
      background:rgba(250,204,21,.10);
    }
    .actBtn.json{
      border-color:rgba(34,197,94,.24);
      background:rgba(34,197,94,.10);
    }
  </style>

  <!-- ‚úÖ PATH FIX script -->
  <script type="module" src="./hub.safe.js?v=20251230"></script>
</head>

<body>
  <div class="wrap">
    <div class="topbar">
      <div class="brand">
        <div class="logo">HHA</div>
        <div>
          <div class="title">HeroHealth HUB</div>
          <div class="sub">‡∏ú‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î + 4 ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î + Export CSV ‚Ä¢ ‡πÅ‡∏ï‡∏∞ 1=Copy / 2=Play</div>
        </div>
      </div>
      <div class="row" style="justify-content:flex-end">
        <span class="pill"><span class="k">NOW</span> <span id="nowText" class="v">‚Äî</span></span>
      </div>
    </div>

    <div class="grid">
      <!-- Left: Launch / Settings -->
      <div class="card">
        <h3>‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°</h3>

        <div class="row">
          <span class="pill"><span class="k">MODE</span>
            <select id="selRun">
              <option value="play">Play</option>
              <option value="study">Research</option>
            </select>
          </span>

          <span class="pill"><span class="k">DIFF</span>
            <select id="selDiff">
              <option value="easy">Easy</option>
              <option value="normal" selected>Normal</option>
              <option value="hard">Hard</option>
            </select>
          </span>

          <span class="pill"><span class="k">TIME</span>
            <input id="inpTime" type="number" min="20" step="1" value="70" />
          </span>

          <span class="pill"><span class="k">SEED</span>
            <input id="inpSeed" type="number" step="1" placeholder="(optional)" />
          </span>

          <button class="btn warn" id="btnApplyPreset">‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</button>
        </div>

        <div class="muted" style="margin-top:8px; line-height:1.3">
          ‚Ä¢ Research = deterministic ‡πÄ‡∏™‡∏°‡∏≠ (‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÉ‡∏™‡πà seed ‡πÄ‡∏Å‡∏°‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤ default) <br>
          ‚Ä¢ Play = random ‡∏õ‡∏Å‡∏ï‡∏¥ (‡πÅ‡∏ï‡πà‡∏ñ‡πâ‡∏≤‡πÉ‡∏™‡πà seed ‡∏à‡∏∞ deterministic)
        </div>

        <div class="games">
          <div class="gameBtn" data-game="goodjunk">
            <div>
              <div class="gameName">ü•¶ GoodJunk VR</div>
              <div class="gameHint">‡∏Ç‡∏≠‡∏á‡∏î‡∏µ/‡∏Ç‡∏¢‡∏∞ + FEVER/Shield + Boss</div>
            </div>
            <div class="rightTag">PLAY</div>
          </div>

          <div class="gameBtn" data-game="hydration">
            <div>
              <div class="gameName">üíß Hydration VR</div>
              <div class="gameHint">‡∏ô‡πâ‡∏≥‡∏™‡∏°‡∏î‡∏∏‡∏• + Storm minis + Adaptive (Play)</div>
            </div>
            <div class="rightTag">PLAY</div>
          </div>

          <div class="gameBtn" data-game="plate">
            <div>
              <div class="gameName">üçΩÔ∏è Plate VR</div>
              <div class="gameHint">‡∏à‡∏≤‡∏ô‡∏™‡∏°‡∏î‡∏∏‡∏• 5 ‡∏´‡∏°‡∏π‡πà + Plate Rush (‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏°‡πà plate-vr.html)</div>
            </div>
            <div class="rightTag">PLAY</div>
          </div>

          <div class="gameBtn" data-game="groups">
            <div>
              <div class="gameName">üçé Groups VR</div>
              <div class="gameHint">‡πÄ‡∏Å‡∏°‡∏≠‡∏≤‡∏´‡∏≤‡∏£ 5 ‡∏´‡∏°‡∏π‡πà + Boss/Decoy</div>
            </div>
            <div class="rightTag">PLAY</div>
          </div>
        </div>

        <div class="row" style="margin-top:10px">
          <button class="btn" id="btnCopyLink">üîó ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÄ‡∏Å‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</button>
          <span class="muted" id="linkHint">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏Å‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡∏Å‡πà‡∏≠‡∏ô</span>
        </div>
      </div>

      <!-- Right: Last summary + Recent -->
      <div class="card">
        <h3>‡∏ú‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î (HHA_LAST_SUMMARY)</h3>

        <div id="lastEmpty" class="muted" style="display:none; line-height:1.3">
          ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î ‚Äî ‡πÑ‡∏õ‡πÄ‡∏•‡πà‡∏ô‡∏™‡∏±‡∏Å‡πÄ‡∏Å‡∏°‡∏Å‡πà‡∏≠‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏î‡∏π‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ ‚úÖ
        </div>

        <div id="lastPanel" style="display:none">
          <div class="row">
            <span id="badgeGame" class="badge">‚Äî</span>
            <span id="badgeGrade" class="badge">‚Äî</span>
            <span class="pill"><span class="k">SESSION</span> <span id="lastSession" class="v">‚Äî</span></span>
          </div>

          <div class="miniGrid">
            <div class="kv"><span class="k">Score</span><span id="lastScore" class="v">0</span></div>
            <div class="kv"><span class="k">Max Combo</span><span id="lastCombo" class="v">0</span></div>
            <div class="kv"><span class="k">Miss</span><span id="lastMiss" class="v">0</span></div>
            <div class="kv"><span class="k">Goals</span><span id="lastGoals" class="v">0/0</span></div>
            <div class="kv"><span class="k">Minis</span><span id="lastMinis" class="v">0/0</span></div>
            <div class="kv"><span class="k">Played</span><span id="lastDur" class="v">0s</span></div>
          </div>

          <div class="row" style="margin-top:10px">
            <span class="pill"><span class="k">MODE</span> <span id="lastMode" class="v">‚Äî</span></span>
            <span class="pill"><span class="k">DIFF</span> <span id="lastDiff" class="v">‚Äî</span></span>
            <span class="pill"><span class="k">SEED</span> <span id="lastSeed" class="v">‚Äî</span></span>
          </div>

          <div class="row" style="margin-top:10px">
            <button class="btn primary" id="btnReplayLast">‚ñ∂Ô∏è ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°‡πÄ‡∏î‡∏¥‡∏° (‡∏Ñ‡πà‡∏≤‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î)</button>
            <button class="btn" id="btnCopyLastJson">üìã ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å JSON</button>
            <button class="btn warn" id="btnExportLastCsv">‚¨áÔ∏è Export CSV (‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î)</button>
            <button class="btn danger" id="btnClearLast">üßπ ‡∏•‡πâ‡∏≤‡∏á‡∏ú‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</button>
          </div>

          <details>
            <summary class="muted" style="cursor:pointer; font-weight:1000">‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î (metrics/ctx)</summary>
            <pre id="lastJson">‚Äî</pre>
          </details>

          <h3 style="margin-top:14px">4 ‡πÄ‡∏Å‡∏°‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î (History)</h3>
          <div id="recentEmpty" class="muted" style="display:none; line-height:1.3">
            ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥ ‚Äî (‡πÄ‡∏•‡πà‡∏ô 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡∏à‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡πá‡∏ö‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥)
          </div>

          <div id="recentPanel" style="display:none">
            <div class="row">
              <button class="btn warn" id="btnExportRecentCsv">‚¨áÔ∏è Export CSV (4 ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î)</button>
              <button class="btn danger" id="btnClearHistory">üßπ ‡∏•‡πâ‡∏≤‡∏á History</button>
              <span class="muted" id="historyHint">‚Äî</span>
            </div>

            <div class="tableWrap">
              <table>
                <thead>
                  <tr>
                    <th>Time</th>
                    <th>Game</th>
                    <th>Mode</th>
                    <th>Diff</th>
                    <th>Score</th>
                    <th>Grade</th>
                    <th>Miss</th>
                    <th>Goals</th>
                    <th>Minis</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody id="recentTbody">
                  <tr><td colspan="10" class="muted">‚Äî</td></tr>
                </tbody>
              </table>
            </div>
          </div>
        </div><!-- lastPanel -->
      </div>
    </div><!-- grid -->
  </div><!-- wrap -->
</body>
</html>
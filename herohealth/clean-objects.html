<!-- === /herohealth/clean-objects.html ===
Clean Objects — ROOT Auto-Redirect Launcher (Gate-friendly)
Redirects to: /herohealth/vr-clean/home-clean.html
- Keeps querystring intact
- If view exists: keep it (do NOT override)
- If view missing: auto set (mobile/pc)
- If view=cvr: add vr=1 (+ optional autoEnterVR=1)
-->
<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
  <title>Launching Clean Objects…</title>
  <meta name="color-scheme" content="dark light"/>
  <style>
    :root{ --bg:#050814; --fg:rgba(229,231,235,.92); --mut:rgba(148,163,184,.9); --bd:rgba(148,163,184,.18); }
    html,body{height:100%;margin:0;background:var(--bg);color:var(--fg);font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial}
    .wrap{max-width:720px;margin:0 auto;padding:20px}
    .card{border:1px solid var(--bd);background:rgba(2,6,23,.60);border-radius:18px;padding:14px;box-shadow:0 20px 60px rgba(0,0,0,.35)}
    .mut{color:var(--mut);font-size:12px;line-height:1.45}
    code{color:#cfe2ff}
    a{color:#93c5fd}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div style="font-weight:900">Launching Clean Objects…</div>
      <div class="mut" style="margin-top:6px">
        Redirecting to <code>/herohealth/vr-clean/home-clean.html</code><br/>
        (If not redirected, tap the link below.)
      </div>
      <div class="mut" style="margin-top:10px">
        <a id="fallback" href="./vr-clean/home-clean.html">Open run game</a>
      </div>
    </div>
  </div>

<script>
(function(){
  'use strict';

  const RUN_URL = './vr-clean/home-clean.html';

  function isMobileUA(){
    const ua = navigator.userAgent || '';
    return /Android|iPhone|iPad|iPod/i.test(ua);
  }

  function normalizeView(v){
    v = String(v||'').toLowerCase();
    if(v==='cvr' || v==='cardboard' || v==='vr') return 'cvr';
    if(v==='mobile' || v==='m') return 'mobile';
    if(v==='pc' || v==='desktop') return 'pc';
    return '';
  }

  function build(){
    const u = new URL(location.href);
    const sp = new URLSearchParams(u.search);

    // defaults (keep if already present)
    if(!sp.get('run'))  sp.set('run','play');
    if(!sp.get('diff')) sp.set('diff','normal');
    if(!sp.get('time')) sp.set('time','80');
    if(!sp.get('seed')) sp.set('seed', String(Date.now()));
    if(!sp.get('pid'))  sp.set('pid','anon');

    // view: keep if provided; else auto
    const vNorm = normalizeView(sp.get('view'));
    if(!vNorm){
      sp.set('view', isMobileUA() ? 'mobile' : 'pc');
    }else{
      sp.set('view', vNorm); // normalize variants like "vr" -> "cvr"
    }

    // If Cardboard: add hints (do NOT overwrite if already set)
    if(sp.get('view') === 'cvr'){
      if(!sp.get('vr')) sp.set('vr','1');
      // optional: let run page auto-open VR affordance if you support it
      if(!sp.get('autoEnterVR')) sp.set('autoEnterVR','1');
    }

    const target = RUN_URL + '?' + sp.toString() + (u.hash || '');
    return target;
  }

  const target = build();

  // fallback link
  document.getElementById('fallback').href = target;

  // redirect now (replace keeps history clean)
  location.replace(target);
})();
</script>
</body>
</html>
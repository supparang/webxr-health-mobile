<!-- === /herohealth/plate/plate-vr.html ===
PlateVR RUN — PRODUCTION (HHA Standard)
✅ Uses: ./plate-vr.css
✅ Boots: ./plate.boot.js (ESM)
✅ Optional VR UI: ../vr/vr-ui.js (ENTER VR/EXIT/RECENTER + crosshair + hha:shoot)
✅ Mount: #plate-layer
✅ HUD IDs match plate.boot.js
✅ End overlay IDs match plate.boot.js (incl. miss breakdown + grade)
-->
<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
  <title>HeroHealth — PlateVR</title>
  <meta name="color-scheme" content="dark light"/>
  <meta name="theme-color" content="#050712"/>
  <link rel="icon" href="../favicon.ico"/>

  <link rel="stylesheet" href="./plate-vr.css"/>
</head>
<body class="view-pc">
  <div id="app" aria-label="PlateVR App">
    <!-- optional FX layers -->
    <div id="bossFx" aria-hidden="true"></div>
    <div id="stormFx" aria-hidden="true"></div>

    <!-- playfield mount (targets appended here; positions are viewport-fixed) -->
    <div id="plate-layer" aria-label="Playfield"></div>

    <!-- HUD -->
    <header id="hud" aria-label="HUD">
      <div class="hudRow" aria-hidden="true">
        <div class="chip score">
          <div class="lbl">SCORE</div>
          <div class="val" id="hudScore">0</div>
        </div>
        <div class="chip time">
          <div class="lbl">TIME</div>
          <div class="val" id="hudTime">0</div>
        </div>
        <div class="chip combo">
          <div class="lbl">COMBO</div>
          <div class="val" id="hudCombo">0</div>
        </div>
      </div>

      <!-- quests card -->
      <section class="card" aria-hidden="true">
        <div class="cardTitle">
          <div class="t">ภารกิจ</div>
          <div class="hint">เติมจานให้ครบ 5 หมู่ + คุมความแม่น</div>
        </div>

        <div class="qItem">
          <div class="qText">
            <div class="name" id="goalName">Goal</div>
            <div class="sub" id="goalSub">—</div>
          </div>
          <div class="qProg">
            <div class="qNums" id="goalNums">0/5</div>
            <div class="bar"><i id="goalBar" style="width:0%"></i></div>
          </div>
        </div>

        <div class="qItem">
          <div class="qText">
            <div class="name" id="miniName">Mini Quest</div>
            <div class="sub" id="miniSub">—</div>
          </div>
          <div class="qProg">
            <div class="qNums" id="miniNums">0/80</div>
            <div class="bar"><i id="miniBar" style="width:0%"></i></div>
          </div>
        </div>
      </section>
    </header>

    <!-- Coach bubble -->
    <div id="coachCard" aria-hidden="true">
      <div class="inner">
        <div id="coachMsg">—</div>
        <div id="coachMeta">Coach</div>
      </div>
    </div>

    <!-- End overlay -->
    <div id="endOverlay" aria-hidden="true" role="dialog" aria-label="End Summary">
      <div class="endPanel">
        <div class="endTitle">
          <h2>สรุปผล PlateVR</h2>
          <div class="tag" id="endTag">—</div>
        </div>

        <div class="endGrid">
          <div class="kpi">
            <div class="k">คะแนน</div>
            <div class="v" id="kScore">0</div>
          </div>
          <div class="kpi">
            <div class="k">ความแม่น</div>
            <div class="v" id="kAcc">—</div>
          </div>
          <div class="kpi">
            <div class="k">คอมโบสูงสุด</div>
            <div class="v" id="kCombo">0</div>
          </div>

          <div class="kpi">
            <div class="k">ภารกิจหลัก</div>
            <div class="v" id="kGoals">0/1</div>
          </div>
          <div class="kpi">
            <div class="k">มินิเควสท์</div>
            <div class="v" id="kMini">0/1</div>
          </div>
          <div class="kpi">
            <div class="k">พลาดรวม</div>
            <div class="v" id="kMiss">0</div>
          </div>

          <!-- optional breakdown -->
          <div class="kpi">
            <div class="k">พลาดเพราะ JUNK</div>
            <div class="v" id="kMissJunk">0</div>
          </div>
          <div class="kpi">
            <div class="k">พลาดเพราะหมดเวลา</div>
            <div class="v" id="kMissTimeout">0</div>
          </div>
          <div class="kpi">
            <div class="k">เกรด</div>
            <div class="v" id="kGrade">—</div>
          </div>
        </div>

        <div class="endBtns">
          <button class="btn" id="btnBackHub" type="button">กลับ HUB</button>
          <button class="btn primary" id="btnRestart" type="button">เล่นอีกครั้ง</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Universal VR UI (ENTER VR/EXIT/RECENTER + crosshair + tap-to-shoot) -->
  <script src="../vr/vr-ui.js"></script>

  <!-- Boot (ESM) -->
  <script type="module" src="./plate.boot.js"></script>

  <!-- tiny helper: show endTag (optional, non-critical) -->
  <script>
    (function(){
      'use strict';
      function q(k,d){ try{ return new URL(location.href).searchParams.get(k) ?? d; }catch{ return d; } }
      function clamp(n,a,b){ n=Number(n)||0; return n<a?a:(n>b?b:n); }
      const run  = (q('run','play')||'play').toLowerCase();
      const diff = (q('diff','normal')||'normal').toLowerCase();
      const time = clamp(q('time','90'), 10, 999);
      const tag = document.getElementById('endTag');
      if(tag) tag.textContent = `${run.toUpperCase()} · ${diff.toUpperCase()} · ${time}s`;
    })();
  </script>
</body>
</html>
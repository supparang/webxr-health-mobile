<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>HeroHealth — Balanced Plate VR</title>
  <meta name="color-scheme" content="dark" />
  <link rel="icon" href="../favicon.ico" type="image/x-icon" />

  <!-- (Optional) UI polish: ถ้ามีไฟล์นี้อยู่แล้วใช้ได้เลย -->
  <link rel="stylesheet" href="./plate-vr.css" />

  <!-- ✅ Minimal essential CSS (กันกรณีไม่มี plate-vr.css) -->
  <style>
    :root{
      --bg:#020617;
      --sat: env(safe-area-inset-top, 0px);
      --sar: env(safe-area-inset-right, 0px);
      --sab: env(safe-area-inset-bottom, 0px);
      --sal: env(safe-area-inset-left, 0px);
    }
    *{ box-sizing:border-box; }
    html,body{
      margin:0; padding:0;
      width:100%; height:100%;
      overflow:hidden;
      background:var(--bg);
      color:#e5e7eb;
      font-family: system-ui, -apple-system, "Noto Sans Thai", Segoe UI, Roboto, sans-serif;
    }

    /* ✅ DOM spawn layer (ต้องมี) */
    #plate-layer{
      position:fixed; inset:0;
      z-index:10;
      pointer-events:auto;
      touch-action:none;
      user-select:none;
    }

    /* FX overlay (optional) */
    #hitFx{
      position:fixed; inset:0;
      z-index:12;
      pointer-events:none;
      opacity:0;
    }

    /* simple background */
    .bg{
      position:fixed; inset:0; z-index:1;
      background:
        radial-gradient(circle at 12% 10%, rgba(34,211,238,.12), transparent 40%),
        radial-gradient(circle at 88% 20%, rgba(167,139,250,.10), transparent 42%),
        radial-gradient(circle at 50% 92%, rgba(34,197,94,.10), transparent 48%),
        linear-gradient(180deg, rgba(2,6,23,.98), rgba(2,6,23,1));
      pointer-events:none;
    }

    /* Debug strip (ช่วยเช็กว่าหน้าโหลดครบ) */
    #bootDbg{
      position:fixed;
      left:10px; right:10px;
      bottom: calc(10px + var(--sab));
      z-index:9999;
      padding:10px 12px;
      border-radius:14px;
      border:1px solid rgba(148,163,184,.18);
      background: rgba(2,6,23,.66);
      backdrop-filter: blur(10px);
      font-weight:900;
      font-size:12px;
      color:rgba(229,231,235,.92);
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:space-between;
    }
    #bootDbg .mono{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      opacity:.9;
      word-break:break-all;
    }
    #bootDbg button{
      appearance:none;
      border:none;
      border-radius:999px;
      padding:8px 10px;
      background: rgba(34,197,94,.14);
      border:1px solid rgba(34,197,94,.28);
      color: rgba(229,231,235,.95);
      font: 1000 12px/1 system-ui;
      cursor:pointer;
    }
    #bootDbg button:active{ transform: translateY(1px); }
  </style>

  <!-- ✅ Universal VR UI config (crosshair assist) -->
  <script>
    window.HHA_VRUI_CONFIG = { lockPx: 28, cooldownMs: 90 };
  </script>

  <!-- ✅ A-Frame (optional แต่ช่วย Enter VR เสถียร) -->
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>

  <!-- ✅ Utilities (optional แต่แนะนำ) -->
  <script src="../vr/particles.js" defer></script>
  <script src="../vr/hha-cloud-logger.js" defer></script>
  <script src="../vr/vr-ui.js" defer></script>
</head>

<body>
  <!-- A-Frame minimal scene (ใช้ปุ่ม Enter VR/Exit/Recenter จาก vr-ui.js ได้ชัวร์ขึ้น) -->
  <a-scene embedded vr-mode-ui="enabled:false" renderer="antialias:true" background="color: #000">
    <a-entity id="rig" position="0 0 0">
      <a-camera position="0 1.6 0" look-controls="enabled:true"></a-camera>
    </a-entity>
  </a-scene>

  <div class="bg"></div>

  <!-- ✅ REQUIRED: DOM targets spawn here -->
  <div id="plate-layer" aria-label="plate targets layer"></div>

  <!-- optional -->
  <div id="hitFx"></div>

  <!-- tiny debug strip -->
  <div id="bootDbg">
    <div class="mono" id="bootDbgText">booting…</div>
    <button id="btnHideDbg" type="button">ซ่อน</button>
  </div>

  <script>
    (function(){
      const t = document.getElementById('bootDbgText');
      const hide = document.getElementById('btnHideDbg');
      if(hide) hide.addEventListener('click', ()=> {
        const el = document.getElementById('bootDbg');
        if(el) el.style.display = 'none';
      }, {passive:true});

      const u = new URL(location.href);
      const info = [
        `view=${u.searchParams.get('view')||'mobile'}`,
        `run=${u.searchParams.get('run')||u.searchParams.get('runMode')||'play'}`,
        `diff=${u.searchParams.get('diff')||'normal'}`,
        `time=${u.searchParams.get('time')||'90'}`,
        `seed=${u.searchParams.get('seed')||'(auto)'}`
      ].join(' • ');
      if(t) t.textContent = `Plate RUN ✅ ${info}`;
    })();
  </script>

  <!-- ✅ RUN GAME (ES Module) -->
  <script type="module" src="./plate.safe.js"></script>
</body>
</html>
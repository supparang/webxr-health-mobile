/* === /herohealth/plate/plate-vr.css ===
Balanced Plate VR â€” HHA Standard UI (PRODUCTION)
- Fullscreen play layer + safe-area
- HUD top (Goal/Mini) + Stats/Buttons
- Boss/Storm overlays
- Start/Result overlays
- VR-UI friendly: keep buttons clickable, avoid HUD overlap
*/

:root{
  color-scheme: dark;

  --bg:#020617;
  --panel: rgba(2,6,23,.78);
  --panel2: rgba(15,23,42,.72);
  --stroke: rgba(148,163,184,.20);

  --text:#e5e7eb;
  --muted:#94a3b8;

  --accent:#22c55e;
  --warn:#f59e0b;
  --bad:#ef4444;
  --cyan:#22d3ee;
  --violet:#a78bfa;

  --radius:22px;
  --pill:999px;

  --sat: env(safe-area-inset-top, 0px);
  --sab: env(safe-area-inset-bottom, 0px);
  --sal: env(safe-area-inset-left, 0px);
  --sar: env(safe-area-inset-right, 0px);

  /* play rect padding */
  --play-pad-top: calc(10px + var(--sat));
  --play-pad-bottom: calc(12px + var(--sab));
  --play-pad-side: 12px;

  /* reserved space for VR-UI buttons (top-left) */
  --vrui-safe-left: 110px;   /* enter/recenter buttons area */
  --vrui-safe-top: 64px;
}

*{ box-sizing:border-box; }
html,body{
  width:100%;
  height:100%;
  margin:0;
  padding:0;
  overflow:hidden;
  background:
    radial-gradient(circle at top left, rgba(34,211,238,.18), transparent 58%),
    radial-gradient(circle at bottom right, rgba(167,139,250,.16), transparent 55%),
    radial-gradient(circle at 30% 70%, rgba(34,197,94,.10), transparent 60%),
    var(--bg);
  color:var(--text);
  font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans Thai", sans-serif;
}

/* ---------- View helpers (boot can set body classes) ---------- */
body.view-pc{}
body.view-mobile{}
body.view-vr{}
body.view-cvr{}

/* ---------- Play layer (targets spawn here via JS) ---------- */
#plate-layer{
  position:fixed;
  inset:0;
  z-index:10;
  overflow:hidden;
  touch-action: manipulation;
  user-select:none;
  -webkit-user-select:none;

  /* padding used by engine to compute bounds (if it reads CSS vars) */
  padding:
    var(--play-pad-top)
    calc(var(--play-pad-side) + var(--sar))
    var(--play-pad-bottom)
    calc(var(--play-pad-side) + var(--sal));
}

/* Make sure A-Frame embedded doesn't block clicks */
a-scene{ pointer-events:none !important; }

/* ---------- FX layer ---------- */
#hitFx{
  position:fixed;
  inset:0;
  z-index:90;
  pointer-events:none;
}

/* ---------- HUD Top (Goal/Mini) ---------- */
.hud-top{
  position:fixed;
  top:calc(10px + var(--sat));
  left:calc(10px + var(--sal));
  right:calc(10px + var(--sar));
  z-index:60;
  display:flex;
  gap:10px;
  align-items:stretch;
  pointer-events:none; /* so targets behind are clickable */
}

.hud-chip{
  flex:1;
  min-width:0;
  background: var(--panel);
  border:1px solid var(--stroke);
  border-radius: var(--radius);
  padding:10px 12px;
  box-shadow: 0 12px 30px rgba(0,0,0,.35);
  backdrop-filter: blur(8px);
}

.hud-title{
  font-weight:900;
  letter-spacing:.08em;
  font-size:12px;
  color:var(--muted);
  margin-bottom:6px;
}

.hud-row{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:8px;
}

.hud-main{
  font-weight:900;
  font-size:14px;
  overflow:hidden;
  text-overflow:ellipsis;
  white-space:nowrap;
}

.hud-right{ display:flex; gap:8px; align-items:center; }
.hud-count{
  font-weight:900;
  font-size:12px;
  color:var(--muted);
  white-space:nowrap;
}

.hud-bar{
  height:10px;
  margin-top:8px;
  border-radius: var(--pill);
  background: rgba(148,163,184,.12);
  border: 1px solid rgba(148,163,184,.16);
  overflow:hidden;
}

.hud-fill{
  height:100%;
  width:0%;
  border-radius: var(--pill);
  background: linear-gradient(90deg, rgba(34,197,94,.95), rgba(34,211,238,.95));
  transition: width .18s ease;
}

/* ---------- Mini hint panel ---------- */
.mini-panel{
  position:fixed;
  left:calc(10px + var(--sal));
  right:calc(10px + var(--sar));
  top:calc(96px + var(--sat));
  z-index:55;
  display:flex;
  justify-content:center;
  pointer-events:none;
}

.mini-hint{
  max-width:740px;
  width:100%;
  background: var(--panel2);
  border:1px solid var(--stroke);
  border-radius: var(--radius);
  padding:10px 12px;
  display:flex;
  gap:10px;
  align-items:flex-start;
  backdrop-filter: blur(8px);
}

.mini-tag{
  flex:0 0 auto;
  font-weight:900;
  font-size:12px;
  padding:4px 10px;
  border-radius: var(--pill);
  background: rgba(34,211,238,.16);
  border:1px solid rgba(34,211,238,.22);
  color:#e6fbff;
}

.mini-text{
  font-size:13px;
  font-weight:700;
  color:var(--text);
  line-height:1.2;
}

/* ---------- Coach panel ---------- */
.coach-panel{
  position:fixed;
  left:calc(10px + var(--sal));
  bottom:calc(10px + var(--sab));
  z-index:58;
  pointer-events:none;
}

.coach-card{
  display:flex;
  gap:10px;
  align-items:flex-end;
}

.coach-img{
  width:56px;
  height:56px;
  border-radius: 16px;
  border:1px solid rgba(148,163,184,.25);
  background: rgba(2,6,23,.45);
  object-fit:cover;
  box-shadow: 0 10px 26px rgba(0,0,0,.30);
}

.coach-bubble{
  max-width: 320px;
  background: rgba(2,6,23,.78);
  border:1px solid rgba(148,163,184,.22);
  border-radius: 18px;
  padding:10px 12px;
  backdrop-filter: blur(8px);
  box-shadow: 0 10px 24px rgba(0,0,0,.32);
}

.coach-name{
  font-weight:900;
  font-size:12px;
  letter-spacing:.04em;
  color:var(--muted);
  margin-bottom:4px;
}

.coach-msg{
  font-weight:800;
  font-size:13px;
  line-height:1.2;
}

/* ---------- HUD Buttons/Stats ---------- */
.hud-btns{
  position:fixed;
  right:calc(10px + var(--sar));
  bottom:calc(10px + var(--sab));
  z-index:70; /* above targets; but keep stats area pointer-friendly */
  width:min(460px, calc(100vw - 20px - var(--sal) - var(--sar)));
  pointer-events:auto;
}

.stats{
  display:grid;
  grid-template-columns: repeat(4, minmax(0, 1fr));
  gap:8px;
  margin-bottom:10px;
}

.stat{
  background: var(--panel);
  border:1px solid var(--stroke);
  border-radius: 16px;
  padding:8px 10px;
  box-shadow: 0 10px 24px rgba(0,0,0,.28);
  backdrop-filter: blur(8px);
}

.stat .k{
  font-weight:900;
  font-size:10px;
  letter-spacing:.10em;
  color:var(--muted);
}
.stat .v{
  font-weight:1000;
  font-size:16px;
  margin-top:2px;
}

.bars{
  display:flex;
  gap:10px;
  margin-bottom:10px;
}

.bar{
  flex:1;
  background: var(--panel);
  border:1px solid var(--stroke);
  border-radius: 16px;
  padding:8px 10px;
  backdrop-filter: blur(8px);
  box-shadow: 0 10px 24px rgba(0,0,0,.26);
}

.bar-head{
  display:flex;
  justify-content:space-between;
  align-items:center;
  font-weight:900;
  font-size:11px;
  letter-spacing:.08em;
  color:var(--muted);
  margin-bottom:8px;
}

.bar-track{
  height:10px;
  border-radius: var(--pill);
  background: rgba(148,163,184,.12);
  border:1px solid rgba(148,163,184,.16);
  overflow:hidden;
}

.bar-fill{
  height:100%;
  width:0%;
  border-radius: var(--pill);
  background: linear-gradient(90deg, rgba(245,158,11,.95), rgba(239,68,68,.95));
  transition: width .16s ease;
}

.groups{
  display:flex;
  flex-wrap:wrap;
  gap:8px;
  margin-bottom:10px;
}

.g{
  background: rgba(2,6,23,.72);
  border:1px solid rgba(148,163,184,.20);
  border-radius: var(--pill);
  padding:6px 10px;
  font-weight:900;
  font-size:12px;
  backdrop-filter: blur(6px);
}

.actions{
  display:flex;
  flex-wrap:wrap;
  gap:8px;
  justify-content:flex-end;
}

.btn{
  appearance:none;
  border:1px solid rgba(148,163,184,.22);
  background: rgba(2,6,23,.78);
  color:var(--text);
  border-radius: 16px;
  padding:10px 12px;
  font-weight:900;
  font-size:13px;
  cursor:pointer;
  box-shadow: 0 10px 22px rgba(0,0,0,.26);
  backdrop-filter: blur(8px);
  transition: transform .08s ease, filter .12s ease;
}
.btn:active{ transform: translateY(1px) scale(.99); }
.btn:hover{ filter: brightness(1.08); }

.btn.primary{
  background: rgba(34,197,94,.18);
  border-color: rgba(34,197,94,.35);
}
.btn.ghost{
  background: rgba(15,23,42,.60);
  border-color: rgba(148,163,184,.20);
}
.btn.danger{
  background: rgba(239,68,68,.16);
  border-color: rgba(239,68,68,.35);
}

.muted{ color:var(--muted); }

/* ---------- Pause overlay ---------- */
.overlay{
  position:fixed;
  inset:0;
  z-index:120;
  background: rgba(0,0,0,.55);
  display:flex;
  align-items:center;
  justify-content:center;
  padding: calc(16px + var(--sat)) calc(16px + var(--sar)) calc(16px + var(--sab)) calc(16px + var(--sal));
}
.overlay-card{
  width:min(520px, 100%);
  background: rgba(2,6,23,.86);
  border:1px solid rgba(148,163,184,.22);
  border-radius: 26px;
  padding:18px 16px;
  box-shadow: 0 20px 60px rgba(0,0,0,.50);
  text-align:center;
}
.overlay-title{
  font-size:22px;
  font-weight:1000;
  margin-bottom:8px;
}
.overlay-text{
  color:var(--muted);
  font-weight:800;
}

/* ---------- Start overlay ---------- */
.start-overlay{
  position:fixed;
  inset:0;
  z-index:140;
  display:flex;
  align-items:center;
  justify-content:center;
  padding: calc(18px + var(--sat)) calc(16px + var(--sar)) calc(16px + var(--sab)) calc(16px + var(--sal));
  background: radial-gradient(circle at 50% 40%, rgba(34,197,94,.14), rgba(2,6,23,.92) 60%);
}

.start-card{
  width:min(680px, 100%);
  background: rgba(2,6,23,.88);
  border:1px solid rgba(148,163,184,.22);
  border-radius: 28px;
  padding:18px 16px 16px;
  box-shadow: 0 24px 70px rgba(0,0,0,.58);
}
.start-card .brand{
  font-weight:1000;
  letter-spacing:.10em;
  color: rgba(34,211,238,.95);
  font-size:12px;
}
.start-card .title{
  font-weight:1000;
  font-size:26px;
  margin:6px 0 10px;
}
.start-card .sub{
  display:flex;
  flex-wrap:wrap;
  gap:10px;
  color:var(--muted);
  font-weight:900;
  font-size:12px;
  margin-bottom:12px;
}
.tips{
  display:grid;
  gap:8px;
  margin-bottom:14px;
}
.tip{
  background: rgba(15,23,42,.60);
  border:1px solid rgba(148,163,184,.18);
  border-radius: 18px;
  padding:10px 12px;
  font-weight:900;
  font-size:13px;
}
.start-actions{
  display:flex;
  gap:10px;
  justify-content:flex-end;
  flex-wrap:wrap;
}
.note{
  margin-top:10px;
  font-weight:800;
  font-size:12px;
  color:var(--muted);
}

/* ---------- Boss / Storm overlays ---------- */
.boss-hud,.storm-hud{
  position:fixed;
  left:calc(10px + var(--sal));
  right:calc(10px + var(--sar));
  top:calc(160px + var(--sat));
  z-index:95;
  pointer-events:none;
  display:flex;
  justify-content:center;
}
.boss-card,.storm-card{
  width:min(740px, 100%);
  background: rgba(2,6,23,.82);
  border:1px solid rgba(148,163,184,.22);
  border-radius: 24px;
  padding:12px 14px;
  box-shadow: 0 18px 50px rgba(0,0,0,.45);
  backdrop-filter: blur(8px);
}
.boss-title{ font-weight:1000; font-size:16px; color: rgba(239,68,68,.95); }
.storm-title{ font-weight:1000; font-size:16px; color: rgba(34,211,238,.95); }
.boss-hint,.storm-hint{ margin-top:6px; font-weight:900; color:var(--text); }
.boss-prog,.storm-prog{ margin-top:6px; font-weight:900; color:var(--muted); font-size:12px; }

.boss-fx,.storm-fx{
  position:fixed;
  inset:0;
  z-index:94;
  pointer-events:none;
  background:
    radial-gradient(circle at 50% 50%, rgba(239,68,68,.10), transparent 55%);
  mix-blend-mode: screen;
}
.storm-fx{
  background:
    radial-gradient(circle at 50% 50%, rgba(34,211,238,.12), transparent 55%);
}

/* ---------- Result overlay ---------- */
.result-backdrop{
  position:fixed;
  inset:0;
  z-index:150;
  display:flex;
  align-items:center;
  justify-content:center;
  padding: calc(18px + var(--sat)) calc(16px + var(--sar)) calc(16px + var(--sab)) calc(16px + var(--sal));
  background: rgba(0,0,0,.60);
}

.result-card{
  width:min(720px, 100%);
  background: rgba(2,6,23,.90);
  border:1px solid rgba(148,163,184,.22);
  border-radius: 30px;
  padding:16px 16px 14px;
  box-shadow: 0 26px 78px rgba(0,0,0,.62);
  backdrop-filter: blur(10px);
}

.result-head{
  display:flex;
  justify-content:space-between;
  align-items:baseline;
  gap:10px;
  margin-bottom:12px;
}
.result-title{
  font-weight:1000;
  font-size:24px;
}
.result-mode{
  color:var(--muted);
  font-weight:900;
  font-size:12px;
}

.grade{
  display:flex;
  align-items:center;
  gap:10px;
  font-weight:1000;
  letter-spacing:.08em;
  margin-bottom:12px;
}
.grade-badge{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  min-width:48px;
  padding:6px 12px;
  border-radius: var(--pill);
  background: rgba(167,139,250,.18);
  border:1px solid rgba(167,139,250,.30);
  font-size:14px;
}

.grid{
  display:grid;
  grid-template-columns: repeat(3, minmax(0,1fr));
  gap:10px;
  margin-bottom:14px;
}
.cell{
  background: rgba(15,23,42,.60);
  border:1px solid rgba(148,163,184,.18);
  border-radius: 18px;
  padding:10px 12px;
}
.cell .k{
  color:var(--muted);
  font-weight:900;
  letter-spacing:.08em;
  font-size:11px;
}
.cell .v{
  font-weight:1000;
  font-size:18px;
  margin-top:4px;
}

.plate-break .k{
  color:var(--muted);
  font-weight:900;
  letter-spacing:.08em;
  font-size:11px;
  margin-bottom:8px;
}
.groups2{
  display:flex;
  flex-wrap:wrap;
  gap:10px;
  font-weight:1000;
  background: rgba(15,23,42,.60);
  border:1px solid rgba(148,163,184,.18);
  border-radius: 18px;
  padding:10px 12px;
}

.result-actions{
  margin-top:14px;
  display:flex;
  gap:10px;
  justify-content:flex-end;
  flex-wrap:wrap;
}

/* ---------- Responsive tuning ---------- */
@media (max-width: 520px){
  .hud-top{ gap:8px; }
  .hud-chip{ padding:9px 10px; border-radius: 18px; }
  .hud-main{ font-size:13px; }
  .mini-panel{ top: calc(102px + var(--sat)); }
  .coach-bubble{ max-width: 260px; }
  .stats{ grid-template-columns: repeat(3, minmax(0,1fr)); }
  .grid{ grid-template-columns: repeat(2, minmax(0,1fr)); }
}

/* ---------- cVR strict: keep HUD from blocking crosshair gameplay ---------- */
body.view-cvr .hud-btns{ width:min(420px, calc(100vw - 20px)); }
body.view-cvr .hud-top{ pointer-events:none; }
body.view-cvr .mini-panel{ pointer-events:none; }
body.view-cvr .coach-panel{ pointer-events:none; }

/* ---------- VR-UI friendliness (top-left reserved area) ---------- */
/* keep goal/minibar away from vr-ui buttons zone */
.hud-top{
  padding-left: calc(var(--vrui-safe-left));
}
@media (max-width: 520px){
  :root{ --vrui-safe-left: 104px; }
  .hud-top{ padding-left: calc(var(--vrui-safe-left)); }
}
/* === /herohealth/plate/plate-vr.css ===
Balanced Plate VR — PRODUCTION CSS (HHA Standard UI)
✅ supports view: pc / mobile / vr / cvr (body.view-*)
✅ supports HUD hide toggle (body.hud-hidden)
✅ stage layer safe-area + spawn-safe vars
✅ targets: .plateTarget (size/pos driven by JS inline styles)
✅ keeps vr-ui buttons clickable (z-index discipline)
✅ cVR strict friendly: target pointer-events can remain ON (shoot system hits nearest)
*/

:root{
  color-scheme: dark;

  --bg:#020617;
  --panel:rgba(2,6,23,.78);
  --panel2:rgba(15,23,42,.70);
  --stroke:rgba(148,163,184,.18);
  --text:#e5e7eb;
  --muted:#94a3b8;
  --accent:#22c55e;
  --warn:#f59e0b;
  --bad:#ef4444;
  --cyan:#22d3ee;
  --violet:#a78bfa;

  --radius:18px;
  --radius2:22px;
  --pill:999px;

  /* safe-area */
  --sat: env(safe-area-inset-top, 0px);
  --sar: env(safe-area-inset-right, 0px);
  --sab: env(safe-area-inset-bottom, 0px);
  --sal: env(safe-area-inset-left, 0px);

  /* HUD-safe bands (used by safe.js/engine if needed) */
  --plate-top-safe: calc(78px + var(--sat));
  --plate-bottom-safe: calc(86px + var(--sab));

  /* target style */
  --t-bg: rgba(2,6,23,.55);
  --t-stroke: rgba(148,163,184,.18);
  --t-shadow: 0 18px 44px rgba(0,0,0,.28);

  /* motion */
  --ease: cubic-bezier(.2,.8,.2,1);
}

*,
*::before,
*::after{ box-sizing:border-box; }

html, body{
  margin:0;
  width:100%;
  height:100%;
  overflow:hidden;
  background:var(--bg);
  color:var(--text);
  font-family: system-ui, -apple-system, "Noto Sans Thai", Segoe UI, Roboto, sans-serif;
  -webkit-font-smoothing: antialiased;
  text-rendering: optimizeLegibility;
}

button{
  font: inherit;
}

/* =========================================================
   View modes
   ========================================================= */
body.view-pc{
  --plate-top-safe: 78px;
  --plate-bottom-safe: 80px;
}
body.view-mobile{
  --plate-top-safe: calc(78px + var(--sat));
  --plate-bottom-safe: calc(86px + var(--sab));
}
body.view-vr{
  --plate-top-safe: 72px;
  --plate-bottom-safe: 72px;
}
body.view-cvr{
  --plate-top-safe: 72px;
  --plate-bottom-safe: 72px;
}

/* HUD hide (for debugging / research) */
body.hud-hidden #hudTop,
body.hud-hidden #miniPanel,
body.hud-hidden #coachPanel,
body.hud-hidden #hudBtns,
body.hud-hidden #bossHud,
body.hud-hidden #stormHud{
  display:none !important;
}

/* =========================================================
   Layers & z-index discipline
   IMPORTANT: vr-ui.js mounts its own UI (enter/exit/recenter/crosshair).
   Keep our HUD below those buttons if needed, but never block clicks.
   ========================================================= */

/* A-Frame scene behind */
a-scene{ position:fixed; inset:0; z-index:0; }

/* background overlay */
.bg{ position:fixed; inset:0; z-index:1; pointer-events:none; }

/* stage container */
.stage{
  position:fixed;
  inset:0;
  z-index:2;
  padding: calc(10px + var(--sat)) calc(10px + var(--sar)) calc(10px + var(--sab)) calc(10px + var(--sal));
}

/* spawn layer */
#plate-layer{
  position:fixed;
  inset:0;
  z-index:10;
  pointer-events:auto;
  touch-action:none;
  user-select:none;
  -webkit-user-select:none;
  transform: translateZ(0);
}

/* hit overlay */
#hitFx{
  position:fixed;
  inset:0;
  z-index:12;
  pointer-events:none;
}

/* storm/boss FX layers (under overlays, above play) */
#stormFx, #bossFx{
  position:fixed;
  inset:0;
  z-index:55;
  pointer-events:none;
  display:none;
}

/* overlays sit above HUD */
#startOverlay,
#hudPaused,
#resultBackdrop{
  z-index:70;
}

/* HUD zones */
#hudTop{ z-index:30; }
#miniPanel{ z-index:28; }
#coachPanel{ z-index:28; }
#hudBtns{ z-index:40; }
#bossHud{ z-index:42; }
#stormHud{ z-index:43; }

/* =========================================================
   Targets
   ========================================================= */
.plateTarget{
  appearance:none;
  border:none;
  cursor:pointer;

  width:56px; height:56px; /* JS overrides */
  border-radius:999px;
  border:1px solid var(--t-stroke);
  background: var(--t-bg);
  backdrop-filter: blur(8px);
  box-shadow: var(--t-shadow);

  display:grid;
  place-items:center;

  font-weight: 900;
  font-size: 28px; /* JS may override by style */
  line-height: 1;

  transform: translateZ(0);
  transition: transform .12s var(--ease), filter .12s var(--ease), opacity .12s var(--ease);
  -webkit-tap-highlight-color: transparent;
  user-select:none;
}

.plateTarget:active{
  transform: translateZ(0) scale(.96);
}

.plateTarget[data-kind="good"]{
  filter: drop-shadow(0 0 0 rgba(34,197,94,0));
}
.plateTarget[data-kind="junk"]{
  filter: drop-shadow(0 0 0 rgba(239,68,68,0));
}
.plateTarget[data-kind="shield"]{
  filter: drop-shadow(0 0 0 rgba(34,211,238,0));
}

/* pop-in/out */
@keyframes platePopIn{
  0%{ transform: translateZ(0) scale(.6); opacity:0; }
  100%{ transform: translateZ(0) scale(1); opacity:1; }
}
@keyframes platePopOut{
  0%{ transform: translateZ(0) scale(1); opacity:1; }
  100%{ transform: translateZ(0) scale(.55); opacity:0; }
}

/* optional classes if JS adds later */
.plateTarget.spawn-in{ animation: platePopIn .14s var(--ease) 0s 1 both; }
.plateTarget.hit-out{ animation: platePopOut .12s var(--ease) 0s 1 both; }

/* =========================================================
   Storm / Boss FX (simple visual atmosphere)
   ========================================================= */
#stormFx.storm-on{
  display:block;
  background:
    radial-gradient(circle at 20% 20%, rgba(34,211,238,.10), transparent 45%),
    radial-gradient(circle at 80% 60%, rgba(34,211,238,.08), transparent 50%),
    linear-gradient(180deg, rgba(2,6,23,.05), rgba(2,6,23,.16));
}
#stormFx.storm-panic{
  filter: brightness(1.18) saturate(1.05);
}

#bossFx.boss-on{
  display:block;
  background:
    radial-gradient(circle at 30% 25%, rgba(167,139,250,.10), transparent 45%),
    radial-gradient(circle at 70% 70%, rgba(167,139,250,.08), transparent 50%),
    linear-gradient(180deg, rgba(2,6,23,.08), rgba(2,6,23,.20));
}
#bossFx.boss-panic{
  filter: brightness(1.20) saturate(1.07);
}

/* =========================================================
   Make sure vr-ui buttons remain clickable
   - vr-ui.js usually uses z-index ~ 95/100 (varies).
   - We guarantee we don't overlay with pointer-events.
   ========================================================= */
#hudTop,
#miniPanel,
#coachPanel,
#bossHud,
#stormHud{
  pointer-events:none;
}
#hudTop .card,
#miniPanel .questCard,
#coachPanel .questCard,
#bossHud .bossCard,
#stormHud .stormCard{
  pointer-events:auto;
}

/* In cVR, don't allow targets to block essential UI buttons (best effort)
   If you ever need strict "shoot only" with no tapping on targets:
   body.view-cvr #plate-layer { pointer-events:none; }
   but we keep it ON by default for hybrid mobile/cVR.
*/
body.view-cvr #plate-layer{
  pointer-events:auto;
}

/* =========================================================
   Responsive tweaks
   ========================================================= */
@media (max-width: 920px){
  :root{
    --radius: 18px;
  }
  .plateTarget{
    font-size: 26px;
  }
}

@media (max-width: 560px){
  .plateTarget{
    font-size: 24px;
  }
}

/* landscape mobile (more room) */
@media (max-height: 520px) and (orientation: landscape){
  body.view-mobile{
    --plate-top-safe: calc(62px + var(--sat));
    --plate-bottom-safe: calc(64px + var(--sab));
  }
}

/* =========================================================
   Accessibility / reduced motion
   ========================================================= */
@media (prefers-reduced-motion: reduce){
  .plateTarget{
    transition: none !important;
    animation: none !important;
  }
}
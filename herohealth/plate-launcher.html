<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>HeroHealth ‚Äî Plate VR Launcher</title>
  <meta name="color-scheme" content="dark" />
  <link rel="icon" href="./favicon.ico" type="image/x-icon" />

  <style>
    :root{
      --bg:#020617;
      --panel:rgba(2,6,23,.78);
      --panel2:rgba(15,23,42,.70);
      --stroke:rgba(148,163,184,.18);
      --text:#e5e7eb;
      --muted:#94a3b8;
      --accent:#22c55e;
      --warn:#f59e0b;
      --bad:#ef4444;
      --cyan:#22d3ee;
      --violet:#a78bfa;
      --radius:22px;
      --pill:999px;

      --sat: env(safe-area-inset-top, 0px);
      --sar: env(safe-area-inset-right, 0px);
      --sab: env(safe-area-inset-bottom, 0px);
      --sal: env(safe-area-inset-left, 0px);
    }
    *{ box-sizing:border-box; }
    html,body{
      margin:0; height:100%; width:100%; overflow:hidden;
      background:var(--bg); color:var(--text);
      font-family: system-ui, -apple-system, "Noto Sans Thai", Segoe UI, Roboto, sans-serif;
    }
    .bg{
      position:fixed; inset:0; pointer-events:none;
      background:
        radial-gradient(circle at 12% 10%, rgba(34,211,238,.12), transparent 40%),
        radial-gradient(circle at 88% 20%, rgba(167,139,250,.10), transparent 42%),
        radial-gradient(circle at 50% 92%, rgba(34,197,94,.10), transparent 48%),
        linear-gradient(180deg, rgba(2,6,23,.98), rgba(2,6,23,1));
    }
    .wrap{
      position:fixed; inset:0;
      padding: calc(14px + var(--sat)) calc(14px + var(--sar)) calc(14px + var(--sab)) calc(14px + var(--sal));
      overflow:auto;
    }
    .card{
      width:min(1020px,100%);
      margin:0 auto;
      background:var(--panel);
      border:1px solid var(--stroke);
      border-radius:var(--radius);
      box-shadow: 0 26px 90px rgba(0,0,0,.42);
      backdrop-filter: blur(10px);
      padding:16px;
    }
    .top{
      display:flex; justify-content:space-between; gap:12px; flex-wrap:wrap;
      align-items:flex-start;
    }
    .title{
      font-weight:1200;
      font-size:18px;
      display:flex; gap:10px; align-items:center;
    }
    .sub{
      margin-top:6px;
      color:var(--muted);
      font-weight:900;
      line-height:1.35;
      font-size:13px;
    }
    .grid{
      margin-top:14px;
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap:12px;
    }
    @media (max-width: 920px){
      .grid{ grid-template-columns: 1fr; }
    }
    .panel{
      background:var(--panel2);
      border:1px solid var(--stroke);
      border-radius:18px;
      padding:12px;
    }
    .k{ font-weight:1100; font-size:12px; color:rgba(229,231,235,.92); }
    .row{ margin-top:10px; display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
    .pill{
      display:inline-flex; gap:8px; align-items:center;
      padding:8px 10px;
      border-radius:var(--pill);
      border:1px solid var(--stroke);
      background:rgba(15,23,42,.56);
      font-weight:1000;
      font-size:12px;
      white-space:nowrap;
    }
    .btn{
      appearance:none;
      border:none;
      border-radius:999px;
      padding:10px 12px;
      background:rgba(2,6,23,.70);
      border:1px solid rgba(148,163,184,.20);
      color:rgba(229,231,235,.95);
      font: 1000 12px/1 system-ui, -apple-system, "Noto Sans Thai", Segoe UI, Roboto, sans-serif;
      box-shadow: 0 16px 40px rgba(0,0,0,.32);
      backdrop-filter: blur(10px);
      cursor:pointer;
      -webkit-tap-highlight-color:transparent;
      user-select:none;
    }
    .btn:active{ transform: translateY(1px); }
    .btn.primary{ background:rgba(34,197,94,.14); border-color:rgba(34,197,94,.30); }
    .btn.warn{ background:rgba(245,158,11,.14); border-color:rgba(245,158,11,.30); }
    .btn.bad{ background:rgba(239,68,68,.12); border-color:rgba(239,68,68,.26); }

    .optGrid{
      display:grid;
      grid-template-columns: repeat(2, minmax(0,1fr));
      gap:10px;
      margin-top:10px;
    }
    @media (max-width: 700px){
      .optGrid{ grid-template-columns: 1fr; }
    }

    .modeBtn{
      text-align:left;
      width:100%;
      border-radius:18px;
      padding:12px;
      border:1px solid rgba(148,163,184,.18);
      background:rgba(2,6,23,.55);
      color:var(--text);
      cursor:pointer;
      box-shadow: 0 16px 48px rgba(0,0,0,.28);
    }
    .modeBtn:active{ transform: translateY(1px); }
    .modeHdr{
      display:flex; justify-content:space-between; gap:10px; align-items:center;
      font-weight:1200;
    }
    .modeDesc{
      margin-top:6px;
      color:var(--muted);
      font-weight:900;
      font-size:12px;
      line-height:1.35;
    }
    .tag{
      font-size:11px;
      font-weight:1100;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,.18);
      background:rgba(15,23,42,.56);
      color:rgba(229,231,235,.95);
      white-space:nowrap;
    }
    .tag.cyan{ border-color: rgba(34,211,238,.28); background: rgba(34,211,238,.10); }
    .tag.vio{ border-color: rgba(167,139,250,.28); background: rgba(167,139,250,.10); }
    .tag.green{ border-color: rgba(34,197,94,.28); background: rgba(34,197,94,.10); }
    .tag.warn{ border-color: rgba(245,158,11,.28); background: rgba(245,158,11,.10); }

    select,input{
      background:rgba(2,6,23,.55);
      color:var(--text);
      border:1px solid rgba(148,163,184,.18);
      border-radius:12px;
      padding:10px 12px;
      font: 1000 12px/1 system-ui, -apple-system, "Noto Sans Thai", Segoe UI, Roboto, sans-serif;
      outline:none;
    }
    input{ width:120px; }
    .mono{ font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; }

    .hint{
      color:rgba(148,163,184,.95);
      font-weight:900;
      font-size:12px;
      line-height:1.35;
      margin-top:8px;
    }

    .footerRow{
      margin-top:12px;
      display:flex; gap:10px; flex-wrap:wrap; justify-content:space-between; align-items:center;
    }
    .linkBox{
      margin-top:10px;
      background:rgba(2,6,23,.55);
      border:1px solid rgba(148,163,184,.18);
      border-radius:14px;
      padding:10px 12px;
      color:rgba(229,231,235,.92);
      font-weight:900;
      font-size:12px;
      line-height:1.35;
      word-break:break-all;
    }
  </style>
</head>

<body>
  <div class="bg"></div>

  <div class="wrap">
    <div class="card">
      <div class="top">
        <div>
          <div class="title">üçΩÔ∏è Balanced Plate VR ‚Äî Launcher</div>
          <div class="sub">
            ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏´‡∏°‡∏î‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå ‚Üí ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Run / Difficulty / Time ‚Üí ‡∏Å‡∏î ‚Äú‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏•‡πà‡∏ô‚Äù
            <br/>Play = Adaptive ON ‚Ä¢ Study = Seeded & Adaptive OFF
          </div>
        </div>
        <div class="sub" style="text-align:right">
          Tip: Cardboard ‡πÉ‡∏ä‡πâ <b>view=cvr</b><br/>‡∏¢‡∏¥‡∏á‡∏à‡∏≤‡∏Å crosshair ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ (vr-ui.js)
        </div>
      </div>

      <div class="grid">
        <!-- LEFT: device modes -->
        <div class="panel">
          <div class="k">üïπÔ∏è ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</div>

          <div class="optGrid" id="deviceGrid">
            <button class="modeBtn" data-view="pc" type="button">
              <div class="modeHdr">
                <span>üñ•Ô∏è PC</span>
                <span class="tag green">‡πÄ‡∏°‡∏≤‡∏™‡πå‡∏Ñ‡∏•‡∏¥‡∏Å</span>
              </div>
              <div class="modeDesc">‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≤‡∏ò‡∏¥‡∏ï‡∏ö‡∏ô‡∏Ñ‡∏≠‡∏°/‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ‡πÄ‡∏ï‡∏≠‡∏£‡πå ‚Ä¢ ‡πÄ‡∏õ‡πâ‡∏≤‡πÉ‡∏´‡∏ç‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏µ</div>
            </button>

            <button class="modeBtn" data-view="mobile" type="button">
              <div class="modeHdr">
                <span>üì± Mobile</span>
                <span class="tag cyan">‡πÅ‡∏ï‡∏∞‡∏à‡∏≠ + Gyro</span>
              </div>
              <div class="modeDesc">‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ ‚Ä¢ ‡πÅ‡∏ï‡∏∞‡∏¢‡∏¥‡∏á‡πÄ‡∏õ‡πâ‡∏≤ + VR-feel (gyro/drag)</div>
            </button>

            <button class="modeBtn" data-view="vr" type="button">
              <div class="modeHdr">
                <span>üï∂Ô∏è VR</span>
                <span class="tag vio">Enter VR</span>
              </div>
              <div class="modeDesc">‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö WebXR headset ‚Ä¢ ‡∏Å‡∏î ENTER VR ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏•‡πà‡∏ô</div>
            </button>

            <button class="modeBtn" data-view="cvr" type="button">
              <div class="modeHdr">
                <span>üì¶ Cardboard (cVR)</span>
                <span class="tag warn">Crosshair ‡∏¢‡∏¥‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏à‡∏≠</span>
              </div>
              <div class="modeDesc">‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ + Cardboard ‚Ä¢ ‡∏¢‡∏¥‡∏á‡∏à‡∏≤‡∏Å crosshair ‡∏î‡πâ‡∏ß‡∏¢ vr-ui.js</div>
            </button>
          </div>

          <div class="hint" id="deviceHint">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏ô‡∏∂‡πà‡∏á‡πÇ‡∏´‡∏°‡∏î (‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏à‡∏≥‡πÑ‡∏ß‡πâ‡πÉ‡∏´‡πâ)</div>
        </div>

        <!-- RIGHT: settings -->
        <div class="panel">
          <div class="k">‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏Å‡∏°</div>

          <div class="row">
            <span class="pill">Run
              <select id="selRun">
                <option value="play">play</option>
                <option value="study">study</option>
              </select>
            </span>

            <span class="pill">Diff
              <select id="selDiff">
                <option value="easy">easy</option>
                <option value="normal" selected>normal</option>
                <option value="hard">hard</option>
              </select>
            </span>

            <span class="pill">Time
              <input id="inpTime" type="number" min="20" max="9999" step="1" value="90" />
              <span class="muted">sec</span>
            </span>
          </div>

          <div class="row">
            <span class="pill">Seed
              <input id="inpSeed" class="mono" type="number" step="1" placeholder="auto" />
            </span>
            <button class="btn" id="btnSeedNow" type="button">‡∏™‡∏∏‡πà‡∏° seed üé≤</button>
          </div>

          <div class="hint">
            ‚Ä¢ play: ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÉ‡∏™‡πà seed ‚Üí ‡∏à‡∏∞‡∏™‡∏∏‡πà‡∏°‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (adaptive ON) <br/>
            ‚Ä¢ study: seed ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡∏Ñ‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠ deterministic
          </div>

          <div class="footerRow">
            <div style="display:flex; gap:8px; flex-wrap:wrap">
              <button class="btn primary" id="btnGo" type="button">‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏•‡πà‡∏ô ‚ñ∂</button>
              <button class="btn" id="btnCopy" type="button">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå üîó</button>
              <button class="btn warn" id="btnReset" type="button">‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏à‡∏≥ ‚ôª</button>
            </div>
            <div style="display:flex; gap:8px; flex-wrap:wrap">
              <button class="btn" id="btnBackHub" type="button">‡∏Å‡∏•‡∏±‡∏ö HUB üè†</button>
            </div>
          </div>

          <div class="linkBox" id="linkBox">‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏à‡∏∞‡πÇ‡∏ä‡∏ß‡πå‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‚Ä¶</div>
        </div>
      </div>

      <div class="hint" id="dbg"></div>
    </div>
  </div>

  <script>
    (function(){
      const LS_KEY = 'HHA_PLATE_LAUNCHER_PREF';

      const URLX = new URL(location.href);
      const hub = URLX.searchParams.get('hub') || '';

      const elRun  = document.getElementById('selRun');
      const elDiff = document.getElementById('selDiff');
      const elTime = document.getElementById('inpTime');
      const elSeed = document.getElementById('inpSeed');

      const linkBox = document.getElementById('linkBox');
      const dbg = document.getElementById('dbg');
      const deviceHint = document.getElementById('deviceHint');

      const btnGo = document.getElementById('btnGo');
      const btnCopy = document.getElementById('btnCopy');
      const btnReset = document.getElementById('btnReset');
      const btnBackHub = document.getElementById('btnBackHub');
      const btnSeedNow = document.getElementById('btnSeedNow');

      let pref = {
        view: 'mobile',
        run: 'play',
        diff: 'normal',
        time: 90,
        seed: '',
      };

      function load(){
        try{
          const s = localStorage.getItem(LS_KEY);
          if(!s) return;
          const o = JSON.parse(s);
          if(o && typeof o === 'object'){
            pref = Object.assign(pref, o);
          }
        }catch(e){}
      }
      function save(){
        try{ localStorage.setItem(LS_KEY, JSON.stringify(pref)); }catch(e){}
      }

      function clamp(v,a,b){
        v = Number(v)||0;
        if(v<a) return a;
        if(v>b) return b;
        return v;
      }

      function setActiveView(view){
        pref.view = view;
        save();
        // visual state
        document.querySelectorAll('.modeBtn').forEach(b=>{
          const v = b.getAttribute('data-view');
          const on = (v === view);
          b.style.borderColor = on ? 'rgba(34,197,94,.30)' : 'rgba(148,163,184,.18)';
          b.style.boxShadow = on ? '0 18px 60px rgba(0,0,0,.30), 0 0 28px rgba(34,197,94,.12)' : '0 16px 48px rgba(0,0,0,.28)';
        });
        deviceHint.textContent = '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß: ' + view.toUpperCase();
        renderLink();
      }

      function renderLink(){
        pref.run = (elRun.value || 'play').toLowerCase();
        pref.diff = (elDiff.value || 'normal').toLowerCase();
        pref.time = clamp(elTime.value || 90, 20, 9999);
        pref.seed = (elSeed.value || '').trim();

        save();

        const u = new URL('./plate-vr.html', location.href);
        u.searchParams.set('view', pref.view);
        u.searchParams.set('run', pref.run);
        u.searchParams.set('diff', pref.diff);
        u.searchParams.set('time', String(pref.time));
        if(hub) u.searchParams.set('hub', hub);

        // seed rules
        if(pref.run === 'study'){
          // study: force deterministic seed if blank
          const s = Number(pref.seed) || 13579;
          u.searchParams.set('seed', String(s));
        }else{
          // play: use seed if provided; else randomize at time of GO (optional)
          if(pref.seed){
            const s = Number(pref.seed) || 13579;
            u.searchParams.set('seed', String(s));
          }
        }

        linkBox.textContent = u.toString();
        return u;
      }

      function applyToUI(){
        elRun.value = pref.run || 'play';
        elDiff.value = pref.diff || 'normal';
        elTime.value = String(pref.time || 90);
        elSeed.value = pref.seed || '';
        setActiveView(pref.view || 'mobile');
      }

      // bind device buttons
      document.querySelectorAll('.modeBtn').forEach(b=>{
        b.addEventListener('click', ()=>{
          const v = b.getAttribute('data-view') || 'mobile';
          setActiveView(v);
        }, { passive:true });
      });

      // bind settings
      [elRun, elDiff, elTime, elSeed].forEach(el=>{
        el.addEventListener('input', renderLink, { passive:true });
        el.addEventListener('change', renderLink, { passive:true });
      });

      btnSeedNow.addEventListener('click', ()=>{
        const s = (Date.now() ^ (Math.random()*1e9)) | 0;
        elSeed.value = String(Math.abs(s));
        renderLink();
      }, { passive:true });

      btnGo.addEventListener('click', ()=>{
        const u = renderLink();

        // play without seed: randomize at click time
        if((elRun.value||'play') === 'play' && !String(elSeed.value||'').trim()){
          u.searchParams.set('seed', String(Date.now() ^ (Math.random()*1e9)));
        }
        location.href = u.toString();
      }, { passive:true });

      btnCopy.addEventListener('click', async ()=>{
        const u = renderLink();
        try{
          await navigator.clipboard.writeText(u.toString());
          dbg.textContent = '‚úÖ ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÅ‡∏•‡πâ‡∏ß';
        }catch(e){
          dbg.textContent = '‚ö†Ô∏è ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‚Äî ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÑ‡∏î‡πâ';
        }
      }, { passive:true });

      btnReset.addEventListener('click', ()=>{
        try{ localStorage.removeItem(LS_KEY); }catch(e){}
        pref = { view:'mobile', run:'play', diff:'normal', time:90, seed:'' };
        applyToUI();
        dbg.textContent = '‚ôª ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÅ‡∏•‡πâ‡∏ß';
      }, { passive:true });

      btnBackHub.addEventListener('click', ()=>{
        if(hub) location.href = hub;
        else location.href = './hub.html';
      }, { passive:true });

      // init
      load();
      applyToUI();
      renderLink();

      dbg.textContent = 'Launcher ready ‚úì';
    })();
  </script>
</body>
</html>
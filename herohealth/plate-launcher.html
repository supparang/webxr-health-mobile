<!-- === /herohealth/plate-launcher.html ===
HeroHealth ‚Äî Balanced Plate VR Launcher (PRODUCTION+)
‚úÖ Choose: PC / Mobile / Cardboard(cVR) / VR
‚úÖ Set: run (play/study), diff, time, seed, hub
‚úÖ Remembers last settings via localStorage
‚úÖ Builds link -> ./plate-vr.html with params
‚úÖ HHA Standard: keeps hub=... roundtrip
-->
<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>HeroHealth ‚Äî Plate VR Launcher</title>
  <meta name="color-scheme" content="dark" />
  <link rel="icon" href="./favicon.ico" type="image/x-icon" />

  <style>
    :root{
      color-scheme: dark;
      --bg:#020617;
      --panel:rgba(2,6,23,.78);
      --panel2:rgba(15,23,42,.70);
      --stroke:rgba(148,163,184,.18);
      --text:#e5e7eb;
      --muted:#94a3b8;
      --accent:#22c55e;
      --warn:#f59e0b;
      --bad:#ef4444;
      --cyan:#22d3ee;
      --violet:#a78bfa;
      --radius:22px;
      --pill:999px;

      --sat: env(safe-area-inset-top, 0px);
      --sar: env(safe-area-inset-right, 0px);
      --sab: env(safe-area-inset-bottom, 0px);
      --sal: env(safe-area-inset-left, 0px);
    }
    *{ box-sizing:border-box; }
    html,body{
      margin:0; height:100%; width:100%;
      overflow:hidden;
      font-family: system-ui, -apple-system, "Noto Sans Thai", Segoe UI, Roboto, sans-serif;
      background:var(--bg);
      color:var(--text);
    }
    .bg{
      position:fixed; inset:0;
      background:
        radial-gradient(circle at 12% 10%, rgba(34,211,238,.14), transparent 40%),
        radial-gradient(circle at 88% 16%, rgba(167,139,250,.12), transparent 44%),
        radial-gradient(circle at 50% 92%, rgba(34,197,94,.12), transparent 52%),
        linear-gradient(180deg, rgba(2,6,23,.98), rgba(2,6,23,1));
      pointer-events:none;
    }
    .wrap{
      position:fixed; inset:0;
      padding: calc(14px + var(--sat)) calc(14px + var(--sar)) calc(14px + var(--sab)) calc(14px + var(--sal));
      overflow:auto;
    }
    .container{
      width:min(1080px, 100%);
      margin:0 auto;
      display:grid;
      gap:14px;
    }
    .topbar{
      display:flex; justify-content:space-between; gap:12px; flex-wrap:wrap; align-items:flex-start;
    }
    .title{
      display:flex; gap:10px; align-items:center; flex-wrap:wrap;
    }
    .badge{
      display:inline-flex; gap:8px; align-items:center;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,.20);
      background:rgba(15,23,42,.55);
      font-weight:1000; font-size:12px;
      color:rgba(229,231,235,.92);
      white-space:nowrap;
    }
    .muted{ color:var(--muted); font-weight:900; }
    .card{
      background:var(--panel);
      border:1px solid var(--stroke);
      border-radius:var(--radius);
      padding:14px;
      box-shadow: 0 22px 80px rgba(0,0,0,.38);
      backdrop-filter: blur(10px);
    }
    .grid{
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap:14px;
    }
    @media (max-width: 980px){
      .grid{ grid-template-columns: 1fr; }
    }
    .h{
      font-weight:1200; font-size:18px;
    }
    .sub{
      margin-top:6px;
      font-size:13px;
      color:rgba(148,163,184,.95);
      font-weight:900;
      line-height:1.4;
    }
    .row{
      margin-top:12px;
      display:flex; gap:10px; flex-wrap:wrap; align-items:center;
    }
    .pill{
      display:inline-flex; gap:8px; align-items:center;
      padding:8px 10px;
      border-radius:var(--pill);
      border:1px solid rgba(148,163,184,.20);
      background:rgba(15,23,42,.55);
      font-weight:1000; font-size:12px;
      color:rgba(229,231,235,.92);
      white-space:nowrap;
    }

    .seg{
      display:flex; gap:8px; flex-wrap:wrap;
    }
    .seg button{
      appearance:none;
      border:none;
      border-radius:999px;
      padding:10px 12px;
      background:rgba(2,6,23,.66);
      border:1px solid rgba(148,163,184,.22);
      color:rgba(229,231,235,.95);
      font-weight:1100; font-size:12px;
      cursor:pointer;
      -webkit-tap-highlight-color:transparent;
      user-select:none;
      box-shadow: 0 14px 40px rgba(0,0,0,.28);
      backdrop-filter: blur(10px);
    }
    .seg button.active{
      background:rgba(34,197,94,.16);
      border-color:rgba(34,197,94,.36);
      color:#eafff1;
    }
    .seg button.warn.active{
      background:rgba(245,158,11,.16);
      border-color:rgba(245,158,11,.36);
    }
    .seg button:active{ transform: translateY(1px); }

    label{
      display:flex; flex-direction:column; gap:6px;
      font-weight:1000; font-size:12px;
      color:rgba(229,231,235,.92);
      min-width: 210px;
    }
    input, select{
      appearance:none;
      border-radius:14px;
      border:1px solid rgba(148,163,184,.22);
      background:rgba(15,23,42,.62);
      color:rgba(229,231,235,.95);
      padding:10px 12px;
      font-weight:1000;
      outline:none;
    }
    input:focus, select:focus{
      border-color: rgba(34,197,94,.45);
      box-shadow: 0 0 0 3px rgba(34,197,94,.12);
    }
    .btn{
      appearance:none;
      border:none;
      border-radius:999px;
      padding:12px 14px;
      background:rgba(2,6,23,.70);
      border:1px solid rgba(148,163,184,.22);
      color:rgba(229,231,235,.96);
      font: 1200 13px/1 system-ui, -apple-system, "Noto Sans Thai", Segoe UI, Roboto, sans-serif;
      cursor:pointer;
      -webkit-tap-highlight-color:transparent;
      user-select:none;
      box-shadow: 0 16px 50px rgba(0,0,0,.34);
      backdrop-filter: blur(10px);
    }
    .btn.primary{
      background:rgba(34,197,94,.16);
      border-color:rgba(34,197,94,.36);
    }
    .btn.warn{
      background:rgba(245,158,11,.16);
      border-color:rgba(245,158,11,.36);
    }
    .btn:active{ transform: translateY(1px); }

    .box{
      margin-top:10px;
      background:var(--panel2);
      border:1px solid rgba(148,163,184,.18);
      border-radius:18px;
      padding:12px;
    }
    .mono{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      font-size:12px;
      color:rgba(229,231,235,.92);
      line-height:1.35;
      word-break: break-all;
      user-select:text;
    }
  </style>
</head>

<body>
  <div class="bg"></div>
  <div class="wrap">
    <div class="container">

      <div class="topbar">
        <div class="title">
          <div class="h">üçΩÔ∏è Balanced Plate VR ‚Äî Launcher</div>
          <span class="badge">HHA Standard</span>
          <span class="badge" style="border-color:rgba(34,211,238,.28); background:rgba(34,211,238,.10)">PC / Mobile / cVR / VR</span>
        </div>
        <div class="sub" id="nowLine">‚Äî</div>
      </div>

      <div class="grid">
        <div class="card">
          <div class="h">1) ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå + ‡πÇ‡∏´‡∏°‡∏î</div>
          <div class="sub">‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: Cardboard ‡πÉ‡∏ä‡πâ <b>cVR</b> (‡∏¢‡∏¥‡∏á‡∏à‡∏≤‡∏Å crosshair) ‚Ä¢ VR ‡πÉ‡∏ä‡πâ <b>view=vr</b> ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î ENTER VR ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ run</div>

          <div class="row">
            <div class="pill">üß≠ View</div>
            <div class="seg" id="segView">
              <button type="button" data-view="pc">üñ• PC</button>
              <button type="button" data-view="mobile" class="active">üì± Mobile</button>
              <button type="button" data-view="cvr">üßø Cardboard (cVR)</button>
              <button type="button" data-view="vr">üï∂ VR</button>
            </div>
          </div>

          <div class="row">
            <div class="pill">üéÆ Run</div>
            <div class="seg" id="segRun">
              <button type="button" data-run="play" class="active">‚ñ∂ Play (Adaptive ON)</button>
              <button type="button" data-run="study" class="warn">üß™ Study (Seeded + Adaptive OFF)</button>
            </div>
          </div>

          <div class="row">
            <div class="pill">‚öô Difficulty</div>
            <div class="seg" id="segDiff">
              <button type="button" data-diff="easy">Easy</button>
              <button type="button" data-diff="normal" class="active">Normal</button>
              <button type="button" data-diff="hard">Hard</button>
            </div>
          </div>

          <div class="row">
            <label>
              ‚è± ‡πÄ‡∏ß‡∏•‡∏≤ (‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ)
              <input id="inpTime" type="number" min="20" max="9999" step="1" value="90" />
            </label>

            <label>
              üå± Seed (‡πÄ‡∏â‡∏û‡∏≤‡∏∞ Study ‡∏Ñ‡∏ß‡∏£ fix)
              <input id="inpSeed" type="number" step="1" value="13579" />
            </label>

            <label style="min-width:320px; flex:1">
              üè† HUB URL (‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤ HUB)
              <input id="inpHub" type="text" placeholder="‡πÉ‡∏™‡πà hub=... ‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏ß‡πà‡∏≤‡∏á" />
            </label>
          </div>

          <div class="row">
            <button class="btn primary" id="btnOpen">‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏•‡πà‡∏ô (Run) ‚ñ∂</button>
            <button class="btn" id="btnCopy">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå üîó</button>
            <button class="btn warn" id="btnOpenHub">‡∏Å‡∏•‡∏±‡∏ö HUB üè†</button>
            <button class="btn" id="btnReset">‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ñ‡πà‡∏≤</button>
          </div>

          <div class="box">
            <div class="sub" style="margin:0 0 8px 0">‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÄ‡∏õ‡∏¥‡∏î:</div>
            <div class="mono" id="outLink">‚Äî</div>
          </div>
        </div>

        <div class="card">
          <div class="h">2) ‡∏ó‡∏£‡∏¥‡∏Ñ‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô</div>
          <div class="sub">
            ‚Ä¢ <b>cVR</b>: ‡∏¢‡∏¥‡∏á‡∏à‡∏≤‡∏Å crosshair ‡∏Å‡∏•‡∏≤‡∏á‡∏à‡∏≠ (vr-ui.js) <br/>
            ‚Ä¢ <b>Mobile</b>: ‡πÅ‡∏ï‡∏∞‡πÄ‡∏õ‡πâ‡∏≤ / ‡∏•‡∏≤‡∏Å‡∏à‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠ ‚Äúlook-shift‚Äù ‡πÑ‡∏î‡πâ <br/>
            ‚Ä¢ <b>Study</b>: Seeded + Adaptive OFF ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡∏à‡∏±‡∏¢ (‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ô‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô) <br/>
            ‚Ä¢ <b>Play</b>: Adaptive ON + AI tips ‡∏ä‡πà‡∏ß‡∏¢‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏Å‡πÅ‡∏ö‡∏ö‡∏¢‡∏∏‡∏ï‡∏¥‡∏ò‡∏£‡∏£‡∏°
          </div>

          <div class="box">
            <div class="sub" style="margin:0 0 8px 0">‡πÇ‡∏ô‡πâ‡∏ï (debug):</div>
            <div class="mono" id="dbg">‚Äî</div>
          </div>

          <div class="box">
            <div class="sub" style="margin:0 0 8px 0">‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ:</div>
            <div class="mono">
              /herohealth/plate-launcher.html<br/>
              /herohealth/plate-vr.html<br/>
              /herohealth/plate/plate.safe.js<br/>
              /herohealth/plate/plate-vr.css<br/>
              /herohealth/vr/vr-ui.js (+ particles + logger)
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>

  <script>
    (function(){
      const LS = 'HHA_PLATE_LAUNCHER_PREFS';

      const segView = document.getElementById('segView');
      const segRun  = document.getElementById('segRun');
      const segDiff = document.getElementById('segDiff');

      const inpTime = document.getElementById('inpTime');
      const inpSeed = document.getElementById('inpSeed');
      const inpHub  = document.getElementById('inpHub');

      const outLink = document.getElementById('outLink');
      const dbg     = document.getElementById('dbg');
      const nowLine = document.getElementById('nowLine');

      const btnOpen = document.getElementById('btnOpen');
      const btnCopy = document.getElementById('btnCopy');
      const btnOpenHub = document.getElementById('btnOpenHub');
      const btnReset = document.getElementById('btnReset');

      const state = {
        view: 'mobile',
        run:  'play',
        diff: 'normal',
        time: 90,
        seed: 13579,
        hub:  ''
      };

      function clamp(v,a,b){ v = Number(v)||0; return v<a?a:(v>b?b:v); }
      function setActive(container, attr, value){
        const btns = container.querySelectorAll('button[data-'+attr+']');
        btns.forEach(b=> b.classList.toggle('active', b.getAttribute('data-'+attr) === value));
      }

      function load(){
        try{
          const u = new URL(location.href);
          const hub = u.searchParams.get('hub') || '';
          if(hub) state.hub = hub;

          const s = localStorage.getItem(LS);
          if(s){
            const o = JSON.parse(s);
            if(o && typeof o === 'object'){
              if(o.view) state.view = String(o.view);
              if(o.run)  state.run  = String(o.run);
              if(o.diff) state.diff = String(o.diff);
              if(o.time != null) state.time = clamp(o.time, 20, 9999);
              if(o.seed != null) state.seed = Number(o.seed)||13579;
              if(o.hub != null)  state.hub  = String(o.hub)||'';
            }
          }
        }catch(_){}
      }

      function save(){
        try{
          localStorage.setItem(LS, JSON.stringify(state));
        }catch(_){}
      }

      function buildLink(){
        const u = new URL('./plate-vr.html', location.href);
        u.searchParams.set('view', state.view);
        u.searchParams.set('run', state.run);
        u.searchParams.set('diff', state.diff);
        u.searchParams.set('time', String(state.time));

        // seed:
        // - Study: always keep seed (deterministic)
        // - Play : allow seed too, but ok; keep if user sets
        if(state.seed != null && String(state.seed).length){
          u.searchParams.set('seed', String(state.seed));
        }

        if(state.hub){
          u.searchParams.set('hub', state.hub);
        }

        return u.toString();
      }

      function render(){
        setActive(segView, 'view', state.view);
        setActive(segRun,  'run',  state.run);
        setActive(segDiff, 'diff', state.diff);

        inpTime.value = String(state.time);
        inpSeed.value = String(state.seed);
        inpHub.value  = state.hub || '';

        const link = buildLink();
        outLink.textContent = link;

        if(dbg){
          dbg.textContent =
            'view=' + state.view +
            ' | run=' + state.run +
            ' | diff=' + state.diff +
            ' | time=' + state.time +
            ' | seed=' + state.seed +
            (state.hub ? (' | hub=OK') : ' | hub=(empty)');
        }

        save();
      }

      function setFromUI(){
        state.time = clamp(inpTime.value, 20, 9999);
        state.seed = Number(inpSeed.value)||13579;
        state.hub  = (inpHub.value||'').trim();
      }

      function bindSeg(container, attr){
        container.addEventListener('click', (e)=>{
          const b = e.target && e.target.closest ? e.target.closest('button[data-'+attr+']') : null;
          if(!b) return;
          state[attr] = b.getAttribute('data-'+attr);
          render();
        }, {passive:true});
      }

      function toast(msg){
        if(nowLine) nowLine.textContent = msg;
        clearTimeout(toast._t);
        toast._t = setTimeout(()=>{
          if(nowLine) nowLine.textContent = new Date().toLocaleString();
        }, 1400);
      }

      // init
      if(nowLine) nowLine.textContent = new Date().toLocaleString();

      load();
      bindSeg(segView, 'view');
      bindSeg(segRun,  'run');
      bindSeg(segDiff, 'diff');

      inpTime.addEventListener('input', ()=>{ setFromUI(); render(); }, {passive:true});
      inpSeed.addEventListener('input', ()=>{ setFromUI(); render(); }, {passive:true});
      inpHub.addEventListener('input',  ()=>{ setFromUI(); render(); }, {passive:true});

      btnOpen.addEventListener('click', ()=>{
        setFromUI();
        const link = buildLink();
        toast('‚ñ∂ ‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏•‡πà‡∏ô');
        location.href = link;
      }, {passive:true});

      btnCopy.addEventListener('click', async ()=>{
        try{
          setFromUI();
          const link = buildLink();
          await navigator.clipboard.writeText(link);
          toast('‚úÖ ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÅ‡∏•‡πâ‡∏ß');
        }catch(e){
          toast('‚ö†Ô∏è ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
        }
      }, {passive:true});

      btnOpenHub.addEventListener('click', ()=>{
        setFromUI();
        if(state.hub){
          location.href = state.hub;
        }else{
          location.href = './hub.html';
        }
      }, {passive:true});

      btnReset.addEventListener('click', ()=>{
        state.view='mobile';
        state.run='play';
        state.diff='normal';
        state.time=90;
        state.seed=13579;
        // keep hub if provided in url
        const urlHub = (new URL(location.href)).searchParams.get('hub') || '';
        state.hub = urlHub || '';
        toast('‚ôª ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡πÅ‡∏•‡πâ‡∏ß');
        render();
      }, {passive:true});

      render();
    })();
  </script>
</body>
</html>
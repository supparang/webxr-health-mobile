// === /herohealth/vr-groups/coach.js ===
// Food Groups VR ‚Äî Coach System (2025-12-05)

(function (ns) {
  'use strict';

  let bubbleEl = null;
  let textEl   = null;

  function init(opts = {}) {
    bubbleEl = opts.bubbleEl || document.getElementById('coach-bubble');
    textEl   = opts.textEl   || document.getElementById('coach-text');

    if (!bubbleEl || !textEl) {
      console.warn('[Coach] bubble or text not found');
    } else {
      bubbleEl.style.zIndex = '9999'; // ‡∏Å‡∏±‡∏ô‡πÇ‡∏î‡∏ô‡∏ö‡∏±‡∏á
    }
  }

  // ----------------------------------------------------
  // Message Pools ‡∏ï‡∏≤‡∏° '‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏Å'
  // ----------------------------------------------------

  const messages = {
    easy: {
      start: [
        '‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏±‡∏ô‡πÄ‡∏•‡∏¢! ‡∏¢‡∏¥‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ô‡∏∞!',
        '‡πÑ‡∏õ‡∏ä‡πâ‡∏≤ ‡πÜ ‡∏™‡∏ö‡∏≤‡∏¢ ‡πÜ ‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏∞ ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÇ‡∏Ñ‡πâ‡∏ä‡πÉ‡∏à‡∏î‡∏µ üòÑ',
        '‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏î‡∏µ‡πÅ‡∏•‡πâ‡∏ß! ‡πÄ‡∏•‡πá‡∏á‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ô‡∏∞!'
      ],
      hit: [
        '‡∏™‡∏∏‡∏î‡∏¢‡∏≠‡∏î! ‡∏ó‡∏≥‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏•‡∏¢! üéâ',
        '‡∏î‡∏µ‡∏°‡∏≤‡∏Å! ‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡πÅ‡∏´‡∏•‡∏∞!',
        '‡∏¢‡∏¥‡∏á‡πÑ‡∏î‡πâ‡∏™‡∏ß‡∏¢‡∏°‡∏≤‡∏Å! ‡πÄ‡∏Å‡πà‡∏á‡∏™‡∏∏‡∏î ‡πÜ!'
      ],
      miss: [
        '‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏£‡∏ô‡∏∞ ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢!',
        '‡∏û‡∏•‡∏≤‡∏î‡∏ô‡∏¥‡∏î‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡πÄ‡∏≠‡∏á üòä',
        '‡πÄ‡∏Å‡∏∑‡∏≠‡∏ö‡πÑ‡∏î‡πâ‡πÅ‡∏•‡πâ‡∏ß!'
      ],
      quest: [
        '‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡πÄ‡∏Å‡πà‡∏á‡∏°‡∏≤‡∏Å‡∏Å‡∏Å! üéØ',
        '‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡πÑ‡∏õ‡πÄ‡∏•‡∏¢! ‡∏ú‡πà‡∏≤‡∏ô‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡πÅ‡∏•‡πâ‡∏ß!',
        '‡∏™‡∏∏‡∏î‡∏¢‡∏≠‡∏î‡∏à‡∏£‡∏¥‡∏á ‡πÜ ‡∏ú‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß 1 ‡∏°‡∏¥‡∏ä‡∏ä‡∏±‡πà‡∏ô!'
      ],
      warning: [
        '‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏ß‡∏•‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏≤‡∏Å‡πÅ‡∏•‡πâ‡∏ß‡∏ô‡∏∞!',
        '‡πÄ‡∏£‡πá‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô‡∏≠‡∏µ‡∏Å‡∏ô‡∏¥‡∏î‡∏ô‡∏∞!',
        '‡∏≠‡∏µ‡∏Å‡∏ô‡∏¥‡∏î‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏à‡∏∞‡∏à‡∏ö‡πÅ‡∏•‡πâ‡∏ß!'
      ]
    },

    normal: {
      start: [
        '‡∏°‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡πâ‡∏≤‡∏ó‡∏≤‡∏¢‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡∏Å‡∏±‡∏ô‡πÄ‡∏ñ‡∏≠‡∏∞!',
        '‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏°‡∏±‡πâ‡∏¢? ‡πÇ‡∏Ñ‡πâ‡∏ä‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡πà‡∏≤‡∏ô‡∏≤‡∏¢‡∏ó‡∏≥‡πÑ‡∏î‡πâ!',
        '‡∏•‡∏∏‡∏¢‡πÄ‡∏•‡∏¢! ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ï‡πâ‡∏≠‡∏á‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏ô‡∏∞!'
      ],
      hit: [
        '‡∏î‡∏µ‡∏°‡∏≤‡∏Å! ‡∏¢‡∏¥‡∏á‡πÑ‡∏î‡πâ‡πÅ‡∏°‡πà‡∏ô‡πÄ‡∏•‡∏¢! üí•',
        '‡πÉ‡∏ä‡πà‡πÄ‡∏•‡∏¢! ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏Å‡∏•‡∏∏‡πà‡∏°!',
        '‡∏¢‡∏¥‡∏á‡∏î‡∏µ‡∏°‡∏≤‡∏Å! ‡∏Ñ‡∏∏‡∏°‡πÄ‡∏Å‡∏°‡∏≠‡∏¢‡∏π‡πà!'
      ],
      miss: [
        '‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏´‡∏ô‡πà‡∏≠‡∏¢‡∏ô‡∏∞! ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ô‡∏±‡πâ‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å!',
        '‡∏û‡∏•‡∏≤‡∏î‡πÑ‡∏õ‡∏ô‡∏¥‡∏î‡∏ô‡∏∂‡∏á ‡∏£‡∏µ‡∏ö‡πÅ‡∏Å‡πâ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏¢!',
        '‡∏î‡∏π‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏ó‡∏µ‡∏ô‡∏∞!'
      ],
      quest: [
        '‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á! ‡πÄ‡∏Å‡πà‡∏á‡∏°‡∏≤‡∏Å!',
        '‡∏™‡∏ß‡∏¢! ‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏µ‡∏Å‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡πÅ‡∏•‡πâ‡∏ß!',
        '‡∏î‡∏µ‡∏°‡∏≤‡∏Å! ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏°‡∏≤!'
      ],
      warning: [
        '‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏î‡πâ‡∏ß‡∏¢! ‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß!',
        '‡πÄ‡∏£‡πà‡∏á‡∏°‡∏∑‡∏≠‡∏Ç‡∏∂‡πâ‡∏ô‡∏≠‡∏µ‡∏Å‡∏ô‡∏¥‡∏î!',
        '‡∏™‡∏õ‡∏µ‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏µ‡∏Å‡∏´‡∏ô‡πà‡∏≠‡∏¢‡∏ô‡∏∞!'
      ]
    },

    hard: {
      start: [
        '‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏¢‡∏≤‡∏Å! ‡πÇ‡∏Ñ‡πâ‡∏ä‡∏à‡∏∞‡∏à‡∏±‡∏ö‡∏ï‡∏≤‡∏°‡∏≠‡∏á‡∏≠‡∏¢‡∏π‡πà‡∏ô‡∏∞! üî•',
        '‡∏•‡∏∏‡∏¢! ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏á‡πà‡∏≤‡∏¢ ‡πÅ‡∏ï‡πà‡∏ô‡∏≤‡∏¢‡∏ó‡∏≥‡πÑ‡∏î‡πâ!',
        '‡∏ï‡∏±‡πâ‡∏á‡∏™‡∏ï‡∏¥‡πÉ‡∏´‡πâ‡∏î‡∏µ! ‡∏´‡∏°‡∏π‡πà‡πÑ‡∏´‡∏ô‡∏ú‡∏¥‡∏î‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢!'
      ],
      hit: [
        '‡πÇ‡∏≠‡πâ‡πÇ‡∏´! ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÅ‡∏°‡πà‡∏ô! üíØ',
        '‡∏™‡∏∏‡∏î‡∏¢‡∏≠‡∏î! ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏á‡πà‡∏≤‡∏¢!',
        '‡∏ï‡∏£‡∏á‡πÄ‡∏õ‡πä‡∏∞! ‡∏Ñ‡∏∏‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡πÑ‡∏î‡πâ‡∏î‡∏µ‡∏°‡∏≤‡∏Å!'
      ],
      miss: [
        '‡πÄ‡∏Æ‡πâ! ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡∏µ‡πâ‡∏û‡∏•‡∏≤‡∏î‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‡∏ö‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß!',
        '‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ô‡∏±‡πâ‡∏ô! ‡πÇ‡∏ü‡∏Å‡∏±‡∏™‡∏î‡∏µ ‡πÜ!',
        '‡∏ï‡∏±‡πâ‡∏á‡∏™‡∏°‡∏≤‡∏ò‡∏¥! ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡∏µ‡πâ‡πÇ‡∏´‡∏î‡∏ô‡∏∞!'
      ],
      quest: [
        '‡∏ú‡πà‡∏≤‡∏ô‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÇ‡∏´‡∏î! üî•',
        '‡∏™‡∏∏‡∏î‡∏¢‡∏≠‡∏î‡∏à‡∏£‡∏¥‡∏á ‡πÜ! ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏¢‡∏≤‡∏Å‡∏¢‡∏±‡∏á‡∏ú‡πà‡∏≤‡∏ô!',
        '‡∏ô‡∏µ‡πà‡πÅ‡∏´‡∏•‡∏∞‡∏Ç‡∏≠‡∏á‡∏à‡∏£‡∏¥‡∏á!'
      ],
      warning: [
        '‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î! ‡∏´‡πâ‡∏≤‡∏°‡∏û‡∏•‡∏≤‡∏î!',
        '‡πÄ‡∏£‡πà‡∏á‡∏™‡∏õ‡∏µ‡∏î! ‡∏´‡πâ‡∏≤‡∏°‡∏´‡∏•‡∏∏‡∏î!',
        '‡∏≠‡∏µ‡∏Å‡∏ô‡∏¥‡∏î‡πÄ‡∏î‡∏µ‡∏¢‡∏ß! ‡πÇ‡∏´‡∏°‡πÑ‡∏ü‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏ß‡πâ!'
      ]
    }
  };

  // ----------------------------------------------------
  // helper random
  // ----------------------------------------------------
  function pick(arr) {
    return arr[Math.floor(Math.random() * arr.length)];
  }

  function say(diff, type) {
    if (!bubbleEl || !textEl) return;

    const pool = messages[diff] || messages.normal;
    const msgArr = pool[type];
    if (!msgArr) return;

    const msg = pick(msgArr);
    textEl.textContent = msg;
    bubbleEl.classList.add('show');

    // ‡∏•‡πá‡∏≠‡∏Å‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏ã‡πâ‡∏≠‡∏ô‡∏ó‡∏±‡∏ö
    bubbleEl.style.zIndex = '99999';
  }

  // ----------------------------------------------------
  // API
  // ----------------------------------------------------
  ns.foodGroupsCoach = {
    init,
    sayStart(diff) {
      say(diff, 'start');
    },
    sayHit(diff) {
      say(diff, 'hit');
    },
    sayMiss(diff) {
      say(diff, 'miss');
    },
    sayQuest(diff) {
      say(diff, 'quest');
    },
    sayWarning(diff) {
      say(diff, 'warning');
    }
  };

})(window.GAME_MODULES || (window.GAME_MODULES = {}));
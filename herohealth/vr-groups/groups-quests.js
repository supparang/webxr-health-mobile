// === /herohealth/vr-groups/groups-quests.js ===
// Quest + Coach script ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Å‡∏° Food Groups (‡πÄ‡∏î‡∏¥‡∏ô‡∏ï‡∏≤‡∏°‡πÄ‡∏û‡∏•‡∏á 5 ‡∏´‡∏°‡∏π‡πà)
// ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏π‡πà‡∏Å‡∏±‡∏ö GameEngine ‡∏Ç‡∏≠‡∏á Groups + HUD ‡πÄ‡∏î‡∏¥‡∏° (quest:update / hha:coach)

'use strict';

import { FOOD_GROUPS } from './food-groups.js';

// ----- ‡πÄ‡∏û‡∏•‡∏á‡πÇ‡∏†‡∏ä‡∏ô‡∏≤‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡∏ö‡∏¢‡πà‡∏≠ (‡πÑ‡∏ß‡πâ‡πÉ‡∏´‡πâ‡πÇ‡∏Ñ‡πâ‡∏ä‡∏û‡∏π‡∏î) -----
export const GROUP_SONG_LINES = {
  1: '‡∏´‡∏°‡∏π‡πà 1 ‡∏°‡∏µ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠ ‡∏ô‡∏° ‡πÑ‡∏Ç‡πà ‡∏ñ‡∏±‡πà‡∏ß‡πÄ‡∏°‡∏•‡πá‡∏î ‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á üí™',
  2: '‡∏´‡∏°‡∏π‡πà 2 ‡∏°‡∏µ‡∏Ç‡πâ‡∏≤‡∏ß ‡πÅ‡∏õ‡πâ‡∏á ‡πÄ‡∏ú‡∏∑‡∏≠‡∏Å ‡∏°‡∏±‡∏ô ‡πÅ‡∏•‡∏∞‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏• ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏û‡∏•‡∏±‡∏á‡πÉ‡∏´‡πâ‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢ ‚ö°',
  3: '‡∏´‡∏°‡∏π‡πà 3 ‡∏ú‡∏±‡∏Å‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á ‡πÅ‡∏•‡∏∞‡∏ú‡∏±‡∏Å‡∏ï‡πà‡∏≤‡∏á ‡πÜ ‡∏°‡∏µ‡∏ß‡∏¥‡∏ï‡∏≤‡∏°‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡πÉ‡∏¢‡∏≠‡∏≤‡∏´‡∏≤‡∏£ ü•¶',
  4: '‡∏´‡∏°‡∏π‡πà 4 ‡∏ú‡∏•‡πÑ‡∏°‡πâ‡∏´‡∏•‡∏≤‡∏Å‡∏™‡∏µ ‡∏™‡∏î‡∏ä‡∏∑‡πà‡∏ô‡πÅ‡∏•‡∏∞‡∏î‡∏µ‡∏ï‡πà‡∏≠‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û üçéüçåüçä',
  5: '‡∏´‡∏°‡∏π‡πà 5 ‡πÑ‡∏Ç‡∏°‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô ‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡∏≠‡∏ö‡∏≠‡∏∏‡πà‡∏ô ‡πÅ‡∏ï‡πà‡∏Å‡∏¥‡∏ô‡πÅ‡∏ï‡πà‡∏û‡∏≠‡∏î‡∏µ‡∏ô‡∏∞ ü•ëüßà'
};

// helper ‡∏™‡πà‡∏á event ‡πÑ‡∏õ HUD ‡πÇ‡∏Ñ‡πâ‡∏ä
function say(text) {
  if (!text) return;
  window.dispatchEvent(new CustomEvent('hha:coach', {
    detail: { text }
  }));
}

// ----- ‡∏™‡∏£‡πâ‡∏≤‡∏á Quest ‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏Å -----
export function buildGroupsQuestPlan(diff = 'normal') {
  diff = String(diff || 'normal').toLowerCase();

  // ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏õ‡πâ‡∏≤ "‡∏î‡∏µ" ‡∏ï‡πà‡∏≠‡∏´‡∏°‡∏π‡πà (‡∏´‡∏•‡∏±‡∏Å ‡πÜ ‡πÉ‡∏ä‡πâ‡∏´‡∏°‡∏π‡πà 1‚Äì4 ‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏∏‡∏î‡πÄ‡∏ô‡πâ‡∏ô, ‡∏´‡∏°‡∏π‡πà 5 ‡πÄ‡∏ô‡πâ‡∏ô "‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡πÄ‡∏¢‡∏≠‡∏∞")
  let g1, g2, g3, g4, g5;
  let mini1Need, mini2Need;

  if (diff === 'easy') {
    g1 = 6;   // ‡πÇ‡∏õ‡∏£‡∏ï‡∏µ‡∏ô
    g2 = 6;   // ‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô
    g3 = 5;   // ‡∏ú‡∏±‡∏Å
    g4 = 5;   // ‡∏ú‡∏•‡πÑ‡∏°‡πâ
    g5 = 3;   // ‡πÑ‡∏Ç‡∏°‡∏±‡∏ô (‡πÉ‡∏´‡πâ‡πÄ‡∏à‡∏≠ ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡πÄ‡∏¢‡∏≠‡∏∞)
    mini1Need = 1; // ‡∏à‡∏≤‡∏ô‡∏™‡∏µ‡∏£‡∏∏‡πâ‡∏á 1 ‡∏£‡∏≠‡∏ö
    mini2Need = 1; // ‡∏à‡∏≤‡∏ô‡∏™‡∏°‡∏î‡∏∏‡∏• 1 ‡∏£‡∏≠‡∏ö
  } else if (diff === 'hard') {
    g1 = 12;
    g2 = 12;
    g3 = 10;
    g4 = 10;
    g5 = 5;
    mini1Need = 2;
    mini2Need = 2;
  } else {
    // normal
    g1 = 9;
    g2 = 9;
    g3 = 8;
    g4 = 8;
    g5 = 4;
    mini1Need = 2;
    mini2Need = 1;
  }

  // helper: label ‡∏´‡∏°‡∏π‡πà‡∏à‡∏≤‡∏Å FOOD_GROUPS
  function groupInfo(id) {
    const g = FOOD_GROUPS.find(x => x.id === id);
    return g || {
      id,
      labelShort: `‡∏´‡∏°‡∏π‡πà ${id}`,
      label: `‡∏´‡∏°‡∏π‡πà ${id}`,
      tagline: ''
    };
  }

  const g1Info = groupInfo(1);
  const g2Info = groupInfo(2);
  const g3Info = groupInfo(3);
  const g4Info = groupInfo(4);
  const g5Info = groupInfo(5);

  // ----- Main goals: ‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏µ‡∏•‡∏∞‡∏´‡∏°‡∏π‡πà‡∏ï‡∏≤‡∏°‡πÄ‡∏û‡∏•‡∏á -----
  const goals = [
    {
      id: 'G1',
      groupId: 1,
      label: `Goal 1 ‚Ä¢ ${g1Info.labelShort} ‚Äî ‡πÄ‡∏Å‡πá‡∏ö‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏´‡∏°‡∏π‡πà 1 ‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö ${g1} ‡∏ä‡∏¥‡πâ‡∏ô`,
      shortLabel: '‡∏´‡∏°‡∏π‡πà 1 ‡πÇ‡∏õ‡∏£‡∏ï‡∏µ‡∏ô',
      target: g1,
      prog: 0,
      done: false,
      songLine: GROUP_SONG_LINES[1]
    },
    {
      id: 'G2',
      groupId: 2,
      label: `Goal 2 ‚Ä¢ ${g2Info.labelShort} ‚Äî ‡πÄ‡∏Å‡πá‡∏ö‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏´‡∏°‡∏π‡πà 2 ‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö ${g2} ‡∏ä‡∏¥‡πâ‡∏ô`,
      shortLabel: '‡∏´‡∏°‡∏π‡πà 2 ‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô',
      target: g2,
      prog: 0,
      done: false,
      songLine: GROUP_SONG_LINES[2]
    },
    {
      id: 'G3',
      groupId: 3,
      label: `Goal 3 ‚Ä¢ ${g3Info.labelShort} ‚Äî ‡πÄ‡∏Å‡πá‡∏ö‡∏ú‡∏±‡∏Å‡∏´‡∏°‡∏π‡πà 3 ‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö ${g3} ‡∏ä‡∏¥‡πâ‡∏ô`,
      shortLabel: '‡∏´‡∏°‡∏π‡πà 3 ‡∏ú‡∏±‡∏Å',
      target: g3,
      prog: 0,
      done: false,
      songLine: GROUP_SONG_LINES[3]
    },
    {
      id: 'G4',
      groupId: 4,
      label: `Goal 4 ‚Ä¢ ${g4Info.labelShort} ‚Äî ‡πÄ‡∏Å‡πá‡∏ö‡∏ú‡∏•‡πÑ‡∏°‡πâ‡∏´‡∏°‡∏π‡πà 4 ‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö ${g4} ‡∏ä‡∏¥‡πâ‡∏ô`,
      shortLabel: '‡∏´‡∏°‡∏π‡πà 4 ‡∏ú‡∏•‡πÑ‡∏°‡πâ',
      target: g4,
      prog: 0,
      done: false,
      songLine: GROUP_SONG_LINES[4]
    },
    {
      id: 'G5',
      groupId: 5,
      label: `Goal 5 ‚Ä¢ ${g5Info.labelShort} ‚Äî ‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å‡∏´‡∏°‡∏π‡πà 5 ‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö ${g5} ‡∏ä‡∏¥‡πâ‡∏ô (‡∏≠‡∏¢‡πà‡∏≤‡∏Å‡∏¥‡∏ô‡πÄ‡∏¢‡∏≠‡∏∞‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ)`,
      shortLabel: '‡∏´‡∏°‡∏π‡πà 5 ‡πÑ‡∏Ç‡∏°‡∏±‡∏ô',
      target: g5,
      prog: 0,
      done: false,
      songLine: GROUP_SONG_LINES[5]
    }
  ];

  // ----- Mini quests: ‚Äú‡πÄ‡∏•‡πà‡∏ô‡∏ï‡∏≤‡∏°‡πÄ‡∏û‡∏•‡∏á‚Äù + ‚Äú‡∏à‡∏≤‡∏ô‡∏™‡∏°‡∏î‡∏∏‡∏•‚Äù -----
  const minis = [
    {
      id: 'M1',
      type: 'rainbow',
      label: `Mini 1 ‚Ä¢ Rainbow Plate ‚Äî ‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏±‡πâ‡∏á 5 ‡∏´‡∏°‡∏π‡πà ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ ${mini1Need} ‡∏£‡∏≠‡∏ö`,
      desc: '‡πÄ‡∏Å‡πá‡∏ö‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏´‡∏°‡∏π‡πà 1‚Äì5 ‡∏ï‡∏≤‡∏°‡πÄ‡∏û‡∏•‡∏á',
      target: mini1Need,
      prog: 0,
      done: false
    },
    {
      id: 'M2',
      type: 'balanced-plate',
      label: `Mini 2 ‚Ä¢ Balanced Plate ‚Äî ‡∏ó‡∏≥‡∏à‡∏≤‡∏ô‡∏™‡∏°‡∏î‡∏∏‡∏• (‡∏´‡∏°‡∏π‡πà 2 ‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å ‡∏ú‡∏±‡∏Å+‡∏ú‡∏•‡πÑ‡∏°‡πâ‡πÄ‡∏¢‡∏≠‡∏∞) ${mini2Need} ‡∏£‡∏≠‡∏ö`,
      desc: '‡πÉ‡∏ô‡∏£‡∏≠‡∏ö‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‡πÉ‡∏´‡πâ‡∏´‡∏°‡∏π‡πà 2,3,4 ‡πÄ‡∏¢‡∏≠‡∏∞‡∏Å‡∏ß‡πà‡∏≤‡∏´‡∏°‡∏π‡πà 5',
      target: mini2Need,
      prog: 0,
      done: false
    }
  ];

  return { goals, minis };
}

// =======================================================
//                     COACH SCRIPT
// =======================================================

export const GroupsCoach = (function () {

  // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ï‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å
  function intro() {
    say('‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏°‡∏≤‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ï‡∏≤‡∏°‡πÄ‡∏û‡∏•‡∏á‡πÇ‡∏†‡∏ä‡∏ô‡∏≤‡∏Å‡∏≤‡∏£‡πÑ‡∏ó‡∏¢‡∏Å‡∏±‡∏ô‡∏ô‡∏∞ üéµ');
    setTimeout(() => {
      say('‡∏ü‡∏±‡∏á‡πÇ‡∏Ñ‡πâ‡∏ä‡πÉ‡∏´‡πâ‡∏î‡∏µ ‡πÅ‡∏•‡πâ‡∏ß‡∏•‡∏≠‡∏á‡πÄ‡∏Å‡πá‡∏ö‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏±‡πâ‡∏á 5 ‡∏´‡∏°‡∏π‡πà‡πÑ‡∏õ‡∏û‡∏£‡πâ‡∏≠‡∏° ‡πÜ ‡∏Å‡∏±‡∏ö‡πÄ‡∏û‡∏•‡∏á‡πÄ‡∏•‡∏¢!');
    }, 2500);
  }

  // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏° Goal ‡πÉ‡∏´‡∏°‡πà (‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏´‡∏°‡∏π‡πà)
  function onGoalStart(goal) {
    if (!goal) return;
    const gId = goal.groupId;

    // ‡∏û‡∏π‡∏î‡∏ï‡∏≤‡∏°‡πÄ‡∏û‡∏•‡∏á‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏´‡∏°‡∏π‡πà
    const line = GROUP_SONG_LINES[gId] || '';
    const base = goal.label || '';

    if (gId === 1) {
      say(`‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏´‡∏°‡∏π‡πà 1 ‡πÅ‡∏•‡πâ‡∏ß! ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠ ‡∏ô‡∏° ‡πÑ‡∏Ç‡πà ‡∏ñ‡∏±‡πà‡∏ß‡πÄ‡∏°‡∏•‡πá‡∏î ‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á üí™ \n‡∏•‡∏≠‡∏á‡πÄ‡∏•‡πá‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏´‡∏°‡∏π‡πà 1 ‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ï‡∏≤‡∏°‡πÄ‡∏õ‡πâ‡∏≤‡∏Å‡∏±‡∏ô‡∏î‡∏π`);
    } else if (gId === 2) {
      say(`‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏´‡∏°‡∏π‡πà 2 ‡∏Ç‡πâ‡∏≤‡∏ß ‡πÅ‡∏õ‡πâ‡∏á ‡πÄ‡∏ú‡∏∑‡∏≠‡∏Å ‡∏°‡∏±‡∏ô ‡πÅ‡∏•‡∏∞‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏• ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏û‡∏•‡∏±‡∏á‡πÉ‡∏´‡πâ‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢ ‚ö°\n‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏´‡πâ‡∏û‡∏≠‡∏î‡∏µ ‡πÑ‡∏°‡πà‡∏´‡∏ß‡∏≤‡∏ô‡∏à‡∏±‡∏î‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ‡∏ô‡∏∞`);
    } else if (gId === 3) {
      say(`‡∏ñ‡∏∂‡∏á‡∏Ñ‡∏¥‡∏ß‡∏´‡∏°‡∏π‡πà 3 ‡∏ú‡∏±‡∏Å‡∏ï‡πà‡∏≤‡∏á ‡πÜ ‡πÅ‡∏•‡πâ‡∏ß! ‡∏ú‡∏±‡∏Å‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á ‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ‡∏ß‡∏¥‡∏ï‡∏≤‡∏°‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡πÉ‡∏¢‡∏≠‡∏≤‡∏´‡∏≤‡∏£ ü•¶`);
    } else if (gId === 4) {
      say(`‡∏´‡∏°‡∏π‡πà 4 ‡∏ú‡∏•‡πÑ‡∏°‡πâ‡∏´‡∏•‡∏≤‡∏Å‡∏™‡∏µ ‡∏™‡∏î‡∏ä‡∏∑‡πà‡∏ô‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏ß‡∏¥‡∏ï‡∏≤‡∏°‡∏¥‡∏ô üçéüçåüçä ‡∏•‡∏≠‡∏á‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ï‡∏≤‡∏°‡πÄ‡∏õ‡πâ‡∏≤‡∏î‡∏π‡∏ô‡∏∞`);
    } else if (gId === 5) {
      say(`‡∏´‡∏°‡∏π‡πà 5 ‡πÑ‡∏Ç‡∏°‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô ‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡∏≠‡∏ö‡∏≠‡∏∏‡πà‡∏ô ü•ëüßà ‡πÅ‡∏ï‡πà‡∏à‡∏≥‡πÑ‡∏ß‡πâ‡∏ß‡πà‡∏≤ ‡∏Å‡∏¥‡∏ô‡πÅ‡∏ï‡πà‡∏û‡∏≠‡∏î‡∏µ‡πÑ‡∏°‡πà‡πÄ‡∏¢‡∏≠‡∏∞‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ‡∏ô‡πâ‡∏≤`);
    } else {
      say(base || line || '‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏•‡πâ‡∏ß ‡∏•‡∏≠‡∏á‡πÄ‡∏Å‡πá‡∏ö‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ï‡∏≤‡∏°‡πÄ‡∏õ‡πâ‡∏≤‡πÄ‡∏•‡∏¢!');
    }
  }

  // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤ Goal ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô (‡πÉ‡∏ä‡πâ‡πÇ‡∏ä‡∏ß‡πå ‚Äú‡πÉ‡∏Å‡∏•‡πâ‡∏Ñ‡∏£‡∏ö‡πÅ‡∏•‡πâ‡∏ß‚Äù)
  function onGoalProgress(goal) {
    if (!goal) return;
    const remain = (goal.target | 0) - (goal.prog | 0);
    if (remain <= 0) return;

    if (remain === 1) {
      say(`‡∏´‡∏°‡∏π‡πà‡∏ô‡∏µ‡πâ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏≠‡∏µ‡∏Å‡πÅ‡∏Ñ‡πà 1 ‡∏ä‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢ ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô! ‡πÄ‡∏Å‡πà‡∏á‡∏°‡∏≤‡∏Å ‡∏•‡∏≠‡∏á‡∏´‡∏≤‡∏ä‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡πÉ‡∏´‡πâ‡πÄ‡∏à‡∏≠ üëÄ`);
    } else if (remain <= 3) {
      say(`‡∏≠‡∏µ‡∏Å‡πÅ‡∏Ñ‡πà ${remain} ‡∏ä‡∏¥‡πâ‡∏ô‡∏Å‡πá‡∏Ñ‡∏£‡∏ö‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏´‡∏°‡∏π‡πà ${goal.groupId} ‡πÅ‡∏•‡πâ‡∏ß ‡∏™‡∏π‡πâ ‡πÜ ‚ú®`);
    }
  }

  // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏à‡∏ö Goal ‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏´‡∏°‡∏π‡πà
  function onGoalComplete(goal, index, total) {
    if (!goal) return;
    const gId = goal.groupId;

    if (gId === 1) {
      say('‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏°‡∏≤‡∏Å! ‡∏´‡∏°‡∏π‡πà 1 ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠ ‡∏ô‡∏° ‡πÑ‡∏Ç‡πà ‡∏ñ‡∏±‡πà‡∏ß‡πÄ‡∏°‡∏•‡πá‡∏î ‡∏Ñ‡∏£‡∏ö‡πÅ‡∏•‡πâ‡∏ß üéâ ‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á ‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï‡∏î‡∏µ‡πÄ‡∏•‡∏¢');
    } else if (gId === 2) {
      say('‡πÄ‡∏Å‡πà‡∏á‡∏°‡∏≤‡∏Å! ‡∏´‡∏°‡∏π‡πà 2 ‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡∏Ñ‡∏£‡∏ö‡πÅ‡∏•‡πâ‡∏ß ‚ö° ‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏û‡∏•‡∏±‡∏á‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏•‡πà‡∏ô‡∏ï‡πà‡∏≠‡∏´‡∏°‡∏π‡πà‡∏ñ‡∏±‡∏î‡πÑ‡∏õ');
    } else if (gId === 3) {
      say('‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏´‡∏°‡∏π‡πà 3 ‡∏ú‡∏±‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß ü•¶ ‡πÑ‡∏î‡πâ‡∏ß‡∏¥‡∏ï‡∏≤‡∏°‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡πÉ‡∏¢‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÄ‡∏û‡∏µ‡∏¢‡∏ö‡πÄ‡∏•‡∏¢!');
    } else if (gId === 4) {
      say('‡∏´‡∏°‡∏π‡πà 4 ‡∏ú‡∏•‡πÑ‡∏°‡πâ‡∏Ñ‡∏£‡∏ö‡πÅ‡∏•‡πâ‡∏ß üçéüçåüçä ‡πÑ‡∏î‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏£‡πà‡∏≠‡∏¢‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡∏ï‡∏≤‡∏°‡∏¥‡∏ô');
    } else if (gId === 5) {
      say('‡∏´‡∏°‡∏π‡πà 5 ‡πÑ‡∏Ç‡∏°‡∏±‡∏ô‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å‡∏Ñ‡∏£‡∏ö‡πÅ‡∏•‡πâ‡∏ß ü•ëüßà ‡∏à‡∏≥‡πÑ‡∏ß‡πâ‡∏ß‡πà‡∏≤‡∏Å‡∏¥‡∏ô‡∏ô‡∏¥‡∏î‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡πá‡∏û‡∏≠ ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏¢‡∏≠‡∏∞‡∏°‡∏≤‡∏Å‡∏ô‡∏∞');
    } else {
      say(`‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏´‡∏°‡∏π‡πà ${gId} ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß! ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏°‡∏≤‡∏Å üéâ`);
    }

    // ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö 5 ‡∏´‡∏°‡∏π‡πà ‡πÉ‡∏´‡πâ‡πÇ‡∏Ñ‡πâ‡∏¢‡∏ä‡∏ß‡∏ô‡πÑ‡∏õ‡∏´‡∏°‡∏π‡πà‡∏ï‡πà‡∏≠‡πÑ‡∏õ
    if (index < total) {
      const nextId = (goal.groupId || 0) + 1;
      if (nextId <= 5) {
        setTimeout(() => {
          say(`‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÑ‡∏õ‡∏´‡∏°‡∏π‡πà ${nextId} ‡∏ï‡πà‡∏≠‡πÄ‡∏•‡∏¢‡πÑ‡∏´‡∏°? ‡∏ü‡∏±‡∏á‡∏Ñ‡∏≥‡πÉ‡∏ô‡πÄ‡∏û‡∏•‡∏á‡πÅ‡∏•‡πâ‡∏ß‡∏•‡∏≠‡∏á‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏î‡∏µ ‡πÜ ‡∏ô‡∏∞ üéµ`);
        }, 2500);
      }
    }
  }

  // Mini quest ‚Äî Rainbow Plate
  function onMiniRainbowProgress(prog, target) {
    if (prog <= 0) return;
    if (prog < target) {
      say(`‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°! ‡∏ó‡∏≥‡∏à‡∏≤‡∏ô‡∏™‡∏µ‡∏£‡∏∏‡πâ‡∏á‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß ${prog} ‡∏£‡∏≠‡∏ö üé® ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö ${target} ‡∏£‡∏≠‡∏ö‡∏ô‡∏∞`);
    } else {
      say('‡∏™‡∏∏‡∏î‡∏¢‡∏≠‡∏î! ‡∏ó‡∏≥ Rainbow Plate ‡∏Ñ‡∏£‡∏ö‡∏ï‡∏≤‡∏°‡πÄ‡∏õ‡πâ‡∏≤‡πÅ‡∏•‡πâ‡∏ß ‡πÑ‡∏î‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏±‡πâ‡∏á 5 ‡∏´‡∏°‡∏π‡πà‡∏ï‡∏≤‡∏°‡πÄ‡∏û‡∏•‡∏á‡πÄ‡∏•‡∏¢ üéâ');
    }
  }

  // Mini quest ‚Äî Balanced Plate
  function onMiniBalancedComplete(prog, target) {
    if (prog < target) {
      say(`‡∏à‡∏≤‡∏ô‡∏™‡∏°‡∏î‡∏∏‡∏•‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß ${prog} ‡∏£‡∏≠‡∏ö ü•ó ‡∏•‡∏≠‡∏á‡∏à‡∏±‡∏î‡πÉ‡∏´‡πâ‡∏´‡∏°‡∏π‡πà 2 (‡∏Ç‡πâ‡∏≤‡∏ß‡πÅ‡∏õ‡πâ‡∏á) + ‡∏ú‡∏±‡∏Å + ‡∏ú‡∏•‡πÑ‡∏°‡πâ ‡∏™‡∏°‡∏î‡∏∏‡∏•‡∏Å‡∏ß‡πà‡∏≤‡∏Ç‡∏≠‡∏á‡∏°‡∏±‡∏ô‡∏ó‡∏≠‡∏î‡∏î‡∏π‡∏Å‡∏±‡∏ô‡∏ï‡πà‡∏≠`);
    } else {
      say('‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏°‡∏≤‡∏Å! ‡∏ó‡∏≥‡∏à‡∏≤‡∏ô‡∏™‡∏°‡∏î‡∏∏‡∏•‡∏Ñ‡∏£‡∏ö‡πÅ‡∏•‡πâ‡∏ß ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤‡∏à‡∏±‡∏î‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ï‡∏≤‡∏°‡∏´‡∏•‡∏±‡∏Å‡πÇ‡∏†‡∏ä‡∏ô‡∏≤‡∏Å‡∏≤‡∏£‡πÑ‡∏î‡πâ‡∏î‡∏µ‡∏°‡∏≤‡∏Å ü•óüåà');
    }
  }

  // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÄ‡∏°‡∏∑‡πà‡∏≠ ‚Äú‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏´‡∏°‡∏π‡πà‚Äù (‡∏à‡∏ö‡πÄ‡∏û‡∏•‡∏á)
  function onAllGroupsComplete() {
    say('‡∏™‡∏∏‡∏î‡∏¢‡∏≠‡∏î! ‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏Å‡πá‡∏ö‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏Ñ‡∏£‡∏ö‡∏ó‡∏±‡πâ‡∏á 5 ‡∏´‡∏°‡∏π‡πà‡∏ï‡∏≤‡∏°‡πÄ‡∏û‡∏•‡∏á‡πÅ‡∏•‡πâ‡∏ß üéµ');
    setTimeout(() => {
      say('‡∏à‡∏≥‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ‡∏ß‡πà‡∏≤‡πÉ‡∏ô‡∏à‡∏≤‡∏ô‡∏ô‡∏∂‡∏á ‡∏Ñ‡∏ß‡∏£‡∏°‡∏µ‡∏Ç‡πâ‡∏≤‡∏ß‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å ‡∏ú‡∏±‡∏Å‡πÅ‡∏•‡∏∞‡∏ú‡∏•‡πÑ‡∏°‡πâ‡πÄ‡∏¢‡∏≠‡∏∞ ‡πÜ ‡πÇ‡∏õ‡∏£‡∏ï‡∏µ‡∏ô‡∏û‡∏≠‡∏î‡∏µ ‡πÜ ‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡∏ó‡∏≠‡∏î‡πÅ‡∏•‡∏∞‡πÑ‡∏Ç‡∏°‡∏±‡∏ô‡∏Å‡∏¥‡∏ô‡πÅ‡∏ï‡πà‡∏ô‡∏¥‡∏î‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏û‡∏≠ ü•óüçöüçé');
    }, 2800);
  }

  return {
    intro,
    onGoalStart,
    onGoalProgress,
    onGoalComplete,
    onMiniRainbowProgress,
    onMiniBalancedComplete,
    onAllGroupsComplete
  };
})();

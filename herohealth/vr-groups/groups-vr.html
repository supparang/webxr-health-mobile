<!-- === /herohealth/vr-groups/groups-vr.html ===
GroupsVR Run (PC/Mobile/Cardboard) ‚Äî PRODUCTION
‚úÖ Uses vr-ui.js (Enter VR/Exit/Recenter + crosshair + tap-to-shoot => hha:shoot)
‚úÖ Telemetry (lite/full/off) + flush-hardened (local queue if no ?log=)
‚úÖ Passthrough hub link + safe viewport
‚úÖ Imports groups.safe.js (engine)
-->
<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>HeroHealth ‚Äî Food Groups VR</title>
  <meta name="color-scheme" content="light dark" />
  <link rel="icon" href="../favicon.ico" type="image/x-icon" />

  <style>
    :root{
      --sat: env(safe-area-inset-top, 0px);
      --sab: env(safe-area-inset-bottom, 0px);
      --sal: env(safe-area-inset-left, 0px);
      --sar: env(safe-area-inset-right, 0px);
      --bg:#020617;
      --text:#e5e7eb;
      --muted:#94a3b8;
      --panel:rgba(2,6,23,.55);
      --stroke:rgba(148,163,184,.18);
      --radius:18px;
      --pill:999px;
    }
    html,body{ margin:0; height:100%; background:var(--bg); color:var(--text); font-family:system-ui,-apple-system,"Noto Sans Thai",Segoe UI,Roboto,sans-serif; }
    #hud{
      position:fixed; z-index:50;
      left: calc(12px + var(--sal)); right: calc(12px + var(--sar));
      top: calc(10px + var(--sat));
      display:flex; gap:10px; align-items:center; justify-content:space-between; flex-wrap:wrap;
      pointer-events:none;
    }
    .pill{
      pointer-events:none;
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 10px; border-radius:var(--pill);
      background:rgba(2,6,23,.55);
      border:1px solid var(--stroke);
      font-weight:950; font-size:12px;
      backdrop-filter: blur(10px);
    }
    #mini{
      pointer-events:none;
      position:fixed; z-index:40;
      left: calc(12px + var(--sal)); right: calc(12px + var(--sar));
      bottom: calc(12px + var(--sab));
      display:flex; justify-content:center;
    }
    .hint{
      background:var(--panel);
      border:1px solid var(--stroke);
      border-radius:var(--radius);
      padding:10px 12px;
      color:rgba(229,231,235,.92);
      font-weight:900;
      font-size:12px;
      max-width:min(720px, 100%);
      backdrop-filter: blur(10px);
    }
    .hint b{ color:#fff; }
    a{ color:#93c5fd; text-decoration:none; pointer-events:auto; }
  </style>

  <!-- A-Frame (‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡∏Å‡∏±‡∏ö Enter VR) -->
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
</head>
<body>

  <!-- HUD (‡πÄ‡∏ö‡∏≤ ‡πÜ) -->
  <div id="hud">
    <div class="pill">üçΩÔ∏è GroupsVR</div>
    <div class="pill" id="pillMeta">loading‚Ä¶</div>
  </div>

  <div id="mini">
    <div class="hint" id="hintBox">
      ‚úÖ ‡∏¢‡∏¥‡∏á‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏´‡∏°‡∏ß‡∏î ‚Ä¢ ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô Cardboard ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ <b>?practice=15</b> ‚Ä¢ ‡∏Å‡∏•‡∏±‡∏ö HUB ‡πÑ‡∏î‡πâ‡∏î‡πâ‡∏ß‡∏¢ <b>?hub=</b>
    </div>
  </div>

  <!-- A-Frame scene minimal -->
  <a-scene
    background="color: #0b1220"
    vr-mode-ui="enabled: true"
    renderer="colorManagement: true; physicallyCorrectLights: false;"
    embedded
  >
    <a-entity position="0 1.6 0">
      <a-camera wasd-controls-enabled="false" look-controls="pointerLockEnabled: false"></a-camera>
    </a-entity>
    <a-entity light="type: ambient; intensity: 0.9"></a-entity>
    <a-entity light="type: directional; intensity: 0.65" position="1 3 2"></a-entity>
  </a-scene>

  <script type="module">
    // Universal VR UI (buttons + crosshair + hha:shoot)
    import '../vr/vr-ui.js';

    // Telemetry (lite/full/off) + flush-hardened
    import '../vr/telemetry.js';
    window.HHATelemetry?.init({ game:'GROUPS' });

    // Engine (‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì)
    import './groups.safe.js';

    // small HUD meta
    const qs = (k,d=null)=>{ try{ return new URL(location.href).searchParams.get(k) ?? d; }catch{ return d; } };
    const run = String(qs('run','play')||'play');
    const diff = String(qs('diff','normal')||'normal');
    const view = String(qs('view','')||'');
    const time = String(qs('time','90')||'90');
    const tlm = String(qs('telemetry','lite')||'lite');

    const el = document.getElementById('pillMeta');
    if (el) el.textContent = `run=${run} ‚Ä¢ diff=${diff} ‚Ä¢ time=${time}s ‚Ä¢ view=${view||'auto'} ‚Ä¢ tlm=${tlm}`;
  </script>
</body>
</html>
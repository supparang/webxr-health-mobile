<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>HeroHealth ‚Äî GroupsVR (Launcher)</title>
  <meta name="color-scheme" content="dark" />
  <link rel="icon" href="./favicon.ico" type="image/x-icon" />
  <style>
    :root{
      color-scheme:dark;
      --bg:#020617; --panel:rgba(2,6,23,.78); --stroke:rgba(148,163,184,.18);
      --text:#e5e7eb; --muted:#94a3b8; --accent:#22c55e; --radius:22px; --pill:999px;
      --sat: env(safe-area-inset-top, 0px);
      --sar: env(safe-area-inset-right, 0px);
      --sab: env(safe-area-inset-bottom, 0px);
      --sal: env(safe-area-inset-left, 0px);
    }
    *{box-sizing:border-box}
    html,body{margin:0;width:100%;height:100%;background:var(--bg);color:var(--text);font-family:system-ui}
    .wrap{min-height:100%;display:flex;align-items:center;justify-content:center;padding:18px}
    .card{
      width:min(640px,100%);
      background:var(--panel);
      border:1px solid var(--stroke);
      border-radius:26px;
      padding:16px;
      box-shadow:0 24px 70px rgba(0,0,0,.55);
      backdrop-filter: blur(10px);
    }
    .title{font-weight:1000;font-size:22px}
    .sub{margin-top:6px;color:var(--muted);font-weight:800;font-size:13px;line-height:1.35}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:12px}
    .pill{
      display:flex;align-items:center;justify-content:space-between;gap:10px;
      padding:12px 14px;border-radius:var(--pill);
      border:1px solid rgba(148,163,184,.18);
      background:rgba(15,23,42,.62);
      font-weight:950;
    }
    .pill small{color:var(--muted);font-weight:900}
    .row{display:flex;gap:10px;margin-top:12px}
    .btn{
      flex:1 1 auto;
      display:inline-flex;align-items:center;justify-content:center;gap:8px;
      padding:12px 12px;border-radius:18px;border:1px solid rgba(148,163,184,.20);
      background:rgba(15,23,42,.65);color:var(--text);font-weight:1000;cursor:pointer;
    }
    .btn-strong{background:rgba(34,197,94,.20);border-color:rgba(34,197,94,.35)}
    .btn:active{transform:translateY(1px)}
    .note{margin-top:10px;color:var(--muted);font-weight:800;font-size:12px}
    @media (max-width:520px){ .grid{grid-template-columns:1fr} }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="title">ü•¶ Food Groups VR</div>
      <div class="sub">
        ‡πÇ‡∏´‡∏°‡∏î‡∏ô‡∏µ‡πâ ‚Äúauto-detect‚Äù ‡πÅ‡∏•‡πâ‡∏ß‡∏û‡∏≤‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏•‡πà‡∏ô‡∏ó‡∏±‡∏ô‡∏ó‡∏µ<br/>
        (‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ñ‡πà‡∏≤‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°)
      </div>

      <div class="grid">
        <div class="pill">
          <span>üéöÔ∏è Difficulty</span>
          <span>
            <small id="vDiff">normal</small>
          </span>
        </div>
        <div class="pill">
          <span>‚è±Ô∏è Time</span>
          <span><small id="vTime">90</small>s</span>
        </div>
        <div class="pill">
          <span>üé® Style</span>
          <span><small id="vStyle">mix</small></span>
        </div>
        <div class="pill">
          <span>üß† AI</span>
          <span><small id="vAi">0</small></span>
        </div>
      </div>

      <div class="row">
        <button id="btnStart" class="btn btn-strong" type="button">üöÄ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô</button>
        <button id="btnReset" class="btn" type="button">‚ôªÔ∏è Reset</button>
      </div>

      <div class="note">
        ‡∏ó‡∏¥‡∏õ: ‡∏ñ‡πâ‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤ Cardboard/cVR ‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏° <b>?view=cvr</b> ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡∏ú‡πà‡∏≤‡∏ô HUB ‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÑ‡∏ß‡πâ‡πÅ‡∏•‡πâ‡∏ß
      </div>
    </div>
  </div>

<script>
(function(){
  'use strict';
  const DOC = document;

  const LS = 'HHA_GROUPS_LAST';
  const qs = (k, def=null)=>{ try{ return new URL(location.href).searchParams.get(k) ?? def; }catch{ return def; } };
  const clamp = (v,a,b)=>{ v=Number(v)||0; return v<a?a:(v>b?b:v); };

  function detectView(){
    const forced = String(qs('view','')||'').toLowerCase();
    if (forced) return forced;

    // very simple heuristic
    const isMobile = matchMedia && matchMedia('(pointer:coarse)').matches;
    const w = Math.max(320, innerWidth||360);
    const h = Math.max(420, innerHeight||640);

    // if opened inside "split/cvr" environment user usually passes view=cvr, so default to mobile/pc
    if (!isMobile && w >= 900) return 'pc';
    return 'mobile';
  }

  function load(){
    try{ return JSON.parse(localStorage.getItem(LS)||'{}'); }catch{ return {}; }
  }
  function save(obj){
    try{ localStorage.setItem(LS, JSON.stringify(obj||{})); }catch{}
  }

  const last = Object.assign({
    diff: 'normal',
    time: 90,
    style:'mix',
    ai: '0',
    run: 'play'
  }, load());

  // allow override from URL
  last.diff  = String(qs('diff', last.diff) || last.diff).toLowerCase();
  last.style = String(qs('style', last.style) || last.style).toLowerCase();
  last.ai    = String(qs('ai', last.ai) || last.ai);
  last.run   = String(qs('run', last.run) || last.run).toLowerCase();
  last.time  = clamp(qs('time', last.time), 30, 180);

  DOC.getElementById('vDiff').textContent = last.diff;
  DOC.getElementById('vTime').textContent = String(last.time);
  DOC.getElementById('vStyle').textContent = last.style;
  DOC.getElementById('vAi').textContent = last.ai;

  function start(){
    const view = detectView();
    const hub = String(qs('hub','')||'');
    const log = String(qs('log','')||'');

    const seed = String(qs('seed', Date.now()) || Date.now());

    save(last);

    const u = new URL('./vr-groups/groups-vr.html', location.href);
    u.searchParams.set('view', view);
    u.searchParams.set('run', last.run);
    u.searchParams.set('diff', last.diff);
    u.searchParams.set('style', last.style);
    u.searchParams.set('time', String(last.time));
    u.searchParams.set('seed', seed);
    u.searchParams.set('ai', last.ai);

    if (hub) u.searchParams.set('hub', hub);
    if (log) u.searchParams.set('log', log);

    // passthrough extra params
    const sp = new URL(location.href).searchParams;
    sp.forEach((v,k)=>{
      if (['view','run','diff','style','time','seed','ai','hub','log'].includes(k)) return;
      u.searchParams.set(k,v);
    });

    location.href = u.toString();
  }

  DOC.getElementById('btnStart').addEventListener('click', start);
  DOC.getElementById('btnReset').addEventListener('click', ()=>{
    try{ localStorage.removeItem(LS); }catch{}
    location.reload();
  });

  // auto-start if ?autostart=1
  if (String(qs('autostart','0')||'0') === '1') start();
})();
</script>
</body>
</html>
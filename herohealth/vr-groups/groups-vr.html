<!-- === A: /herohealth/vr-groups/groups-vr.html ===
GroupsVR RUN ‚Äî PRODUCTION (PC/Mobile/Cardboard/cVR)
‚úÖ Minimal A-Frame scene for Enter VR stability
‚úÖ CSS: ./groups-vr.css (D)
‚úÖ Engine: ./groups.safe.js (B)
‚úÖ Boot: ./groups-vr.boot.js (C) => detect + tap-to-start + start once
‚úÖ Optional packs: audio / ai-hooks / effects / logger (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå‡∏≠‡∏¢‡∏π‡πà‡∏Ñ‡πà‡∏≠‡∏¢‡πÄ‡∏õ‡∏¥‡∏î)
-->
<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>HeroHealth ‚Äî Food Groups VR</title>
  <meta name="color-scheme" content="dark" />
  <link rel="icon" href="../favicon.ico" type="image/x-icon" />

  <!-- STYLE (D) -->
  <link rel="stylesheet" href="./groups-vr.css" />

  <!-- A-Frame (Enter VR reliability) -->
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>

  <!-- Universal VR UI (EnterVR/Exit/Recenter + crosshair + hha:shoot) -->
  <script>window.HHA_VRUI_CONFIG = { lockPx: 92, cooldownMs: 90 };</script>
  <script src="../vr/vr-ui.js" defer></script>

  <!-- FX layer (optional but nice) -->
  <script src="../vr/particles.js" defer></script>

  <!-- OPTIONAL: if you have these files, keep them. If not, remove safely. -->
  <!-- <script src="./audio.js" defer></script> -->
  <!-- <script src="./ai-hooks.js" defer></script> -->
  <!-- <script src="./effects-pack.js" defer></script> -->
  <!-- <script src="./research-ctx.js" defer></script> -->
  <!-- <script src="./flush-log.js" defer></script> -->
  <!-- <script src="./view-helper.js" defer></script> -->

  <!-- ENGINE (B) must load BEFORE boot -->
  <script src="./groups.safe.js" defer></script>

  <!-- BOOT (C) -->
  <script src="./groups-vr.boot.js" defer></script>
</head>

<body class="view-mobile">
  <!-- XR Scene behind DOM -->
  <a-scene class="xr-scene" embedded vr-mode-ui="enabled:false" renderer="colorManagement: true">
    <a-entity position="0 1.6 0">
      <a-camera></a-camera>
    </a-entity>
    <a-sky color="#020617"></a-sky>
  </a-scene>

  <!-- ================= HUD ================= -->
  <div class="hud">
    <div class="hudLeft">
      <div class="pill"><span class="lbl">‚è≥ TIME</span><span id="timeLeft" class="val">90</span></div>
      <div class="pill"><span class="lbl">‚≠ê SCORE</span><span id="scoreVal" class="val">0</span></div>
      <div class="pill"><span class="lbl">üî• COMBO</span><span id="comboVal" class="val">0</span></div>
      <div class="pill"><span class="lbl">‚ùå MISS</span><span id="missVal" class="val">0</span></div>
    </div>
    <div class="hudRight">
      <div class="pill"><span class="lbl">üèÖ RANK</span><span id="rankVal" class="val">C</span></div>
      <div class="pill"><span class="lbl">üéØ ACC</span><span id="accVal" class="val">0%</span></div>
    </div>
  </div>

  <!-- ================= QUEST ================= -->
  <div class="questTop">
    <div class="questCard">
      <div class="qTitle">
        <div>üéØ GOAL</div>
        <div class="tag"><span id="goalNow">0</span>/<span id="goalTotal">1</span></div>
      </div>
      <div class="bar"><div id="goalFill" class="fill"></div></div>
      <div class="qSub" id="goalTitle">‚Äî</div>
      <div class="qSub" id="goalSub"></div>
    </div>

    <div class="questCard">
      <div class="qTitle">
        <div>‚ö° MINI</div>
        <div class="tag"><span id="miniNow">0</span>/<span id="miniTotal">1</span></div>
      </div>
      <div class="bar"><div id="miniFill" class="fill"></div></div>
      <div class="qSub" id="miniTitle">‚Äî</div>
      <div class="qSub" id="miniSub"></div>
    </div>
  </div>

  <!-- ================= COACH ================= -->
  <div class="coachWrap">
    <div class="coachCard">
      <img id="coachImg" class="coachImg" src="../img/coach-neutral.png" alt="coach" />
      <div class="coachBubble">
        <div class="coachName">ü•¶ Coach</div>
        <div id="coachText" class="coachText">‡πÅ‡∏ï‡∏∞‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°‚Ä¶</div>
      </div>
    </div>
  </div>

  <!-- ================= POWER ================= -->
  <div class="powerWrap">
    <div class="powerCard">
      <div class="pHead">‚ö° Power</div>
      <div class="bar powerBar"><div id="powerFill" class="fill"></div></div>
      <div class="pFoot" id="powerText">‡∏û‡∏•‡∏±‡∏á 0/8</div>
    </div>
  </div>

  <!-- ================= PLAY LAYER ================= -->
  <div id="playLayer" class="playLayer"></div>

  <!-- ================= END OVERLAY ================= -->
  <div id="endOverlay" class="overlay overlay-end hidden">
    <div class="panel">
      <div class="title">üèÅ ‡∏à‡∏ö‡πÄ‡∏Å‡∏°</div>
      <div class="sub">‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô</div>

      <div class="grid2">
        <div class="stat"><div class="k">Score</div><div id="endScore" class="v">0</div></div>
        <div class="stat"><div class="k">Rank</div><div id="endGrade" class="v">C</div></div>
        <div class="stat"><div class="k">Accuracy</div><div id="endAcc" class="v">0%</div></div>
        <div class="stat"><div class="k">Miss</div><div id="endMiss" class="v">0</div></div>
      </div>

      <div class="row row2">
        <button id="btnReplay" class="btn btn-strong" type="button">üîÅ ‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
        <button id="btnBack" class="btn btn-ghost" type="button">üè† ‡∏Å‡∏•‡∏±‡∏ö HUB</button>
      </div>

      <div class="note" style="margin-top:10px;">
        Cardboard/cVR: ‡πÉ‡∏ä‡πâ crosshair ‡πÅ‡∏•‡πâ‡∏ß‡∏¢‡∏¥‡∏á‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏ï‡∏∞‡∏à‡∏≠ (hha:shoot) ‚Ä¢ ‡∏õ‡∏∏‡πà‡∏° ENTER VR/RECENTER ‡∏≠‡∏¢‡∏π‡πà vr-ui.js
      </div>
    </div>
  </div>

  <!-- Fix back button: if hub param exists -->
  <script>
    (function(){
      const btn = document.getElementById('btnBack');
      if (!btn) return;
      btn.addEventListener('click', ()=>{
        try{
          const hub = new URL(location.href).searchParams.get('hub');
          if (hub) location.href = hub;
          else history.back();
        }catch{ history.back(); }
      });
    })();
  </script>
</body>
</html>
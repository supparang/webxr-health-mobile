<!-- === /herohealth/vr-groups/dl-train.html ===
DL Trainer (Tiny MLP 32->16->1) ‚Äî On-device
‚úÖ Load dataset from localStorage (dl-dataset.js)
‚úÖ Optional import CSV
‚úÖ Train with Adam + class-weighted BCE
‚úÖ Export / Apply weights to localStorage for dl-infer.js
-->
<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>HeroHealth ‚Äî GroupsVR DL Trainer</title>
  <meta name="color-scheme" content="light dark" />
  <style>
    :root{
      color-scheme: dark;
      --bg:#020617; --panel:rgba(2,6,23,.82); --stroke:rgba(148,163,184,.18);
      --text:#e5e7eb; --muted:#94a3b8; --accent:#22c55e; --warn:#f59e0b;
      --radius:22px;
    }
    *{box-sizing:border-box}
    html,body{margin:0;height:100%;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,"Segoe UI",sans-serif}
    .wrap{max-width:920px;margin:0 auto;padding:14px}
    .card{
      background:var(--panel); border:1px solid var(--stroke); border-radius:var(--radius);
      padding:14px; box-shadow:0 18px 44px rgba(0,0,0,.35); backdrop-filter: blur(10px);
    }
    .h1{font-weight:1000;font-size:18px}
    .sub{color:rgba(229,231,235,.86);font-size:13px;margin-top:6px}
    .grid{display:grid;grid-template-columns:1fr;gap:12px;margin-top:12px}
    @media(min-width:860px){ .grid{grid-template-columns: 1.1fr .9fr;} }
    .row{display:flex;flex-wrap:wrap;gap:10px;align-items:center;margin-top:10px}
    .btn{
      border:1px solid var(--stroke); background:rgba(15,23,42,.70);
      color:var(--text); border-radius:16px; padding:10px 12px; font-weight:900;
      cursor:pointer;
    }
    .btn-strong{border-color:rgba(34,197,94,.35); background:rgba(34,197,94,.18)}
    .btn-warn{border-color:rgba(245,158,11,.35); background:rgba(245,158,11,.16)}
    .btn-ghost{background:rgba(2,6,23,.25)}
    .pill{
      display:inline-flex;gap:8px;align-items:center;
      padding:7px 10px;border-radius:999px;border:1px solid var(--stroke);
      background:rgba(2,6,23,.55);font-weight:900;font-size:12px;color:rgba(229,231,235,.92)
    }
    .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace}
    .k{color:var(--muted);font-weight:900;font-size:12px}
    .v{font-weight:1000}
    .stats{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:10px}
    .stat{border:1px solid var(--stroke);border-radius:18px;background:rgba(15,23,42,.55);padding:10px}
    .log{
      width:100%; height:260px; resize:vertical;
      border-radius:18px; border:1px solid var(--stroke);
      background:rgba(2,6,23,.55); color:rgba(229,231,235,.92);
      padding:10px; font-size:12px; line-height:1.35;
    }
    input[type="number"], input[type="text"]{
      border-radius:14px;border:1px solid var(--stroke);
      background:rgba(2,6,23,.45);color:var(--text);
      padding:10px 12px;font-weight:900;
      width:140px;
    }
    .muted{color:var(--muted);font-size:12px}
    a{color:#7dd3fc}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="h1">üß† GroupsVR ‚Äî DL Trainer (Tiny MLP 32‚Üí16‚Üí1)</div>
      <div class="sub">
        ‡πÉ‡∏ä‡πâ dataset ‡∏à‡∏≤‡∏Å‡πÄ‡∏Å‡∏° (‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏•‡πà‡∏ô‡∏î‡πâ‡∏ß‡∏¢ <span class="pill mono">?run=play&dl=1</span>) ‡πÅ‡∏•‡πâ‡∏ß‡∏°‡∏≤‡∏ù‡∏∂‡∏Å‡πÇ‡∏°‡πÄ‡∏î‡∏•‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á
        ‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏Å‡∏î <b>Apply Weights</b> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡∏°‡πÉ‡∏ä‡πâ DL inference ‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ (<span class="pill mono">?mode=dl</span>)
      </div>

      <div class="grid">
        <div class="card" style="background:rgba(2,6,23,.55)">
          <div class="row">
            <span class="pill">Dataset: <span id="dsInfo" class="mono">‚Äî</span></span>
            <button class="btn btn-ghost" id="btnLoadLS">‚Üª Load from localStorage</button>
            <button class="btn btn-ghost" id="btnClearLS">üßπ Clear localStorage dataset</button>
          </div>

          <div class="row">
            <label class="btn btn-ghost" for="fileCsv">üìÇ Import CSV</label>
            <input id="fileCsv" type="file" accept=".csv,text/csv" style="display:none" />
            <button class="btn btn-ghost" id="btnExportW">‚¨áÔ∏è Export Weights JSON</button>
            <button class="btn btn-strong" id="btnApplyW">‚úÖ Apply Weights</button>
          </div>

          <div class="stats">
            <div class="stat"><div class="k">Rows</div><div class="v" id="vRows">0</div></div>
            <div class="stat"><div class="k">Positives (y=1)</div><div class="v" id="vPos">0</div></div>
            <div class="stat"><div class="k">Train / Val</div><div class="v" id="vSplit">‚Äî</div></div>
            <div class="stat"><div class="k">Last Val AUC</div><div class="v" id="vAuc">‚Äî</div></div>
          </div>

          <div class="row">
            <span class="k">Epochs</span><input id="inEpoch" type="number" value="30" min="3" max="200" />
            <span class="k">Batch</span><input id="inBatch" type="number" value="48" min="8" max="256" />
            <span class="k">LR</span><input id="inLR" type="text" value="0.015" />
            <span class="k">Val%</span><input id="inVal" type="number" value="18" min="10" max="40" />
          </div>

          <div class="row">
            <button class="btn btn-warn" id="btnTrain">üî• Train (Adam)</button>
            <span class="muted">‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: ‡∏°‡∏µ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 200+ rows (pos ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 20+) ‡∏à‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏´‡πá‡∏ô‡∏ú‡∏•</span>
          </div>

          <textarea id="log" class="log mono" readonly placeholder="Log‚Ä¶"></textarea>
        </div>

        <div class="card" style="background:rgba(2,6,23,.55)">
          <div class="h1">üß™ ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ (‡πÄ‡∏£‡πá‡∏ß ‡πÜ)</div>
          <div class="sub">
            1) ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏Å‡∏°: <span class="pill mono">...?run=play&dl=1</span> (‡πÄ‡∏Å‡πá‡∏ö dataset)<br/>
            2) ‡πÄ‡∏•‡πà‡∏ô‡πÉ‡∏´‡πâ‡∏°‡∏µ ‚Äúmiss/bad‚Äù ‡∏ö‡πâ‡∏≤‡∏á ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏°‡∏µ label y=1<br/>
            3) ‡∏°‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ ‡∏Å‡∏î Load ‚Üí Train ‚Üí Apply<br/>
            4) ‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏Å‡∏°‡πÄ‡∏õ‡∏¥‡∏î: <span class="pill mono">...?run=play&mode=dl</span> ‡πÅ‡∏•‡πâ‡∏ß‡∏î‡∏π risk
          </div>

          <div style="height:12px"></div>
          <div class="h1">‚úÖ Notes</div>
          <div class="sub">
            ‚Ä¢ ‡πÇ‡∏´‡∏°‡∏î <b>research/practice</b> ‡∏à‡∏∞‡∏õ‡∏¥‡∏î DL inference ‡∏ï‡∏≤‡∏°‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô<br/>
            ‚Ä¢ Dataset/Weights ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô <b>localStorage ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</b><br/>
            ‚Ä¢ ‡∏´‡∏•‡∏±‡∏á Apply ‡πÅ‡∏•‡πâ‡∏ß dl-infer.js ‡∏à‡∏∞‡∏≠‡πà‡∏≤‡∏ô weights ‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
          </div>

          <div style="height:12px"></div>
          <div class="h1">üîó ‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏Å‡∏°</div>
          <div class="sub">
            ‡πÉ‡∏ä‡πâ‡∏õ‡∏∏‡πà‡∏° Back ‡∏Ç‡∏≠‡∏á browser ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏™‡πà‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå hub=‚Ä¶ ‡πÉ‡∏ô url ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏•‡∏±‡∏ö HUB
          </div>
        </div>
      </div>

    </div>
  </div>

  <script src="./dl-train.js"></script>
</body>
</html>
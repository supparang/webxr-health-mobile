/* === /herohealth/vr-groups/groups-vr.css ===
Food Groups VR — ALL-IN CSS (PATCHED: Responsive + VR/cVR + safer HUD)
*/

:root{
  --bg:#020617;
  --panel:rgba(2,6,23,.78);
  --panel2:rgba(15,23,42,.70);
  --stroke:rgba(148,163,184,.22);
  --text:#e5e7eb;
  --muted:#94a3b8;

  --accent:#22c55e;
  --warn:#f59e0b;
  --bad:#ef4444;
  --cyan:#22d3ee;
  --violet:#a78bfa;

  /* safe-area */
  --sat: env(safe-area-inset-top, 0px);
  --sab: env(safe-area-inset-bottom, 0px);
  --sal: env(safe-area-inset-left, 0px);
  --sar: env(safe-area-inset-right, 0px);
}

*{ box-sizing:border-box; }

html,body{
  margin:0; padding:0;
  width:100%; height:100%;
  overflow:hidden;
  background:var(--bg);
  color:var(--text);
  font-family:system-ui,-apple-system,Segoe UI,sans-serif;
  touch-action:none;
}

/* ========== layer ========== */
.fg-layer, #fg-layer{
  position:fixed; inset:0;
  transform: translate(var(--vx,0px), var(--vy,0px));
  touch-action:none; user-select:none;
  pointer-events:auto;
  z-index:10;
}

/* ========== target base ========== */
.fg-target{
  position:absolute;
  left: var(--x, 50%);
  top:  var(--y, 50%);
  transform: translate(-50%,-50%) scale(var(--s,1));
  width: 78px;
  height: 78px;
  border-radius: 22px;
  border: 1px solid rgba(148,163,184,.18);
  background: rgba(15,23,42,.62);
  box-shadow: 0 18px 55px rgba(0,0,0,.45);
  display:grid;
  place-items:center;
  font-size: 40px;
  line-height: 1;
  cursor:pointer;
  will-change: transform, filter, opacity;
}

.fg-target::before{
  content: attr(data-emoji);
  transform: translateZ(0);
}

/* spawn / hit / out */
.fg-target.spawn{ animation: fgPop .18s ease-out both; }
@keyframes fgPop{
  from{ transform: translate(-50%,-50%) scale(calc(var(--s,1)*0.72)); filter: blur(0.6px); opacity:.75; }
  to  { transform: translate(-50%,-50%) scale(var(--s,1)); filter: blur(0); opacity:1; }
}
.fg-target.hit{ animation: fgHit .20s ease-out both; }
@keyframes fgHit{
  to{ transform: translate(-50%,-50%) scale(calc(var(--s,1)*0.70)); opacity:0; }
}
.fg-target.out{ animation: fgOut .20s ease-out both; }
@keyframes fgOut{
  to{ transform: translate(-50%,-50%) scale(calc(var(--s,1)*0.78)); opacity:0; filter: grayscale(1); }
}

/* types */
.fg-good{ outline: 2px solid rgba(34,197,94,.18); }
.fg-wrong{ outline: 2px solid rgba(245,158,11,.22); }
.fg-junk{  outline: 2px solid rgba(239,68,68,.24); }
.fg-decoy{ outline: 2px dashed rgba(34,211,238,.35); }
.fg-boss{
  width: 92px; height:92px;
  border-radius: 26px;
  outline: 2px solid rgba(168,85,247,.35);
  box-shadow: 0 20px 70px rgba(168,85,247,.18), 0 18px 55px rgba(0,0,0,.45);
}
.fg-boss.fg-boss-weak{ filter: saturate(1.2) brightness(1.05); }
.fg-boss.fg-boss-hurt{ animation: bossHurt .20s ease-out; }
@keyframes bossHurt{
  50%{ transform: translate(-50%,-50%) scale(calc(var(--s,1)*1.05)); }
}

/* ========== global states ========== */
body.groups-overdrive .fg-target{ filter: saturate(1.25) brightness(1.05); }
body.groups-freeze .fg-target{ filter: saturate(.95) brightness(.95); }

body.groups-storm::after{
  content:"";
  position:fixed; inset:0;
  pointer-events:none;
  background:
    radial-gradient(circle at 30% 20%, rgba(34,211,238,.12), transparent 55%),
    radial-gradient(circle at 70% 80%, rgba(168,85,247,.10), transparent 55%);
  z-index:12;
}
body.groups-storm-urgent{
  animation: stormUrgent .35s ease-in-out infinite alternate;
}
@keyframes stormUrgent{
  from{ filter: brightness(1.00); }
  to  { filter: brightness(1.06); }
}

body.clutch .hud .box{
  box-shadow:0 18px 60px rgba(239,68,68,.12);
  border-color: rgba(239,68,68,.20);
}

/* ========== responsive sizes ========== */
body.view-mobile .fg-target{ width:72px; height:72px; font-size:38px; border-radius:20px; }
body.view-pc     .fg-target{ width:82px; height:82px; font-size:42px; }
body.view-vr     .fg-target{ width:86px; height:86px; font-size:44px; }
body.view-cvr    .fg-target{ width:90px; height:90px; font-size:46px; }

/* ✅ IMPORTANT: cVR ยิงจากกลางจอ → ปิด pointer-events ของเป้า */
body.view-cvr .fg-target{ pointer-events:none !important; }

/* ========== HUD safety: keep clear edges ========== */
.hud{
  position:fixed; left:0; right:0; top:0;
  padding: calc(12px + var(--sat)) 12px 10px;
  display:flex; justify-content:space-between; gap:10px;
  pointer-events:none; z-index:50;
}
.hud .box{
  background:var(--panel);
  border:1px solid var(--stroke);
  border-radius:16px;
  padding:10px 12px;
  box-shadow:0 16px 40px rgba(0,0,0,.35);
  min-width:120px;
}
.hud .big{ font-weight:900; font-size:16px; }
.hud .small{ font-size:12px; color:var(--muted); margin-top:2px; }

.centerTop{
  position:fixed; left:50%; transform:translateX(-50%);
  top: calc(10px + var(--sat));
  z-index:55; pointer-events:none;
  display:flex; gap:10px; flex-wrap:wrap; justify-content:center;
}
.pill{
  background:rgba(15,23,42,.72);
  border:1px solid rgba(148,163,184,.16);
  border-radius:999px;
  padding:8px 12px;
  font-size:12px;
  color:var(--text);
  box-shadow:0 16px 40px rgba(0,0,0,.35);
}

/* Quest RIGHT */
.questTop{
  position:fixed;
  right:calc(10px + var(--sar));
  top:  calc(62px + var(--sat));
  left: auto;
  width: min(340px, 48vw);
  display:flex; gap:10px; flex-wrap:wrap;
  z-index:58; pointer-events:none;
}
.qbar{
  flex:1 1 240px;
  background:rgba(2,6,23,.55);
  border:1px solid rgba(148,163,184,.14);
  border-radius:16px;
  padding:10px 12px;
  box-shadow:0 16px 40px rgba(0,0,0,.25);
}
.qbar .t{ font-size:12px; color:var(--muted); }
.qbar .b{ margin-top:2px; font-size:13px; font-weight:900; }
.qbar .p{
  margin-top:8px; height:10px;
  background:rgba(15,23,42,.65);
  border:1px solid rgba(148,163,184,.14);
  border-radius:999px; overflow:hidden;
}
.qbar .p > i{
  display:block; height:100%; width:0%;
  background:linear-gradient(90deg, rgba(34,197,94,.95), rgba(34,211,238,.90));
}
.qbar .time{
  margin-top:6px;
  font-size:12px;
  color:rgba(226,232,240,.85);
  display:none;
}

/* Power bottom */
.powerWrap{
  position:fixed; left:12px; right:12px;
  bottom: calc(14px + var(--sab));
  z-index:60; pointer-events:none;
}
.power{
  height:14px; border-radius:999px;
  border:1px solid rgba(148,163,184,.18);
  background:rgba(15,23,42,.65);
  overflow:hidden;
}
.power > i{
  display:block; height:100%; width:0%;
  background:linear-gradient(90deg, rgba(34,197,94,.95), rgba(34,211,238,.90));
}
.powerLabel{
  margin-top:8px; font-size:12px; color:var(--muted);
  display:flex; justify-content:space-between;
}

/* Coach bottom-right */
.coachWrap{
  position:fixed;
  right:calc(10px + var(--sar));
  bottom: calc(82px + var(--sab)); /* above power */
  z-index:70;
  pointer-events:none;
  display:flex;
  gap:10px;
  align-items:flex-end;
}
.coachCard{
  width:220px;
  background:rgba(2,6,23,.60);
  border:1px solid rgba(148,163,184,.14);
  border-radius:18px;
  padding:10px 10px 10px;
  box-shadow:0 16px 40px rgba(0,0,0,.25);
}
.coachLine{ font-size:12px; color:rgba(226,232,240,.92); line-height:1.45; min-height:34px; }
.feverMini{
  margin-top:8px;
  height:10px;
  border-radius:999px;
  border:1px solid rgba(148,163,184,.14);
  background:rgba(15,23,42,.65);
  overflow:hidden;
}
.feverMini > i{ display:block; height:100%; width:0%; background:rgba(239,68,68,.85); }
.shieldTag{
  margin-top:8px;
  display:inline-flex;
  gap:6px;
  align-items:center;
  font-size:12px;
  color:rgba(226,232,240,.92);
  padding:6px 10px;
  border-radius:999px;
  border:1px solid rgba(148,163,184,.14);
  background:rgba(15,23,42,.60);
}
.coachImg{
  width:74px; height:74px;
  border-radius:18px;
  border:1px solid rgba(148,163,184,.14);
  background:rgba(15,23,42,.55);
  overflow:hidden;
  box-shadow:0 16px 40px rgba(0,0,0,.25);
}
.coachImg img{ width:100%; height:100%; object-fit:cover; display:block; }

/* ===== small screens ===== */
@media (max-width: 520px){
  .questTop{ width: min(300px, 56vw); top: calc(58px + var(--sat)); }
  .coachWrap{ bottom: calc(90px + var(--sab)); }
  .coachCard{ width: min(210px, 58vw); }
}
@media (max-height: 640px){
  .coachCard{ padding: 8px 10px; }
  .coachLine{ min-height: 28px; }
}
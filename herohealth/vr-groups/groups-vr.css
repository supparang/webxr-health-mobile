/* === /herohealth/vr-groups/groups-vr.css ===
Food Groups VR — PRODUCTION CSS (VR-feel)
✅ HUD top + quest bars + rank
✅ Safe-area vars
✅ Target uses --x --y --s from engine
✅ VR-feel: layer parallax --lookX/--lookY + target float/wobble
✅ Panic / Stun / Swap flash
✅ Boss bar + Lock ring
✅ Result overlay
*/

:root{
  color-scheme: dark;

  --bg-main:#020617;
  --panel:#020617;
  --panel-soft:#0b1120;

  --accent:#22c55e;
  --accent-soft:rgba(34,197,94,0.20);
  --danger:#f97373;

  --text-main:#e5e7eb;
  --text-soft:#9ca3af;

  --radius-lg:18px;
  --radius-pill:999px;

  /* ✅ Safe-area -> read by engine via --sat/--sab/--sal/--sar */
  --sat: env(safe-area-inset-top, 0px);
  --sab: env(safe-area-inset-bottom, 0px);
  --sal: env(safe-area-inset-left, 0px);
  --sar: env(safe-area-inset-right, 0px);

  /* ✅ VR-look offset (engine updates) */
  --lookX: 0px;
  --lookY: 0px;
}

*,
*::before,
*::after{ box-sizing:border-box; }

html, body{
  margin:0; padding:0; width:100%; height:100%;
  overflow:hidden;
  font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
  background:
    radial-gradient(circle at top left, rgba(56,189,248,0.18), transparent 60%),
    radial-gradient(circle at bottom right, rgba(34,197,94,0.24), transparent 55%),
    #020617;
  color:var(--text-main);
}

/* A-Frame bg full */
.a-fullscreen body > a-scene,
a-scene{
  position:fixed;
  inset:0;
  z-index:0;
}

/* ===== HUD root ===== */
.hud-root{
  position:fixed;
  inset:0;
  pointer-events:none;
  z-index:60;
}

.hud-top{
  position:absolute;
  top:0;
  left:0; right:0;
  padding:10px;
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
  gap:10px;
  pointer-events:none;
}

/* ===== HUD cards ===== */
.hud-card{
  pointer-events:auto;
  background:radial-gradient(circle at top, #0f172a, #020617);
  border-radius:var(--radius-lg);
  padding:10px 14px;
  border:1px solid rgba(148,163,184,0.25);
  box-shadow: 0 18px 40px rgba(15,23,42,0.90), 0 0 0 1px rgba(15,23,42,1);
  color:var(--text-main);
  min-width:220px;
  max-width:380px;
}

/* Small rows for your HTML */
.hud-row{
  display:flex;
  align-items:baseline;
  justify-content:space-between;
  gap:10px;
  padding:3px 0;
}
.hud-title{
  font-size:11px;
  letter-spacing:.16em;
  text-transform:uppercase;
  color:var(--text-soft);
}
.hud-val{
  font-size:18px;
  font-weight:900;
  font-variant-numeric:tabular-nums;
}

/* Mid card */
.hud-group-row{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  margin-bottom:8px;
}
.hud-group{
  font-weight:900;
  letter-spacing:.2px;
  font-size:14px;
}
.hud-timer{
  font-weight:1000;
  font-size:18px;
  padding:4px 10px;
  border-radius:999px;
  border:1px solid rgba(148,163,184,0.35);
  background: rgba(2,6,23,.55);
}

/* Power bar */
.power-wrap{ margin-top:6px; }
.power-label{
  display:flex; align-items:center; justify-content:space-between;
  font-size:11px; letter-spacing:.14em;
  text-transform:uppercase; color:var(--text-soft);
  margin-bottom:6px;
}
.power-bar{
  height:10px;
  border-radius:999px;
  background: rgba(148,163,184,0.12);
  border:1px solid rgba(148,163,184,0.18);
  overflow:hidden;
}
.power-fill{
  height:100%;
  width:0%;
  border-radius:999px;
  background: linear-gradient(90deg, rgba(34,197,94,.65), rgba(56,189,248,.55));
  box-shadow: 0 0 0 1px rgba(34,197,94,.20);
  transition: width .12s ease-out;
}

/* Quest bars */
.quest-wrap{ margin-top:10px; display:flex; flex-direction:column; gap:6px; }
.quest-line{
  display:flex; align-items:center; gap:8px;
  font-size:12px;
}
.q-badge{
  font-size:11px;
  font-weight:1000;
  letter-spacing:.16em;
  text-transform:uppercase;
  padding:2px 8px;
  border-radius:999px;
  border:1px solid rgba(148,163,184,0.25);
  background: rgba(2,6,23,.55);
  color:#bbf7d0;
}
.q-badge.mini{ color:#fde68a; }
.q-text{ flex:1; color:rgba(229,231,235,.92); }
.q-num{
  font-variant-numeric:tabular-nums;
  color:#bbf7d0;
  font-weight:900;
}
.qbar{ position:relative; }
.qbar-track{
  height:10px;
  border-radius:999px;
  background: rgba(148,163,184,0.12);
  border:1px solid rgba(148,163,184,0.18);
  overflow:hidden;
}
.qbar-fill{
  height:100%;
  width:0%;
  border-radius:999px;
  transition: width .14s ease-out;
}
.qbar-fill.goal{
  background: linear-gradient(90deg, rgba(34,197,94,.65), rgba(34,197,94,.18));
}
.qbar-fill.mini{
  background: linear-gradient(90deg, rgba(250,204,21,.65), rgba(56,189,248,.35));
}
.qbar-timer{
  position:absolute;
  right:6px; top:-18px;
  font-size:11px;
  color:#fde68a;
  font-variant-numeric:tabular-nums;
}

/* Rank */
.rank-box{
  display:flex; align-items:center; justify-content:space-between;
  gap:10px;
  margin-bottom:6px;
}
.rank-title{
  font-size:11px;
  letter-spacing:.16em;
  text-transform:uppercase;
  color:var(--text-soft);
}
.rank-sub{
  display:flex; align-items:center; justify-content:space-between;
  gap:10px;
  font-size:11px;
  color:rgba(229,231,235,.78);
}
.rank-grade{
  font-size:26px;
  font-weight:1000;
  padding:6px 12px;
  border-radius:14px;
  background: rgba(34,197,94,.12);
  border:1px solid rgba(34,197,94,.25);
  box-shadow: 0 12px 34px rgba(0,0,0,.35);
}

/* ===== Start Overlay ===== */
.start-overlay{
  position:fixed; inset:0;
  z-index:120;
  display:flex;
  align-items:center;
  justify-content:center;
  background: radial-gradient(circle at top,#020617ee,#020617f5);
  backdrop-filter: blur(10px);
}
.start-card{
  width:92%;
  max-width:520px;
  border-radius:18px;
  padding:16px 16px 14px;
  background: radial-gradient(circle at top,#0f172a,#020617);
  border:1px solid rgba(148,163,184,0.55);
  box-shadow: 0 22px 55px rgba(0,0,0,0.85);
}
.start-title{ font-size:18px; font-weight:1000; margin:0 0 8px; }
.start-sub{ font-size:13px; color:rgba(229,231,235,.88); line-height:1.35; }
.start-grid{ display:flex; gap:8px; flex-wrap:wrap; margin:10px 0; }
.pill{
  padding:6px 10px;
  border-radius:999px;
  background: rgba(2,6,23,.55);
  border:1px solid rgba(148,163,184,.25);
  font-size:12px;
  color:rgba(229,231,235,.86);
}
.start-actions{ display:flex; gap:10px; margin-top:10px; flex-wrap:wrap; }
.btn{
  border-radius:999px;
  border:1px solid rgba(148,163,184,.5);
  padding:8px 12px;
  font-size:13px;
  font-weight:900;
  cursor:pointer;
  background: rgba(2,6,23,.55);
  color:#e5e7eb;
}
.btn.primary{
  background: rgba(34,197,94,.14);
  border-color: rgba(34,197,94,.35);
}
.btn.ghost{ opacity:.9; }
.start-note{ margin-top:10px; font-size:12px; color:rgba(156,163,175,.95); }

/* ===== Target Layer + VR-feel parallax ===== */
.fg-layer,
#fg-layer{
  position:fixed;
  inset:0;
  z-index:40;
  pointer-events:none;

  /* ✅ VR-feel: move entire playfield */
  transform: translate3d(var(--lookX), var(--lookY), 0);
  transition: transform .04s linear;
  will-change: transform;
}

/* Targets */
.fg-target{
  position:absolute;

  width:132px;
  height:132px;
  border-radius:50%;

  display:flex;
  align-items:center;
  justify-content:center;

  /* ✅ must use --x --y */
  left: var(--x);
  top:  var(--y);

  pointer-events:auto;
  cursor:pointer;

  box-shadow:
    0 12px 32px rgba(15,23,42,0.85),
    0 0 0 4px rgba(15,23,42,0.9);

  /* ✅ size from engine: --s */
  --fg-scale: var(--s, 1);
  transform: translate(-50%, -50%) scale(var(--fg-scale));

  transition:
    transform .12s ease-out,
    opacity .12s ease-out,
    box-shadow .12s ease-out;

  /* ✅ VR float */
  animation: fgFloat var(--floatDur, 1200ms) ease-in-out infinite;
  will-change: transform, filter;

  /* glossy */
  background: radial-gradient(circle at 30% 30%, #f97316, #c2410c);
}

@keyframes fgFloat{
  0%,100%{ transform: translate(-50%,-50%) scale(var(--fg-scale)) translate3d(0,0,0) rotate(0deg); filter: brightness(1); }
  50%{ transform: translate(-50%,-50%) scale(var(--fg-scale)) translate3d(0,-10px,0) rotate(1.4deg); filter: brightness(1.08); }
}

/* Types */
.fg-good { background: radial-gradient(circle at 30% 30%, #22c55e, #15803d); }
.fg-junk { background: radial-gradient(circle at 30% 30%, #f97316, #c2410c); }
.fg-decoy{ background: radial-gradient(circle at 30% 30%, #38bdf8, #1d4ed8); }
.fg-boss { background: radial-gradient(circle at 30% 30%, #a78bfa, #4c1d95); }

/* Emoji from data-emoji (engine sets) */
.fg-target::before{
  content: attr(data-emoji);
  display:block;
  font-size: clamp(40px, 7vmin, 64px);
  line-height:1;
  color:#fefce8;
  text-shadow: 0 2px 4px rgba(15,23,42,0.9), 0 0 10px rgba(15,23,42,0.9);
}

/* Spawn / Out / Hit */
.fg-target.spawn{
  opacity:0;
  transform: translate(-50%,-50%) scale(calc(var(--fg-scale) * 0.70));
  animation: fgSpawn 180ms ease-out both, fgFloat var(--floatDur, 1200ms) ease-in-out infinite;
}
@keyframes fgSpawn{
  to{ opacity:1; transform: translate(-50%,-50%) scale(var(--fg-scale)); }
}
.fg-target.out{
  opacity:0;
  transform: translate(-50%,-50%) scale(calc(var(--fg-scale) * 0.78));
}
.fg-target.hit{
  opacity:0;
  transform: translate(-50%,-50%) scale(calc(var(--fg-scale) * 0.62));
}

/* Lock ring */
.fg-target.lock{
  box-shadow:
    0 12px 32px rgba(15,23,42,0.85),
    0 0 0 4px rgba(15,23,42,0.9),
    0 0 0 2px rgba(56,189,248,0.35),
    0 0 26px rgba(56,189,248,0.20);
}

/* Boss bar */
.bossbar{
  position:absolute;
  left:50%; bottom:10px;
  transform: translateX(-50%);
  width:70%;
  height:10px;
  border-radius:999px;
  background: rgba(2,6,23,.55);
  border:1px solid rgba(255,255,255,.14);
  overflow:hidden;
  box-shadow: 0 10px 24px rgba(0,0,0,.35);
}
.bossbar-fill{
  height:100%;
  width:100%;
  border-radius:999px;
  background: linear-gradient(90deg, rgba(250,204,21,.65), rgba(248,113,113,.55));
  transition: width .12s ease-out;
}
.fg-target.rage{
  filter: saturate(1.2) brightness(1.1);
  box-shadow:
    0 12px 32px rgba(15,23,42,0.85),
    0 0 0 4px rgba(15,23,42,0.9),
    0 0 0 2px rgba(248,113,113,0.35),
    0 0 34px rgba(248,113,113,0.22);
}

/* ===== FX states ===== */
html.panic .hud-timer{
  border-color: rgba(248,113,113,.55);
  box-shadow: 0 0 0 1px rgba(248,113,113,.18), 0 0 22px rgba(248,113,113,.18);
  animation: panicPulse .35s ease-in-out infinite alternate;
}
@keyframes panicPulse{
  from{ transform: translateZ(0) scale(1); }
  to{ transform: translateZ(0) scale(1.06); }
}
html.stunflash{
  animation: stunFlash 220ms ease-out both;
}
@keyframes stunFlash{
  0%{ filter: none; }
  30%{ filter: brightness(1.25) saturate(1.15); }
  100%{ filter: none; }
}
html.swapflash{
  animation: swapFlash 220ms ease-out both;
}
@keyframes swapFlash{
  0%{ filter: none; }
  40%{ filter: hue-rotate(22deg) brightness(1.12); }
  100%{ filter:none; }
}

/* ===== Result overlay ===== */
.result-overlay{
  position:fixed;
  inset:0;
  z-index:130;
  display:none;
  align-items:center;
  justify-content:center;
  background: radial-gradient(circle at top,#020617ee,#020617f5);
  backdrop-filter: blur(10px);
}
.result-overlay.show{ display:flex; }
.result-card{
  width:92%;
  max-width:420px;
  padding:18px 18px 14px;
  border-radius:18px;
  background: radial-gradient(circle at top,#0f172a,#020617);
  border:1px solid rgba(148,163,184,0.7);
  box-shadow: 0 22px 55px rgba(0,0,0,0.85);
  color:var(--text-main);
  font-size:14px;
}
.result-card h2{ margin:0 0 8px; font-size:16px; }
.result-card p{ margin:4px 0; font-size:13px; }
.result-card hr{ border:none; border-top:1px solid rgba(148,163,184,0.5); margin:10px 0; }
.result-card button{
  border-radius:999px;
  border:1px solid rgba(148,163,184,0.7);
  padding:8px 12px;
  font-size:13px;
  font-weight:900;
  cursor:pointer;
  background:rgba(15,23,42,0.9);
  color:#e5e7eb;
}
.result-card button + button{ margin-left:8px; }

/* Mobile layout */
@media (max-width:640px){
  .hud-top{ flex-direction:column; align-items:stretch; }
  .hud-card{ min-width:0; width:100%; max-width:none; }
}

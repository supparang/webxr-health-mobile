<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Hero Health — Food Groups VR</title>
  <meta name="color-scheme" content="dark" />
  <link rel="icon" href="./favicon.ico" type="image/x-icon">

  <!-- A-Frame สำหรับฉากพื้นหลัง -->
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>

  <style>
    :root {
      color-scheme: dark;
      --bg-main:#020617;
      --panel:#020617;
      --panel-soft:#0b1120;
      --accent:#22c55e;
      --accent-soft:rgba(34,197,94,0.20);
      --danger:#f97373;
      --text-main:#e5e7eb;
      --text-soft:#9ca3af;
      --radius-lg:18px;
      --radius-pill:999px;
    }

    *,*::before,*::after{box-sizing:border-box;}

    html, body {
      margin:0;
      padding:0;
      width:100%;
      height:100%;
      overflow:hidden;
      font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
      background:
        radial-gradient(circle at top left, rgba(56,189,248,0.18), transparent 60%),
        radial-gradient(circle at bottom right, rgba(34,197,94,0.24), transparent 55%),
        #020617;
      color:var(--text-main);
    }

    /* A-Frame เต็มหน้าจอ */
    a-scene {
      position:fixed;
      inset:0;
      z-index:0;
    }

    /* ===== HUD root ===== */
    .hud-root{
      position:fixed;
      inset:0;
      pointer-events:none;
      z-index:60;
    }

    .hud-top{
      position:absolute;
      top:0;
      left:0;
      right:0;
      padding:10px;
      display:flex;
      justify-content:space-between;
      align-items:flex-start;
      gap:10px;
      pointer-events:none;
    }

    /* ===== HUD Score (ซ้ายบน) ===== */
    .hud-card{
      pointer-events:auto;
      background:radial-gradient(circle at top, #0f172a, #020617);
      border-radius:var(--radius-lg);
      padding:10px 14px;
      border:1px solid rgba(148,163,184,0.25);
      box-shadow:
        0 18px 40px rgba(15,23,42,0.9),
        0 0 0 1px rgba(15,23,42,1);
      color:var(--text-main);
      min-width:260px;
      max-width:360px;
    }

    .hud-main-title{
      font-size:11px;
      letter-spacing:.18em;
      text-transform:uppercase;
      color:var(--text-soft);
      margin-bottom:2px;
    }

    .hud-main-mode{
      font-size:18px;
      font-weight:600;
    }

    .hud-pill{
      margin-top:4px;
      border-radius:999px;
      padding:2px 8px;
      font-size:11px;
      border:1px solid rgba(148,163,184,0.5);
      color:var(--text-soft);
      display:inline-flex;
      align-items:center;
      gap:4px;
    }

    .hud-metrics{
      margin-top:8px;
      display:flex;
      gap:14px;
      flex-wrap:wrap;
    }

    .metric{display:flex;flex-direction:column;gap:2px;}
    .metric-label{font-size:11px;color:var(--text-soft);}
    .metric-value{font-size:18px;font-weight:700;}
    .metric-value.accent{color:#bbf7d0;}
    .metric-sub{font-size:11px;color:var(--text-soft);min-height:14px;}

    /* ===== HUD Quest (ขวาบน) ===== */
    .fg-quest-panel{
      pointer-events:auto;
      min-width:260px;
      max-width:320px;
      padding:10px 14px;
      border-radius:var(--radius-lg);
      background:radial-gradient(circle at top, #0f172a, #020617);
      border:1px solid rgba(148,163,184,0.25);
      box-shadow:
        0 18px 40px rgba(15,23,42,0.9),
        0 0 0 1px rgba(15,23,42,1);
      color:var(--text-main);
      max-height:40vh;
      overflow-y:auto;
    }

    .fg-quest-title{
      font-size:11px;
      letter-spacing:.16em;
      text-transform:uppercase;
      color:var(--text-soft);
      margin-bottom:4px;
    }

    .fg-quest-row{
      display:flex;
      align-items:flex-start;
      gap:6px;
      font-size:13px;
      padding:2px 0;
    }

    .fg-quest-label{
      font-size:11px;
      text-transform:uppercase;
      letter-spacing:.12em;
      color:var(--text-soft);
      margin-top:2px;
      white-space:nowrap;
    }

    .fg-quest-main{
      flex:1;
      color:var(--text-main);
      opacity:.9;
    }

    .fg-quest-progress{
      font-variant-numeric:tabular-nums;
      font-size:12px;
      color:#bbf7d0;
      white-space:nowrap;
    }

    /* ===== Coach bubble ===== */
    .hud-bottom{
      position:absolute;
      left:0;
      right:0;
      bottom:64px;
      display:flex;
      justify-content:center;
      align-items:center;
      pointer-events:none;
    }

    .coach-bubble{
      min-width:60%;
      max-width:640px;
      background:rgba(15,23,42,0.95);
      border-radius:var(--radius-pill);
      padding:8px 14px;
      border:1px solid rgba(52,211,153,0.5);
      font-size:13px;
      display:none;
      align-items:center;
      gap:8px;
      pointer-events:auto;
      transition:
        transform .20s ease-out,
        box-shadow .20s ease-out,
        background .20s ease-out;
    }
    .coach-bubble.show{display:flex;}

    .coach-label{
      font-size:11px;
      text-transform:uppercase;
      letter-spacing:.16em;
      color:#6ee7b7;
      font-weight:600;
    }

    .coach-avatar{
      width:28px;
      height:28px;
      border-radius:50%;
      background:radial-gradient(circle at 30% 30%, #fef3c7, #f97316);
      display:inline-flex;
      align-items:center;
      justify-content:center;
      font-size:18px;
      box-shadow:0 0 0 2px rgba(15,23,42,0.9);
      animation:coach-breathe 2.4s ease-in-out infinite;
    }

    @keyframes coach-breathe{
      0%,100%{transform:scale(1);}
      50%{transform:scale(1.07);}
    }

    @media (max-width:640px){
      .hud-top{flex-direction:column;align-items:stretch;}
      .hud-card,.fg-quest-panel{min-width:0;width:100%;max-width:none;}
      .fg-quest-panel{margin-top:6px;max-height:34vh;}
      .coach-bubble{min-width:0;width:calc(100% - 32px);font-size:12px;}
    }

    /* Target layer (ตอนนี้ GameEngine VR ใช้ A-Frame แทน DOM แล้วจะไม่เห็นเป้าซ้อน) */
    #fg-layer{
      position:fixed;
      inset:0;
      z-index:40;
      pointer-events:none;
    }

    /* Summary, toast, fever, countdown, VR button — เหมือนเดิม */
    .result-overlay{position:fixed;inset:0;z-index:120;display:none;align-items:center;justify-content:center;background:radial-gradient(circle at top,#020617ee,#020617f5);backdrop-filter:blur(10px);}
    .result-overlay.show{display:flex;}
    .result-card{width:90%;max-width:420px;padding:18px 18px 14px;border-radius:18px;background:radial-gradient(circle at top,#0f172a,#020617);border:1px solid rgba(148,163,184,0.7);box-shadow:0 22px 55px rgba(0,0,0,0.85),0 0 0 1px rgba(15,23,42,1);color:var(--text-main);font-size:14px;}
    .result-card h2{margin:0 0 8px;font-size:16px;}
    .result-card p{margin:4px 0;font-size:13px;}
    .result-card hr{border:none;border-top:1px solid rgba(148,163,184,0.5);margin:10px 0;}
    .result-actions{margin-top:10px;display:flex;justify-content:flex-end;gap:8px;}
    .result-btn{border-radius:999px;border:1px solid rgba(148,163,184,0.7);padding:6px 12px;font-size:13px;font-weight:600;cursor:pointer;background:rgba(15,23,42,0.9);color:#e5e7eb;}
    .result-btn.primary{background:linear-gradient(90deg,#22c55e,#4ade80);color:#022c22;border:none;}

    .end-toast{position:fixed;right:12px;bottom:12px;z-index:120;max-width:280px;width:calc(100% - 32px);padding:12px 14px 10px;border-radius:18px;background:radial-gradient(circle at top,#0f172a,#020617);border:1px solid rgba(148,163,184,0.5);box-shadow:0 18px 40px rgba(15,23,42,0.95),0 0 0 1px rgba(15,23,42,1);font-size:13px;color:var(--text-main);display:none;}
    .end-toast.show{display:block;}
    .end-title{font-size:14px;font-weight:600;margin-bottom:6px;}
    .end-row{display:flex;justify-content:space-between;align-items:center;gap:8px;margin:2px 0;}
    .end-row strong{font-variant-numeric:tabular-nums;}
    .end-actions{margin-top:10px;display:flex;justify-content:flex-end;gap:8px;}
    .end-btn{border-radius:999px;border:1px solid rgba(148,163,184,0.7);padding:4px 10px;font-size:12px;font-weight:600;cursor:pointer;background:rgba(15,23,42,0.9);color:#e5e7eb;}
    .end-btn.primary{background:linear-gradient(90deg,#22c55e,#4ade80);color:#022c22;border:none;}

    .hha-fever-wrap{
      position:fixed !important;
      left:10px;
      bottom:10px;
      right:auto;
      transform:none;
      z-index:80 !important;
    }

    .countdown-overlay{
      position:fixed;inset:0;display:flex;align-items:center;justify-content:center;z-index:200;
      font-size:clamp(3rem,10vw,5rem);font-weight:800;color:#fbbf24;
      text-shadow:0 0 40px rgba(0,0,0,0.85);pointer-events:none;
      opacity:0;transform:scale(0.8);transition:opacity .2s ease-out,transform .2s ease-out;
    }
    .countdown-overlay.show{opacity:1;transform:scale(1);}

    .vr-btn{
      position:fixed;right:12px;bottom:16px;z-index:653;border-radius:999px;
      border:1px solid rgba(56,189,248,0.7);padding:8px 14px;font-size:12px;font-weight:600;
      cursor:pointer;background:radial-gradient(circle at top left, rgba(56,189,248,0.35), transparent 55%),rgba(15,23,42,0.96);
      color:#e0f2fe;display:inline-flex;align-items:center;gap:6px;box-shadow:0 14px 30px rgba(15,23,42,0.9);
    }
    .vr-btn span{font-size:16px;}
  </style>
</head>
<body>

  <!-- ฉาก VR พื้นหลัง (ลบ a-plane พื้นออกแล้ว) -->
  <a-scene
    vr-mode-ui="enabled: true"
    renderer="antialias: true; colorManagement: true; physicallyCorrectLights: true"
    background="color: #020617">

    <a-entity id="rig" position="0 1.6 0">
      <a-camera id="fg-camera"
                wasd-controls-enabled="false"
                look-controls="pointerLockEnabled: false">
        <a-entity id="cursor"
                  cursor="fuse: false; rayOrigin: mouse"
                  geometry="primitive: ring; radiusInner: 0.01; radiusOuter: 0.016"
                  material="shader: flat; color: #ffffff"
                  position="0 0 -0.9">
        </a-entity>
      </a-camera>
    </a-entity>

    <!-- ไฟ + ท้องฟ้า (ไม่มีพื้นแล้ว) -->
    <a-entity light="type: hemisphere; color: #ffffff; groundColor: #4b5563; intensity: 0.9"></a-entity>
    <a-entity light="type: directional; intensity: 0.65" position="1 2 0.5"></a-entity>
    <a-sky color="#020617"></a-sky>
  </a-scene>

  <!-- เลเยอร์ DOM เป้า (ตอนนี้ถ้าใช้ GameEngine VR 3D จริง ๆ จะไม่ใช้เลเยอร์นี้ก็ได้) -->
  <div id="fg-layer"></div>

  <!-- HUD เหมือนเดิม -->
  <!-- ... (ส่วน HUD + coach + result overlay ทั้งหมดเหมือนโค้ดที่คุณส่งมา) ... -->

  <!-- ตัดออกเพื่อไม่ให้ยาวเกิน: ใช้ block เดิมของคุณต่อจากตรงนี้ได้เลย 
       (ปุ่ม VR, countdown, result overlay, scripts, boot logic ฯลฯ) -->

</body>
</html>

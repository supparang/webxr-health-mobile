<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>HeroHealth ‚Äî GroupsVR Launcher</title>
  <meta name="color-scheme" content="dark" />
  <link rel="icon" href="./favicon.ico" type="image/x-icon" />
  <style>
    :root{
      --bg:#020617;
      --panel:rgba(2,6,23,.78);
      --stroke:rgba(148,163,184,.22);
      --text:#e5e7eb;
      --muted:#94a3b8;
      --accent:#22c55e;
      --radius:22px;
      --pill:999px;
      --sat: env(safe-area-inset-top, 0px);
      --sar: env(safe-area-inset-right, 0px);
      --sab: env(safe-area-inset-bottom, 0px);
      --sal: env(safe-area-inset-left, 0px);
    }
    *{ box-sizing:border-box; }
    html,body{ height:100%; margin:0; }
    body{
      background:
        radial-gradient(circle at top left, rgba(34,211,238,.14), transparent 55%),
        radial-gradient(circle at bottom right, rgba(167,139,250,.12), transparent 55%),
        var(--bg);
      color:var(--text);
      font-family:system-ui,-apple-system,"Segoe UI",sans-serif;
      overflow:hidden;
    }
    .wrap{
      position:fixed; inset:0;
      padding: calc(18px + var(--sat)) calc(18px + var(--sar)) calc(18px + var(--sab)) calc(18px + var(--sal));
      display:flex; align-items:center; justify-content:center;
    }
    .card{
      width:min(720px, 100%);
      border-radius: 26px;
      background: var(--panel);
      border: 1px solid var(--stroke);
      box-shadow: 0 24px 70px rgba(0,0,0,.55);
      padding: 18px;
      backdrop-filter: blur(10px);
    }
    .title{
      font-weight:1000;
      font-size:22px;
      letter-spacing:.2px;
      display:flex; align-items:center; gap:10px;
    }
    .sub{
      margin-top:6px;
      color:var(--muted);
      font-weight:800;
      font-size:13px;
      line-height:1.35;
    }
    .grid{
      margin-top:14px;
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
    }
    .stat{
      padding: 12px;
      border-radius: 18px;
      background: rgba(15,23,42,.62);
      border: 1px solid rgba(148,163,184,.16);
    }
    .k{ font-weight:900; font-size:12px; color:var(--muted); }
    .v{ margin-top:4px; font-weight:1000; font-size:16px; }
    .row{
      margin-top:14px;
      display:flex; gap:10px; flex-wrap:wrap;
    }
    .btn{
      flex: 1 1 220px;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:10px;
      padding: 14px 14px;
      border-radius: 18px;
      border: 1px solid rgba(148,163,184,.20);
      background: rgba(15,23,42,.65);
      color: var(--text);
      font-weight: 1000;
      cursor:pointer;
      user-select:none;
      text-decoration:none;
    }
    .btn:active{ transform: translateY(1px); }
    .btn-strong{
      background: rgba(34,197,94,.20);
      border-color: rgba(34,197,94,.35);
    }
    .note{
      margin-top:10px;
      color:var(--muted);
      font-size:12px;
      font-weight:800;
    }

    /* Tap-to-start overlay */
    .tap{
      position:fixed; inset:0;
      display:flex; align-items:center; justify-content:center;
      padding: 18px;
      background: rgba(2,6,23,.78);
      backdrop-filter: blur(10px);
      z-index: 50;
    }
    .tap.hidden{ display:none; }
    .tapPanel{
      width:min(520px, 100%);
      border-radius: 26px;
      background: rgba(2,6,23,.88);
      border: 1px solid rgba(148,163,184,.22);
      box-shadow: 0 24px 70px rgba(0,0,0,.55);
      padding: 16px;
      text-align:center;
    }
    .tapBig{
      margin-top:10px;
      font-size:20px;
      font-weight:1000;
      letter-spacing:.2px;
    }
    .tapSmall{
      margin-top:8px;
      color:var(--muted);
      font-weight:800;
      font-size:12px;
      line-height:1.35;
    }
    @media (max-width:560px){
      .grid{ grid-template-columns:1fr; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="title">ü•¶ HeroHealth ‚Äî Food Groups VR</div>
      <div class="sub">
        Launcher ‡πÅ‡∏ö‡∏ö Auto-detect + Tap-to-start (‡∏Å‡∏±‡∏ô‡∏õ‡∏±‡∏ç‡∏´‡∏≤ browser block)
        ‚Ä¢ ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏û‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏Å‡∏°‡πÄ‡∏≠‡∏á‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏°‡∏ô‡∏π
      </div>

      <div class="grid">
        <div class="stat">
          <div class="k">Detected View</div>
          <div id="vView" class="v">‚Äî</div>
        </div>
        <div class="stat">
          <div class="k">Run Mode</div>
          <div id="vRun" class="v">‚Äî</div>
        </div>
        <div class="stat">
          <div class="k">Difficulty</div>
          <div id="vDiff" class="v">‚Äî</div>
        </div>
        <div class="stat">
          <div class="k">Time</div>
          <div id="vTime" class="v">‚Äî</div>
        </div>
      </div>

      <div class="row">
        <a id="btnStart" class="btn btn-strong" href="#">üöÄ Start (Tap)</a>
        <a id="btnOpenRun" class="btn" href="#" target="_blank" rel="noopener">üîó Open RUN URL</a>
      </div>

      <div class="note">
        Tip: ‡∏ñ‡πâ‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡πÅ‡∏•‡πâ‡∏ß ‚Äú‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‚Äù ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏¥‡∏î Console ‡πÄ‡∏ä‡πá‡∏Ñ 404 ‡∏Ç‡∏≠‡∏á
        <b>/herohealth/vr-groups/effects-pack.js</b> ‡πÅ‡∏•‡∏∞ <b>/herohealth/vr/particles.js</b>
      </div>
    </div>
  </div>

  <div id="tap" class="tap">
    <div class="tapPanel">
      <div style="font-size:34px">üëÜ</div>
      <div class="tapBig">TAP TO START</div>
      <div class="tapSmall">
        ‡∏ö‡∏≤‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏ï‡∏∞‡∏Å‡πà‡∏≠‡∏ô ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡πÄ‡∏™‡∏µ‡∏¢‡∏á/‡πÄ‡∏ï‡πá‡∏°‡∏à‡∏≠/VR UI<br/>
        ‡πÅ‡∏ï‡∏∞‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‡πÅ‡∏•‡πâ‡∏ß‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏û‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏Å‡∏°‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
      </div>
      <div class="row" style="margin-top:14px">
        <button id="tapGo" class="btn btn-strong" type="button">‚úÖ Tap ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏Å‡∏°</button>
      </div>
    </div>
  </div>

<script>
(function(){
  'use strict';
  const DOC = document;
  const $ = (id)=>DOC.getElementById(id);

  function qs(k, def=null){
    try { return new URL(location.href).searchParams.get(k) ?? def; }
    catch { return def; }
  }

  // ‚úÖ Auto-detect (no override)
  function detectView(){
    const ua = navigator.userAgent || '';
    const isMobile = /Android|iPhone|iPad|iPod/i.test(ua) || (navigator.maxTouchPoints>1);
    const hasWebXR = !!navigator.xr;
    // ‡πÄ‡∏£‡∏≤ ‚Äú‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö VR‚Äù ‡πÄ‡∏≠‡∏á ‚Äî ‡πÉ‡∏´‡πâ vr-ui.js ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ EnterVR/Immersive
    // ‡πÅ‡∏ï‡πà‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡πÉ‡∏´‡πâ default ‡πÄ‡∏õ‡πá‡∏ô mobile (‡πÅ‡∏•‡∏∞‡∏Ñ‡πà‡∏≠‡∏¢‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ EnterVR ‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£)
    // ‡∏ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏ä‡πâ cVR ‡∏ú‡πà‡∏≤‡∏ô‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå view=cvr ‡πÉ‡∏ô link ‡πÉ‡∏´‡πâ RUN ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡πÄ‡∏≠‡∏á
    return isMobile ? 'mobile' : 'pc';
  }

  function clamp(n,a,b){ n=Number(n)||0; return n<a?a:(n>b?b:n); }

  // build RUN url
  function buildRunUrl(){
    const run  = String(qs('run','play')||'play').toLowerCase();       // play|research
    const diff = String(qs('diff','normal')||'normal').toLowerCase();  // easy|normal|hard
    const style= String(qs('style','feel')||'feel').toLowerCase();     // feel|mix|...
    const time = clamp(qs('time',90), 30, 180);
    const seed = String(qs('seed', Date.now()) || Date.now());
    const hub  = String(qs('hub','')||'');

    const viewDetected = detectView();

    const u = new URL('./vr-groups/groups-vr.html', location.href);
    u.searchParams.set('view', viewDetected);
    u.searchParams.set('run', run);
    u.searchParams.set('diff', diff);
    u.searchParams.set('style', style);
    u.searchParams.set('time', String(time));
    u.searchParams.set('seed', seed);
    u.searchParams.set('ai', String(qs('ai','0')||'0'));              // default OFF
    u.searchParams.set('practice', String(qs('practice','0')||'0'));  // default OFF
    if (hub) u.searchParams.set('hub', hub);

    // passthrough extra params (except duplicates)
    try{
      const sp = new URL(location.href).searchParams;
      sp.forEach((v,k)=>{
        if (['view','run','diff','style','time','seed','ai','practice','hub'].includes(k)) return;
        u.searchParams.set(k,v);
      });
    }catch(_){}

    return { url: u.toString(), viewDetected, run, diff, time };
  }

  const info = buildRunUrl();
  $('vView').textContent = info.viewDetected.toUpperCase();
  $('vRun').textContent  = info.run.toUpperCase();
  $('vDiff').textContent = info.diff.toUpperCase();
  $('vTime').textContent = info.time + 's';

  $('btnOpenRun').href = info.url;
  $('btnStart').addEventListener('click', (e)=>{ e.preventDefault(); $('tap').classList.remove('hidden'); });

  // ‚úÖ Tap-to-start ‚Üí ‡πÄ‡∏Ç‡πâ‡∏≤ RUN
  function go(){
    try{
      // best-effort unlock (no harm)
      if (navigator.vibrate) navigator.vibrate(6);
    }catch(_){}
    location.href = info.url;
  }
  $('tapGo').addEventListener('click', go);

  // show overlay immediately (satisfy request)
  // if user prefers auto-navigate, comment next line:
  $('tap').classList.remove('hidden');
})();
</script>
</body>
</html>
<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>HeroHealth ‚Äî GroupsVR Launcher</title>
  <meta name="color-scheme" content="light dark" />
  <link rel="icon" href="./favicon.ico" type="image/x-icon" />
  <link rel="stylesheet" href="./vr-groups/groups-vr.css" />
</head>
<body class="view-mobile">
  <div class="overlay" id="launcher">
    <div class="panel">
      <div class="title">üçΩÔ∏è Food Groups VR</div>
      <div class="sub">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå + ‡πÇ‡∏´‡∏°‡∏î + ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏Å ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢</div>
      <div class="hr"></div>

      <div class="kv">
        <div class="k">DEVICE</div>
        <div class="v">
          <button class="btn btn-strong" data-view="pc" type="button">üñ•Ô∏è PC</button>
          <button class="btn btn-strong" data-view="mobile" type="button">üì± Mobile</button>
          <button class="btn btn-strong" data-view="cvr" type="button">üï∂Ô∏è Cardboard (cVR)</button>
        </div>
      </div>

      <div class="grid2" style="margin-top:12px;">
        <div class="kv">
          <div class="k">RUN</div>
          <div class="v">
            <span class="chip chip-on" data-run="play">PLAY</span>
            <span class="chip" data-run="research">RESEARCH</span>
          </div>
        </div>
        <div class="kv">
          <div class="k">DIFF</div>
          <div class="v">
            <span class="chip" data-diff="easy">EASY</span>
            <span class="chip chip-on" data-diff="normal">NORMAL</span>
            <span class="chip" data-diff="hard">HARD</span>
          </div>
        </div>
      </div>

      <div class="grid2" style="margin-top:12px;">
        <div class="kv">
          <div class="k">STYLE</div>
          <div class="v">
            <span class="chip chip-on" data-style="mix">MIX</span>
            <span class="chip" data-style="feel">FEEL</span>
            <span class="chip" data-style="hard">HARD</span>
          </div>
        </div>
        <div class="kv">
          <div class="k">TIME (sec)</div>
          <div class="v">
            <input id="inTime" class="input" type="number" value="90" min="30" max="180" />
            <span class="hint">30‚Äì180</span>
          </div>
        </div>
      </div>

      <div class="grid2" style="margin-top:12px;">
        <div class="kv">
          <div class="k">PRACTICE</div>
          <div class="v">
            <span class="chip chip-on" data-practice="1">ON</span>
            <span class="chip" data-practice="0">OFF</span>
          </div>
        </div>
        <div class="kv">
          <div class="k">SEED</div>
          <div class="v">
            <input id="inSeed" class="input" type="text" value="123" />
            <span class="hint">research ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ fix</span>
          </div>
        </div>
      </div>

      <div class="hr"></div>
      <div class="row">
        <button id="btnStart" class="btn btn-strong" type="button">‚ñ∂Ô∏è START</button>
        <button id="btnStartHub" class="btn btn-ghost" type="button">üè† START + HUB</button>
      </div>

      <div class="note" style="margin-top:10px;">
        Cardboard: ‡πÄ‡∏Ç‡πâ‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î ENTER VR/RECENTER ‡∏à‡∏≤‡∏Å vr-ui.js ‡πÅ‡∏•‡∏∞‡πÅ‡∏ï‡∏∞‡∏à‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏¥‡∏á (crosshair)
      </div>
    </div>
  </div>

<script>
(function(){
  'use strict';
  const DOC = document;
  const $ = (id)=>DOC.getElementById(id);

  let state = {
    view:'mobile',
    run:'play',
    diff:'normal',
    style:'mix',
    practice:'1'
  };

  function setChip(groupAttr, val){
    DOC.querySelectorAll(`[data-${groupAttr}]`).forEach(el=>{
      if (String(el.getAttribute(`data-${groupAttr}`)) === String(val)) el.classList.add('chip-on');
      else el.classList.remove('chip-on');
    });
  }
  function clamp(v,a,b){ v=Number(v)||0; return v<a?a:(v>b?b:v); }

  // device buttons
  DOC.querySelectorAll('[data-view]').forEach(btn=>{
    btn.addEventListener('click', ()=>{
      state.view = btn.getAttribute('data-view');
      DOC.body.classList.remove('view-pc','view-mobile','view-vr','view-cvr');
      DOC.body.classList.add('view-'+state.view);
    });
  });

  // chips
  DOC.querySelectorAll('[data-run]').forEach(ch=>{
    ch.addEventListener('click', ()=>{
      state.run = ch.getAttribute('data-run');
      setChip('run', state.run);
    });
  });
  DOC.querySelectorAll('[data-diff]').forEach(ch=>{
    ch.addEventListener('click', ()=>{
      state.diff = ch.getAttribute('data-diff');
      setChip('diff', state.diff);
    });
  });
  DOC.querySelectorAll('[data-style]').forEach(ch=>{
    ch.addEventListener('click', ()=>{
      state.style = ch.getAttribute('data-style');
      setChip('style', state.style);
    });
  });
  DOC.querySelectorAll('[data-practice]').forEach(ch=>{
    ch.addEventListener('click', ()=>{
      state.practice = ch.getAttribute('data-practice');
      setChip('practice', state.practice);
    });
  });

  setChip('run', state.run);
  setChip('diff', state.diff);
  setChip('style', state.style);
  setChip('practice', state.practice);

  function buildUrl(withHub){
    const time = clamp($('inTime').value, 30, 180);
    const seed = String($('inSeed').value || Date.now());
    const u = new URL('./vr-groups/groups.html', location.href);
    u.searchParams.set('view', state.view);
    u.searchParams.set('run', state.run);
    u.searchParams.set('diff', state.diff);
    u.searchParams.set('style', state.style);
    u.searchParams.set('time', String(time));
    u.searchParams.set('seed', seed);
    u.searchParams.set('practice', state.practice);
    if (withHub){
      // default hub path
      u.searchParams.set('hub', './hub.html');
    }
    return u.toString();
  }

  $('btnStart').addEventListener('click', ()=> location.href = buildUrl(false));
  $('btnStartHub').addEventListener('click', ()=> location.href = buildUrl(true));

})();
</script>
</body>
</html>
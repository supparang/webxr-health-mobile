<!-- === /herohealth/groups-vr.html ===
HeroHealth ‚Äî GroupsVR Launcher (PC / Mobile / VR Cardboard)
‚úÖ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å view: pc / mobile / cvr
‚úÖ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å run: play / research
‚úÖ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å diff/style/time/seed
‚úÖ ‡∏à‡∏≥‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏° (localStorage)
‚úÖ ‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠ hub=... ‡πÑ‡∏õ run
-->
<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>HeroHealth ‚Äî GroupsVR Launcher</title>
  <meta name="color-scheme" content="light dark" />
  <link rel="icon" href="./favicon.ico" type="image/x-icon" />

  <!-- Reuse main css (‡∏°‡∏µ panel/btn/grid ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß) -->
  <link rel="stylesheet" href="./vr-groups/groups-vr.css" />

  <style>
    /* launcher tweaks (‡πÑ‡∏°‡πà‡πÑ‡∏õ‡∏£‡∏ö‡∏Å‡∏ß‡∏ô run) */
    body{ overflow:auto; }
    .overlay{ position:relative; min-height:100dvh; }
    .overlay{ background: radial-gradient(circle at 20% 0%, rgba(34,211,238,.18), transparent 55%),
                        radial-gradient(circle at 80% 110%, rgba(167,139,250,.16), transparent 60%),
                        rgba(2,6,23,.88); }
    .panel{ margin: 22px auto; }
    .preview{
      border:1px solid rgba(148,163,184,.18);
      border-radius:18px;
      padding:12px;
      background: rgba(15,23,42,.35);
    }
    .mini{
      font-size: 12px;
      color: rgba(229,231,235,.82);
      line-height:1.35;
      font-weight:800;
    }
    .btnRow{ display:flex; gap:10px; flex-wrap:wrap; }
    .btnWide{ min-width: 190px; justify-content:center; display:inline-flex; }
    .chip{ user-select:none; }
  </style>
</head>

<body>
  <div class="overlay">
    <div class="panel">
      <div class="title">üçΩÔ∏è Food Groups VR ‚Äî Launcher</div>
      <div class="sub">
        ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏´‡∏°‡∏î‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏•‡πà‡∏ô‡πÉ‡∏´‡πâ‡∏ä‡∏±‡∏î ‡πÜ: <b>PC / Mobile / VR Cardboard</b><br/>
        <span class="hint">Cardboard ‡πÉ‡∏ä‡πâ <b>view=cvr</b> ‡πÅ‡∏•‡πâ‡∏ß ‚Äú‡πÅ‡∏ï‡∏∞‡∏à‡∏≠ = ‡∏¢‡∏¥‡∏á‡∏à‡∏≤‡∏Å crosshair‚Äù ‡∏ú‡πà‡∏≤‡∏ô vr-ui.js</span>
      </div>

      <div class="hr"></div>

      <div class="grid2">
        <div class="kv">
          <div class="k">Device / View</div>
          <div class="v" id="viewChips">
            <button class="chip" data-view="pc">üñ•Ô∏è PC</button>
            <button class="chip" data-view="mobile">üì± Mobile</button>
            <button class="chip" data-view="cvr">üï∂Ô∏è Cardboard (VR)</button>
          </div>
          <div class="note" style="margin-top:8px;">
            <b>PC/Mobile</b>: ‡πÅ‡∏ï‡∏∞/‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏õ‡πâ‡∏≤‡πÑ‡∏î‡πâ‡∏ï‡∏£‡∏á ‡πÜ<br/>
            <b>Cardboard</b>: ‡πÄ‡∏õ‡πâ‡∏≤ ‚Äú‡πÑ‡∏°‡πà‡∏£‡∏±‡∏ö‡∏Ñ‡∏•‡∏¥‡∏Å‚Äù (pointer-events off) ‚Äî ‡∏¢‡∏¥‡∏á‡∏î‡πâ‡∏ß‡∏¢ crosshair
          </div>
        </div>

        <div class="kv">
          <div class="k">Run mode</div>
          <div class="v" id="runChips">
            <button class="chip" data-run="play">üéÆ Play (Adaptive ON)</button>
            <button class="chip" data-run="research">üß™ Research (Deterministic)</button>
          </div>
          <div class="note" style="margin-top:8px;">
            Research: ‡∏õ‡∏¥‡∏î adaptive/AI (‡∏Ñ‡∏á‡∏ó‡∏µ‡πà‡∏î‡πâ‡∏ß‡∏¢ seed) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏á‡∏ï‡∏£‡∏á
          </div>
        </div>
      </div>

      <div class="hr"></div>

      <div class="grid2">
        <div class="kv">
          <div class="k">Difficulty</div>
          <div class="v" id="diffChips">
            <button class="chip" data-diff="easy">üôÇ Easy</button>
            <button class="chip" data-diff="normal">üòé Normal</button>
            <button class="chip" data-diff="hard">üòà Hard</button>
          </div>
        </div>

        <div class="kv">
          <div class="k">Style</div>
          <div class="v" id="styleChips">
            <button class="chip" data-style="mix">üéõÔ∏è Mix</button>
            <button class="chip" data-style="feel">üåä Feel</button>
            <button class="chip" data-style="hard">üåÄ Hard</button>
          </div>
          <div class="note" style="margin-top:8px;">
            Feel: wave storm ‡πÄ‡∏î‡πà‡∏ô / Hard: spiral storm ‡πÄ‡∏î‡πà‡∏ô / Mix: ‡∏™‡∏•‡∏±‡∏ö pattern
          </div>
        </div>
      </div>

      <div class="hr"></div>

      <div class="grid2">
        <div class="kv">
          <div class="k">Time (sec)</div>
          <div class="v">
            <input id="timeInput" class="input" type="number" min="30" max="180" step="5" />
            <span class="hint">30‚Äì180</span>
          </div>
        </div>

        <div class="kv">
          <div class="k">Seed</div>
          <div class="v">
            <input id="seedInput" class="input" type="text" />
            <button id="btnNewSeed" class="btn btn-ghost" type="button">üé≤ ‡∏™‡∏∏‡πà‡∏°</button>
          </div>
          <div class="note" style="margin-top:8px;">
            ‡πÉ‡∏™‡πà seed ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô = ‡πÑ‡∏î‡πâ pattern ‡πÉ‡∏Å‡∏•‡πâ‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á‡∏Å‡∏±‡∏ô (‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡πÉ‡∏ô research)
          </div>
        </div>
      </div>

      <div class="hr"></div>

      <div class="preview">
        <div class="mini"><b>‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏•‡πà‡∏ô:</b></div>
        <div class="mini" id="previewUrl" style="word-break:break-all; margin-top:6px;"></div>
      </div>

      <div class="hr"></div>

      <div class="btnRow">
        <button id="btnStart" class="btn btn-strong btnWide" type="button">üöÄ START</button>
        <button id="btnCopyLink" class="btn btnWide" type="button">üîó Copy Link</button>
        <button id="btnHub" class="btn btn-ghost btnWide" type="button">üè† ‡πÑ‡∏õ HUB</button>
      </div>

      <div class="note" style="margin-top:12px;">
        ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡πÅ‡∏•‡πâ‡∏ß‡∏≠‡∏¢‡∏≤‡∏Å‡πÄ‡∏•‡πà‡∏ô VR Cardboard: ‡∏Å‡∏î START (view=cvr) ‚Üí ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏£‡∏±‡∏ô‡∏à‡∏∞‡∏°‡∏µ‡∏õ‡∏∏‡πà‡∏° <b>ENTER VR</b> ‡∏à‡∏≤‡∏Å vr-ui.js
      </div>
    </div>
  </div>

<script>
(function(){
  'use strict';
  const DOC = document;
  const $ = (id)=>DOC.getElementById(id);

  const LS = 'HHA_GROUPS_LAUNCHER';

  function qs(k, def=null){
    try { return new URL(location.href).searchParams.get(k) ?? def; }
    catch { return def; }
  }
  function clamp(v,a,b){ v = Number(v)||0; return v<a?a:(v>b?b:v); }

  async function copyText(text){
    try { await navigator.clipboard.writeText(String(text||'')); return true; }
    catch{
      try{
        const ta = DOC.createElement('textarea');
        ta.value = String(text||'');
        DOC.body.appendChild(ta);
        ta.select();
        DOC.execCommand('copy');
        ta.remove();
        return true;
      }catch{ return false; }
    }
  }

  const state = {
    view: 'mobile',
    run: 'play',
    diff: 'normal',
    style:'mix',
    time: 90,
    seed: String(Date.now())
  };

  function load(){
    try{
      const s = JSON.parse(localStorage.getItem(LS)||'null');
      if (s && typeof s==='object'){
        if (s.view) state.view = String(s.view);
        if (s.run) state.run = String(s.run);
        if (s.diff) state.diff = String(s.diff);
        if (s.style) state.style = String(s.style);
        if (s.time) state.time = clamp(s.time, 30, 180);
        if (s.seed) state.seed = String(s.seed);
      }
    }catch{}
    // allow URL override
    state.view  = String(qs('view',  state.view)  || state.view);
    state.run   = String(qs('run',   state.run)   || state.run);
    state.diff  = String(qs('diff',  state.diff)  || state.diff);
    state.style = String(qs('style', state.style) || state.style);
    state.time  = clamp(qs('time', state.time), 30, 180);
    state.seed  = String(qs('seed', state.seed) || state.seed);
  }
  function save(){
    try{ localStorage.setItem(LS, JSON.stringify(state)); }catch{}
  }

  function setChipOn(containerId, key, val){
    const box = $(containerId);
    if (!box) return;
    box.querySelectorAll('.chip').forEach(btn=>{
      const v = btn.dataset[key];
      btn.classList.toggle('chip-on', String(v) === String(val));
    });
  }

  function buildUrl(){
    const hub = String(qs('hub','')||'');
    const u = new URL('./vr-groups/groups.html', location.href);
    u.searchParams.set('view', state.view);
    u.searchParams.set('run', state.run);
    u.searchParams.set('diff', state.diff);
    u.searchParams.set('style', state.style);
    u.searchParams.set('time', String(state.time));
    u.searchParams.set('seed', state.seed);
    if (hub) u.searchParams.set('hub', hub);
    return u.toString();
  }

  function refresh(){
    setChipOn('viewChips','view',state.view);
    setChipOn('runChips','run',state.run);
    setChipOn('diffChips','diff',state.diff);
    setChipOn('styleChips','style',state.style);

    $('timeInput').value = String(state.time);
    $('seedInput').value = state.seed;

    $('previewUrl').textContent = buildUrl();
    save();
  }

  // bind chips
  function bindChips(containerId, key){
    const box = $(containerId);
    if (!box) return;
    box.addEventListener('click', (e)=>{
      const btn = e.target.closest('.chip');
      if (!btn) return;
      const v = btn.dataset[key];
      if (!v) return;
      state[key] = v;
      refresh();
    });
  }

  // init
  load();
  bindChips('viewChips','view');
  bindChips('runChips','run');
  bindChips('diffChips','diff');
  bindChips('styleChips','style');

  $('timeInput').addEventListener('change', ()=>{
    state.time = clamp($('timeInput').value, 30, 180);
    refresh();
  });

  $('seedInput').addEventListener('change', ()=>{
    state.seed = String($('seedInput').value || Date.now());
    refresh();
  });

  $('btnNewSeed').addEventListener('click', ()=>{
    state.seed = String(Date.now());
    refresh();
  });

  $('btnStart').addEventListener('click', ()=>{
    location.href = buildUrl();
  });

  $('btnCopyLink').addEventListener('click', async ()=>{
    const ok = await copyText(buildUrl());
    alert(ok ? '‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÅ‡∏•‡πâ‡∏ß ‚úÖ' : 'Copy ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
  });

  $('btnHub').addEventListener('click', ()=>{
    const hub = String(qs('hub','')||'');
    if (!hub){ alert('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå hub=...'); return; }
    location.href = hub;
  });

  refresh();
})();
</script>
</body>
</html>
<!-- === /herohealth/groups-vr.html ===
HeroHealth ‚Äî GroupsVR Launcher (PC/Mobile/Cardboard)
‚úÖ remembers last settings
‚úÖ passthrough unknown params (study ctx etc.)
‚úÖ sends: view, run, diff, style, time, seed, practice
-->
<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>HeroHealth ‚Äî GroupsVR Launcher</title>
  <meta name="color-scheme" content="light dark" />
  <link rel="icon" href="./favicon.ico" type="image/x-icon" />

  <style>
    :root{
      color-scheme: dark;
      --bg:#020617;
      --panel:rgba(2,6,23,.78);
      --panel2:rgba(15,23,42,.70);
      --stroke:rgba(148,163,184,.18);
      --text:#e5e7eb;
      --muted:#94a3b8;
      --accent:#22c55e;
      --warn:#f59e0b;
      --radius:18px;
      --pill:999px;
      --sat: env(safe-area-inset-top, 0px);
      --sab: env(safe-area-inset-bottom, 0px);
    }
    *{ box-sizing:border-box; }
    html,body{
      width:100%; height:100%; margin:0; overflow:hidden;
      background:
        radial-gradient(circle at 10% 0%, rgba(34,211,238,.16), transparent 60%),
        radial-gradient(circle at 90% 100%, rgba(167,139,250,.14), transparent 60%),
        var(--bg);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      color:var(--text);
    }
    .wrap{
      position:fixed; inset:0;
      display:flex; align-items:center; justify-content:center;
      padding: calc(16px + var(--sat)) 16px calc(16px + var(--sab));
    }
    .panel{
      width:min(820px, 100%);
      background: linear-gradient(180deg, rgba(2,6,23,.90), rgba(2,6,23,.72));
      border:1px solid var(--stroke);
      border-radius: 22px;
      padding: 18px;
      box-shadow: 0 18px 60px rgba(0,0,0,.35);
    }
    .title{
      font-weight: 1000;
      font-size: 24px;
      letter-spacing: .2px;
      margin-bottom: 6px;
    }
    .sub{
      color: var(--muted);
      line-height: 1.35;
      margin-bottom: 14px;
    }
    .hr{ height:1px; background:var(--stroke); margin:14px 0; }

    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
    }
    @media (max-width:760px){ .grid2{ grid-template-columns:1fr; } }

    .card{
      border:1px solid var(--stroke);
      background: rgba(15,23,42,.45);
      border-radius: 18px;
      padding: 12px;
    }
    .k{
      font-size: 12px;
      color: var(--muted);
      margin-bottom: 8px;
      font-weight: 900;
      letter-spacing: .4px;
      text-transform: uppercase;
    }
    .row{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
    }
    .chip{
      border:1px solid var(--stroke);
      background: rgba(15,23,42,.55);
      color: var(--text);
      border-radius: var(--pill);
      padding: 8px 12px;
      cursor:pointer;
      font-weight: 1000;
      font-size: 13px;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
    }
    .chip-on{
      border-color: rgba(34,197,94,.42);
      background: rgba(34,197,94,.16);
    }
    .input{
      width: 120px;
      padding: 10px 12px;
      border-radius: 12px;
      border:1px solid var(--stroke);
      background: rgba(15,23,42,.55);
      color:var(--text);
      font-weight: 1000;
    }
    .btn{
      appearance:none;
      border:1px solid var(--stroke);
      background: rgba(15,23,42,.65);
      color: var(--text);
      border-radius: 14px;
      padding: 12px 14px;
      font-weight: 1000;
      cursor:pointer;
      transition: transform .08s ease, border-color .12s ease, background .12s ease;
    }
    .btn:hover{ border-color: rgba(148,163,184,.35); }
    .btn:active{ transform: translateY(1px) scale(.99); }
    .btn-strong{
      background: linear-gradient(180deg, rgba(34,197,94,.25), rgba(34,197,94,.10));
      border-color: rgba(34,197,94,.35);
    }
    .btn-warn{
      background: linear-gradient(180deg, rgba(245,158,11,.22), rgba(245,158,11,.08));
      border-color: rgba(245,158,11,.32);
    }
    .note{
      color: var(--muted);
      font-size: 13px;
      line-height: 1.35;
      margin-top: 10px;
    }
    .small{
      font-size:12px;
      color: var(--muted);
      font-weight: 900;
    }
    .pill{
      display:inline-flex;
      gap:8px;
      align-items:center;
      border:1px solid var(--stroke);
      border-radius: var(--pill);
      padding: 8px 12px;
      background: rgba(2,6,23,.55);
      font-weight: 1000;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="panel">
      <div class="title">üç± Food Groups VR ‚Äî Launcher</div>
      <div class="sub">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏•‡πà‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢: <b>PC / Mobile / VR Cardboard (cVR)</b> ‚Äî ‡∏Ñ‡πà‡∏≤‡∏à‡∏∞‡∏à‡∏≥‡πÑ‡∏ß‡πâ‡πÉ‡∏´‡πâ ‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÄ‡∏Ç‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤ Run ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</div>

      <div class="grid2">
        <div class="card">
          <div class="k">Mode</div>
          <div class="row" id="rowView">
            <div class="chip" data-k="view" data-v="pc">üñ•Ô∏è PC</div>
            <div class="chip" data-k="view" data-v="mobile">üì± Mobile</div>
            <div class="chip" data-k="view" data-v="cvr">ü•Ω Cardboard (cVR)</div>
          </div>

          <div class="hr"></div>

          <div class="k">Run Mode</div>
          <div class="row" id="rowRun">
            <div class="chip" data-k="run" data-v="play">üéÆ Play (Adaptive ON)</div>
            <div class="chip" data-k="run" data-v="research">üß™ Research (Deterministic)</div>
          </div>

          <div class="note">
            <span class="pill">üß™ Research</span>
            ‡∏à‡∏∞‡∏•‡πá‡∏≠‡∏Å‡πÉ‡∏´‡πâ deterministic (seeded) ‡πÅ‡∏•‡∏∞‡∏õ‡∏¥‡∏î adaptive/AI ‡∏ï‡∏≤‡∏°‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô
          </div>
        </div>

        <div class="card">
          <div class="k">Difficulty</div>
          <div class="row" id="rowDiff">
            <div class="chip" data-k="diff" data-v="easy">üòÑ Easy</div>
            <div class="chip" data-k="diff" data-v="normal">üòà Normal</div>
            <div class="chip" data-k="diff" data-v="hard">üíÄ Hard</div>
          </div>

          <div class="hr"></div>

          <div class="k">Style (Pattern feel)</div>
          <div class="row" id="rowStyle">
            <div class="chip" data-k="style" data-v="mix">üéõÔ∏è Mix</div>
            <div class="chip" data-k="style" data-v="feel">üåä Feel</div>
            <div class="chip" data-k="style" data-v="hard">üåÄ Hard</div>
          </div>

          <div class="hr"></div>

          <div class="k">Time / Seed</div>
          <div class="row">
            <input id="inTime" class="input" type="number" min="30" max="180" step="5" value="90" />
            <input id="inSeed" class="input" type="text" placeholder="seed (auto)" />
            <button id="btnSeed" class="btn" type="button">üé≤ Random Seed</button>
          </div>

          <div class="note">
            Cardboard ‡∏à‡∏∞‡∏™‡πà‡∏á <b>practice=15s</b> ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°‡∏à‡∏£‡∏¥‡∏á‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (‡∏Å‡∏±‡∏ô‡∏á‡∏á/‡∏Å‡∏±‡∏ô‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô‡∏´‡∏±‡∏ß)
          </div>
        </div>
      </div>

      <div class="hr"></div>

      <div class="row">
        <button id="btnPlay" class="btn btn-strong" type="button">üöÄ ‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏Å‡∏° (Run)</button>
        <button id="btnCopy" class="btn" type="button">üìã Copy Link</button>
        <span class="small" id="hintCarry">‚Äî</span>
      </div>

      <div class="note">
        ‡∏ó‡∏¥‡∏õ: ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ <code>hub=...</code> ‡∏´‡∏£‡∏∑‡∏≠ <code>log=...</code> ‡∏´‡∏£‡∏∑‡∏≠‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ß‡∏¥‡∏à‡∏±‡∏¢‡∏≠‡∏∑‡πà‡∏ô ‡πÜ (study/phase/‡∏Ø‡∏•‡∏Ø) Launcher ‡∏à‡∏∞ ‚Äú‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠‚Äù ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ Run ‡πÉ‡∏´‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
      </div>
    </div>
  </div>

<script>
(function(){
  'use strict';
  const LS = 'HHA_GROUPS_LAUNCH';
  const DOC = document;
  const $ = (id)=>DOC.getElementById(id);

  function qsAll(){
    try{ return new URL(location.href).searchParams; }catch{ return new URLSearchParams(); }
  }
  function clamp(v,a,b){
    v = Number(v); if (!Number.isFinite(v)) v = a;
    return v<a?a:(v>b?b:v);
  }
  function load(){
    try{ return JSON.parse(localStorage.getItem(LS)||'{}')||{}; }catch{ return {}; }
  }
  function save(st){
    try{ localStorage.setItem(LS, JSON.stringify(st||{})); }catch{}
  }

  const state = Object.assign({
    view:'mobile',
    run:'play',
    diff:'normal',
    style:'mix',
    time:90,
    seed:''
  }, load());

  function applyChips(){
    DOC.querySelectorAll('.chip[data-k]').forEach(ch=>{
      const k = ch.dataset.k;
      const v = ch.dataset.v;
      ch.classList.toggle('chip-on', String(state[k])===String(v));
    });
    $('inTime').value = String(state.time||90);
    $('inSeed').value = String(state.seed||'');
  }

  function bindChips(){
    DOC.querySelectorAll('.chip[data-k]').forEach(ch=>{
      ch.addEventListener('click', ()=>{
        const k = ch.dataset.k;
        const v = ch.dataset.v;
        state[k]=v;
        save(state);
        applyChips();
        updateCarryHint();
      }, {passive:true});
    });
  }

  function randSeed(){
    return String(Date.now()) + '-' + Math.floor(Math.random()*1e6);
  }

  function buildRunUrl(){
    const base = new URL('./vr-groups/groups.html', location.href);

    // passthrough all existing params first
    const sp = qsAll();
    sp.forEach((val,key)=>{
      // do not pass view/run/diff/style/time/seed/practice duplicates
      if (['view','run','diff','style','time','seed','practice'].includes(key)) return;
      base.searchParams.set(key, val);
    });

    // set run params
    base.searchParams.set('view', state.view);
    base.searchParams.set('run', state.run);
    base.searchParams.set('diff', state.diff);
    base.searchParams.set('style', state.style);
    base.searchParams.set('time', String(clamp(state.time,30,180)));

    const seed = String(state.seed||'').trim() || randSeed();
    base.searchParams.set('seed', seed);

    // practice for cardboard
    if (state.view === 'cvr'){
      base.searchParams.set('practice', '15');
    }

    return base;
  }

  async function copyText(text){
    try { await navigator.clipboard.writeText(String(text||'')); return true; }
    catch {
      try{
        const ta = DOC.createElement('textarea');
        ta.value = String(text||'');
        DOC.body.appendChild(ta);
        ta.select();
        DOC.execCommand('copy');
        ta.remove();
        return true;
      }catch{ return false; }
    }
  }

  function updateCarryHint(){
    const sp = qsAll();
    const hub = sp.get('hub');
    const log = sp.get('log');
    const keys = [];
    if (hub) keys.push('hub‚úÖ');
    if (log) keys.push('log‚úÖ');
    // ‡πÅ‡∏Ñ‡πà‡πÇ‡∏ä‡∏ß‡πå‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏≠‡∏∑‡πà‡∏ô ‡πÜ ‡∏î‡πâ‡∏ß‡∏¢
    let extra = 0;
    sp.forEach((v,k)=>{
      if (['view','run','diff','style','time','seed','practice'].includes(k)) return;
      if (k==='hub' || k==='log') return;
      extra++;
    });
    $('hintCarry').textContent =
      '‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå: ' + (keys.length?keys.join(' , '):'‚Äî') + (extra?(' + ‡∏≠‡∏∑‡πà‡∏ô‡πÜ '+extra+' ‡∏Ñ‡πà‡∏≤'):'');

    // sync seed if empty
    if (!String(state.seed||'').trim()){
      $('inSeed').placeholder = 'seed (auto: '+randSeed().slice(0,8)+'...)';
    }
  }

  // init
  bindChips();
  applyChips();
  updateCarryHint();

  $('inTime').addEventListener('change', ()=>{
    state.time = clamp($('inTime').value,30,180);
    save(state);
  }, {passive:true});

  $('inSeed').addEventListener('input', ()=>{
    state.seed = String($('inSeed').value||'').trim();
    save(state);
  }, {passive:true});

  $('btnSeed').addEventListener('click', ()=>{
    state.seed = randSeed();
    save(state);
    applyChips();
  });

  $('btnPlay').addEventListener('click', ()=>{
    const u = buildRunUrl();
    location.href = u.toString();
  });

  $('btnCopy').addEventListener('click', async ()=>{
    const u = buildRunUrl();
    const ok = await copyText(u.toString());
    alert(ok ? '‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÅ‡∏•‡πâ‡∏ß ‚úÖ' : 'Copy ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
  });

})();
</script>
</body>
</html>
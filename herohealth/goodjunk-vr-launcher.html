<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>HeroHealth — GoodJunkVR Launcher</title>
  <meta name="color-scheme" content="light dark" />
  <link rel="icon" href="./favicon.ico" />
  <style>
    :root{
      --bg:#020617; --panel:rgba(2,6,23,.78); --stroke:rgba(148,163,184,.18);
      --text:#e5e7eb; --muted:#94a3b8; --accent:#22c55e; --cyan:#22d3ee; --radius:22px;
      --sat: env(safe-area-inset-top,0px); --sab: env(safe-area-inset-bottom,0px);
      --sal: env(safe-area-inset-left,0px); --sar: env(safe-area-inset-right,0px);
    }
    html,body{margin:0;height:100%;background:radial-gradient(circle at 20% 15%, rgba(34,211,238,.14), transparent 55%),
                               radial-gradient(circle at 78% 85%, rgba(34,197,94,.10), transparent 60%),
                               linear-gradient(180deg,#020617,#020617); color:var(--text);
      font-family:system-ui,-apple-system,"Segoe UI","Noto Sans Thai",sans-serif;}
    .wrap{min-height:100%; display:flex; align-items:center; justify-content:center; padding:calc(18px + var(--sat)) calc(16px + var(--sal)) calc(18px + var(--sab)) calc(16px + var(--sar));}
    .card{width:min(760px, 92vw); border-radius:var(--radius); background:var(--panel); border:1px solid var(--stroke);
      padding:18px; box-shadow:0 18px 60px rgba(0,0,0,.45); backdrop-filter: blur(10px);}
    .h{font-weight:1300; font-size:22px;}
    .p{margin-top:6px; color:var(--muted); font-weight:900; font-size:13px; line-height:1.45;}
    .grid{margin-top:14px; display:grid; grid-template-columns: repeat(2, minmax(0,1fr)); gap:10px;}
    .box{border-radius:18px; border:1px solid rgba(148,163,184,.16); background:rgba(2,6,23,.55); padding:12px;}
    .k{color:var(--muted); font-weight:1000; font-size:11px; letter-spacing:.3px;}
    .v{margin-top:6px; font-weight:1200; font-size:14px; word-break:break-word;}
    .row{margin-top:14px; display:flex; gap:10px; flex-wrap:wrap;}
    .btn{flex:1; min-width:220px; height:54px; border-radius:16px; border:1px solid rgba(148,163,184,.20);
      background:rgba(2,6,23,.60); color:var(--text); font-weight:1200; font-size:16px; cursor:pointer;}
    .btn.primary{border-color: rgba(34,197,94,.35); background: rgba(34,197,94,.14);}
    .btn:active{transform:scale(.99);}
    .tiny{margin-top:10px; color:var(--muted); font-weight:900; font-size:12px;}
    code{font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace; font-size:12px; color:#e5e7eb;}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="h">GoodJunkVR</div>
      <div class="p">Launcher (อยู่ root) → จะพาเข้าไฟล์ Run ที่อยู่ใน <code>/herohealth/vr-goodjunk/</code> โดย <b>auto-detect</b> แต่ <b>ไม่ override</b> ถ้ามี <code>?view=</code> มาแล้ว</div>

      <div class="grid">
        <div class="box"><div class="k">RUN</div><div class="v" id="vRun">—</div></div>
        <div class="box"><div class="k">DIFF</div><div class="v" id="vDiff">—</div></div>
        <div class="box"><div class="k">TIME</div><div class="v" id="vTime">—</div></div>
        <div class="box"><div class="k">HUB</div><div class="v" id="vHub">—</div></div>
      </div>

      <div class="row">
        <button class="btn primary" id="btnStart" type="button">▶ เริ่มเล่น</button>
        <button class="btn" id="btnBackHub" type="button">↩ กลับ HUB</button>
      </div>

      <div class="tiny">ทิป: ใส่ <code>&amp;view=pc|mobile|cvr|vr</code> เพื่อบังคับได้ (ถ้าไม่ใส่ = auto detect)</div>
    </div>
  </div>

  <script>
    (function(){
      const qs=(k,d=null)=>{ try{ return new URL(location.href).searchParams.get(k) ?? d; }catch(_){ return d; } };

      function detectViewNoOverride(){
        const explicit = String(qs('view','')).toLowerCase();
        if (explicit) return explicit;

        const isTouch = ('ontouchstart' in window) || (navigator.maxTouchPoints|0) > 0;
        const w = Math.max(1, innerWidth||1);
        const h = Math.max(1, innerHeight||1);
        const landscape = w >= h;

        if (isTouch){
          if (landscape && w >= 740) return 'cvr';
          return 'mobile';
        }
        return 'pc';
      }

      const run  = qs('run','play');
      const diff = qs('diff','normal');
      const time = qs('time','80');
      const hub  = qs('hub', null);

      document.getElementById('vRun').textContent = run;
      document.getElementById('vDiff').textContent = diff;
      document.getElementById('vTime').textContent = time + 's';
      document.getElementById('vHub').textContent = hub ? 'มี' : '—';

      function buildRunUrl(){
        const view = detectViewNoOverride();
        const url = new URL(location.href);
        // เปลี่ยนไปที่ run file ใน folder
        url.pathname = url.pathname.replace(/\/goodjunk-vr-launcher\.html$/, '/vr-goodjunk/goodjunk-vr.html');
        // ถ้าไม่มี view ใน query ให้เติม view ที่ detect ได้
        if (!qs('view', '')) url.searchParams.set('view', view);
        return url.toString();
      }

      document.getElementById('btnStart').addEventListener('click', ()=>{
        location.href = buildRunUrl();
      });

      document.getElementById('btnBackHub').addEventListener('click', ()=>{
        if(hub) location.href = hub;
        else alert('ยังไม่ได้ใส่ hub url');
      });

      // optional autostart
      const autostart = String(qs('autostart','0')) === '1';
      if(autostart) location.href = buildRunUrl();
    })();
  </script>
</body>
</html>
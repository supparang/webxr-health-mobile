<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>HeroHealth ‚Äî GoodJunkVR Launcher</title>
  <meta name="color-scheme" content="dark" />
  <link rel="icon" href="./favicon.ico" type="image/x-icon" />

  <style>
    :root{
      color-scheme: dark;
      --bg:#020617; --panel:rgba(2,6,23,.78); --panel2:rgba(15,23,42,.72);
      --stroke:rgba(148,163,184,.18);
      --text:#e5e7eb; --muted:#94a3b8;
      --accent:#22c55e; --warn:#f59e0b; --cyan:#22d3ee; --violet:#a78bfa;
      --r:22px; --pill:999px;
      --sat: env(safe-area-inset-top, 0px);
      --sab: env(safe-area-inset-bottom, 0px);
    }
    *{box-sizing:border-box}
    html,body{margin:0;height:100%;
      background:
        radial-gradient(circle at 10% 0%, rgba(56,189,248,.14), transparent 55%),
        radial-gradient(circle at 90% 100%, rgba(34,197,94,.12), transparent 55%),
        var(--bg);
      color:var(--text);
      font-family:system-ui,-apple-system,"Segoe UI",sans-serif;
    }
    .wrap{min-height:100%;padding:calc(18px + var(--sat)) 16px calc(18px + var(--sab));
      display:flex;align-items:center;justify-content:center;}
    .card{width:min(860px, 96vw);background:rgba(2,6,23,.72);border:1px solid var(--stroke);border-radius:var(--r);
      box-shadow:0 20px 60px rgba(0,0,0,.45);padding:18px;}
    .top{display:flex;gap:14px;align-items:flex-start;justify-content:space-between;flex-wrap:wrap;}
    .title{font-size:26px;font-weight:1100;letter-spacing:.2px}
    .sub{margin-top:6px;color:var(--muted);font-weight:900}
    .grid{margin-top:14px;display:grid;grid-template-columns:1.1fr .9fr;gap:14px}
    @media (max-width:860px){.grid{grid-template-columns:1fr}}
    .panel{background:rgba(15,23,42,.55);border:1px solid var(--stroke);border-radius:18px;padding:14px}
    .h{font-weight:1100;margin:0 0 10px}
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .pill{border:1px solid var(--stroke);background:rgba(2,6,23,.55);color:var(--text);
      padding:10px 12px;border-radius:var(--pill);font-weight:1000;cursor:pointer}
    .pill[aria-pressed="true"]{border-color:rgba(34,197,94,.45);background:rgba(34,197,94,.12)}
    label{display:block;font-size:12px;color:var(--muted);font-weight:900;margin-top:10px}
    input,select{width:100%;margin-top:6px;background:rgba(2,6,23,.62);border:1px solid var(--stroke);
      border-radius:14px;color:var(--text);padding:12px;font-weight:900;outline:none}
    .actions{margin-top:14px;display:flex;gap:10px;flex-wrap:wrap}
    .btn{flex:1;min-width:220px;height:54px;border-radius:16px;border:1px solid rgba(34,197,94,.38);
      background:rgba(34,197,94,.16);color:#eafff3;font-weight:1100;font-size:16px;cursor:pointer}
    .btn.alt{border-color:rgba(148,163,184,.22);background:rgba(2,6,23,.55);color:var(--text)}
    .hint{margin-top:10px;color:var(--muted);font-size:12px;font-weight:900;line-height:1.35}
    .last{margin-top:12px;padding:12px;border-radius:16px;border:1px dashed rgba(148,163,184,.25);color:var(--muted);font-weight:900}
    a{color:#9ae6b4}
    code{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="top">
        <div>
          <div class="title">ü•¶üçé GoodJunkVR</div>
          <div class="sub">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏´‡∏°‡∏î‡πÄ‡∏•‡πà‡∏ô + ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î Start</div>
        </div>
      </div>

      <div class="grid">
        <div class="panel">
          <h3 class="h">1) ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå (view)</h3>
          <div class="row" id="viewRow">
            <button class="pill" data-view="pc" type="button">üñ•Ô∏è PC</button>
            <button class="pill" data-view="mobile" type="button">üì± Mobile</button>
            <button class="pill" data-view="vr" type="button">üï∂Ô∏è Cardboard VR</button>
            <button class="pill" data-view="cvr" type="button">üéØ cVR (Crosshair)</button>
          </div>

          <h3 class="h" style="margin-top:14px;">2) ‡πÇ‡∏´‡∏°‡∏î (run)</h3>
          <div class="row" id="runRow">
            <button class="pill" data-run="play" type="button">üéÆ Play</button>
            <button class="pill" data-run="research" type="button">üß™ Research</button>
          </div>

          <div class="actions">
            <button class="btn" id="btnStart" type="button">START ‚ñ∂</button>
            <button class="btn alt" id="btnHub" type="button">‡∏Å‡∏•‡∏±‡∏ö HUB</button>
          </div>

          <div class="hint">
            ‚Ä¢ Cardboard/cVR: ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÇ‡∏´‡∏°‡∏î‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô + Fullscreen<br/>
            ‚Ä¢ Research: ‡πÉ‡∏ä‡πâ seed ‡∏Ñ‡∏á‡∏ó‡∏µ‡πà + ‡πÑ‡∏°‡πà‡∏°‡∏µ practice (‡∏ï‡∏≤‡∏°‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô)
          </div>

          <div class="last" id="lastBox" style="display:none;"></div>
        </div>

        <div class="panel">
          <h3 class="h">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</h3>

          <label>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏Å (diff)</label>
          <select id="diff">
            <option value="easy">easy</option>
            <option value="normal" selected>normal</option>
            <option value="hard">hard</option>
          </select>

          <label>‡πÄ‡∏ß‡∏•‡∏≤ (‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ)</label>
          <input id="time" type="number" min="20" step="5" value="80"/>

          <label>seed (‡πÄ‡∏ß‡πâ‡∏ô‡∏ß‡πà‡∏≤‡∏á = auto / Research ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏™‡πà)</label>
          <input id="seed" type="number" placeholder="‡πÄ‡∏ä‡πà‡∏ô 12345"/>

          <label>hub url (‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏Æ‡∏±‡∏ö)</label>
          <input id="hub" type="text" placeholder="‡πÄ‡∏ä‡πà‡∏ô https://.../herohealth/hub.html"/>

          <label>studyId / phase / conditionGroup (optional)</label>
          <input id="studyId" type="text" placeholder="studyId"/>
          <input id="phase" type="text" placeholder="phase"/>
          <input id="cond" type="text" placeholder="conditionGroup"/>

          <div class="hint" style="margin-top:12px;">
            * Run (‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡πà‡∏ô‡∏à‡∏£‡∏¥‡∏á): <code>/herohealth/vr-goodjunk/goodjunk-vr.html</code>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
(function(){
  const LS = {
    view:'HHA_GJ_VIEW',
    run:'HHA_GJ_RUN',
    diff:'HHA_GJ_DIFF',
    time:'HHA_GJ_TIME',
    seed:'HHA_GJ_SEED',
    hub:'HHA_GJ_HUB',
    study:'HHA_GJ_STUDY',
    phase:'HHA_GJ_PHASE',
    cond:'HHA_GJ_COND',
  };

  const el = (id)=>document.getElementById(id);
  const viewRow = el('viewRow');
  const runRow  = el('runRow');

  function setPressed(row, key, val){
    [...row.querySelectorAll('.pill')].forEach(b=>{
      b.setAttribute('aria-pressed', b.dataset[key] === val ? 'true' : 'false');
    });
  }
  function getPressed(row, key){
    const b = row.querySelector('.pill[aria-pressed="true"]');
    return b ? b.dataset[key] : null;
  }

  function pickDefault(){
    const view = localStorage.getItem(LS.view) || 'mobile';
    const run  = localStorage.getItem(LS.run)  || 'play';
    setPressed(viewRow,'view',view);
    setPressed(runRow,'run',run);

    el('diff').value  = localStorage.getItem(LS.diff) || 'normal';
    el('time').value  = localStorage.getItem(LS.time) || '80';
    el('seed').value  = localStorage.getItem(LS.seed) || '';
    el('hub').value   = localStorage.getItem(LS.hub)  || '';
    el('studyId').value = localStorage.getItem(LS.study) || '';
    el('phase').value   = localStorage.getItem(LS.phase) || '';
    el('cond').value    = localStorage.getItem(LS.cond) || '';
  }

  viewRow.addEventListener('click', (e)=>{
    const b = e.target.closest('.pill'); if(!b) return;
    const v = b.dataset.view;
    localStorage.setItem(LS.view, v);
    setPressed(viewRow,'view',v);
  });
  runRow.addEventListener('click', (e)=>{
    const b = e.target.closest('.pill'); if(!b) return;
    const r = b.dataset.run;
    localStorage.setItem(LS.run, r);
    setPressed(runRow,'run',r);
  });

  function saveFields(){
    localStorage.setItem(LS.diff, el('diff').value);
    localStorage.setItem(LS.time, el('time').value);
    localStorage.setItem(LS.seed, el('seed').value);
    localStorage.setItem(LS.hub,  el('hub').value);
    localStorage.setItem(LS.study, el('studyId').value);
    localStorage.setItem(LS.phase, el('phase').value);
    localStorage.setItem(LS.cond, el('cond').value);
  }

  function start(){
    saveFields();
    const view = getPressed(viewRow,'view') || 'mobile';
    const run  = getPressed(runRow,'run')  || 'play';
    const diff = el('diff').value || 'normal';
    const time = el('time').value || '80';
    const seed = el('seed').value.trim();
    const hub  = el('hub').value.trim();
    const study= el('studyId').value.trim();
    const phase= el('phase').value.trim();
    const cond = el('cond').value.trim();

    const url = new URL('./vr-goodjunk/goodjunk-vr.html', location.href);
    url.searchParams.set('view', view);
    url.searchParams.set('run', run);
    url.searchParams.set('diff', diff);
    url.searchParams.set('time', time);
    if(seed) url.searchParams.set('seed', seed);
    if(hub)  url.searchParams.set('hub', hub);
    if(study)url.searchParams.set('studyId', study);
    if(phase)url.searchParams.set('phase', phase);
    if(cond) url.searchParams.set('conditionGroup', cond);
    location.href = url.toString();
  }

  el('btnStart').addEventListener('click', start);

  el('btnHub').addEventListener('click', ()=>{
    saveFields();
    const hub = el('hub').value.trim();
    if(hub) location.href = hub;
    else alert('‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÉ‡∏™‡πà hub url');
  });

  // last summary peek
  try{
    const last = localStorage.getItem('HHA_LAST_SUMMARY');
    if(last){
      const j = JSON.parse(last);
      if(j && j.projectTag === 'GoodJunkVR'){
        const box = el('lastBox');
        box.style.display = 'block';
        box.innerHTML = `‡∏ú‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: <b>${j.grade || '-'}</b> | score ${j.scoreFinal || 0} | miss ${j.misses || 0} | ${j.reason || ''}`;
      }
    }
  }catch(_){}

  pickDefault();
})();
</script>
</body>
</html>
<!-- === /herohealth/goodjunk-vr.html ===
GoodJunkVR LAUNCHER — ROOT (Production)
✅ Choose difficulty + time (70/80/90) before entering run
✅ Does NOT force view (keeps your auto-detect in boot.js unless ?view already exists)
✅ Pass-through common ctx params: hub, run, seed, log, studyId, phase, conditionGroup, style, pid, sid, etc.
✅ One-tap Start
-->
<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>HeroHealth — GoodJunkVR</title>
  <meta name="color-scheme" content="dark" />
  <link rel="icon" href="./favicon.ico" />
  <style>
    :root{
      color-scheme: dark;
      --bg:#020617;
      --panel:rgba(2,6,23,.72);
      --stroke:rgba(148,163,184,.18);
      --text:#e5e7eb;
      --muted:#94a3b8;
      --accent:#22c55e;
      --warn:#f59e0b;
      --violet:#a78bfa;

      --radius:22px;
      --pill:999px;

      --sat: env(safe-area-inset-top, 0px);
      --sab: env(safe-area-inset-bottom, 0px);
      --sal: env(safe-area-inset-left, 0px);
      --sar: env(safe-area-inset-right, 0px);
    }
    *{ box-sizing:border-box; }
    html,body{ width:100%; height:100%; margin:0; background:var(--bg); color:var(--text); overflow:hidden; }
    body{
      font-family: system-ui,-apple-system,"Segoe UI","Noto Sans Thai",sans-serif;
      background:
        radial-gradient(circle at top left, rgba(34,197,94,.16), transparent 60%),
        radial-gradient(circle at bottom right, rgba(167,139,250,.10), transparent 60%),
        var(--bg);
    }
    .wrap{
      min-height:100%;
      padding: calc(16px + var(--sat)) calc(14px + var(--sar)) calc(16px + var(--sab)) calc(14px + var(--sal));
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .card{
      width:min(720px, 96vw);
      border-radius: 28px;
      border:1px solid var(--stroke);
      background: rgba(2,6,23,.68);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      box-shadow: 0 24px 80px rgba(0,0,0,.55);
      padding: 14px;
    }
    .head{
      display:flex; align-items:center; justify-content:space-between; gap:12px;
      padding: 8px 8px 2px 8px;
    }
    .title{
      font-weight:1300;
      font-size:18px;
      letter-spacing:.2px;
    }
    .meta{
      font-size:12px;
      color: rgba(148,163,184,.92);
      font-weight:900;
      text-align:right;
      line-height:1.2;
    }
    .grid{
      margin-top:10px;
      display:grid;
      grid-template-columns: 1fr;
      gap:10px;
      padding: 8px;
    }
    .row{
      border-radius: 22px;
      border:1px solid rgba(148,163,184,.16);
      background: rgba(15,23,42,.45);
      padding: 12px;
    }
    .row h3{
      margin:0 0 10px 0;
      font-size:13px;
      font-weight:1200;
      letter-spacing:.2px;
      color: rgba(229,231,235,.92);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .hint{
      font-size:11px;
      color: rgba(148,163,184,.92);
      font-weight:900;
    }
    .btns{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
    }
    .btn{
      height:44px;
      padding:0 14px;
      border-radius: 16px;
      border:1px solid rgba(148,163,184,.18);
      background: rgba(2,6,23,.55);
      color:var(--text);
      font-weight:1200;
      cursor:pointer;
      user-select:none;
      -webkit-user-select:none;
    }
    .btn:active{ transform: translateY(1px); }
    .btn.on{
      border-color: rgba(34,197,94,.40);
      background: rgba(34,197,94,.16);
      color:#eafff3;
    }
    .btn.time.on{
      border-color: rgba(34,211,238,.40);
      background: rgba(34,211,238,.10);
    }
    .btn.diff.easy.on{ border-color: rgba(34,197,94,.55); background: rgba(34,197,94,.18); }
    .btn.diff.normal.on{ border-color: rgba(245,158,11,.55); background: rgba(245,158,11,.14); }
    .btn.diff.hard.on{ border-color: rgba(239,68,68,.50); background: rgba(239,68,68,.12); }

    .actions{
      margin-top: 10px;
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      justify-content:flex-end;
      padding: 0 8px 6px 8px;
    }
    .primary{
      height:48px;
      padding:0 16px;
      border-radius: 18px;
      border:1px solid rgba(34,197,94,.50);
      background: rgba(34,197,94,.18);
      color:#eafff3;
      font-weight:1300;
    }
    .ghost{
      height:48px;
      padding:0 16px;
      border-radius: 18px;
      border:1px solid rgba(148,163,184,.18);
      background: rgba(2,6,23,.40);
      color: rgba(229,231,235,.92);
      font-weight:1100;
    }
    .footer{
      padding: 0 8px 6px 8px;
      font-size:11px;
      color: rgba(148,163,184,.92);
      font-weight:900;
      line-height:1.35;
    }
    code{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      font-size: 11px;
      color: rgba(229,231,235,.92);
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="card">
      <div class="head">
        <div>
          <div class="title">GoodJunkVR</div>
          <div class="hint">เลือก “ระดับ” + “เวลา” แล้วกดเริ่มเล่น</div>
        </div>
        <div class="meta" id="metaBox">—</div>
      </div>

      <div class="grid">
        <div class="row">
          <h3>
            <span>ระดับความยาก (diff)</span>
            <span class="hint">Easy ผ่านง่าย / Normal มาตรฐาน / Hard ท้าทาย</span>
          </h3>
          <div class="btns" id="diffBtns">
            <button class="btn diff easy"   data-diff="easy"   type="button">Easy</button>
            <button class="btn diff normal" data-diff="normal" type="button">Normal</button>
            <button class="btn diff hard"   data-diff="hard"   type="button">Hard</button>
          </div>
        </div>

        <div class="row">
          <h3>
            <span>เวลาเล่นต่อรอบ (time)</span>
            <span class="hint">แนะนำ: 70/80/90 วินาที</span>
          </h3>
          <div class="btns" id="timeBtns">
            <button class="btn time" data-time="70" type="button">70s</button>
            <button class="btn time" data-time="80" type="button">80s</button>
            <button class="btn time" data-time="90" type="button">90s</button>
          </div>
        </div>
      </div>

      <div class="actions">
        <button class="btn ghost" id="btnRandomSeed" type="button">สุ่มด่านใหม่ (seed)</button>
        <button class="btn primary" id="btnStart" type="button">เริ่มเล่น ▶</button>
      </div>

      <div class="footer">
        <div>ตัวเกมอ่านค่าจาก URL เช่น <code>?diff=normal&time=80</code></div>
        <div>หมายเหตุ: ไม่บังคับ <code>view</code> — ให้ระบบ auto detect ใน boot ทำงานเอง (ถ้ามี <code>?view=...</code> อยู่แล้วจะส่งต่อไป)</div>
      </div>
    </div>
  </div>

  <script>
    (function(){
      const qs = (k, d=null)=>{ try{ return new URL(location.href).searchParams.get(k) ?? d; }catch(_){ return d; } };
      const setOn = (groupEl, selector, matchFn)=>{
        const btns = Array.from(groupEl.querySelectorAll(selector));
        btns.forEach(b=>b.classList.toggle('on', !!matchFn(b)));
      };

      // ---- state (defaults) ----
      let diff = String(qs('diff','normal')).toLowerCase();
      if(!['easy','normal','hard'].includes(diff)) diff = 'normal';

      let time = Number(qs('time','80')) || 80;
      if(![70,80,90].includes(time)) time = 80;

      let seed = String(qs('seed', Date.now()));

      const metaBox = document.getElementById('metaBox');
      const diffBtns = document.getElementById('diffBtns');
      const timeBtns = document.getElementById('timeBtns');

      function render(){
        setOn(diffBtns, 'button', (b)=> b.dataset.diff === diff);
        setOn(timeBtns, 'button', (b)=> Number(b.dataset.time) === time);

        const run = String(qs('run','play')).toLowerCase();
        const view = (qs('view','auto')||'auto').toLowerCase();
        metaBox.innerHTML =
          `run=${run}<br>`+
          `diff=${diff} · time=${time}<br>`+
          `seed=${seed}<br>`+
          `view=${view}`;
      }

      diffBtns.addEventListener('click', (e)=>{
        const b = e.target.closest('button[data-diff]');
        if(!b) return;
        diff = b.dataset.diff;
        render();
      });

      timeBtns.addEventListener('click', (e)=>{
        const b = e.target.closest('button[data-time]');
        if(!b) return;
        time = Number(b.dataset.time);
        render();
      });

      document.getElementById('btnRandomSeed').addEventListener('click', ()=>{
        seed = String(Date.now());
        render();
      });

      document.getElementById('btnStart').addEventListener('click', ()=>{
        // Target run page (folder-run)
        const target = new URL('./vr-goodjunk/goodjunk-vr.html', location.href);

        // Pass-through ALL current params, then override diff/time/seed
        // (Keeps hub, run, studyId, phase, conditionGroup, log, view, etc.)
        try{
          const cur = new URL(location.href);
          cur.searchParams.forEach((v,k)=> target.searchParams.set(k,v));
        }catch(_){}

        target.searchParams.set('diff', diff);
        target.searchParams.set('time', String(time));
        target.searchParams.set('seed', seed);

        location.href = target.toString();
      });

      render();
    })();
  </script>
</body>
</html>
<!-- === /herohealth/goodjunk-vr.html ===
GoodJunkVR LAUNCHER — ROOT (STRICT AUTO)
✅ Root Launcher = /herohealth/goodjunk-vr.html
✅ Folder Run     = /herohealth/vr-goodjunk/goodjunk-vr.html
✅ NO MENU, NO OVERRIDE: ignores ?view= entirely (removes it before redirect)
✅ Auto-detect base: pc / mobile (UA) -> (used only for status text + default time)
✅ Pass-through all query params except view (keeps: hub, run, diff, time, seed, studyId, phase, conditionGroup, log, lockPx, etc.)
-->

<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>HeroHealth — GoodJunkVR</title>
  <meta name="color-scheme" content="dark" />
  <link rel="icon" href="./favicon.ico" />
  <style>
    :root{
      --bg:#020617; --text:#e5e7eb; --muted:#94a3b8; --accent:#22c55e;
      --panel:rgba(2,6,23,.72); --stroke:rgba(148,163,184,.16);
      --radius:22px; --sat: env(safe-area-inset-top, 0px); --sab: env(safe-area-inset-bottom, 0px);
    }
    *{ box-sizing:border-box; }
    html,body{ height:100%; margin:0; }
    body{
      background:
        radial-gradient(1000px 700px at 50% 15%, rgba(34,197,94,.12), transparent 60%),
        radial-gradient(900px 600px at 20% 90%, rgba(56,189,248,.10), transparent 62%),
        radial-gradient(900px 600px at 85% 85%, rgba(168,85,247,.10), transparent 62%),
        var(--bg);
      color: var(--text);
      font-family: system-ui, -apple-system, "Segoe UI", "Noto Sans Thai", sans-serif;
      display:flex; align-items:center; justify-content:center;
      padding: calc(14px + var(--sat)) 14px calc(14px + var(--sab));
    }
    .card{
      width:min(560px, 100%);
      border-radius: var(--radius);
      background: var(--panel);
      border:1px solid var(--stroke);
      padding: 18px;
      backdrop-filter: blur(10px);
      box-shadow: 0 18px 50px rgba(0,0,0,.38);
    }
    .title{ font-size: 18px; font-weight: 1100; letter-spacing: .2px; }
    .sub{ margin-top:8px; color: var(--muted); font-weight: 900; font-size: 13px; line-height: 1.5; }
    .pill{
      display:inline-flex; align-items:center; gap:8px;
      margin-top: 12px; padding: 10px 12px; border-radius: 999px;
      border:1px solid rgba(34,197,94,.28);
      background: rgba(34,197,94,.12);
      font-weight: 1000; font-size: 13px;
    }
    .dot{
      width:9px; height:9px; border-radius:999px;
      background: var(--accent);
      box-shadow: 0 0 0 6px rgba(34,197,94,.15);
    }
    .mini{ margin-top:10px; font-size: 12px; color: rgba(229,231,235,.78); font-weight: 850; }
    .err{
      margin-top:12px; padding: 10px 12px; border-radius: 14px;
      border:1px solid rgba(239,68,68,.25);
      background: rgba(239,68,68,.10);
      color: rgba(254,226,226,.95);
      font-weight: 900;
      display:none;
      white-space: pre-wrap;
    }
  </style>
</head>
<body>
  <div class="card" role="status" aria-live="polite">
    <div class="title">กำลังเปิด GoodJunkVR…</div>
    <div class="sub">
      ระบบจะตรวจอุปกรณ์อัตโนมัติ และเข้าเกมทันที<br/>
      (Root Launcher → Folder Run)
    </div>
    <div class="pill"><span class="dot"></span><span id="gjStatus">กำลังเตรียมลิงก์…</span></div>
    <div class="mini" id="gjMini">ถ้าไม่เด้งอัตโนมัติ ให้รีเฟรช 1 ครั้ง</div>
    <div class="err" id="gjErr"></div>
  </div>

<script>
(function(){
  'use strict';
  const DOC = document;

  function isMobileUA(){
    const ua = String(navigator.userAgent || '').toLowerCase();
    return /android|iphone|ipad|ipod/.test(ua);
  }
  function setText(id, text){
    const el = DOC.getElementById(id);
    if(el) el.textContent = text;
  }
  function showErr(msg){
    const el = DOC.getElementById('gjErr');
    if(!el) return;
    el.style.display = 'block';
    el.textContent = String(msg || 'Unknown error');
  }

  function buildRunUrl(){
    const here = new URL(location.href);

    // ✅ Folder run target
    const runUrl = new URL('./vr-goodjunk/goodjunk-vr.html', here);

    // ✅ Pass-through ALL params except "view" (STRICT AUTO)
    const q = new URLSearchParams(here.search);
    q.delete('view');

    // optional helpful defaults (only if missing)
    if(!q.get('hub')){
      q.set('hub', new URL('./hub.html', here).href);
    }
    if(!q.get('run'))  q.set('run', 'play');
    if(!q.get('diff')) q.set('diff', 'normal');
    if(!q.get('time')) q.set('time', isMobileUA() ? '70' : '80');

    runUrl.search = q.toString();
    return runUrl;
  }

  function go(){
    try{
      const base = isMobileUA() ? 'mobile' : 'pc';
      setText('gjStatus', `ตรวจพบโหมด: ${base} → เข้าเกม (folder run)…`);

      const target = buildRunUrl();
      location.replace(target.href);
    }catch(err){
      setText('gjStatus', 'เกิดข้อผิดพลาด');
      showErr(err && err.stack ? err.stack : String(err));
    }
  }

  if(DOC.readyState === 'loading'){
    DOC.addEventListener('DOMContentLoaded', ()=>setTimeout(go, 30));
  }else{
    setTimeout(go, 30);
  }
})();
</script>
</body>
</html>
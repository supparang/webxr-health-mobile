<!-- === /herohealth/groups-vr.html ===
HeroHealth ‚Äî Food Groups VR (Launcher)
‚úÖ Choose entry: PC / Mobile / Cardboard (cVR)
‚úÖ Remember last settings (localStorage)
‚úÖ Build run URL -> /herohealth/vr-groups/groups.html with params
‚úÖ Pass hub=... back link (optional)
-->

<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>HeroHealth ‚Äî GroupsVR Launcher</title>
  <meta name="color-scheme" content="light dark" />
  <link rel="icon" href="./favicon.ico" type="image/x-icon" />

  <style>
    :root{
      color-scheme: light dark;
      --bg:#020617;
      --panel:rgba(2,6,23,.78);
      --panel2:rgba(15,23,42,.70);
      --stroke:rgba(148,163,184,.18);
      --text:#e5e7eb;
      --muted:#94a3b8;
      --accent:#22c55e;
      --accent2:#22d3ee;
      --warn:#f59e0b;
      --bad:#ef4444;

      --radius:22px;
      --pill:999px;

      --sat: env(safe-area-inset-top, 0px);
      --sab: env(safe-area-inset-bottom, 0px);
      --sal: env(safe-area-inset-left, 0px);
      --sar: env(safe-area-inset-right, 0px);
    }

    *{ box-sizing:border-box; }
    html,body{
      width:100%;
      height:100%;
      margin:0;
      background:
        radial-gradient(circle at 12% 0%, rgba(34,211,238,.14), transparent 60%),
        radial-gradient(circle at 92% 100%, rgba(34,197,94,.12), transparent 58%),
        var(--bg);
      color:var(--text);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      overflow:hidden;
    }

    .wrap{
      position:fixed;
      inset:0;
      padding:
        calc(14px + var(--sat))
        calc(14px + var(--sar))
        calc(14px + var(--sab))
        calc(14px + var(--sal));
      overflow:auto;
    }

    .card{
      width:min(920px, 100%);
      margin:0 auto;
      border:1px solid var(--stroke);
      background: linear-gradient(180deg, rgba(2,6,23,.92), rgba(2,6,23,.72));
      border-radius: var(--radius);
      padding:16px;
      box-shadow: 0 18px 70px rgba(0,0,0,.38);
    }

    .top{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
    }

    .brand{
      display:flex;
      gap:12px;
      align-items:center;
    }
    .logo{
      width:54px; height:54px;
      border-radius:16px;
      background: rgba(34,197,94,.14);
      border:1px solid rgba(34,197,94,.28);
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:28px;
      box-shadow: 0 14px 40px rgba(0,0,0,.25);
    }
    .title{
      font-weight:1000;
      font-size:22px;
      letter-spacing:.2px;
      margin:0 0 4px 0;
    }
    .sub{
      color:var(--muted);
      font-weight:800;
      line-height:1.35;
      margin:0;
      font-size:13px;
    }

    .hr{
      height:1px;
      background: var(--stroke);
      margin:14px 0;
    }

    .grid{
      display:grid;
      grid-template-columns: 1.1fr .9fr;
      gap:14px;
    }
    @media (max-width:860px){
      .grid{ grid-template-columns:1fr; }
    }

    .pane{
      border:1px solid var(--stroke);
      border-radius: 18px;
      padding:12px;
      background: rgba(15,23,42,.35);
    }

    .h{
      font-weight:1000;
      letter-spacing:.25px;
      margin:0 0 10px 0;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
    }
    .hint{
      color:var(--muted);
      font-weight:800;
      font-size:12px;
      line-height:1.35;
    }

    .row{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      margin:10px 0;
    }

    .chip{
      border:1px solid var(--stroke);
      background: rgba(2,6,23,.55);
      color:var(--text);
      border-radius: var(--pill);
      padding:10px 12px;
      cursor:pointer;
      font-weight:1000;
      font-size:13px;
      transition: transform .08s ease, border-color .12s ease, background .12s ease;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
    }
    .chip:active{ transform: translateY(1px) scale(.99); }
    .chip-on{
      border-color: rgba(34,197,94,.45);
      background: rgba(34,197,94,.16);
    }
    .chip-warn.chip-on{
      border-color: rgba(245,158,11,.55);
      background: rgba(245,158,11,.16);
    }

    .input{
      width: 120px;
      padding:10px 12px;
      border-radius: 14px;
      border:1px solid var(--stroke);
      background: rgba(2,6,23,.55);
      color:var(--text);
      font-weight:1000;
      outline:none;
    }

    .btn{
      appearance:none;
      border:1px solid var(--stroke);
      background: rgba(2,6,23,.55);
      color:var(--text);
      border-radius: 16px;
      padding:12px 14px;
      font-weight:1000;
      cursor:pointer;
      transition: transform .08s ease, border-color .12s ease, background .12s ease;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
      display:inline-flex;
      align-items:center;
      gap:10px;
    }
    .btn:hover{ border-color: rgba(148,163,184,.35); }
    .btn:active{ transform: translateY(1px) scale(.99); }

    .btn-strong{
      background: linear-gradient(180deg, rgba(34,197,94,.25), rgba(34,197,94,.10));
      border-color: rgba(34,197,94,.35);
    }
    .btn-cvr{
      background: linear-gradient(180deg, rgba(34,211,238,.22), rgba(34,211,238,.10));
      border-color: rgba(34,211,238,.35);
    }
    .btn-ghost{
      background: rgba(15,23,42,.25);
    }
    .btn-bad{
      background: rgba(239,68,68,.12);
      border-color: rgba(239,68,68,.35);
    }

    .mono{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      font-size: 12px;
      color: var(--muted);
      word-break: break-all;
      line-height:1.35;
      background: rgba(2,6,23,.45);
      border:1px solid var(--stroke);
      border-radius: 14px;
      padding:10px;
    }

    .footer{
      margin-top:12px;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
    }

    .mini{
      font-size:12px;
      color:var(--muted);
      font-weight:800;
      line-height:1.35;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="card">

      <div class="top">
        <div class="brand">
          <div class="logo">ü•¶</div>
          <div>
            <h1 class="title">Food Groups VR ‚Äî Launcher</h1>
            <p class="sub">
              ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏•‡πà‡∏ô: <b>PC</b> / <b>Mobile</b> / <b>Cardboard (cVR)</b> ‚Ä¢
              ‡πÇ‡∏´‡∏°‡∏î‡∏ß‡∏¥‡∏à‡∏±‡∏¢‡∏à‡∏∞ <b>‡∏õ‡∏¥‡∏î adaptive</b> ‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ <b>seed ‡∏Ñ‡∏á‡∏ó‡∏µ‡πà</b>
            </p>
          </div>
        </div>

        <div class="row">
          <button id="btnHub" class="btn btn-ghost" type="button">üè† ‡∏Å‡∏•‡∏±‡∏ö HUB</button>
          <button id="btnReset" class="btn btn-bad" type="button">üßπ ‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÑ‡∏ß‡πâ</button>
        </div>
      </div>

      <div class="hr"></div>

      <div class="grid">

        <!-- LEFT: Entry buttons -->
        <div class="pane">
          <div class="h">
            <div>üö™ ‡∏ó‡∏≤‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏•‡πà‡∏ô</div>
            <div class="hint">‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: Cardboard ‡πÉ‡∏ä‡πâ Chrome Android ‚Ä¢ ‡∏ï‡∏≠‡∏ô‡πÄ‡∏•‡πà‡∏ô ‚Äú‡πÅ‡∏ï‡∏∞‡∏à‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏¥‡∏á‚Äù ‡∏à‡∏≤‡∏Å crosshair</div>
          </div>

          <div class="row">
            <button id="goPC" class="btn btn-strong" type="button">üñ•Ô∏è ‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏•‡πà‡∏ô‡∏ö‡∏ô PC</button>
            <button id="goMobile" class="btn btn-strong" type="button">üì± ‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏•‡πà‡∏ô‡∏ö‡∏ô Mobile</button>
            <button id="goCardboard" class="btn btn-cvr" type="button">üï∂Ô∏è ‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏•‡πà‡∏ô‡∏ö‡∏ô Cardboard (cVR)</button>
          </div>

          <div class="row">
            <button id="goNewTab" class="btn" type="button">üß∑ ‡πÄ‡∏õ‡∏¥‡∏î Run ‡πÉ‡∏ô‡πÅ‡∏ó‡πá‡∏ö‡πÉ‡∏´‡∏°‡πà</button>
            <button id="btnCopyLink" class="btn btn-ghost" type="button">üìã ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå Run</button>
          </div>

          <div class="row">
            <div class="hint">Run URL:</div>
          </div>
          <div id="preview" class="mono">‚Äî</div>
        </div>

        <!-- RIGHT: Settings -->
        <div class="pane">
          <div class="h">
            <div>‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</div>
            <div class="hint">‡∏Ñ‡πà‡∏≤‡∏à‡∏∞‡∏ñ‡∏π‡∏Å ‚Äú‡∏à‡∏≥‡πÑ‡∏ß‡πâ‚Äù ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</div>
          </div>

          <!-- mode -->
          <div class="row">
            <div class="hint" style="min-width:92px;">Run mode</div>
            <div id="runPlay" class="chip chip-on">üéÆ play</div>
            <div id="runResearch" class="chip chip-warn">üß™ research</div>
          </div>

          <!-- diff -->
          <div class="row">
            <div class="hint" style="min-width:92px;">Difficulty</div>
            <div id="diffEasy" class="chip">üôÇ easy</div>
            <div id="diffNormal" class="chip chip-on">üòà normal</div>
            <div id="diffHard" class="chip">üî• hard</div>
          </div>

          <!-- style -->
          <div class="row">
            <div class="hint" style="min-width:92px;">Style</div>
            <div id="styleMix" class="chip chip-on">üå™Ô∏è mix</div>
            <div id="styleFocus" class="chip">üéØ focus</div>
            <div id="styleChaos" class="chip">üåÄ chaos</div>
          </div>

          <!-- time -->
          <div class="row">
            <div class="hint" style="min-width:92px;">Time (sec)</div>
            <input id="time" class="input" type="number" min="30" max="180" step="5" value="90" />
            <div class="hint">30‚Äì180</div>
          </div>

          <!-- seed -->
          <div class="row">
            <div class="hint" style="min-width:92px;">Seed</div>
            <input id="seed" class="input" type="text" value="" placeholder="auto" />
          </div>

          <div class="row">
            <button id="btnSeedNow" class="btn" type="button">üé≤ ‡∏ï‡∏±‡πâ‡∏á seed = timestamp</button>
            <button id="btnSeedFixed" class="btn btn-ghost" type="button">üìå seed ‡∏Ñ‡∏á‡∏ó‡∏µ‡πà (research)</button>
          </div>

          <div class="hr"></div>

          <div class="mini">
            ‚Ä¢ Cardboard ‡∏à‡∏∞‡πÉ‡∏ä‡πâ <b>view=cvr</b> ‡πÅ‡∏•‡∏∞‡∏¢‡∏¥‡∏á‡∏ú‡πà‡∏≤‡∏ô crosshair (event <b>hha:shoot</b>)<br/>
            ‚Ä¢ ‡∏ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏™‡πà‡∏á <b>hub=...</b> ‡∏°‡∏≤ Launcher ‡∏à‡∏∞‡πÄ‡∏Å‡πá‡∏ö‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠‡πÉ‡∏´‡πâ Run ‡πÄ‡∏û‡∏∑‡πà‡∏≠ ‚Äú‡∏Å‡∏•‡∏±‡∏ö HUB‚Äù ‡πÑ‡∏î‡πâ
          </div>
        </div>

      </div>

      <div class="footer">
        <div class="mini" id="status">‡∏û‡∏£‡πâ‡∏≠‡∏° ‚úÖ</div>
        <div class="mini">HeroHealth ‚Ä¢ GroupsVR</div>
      </div>

    </div>
  </div>

<script>
(function(){
  'use strict';

  const DOC = document;
  const $ = (id)=>DOC.getElementById(id);

  const LS_KEY = 'HHA_GROUPS_LAUNCH_CFG';

  function qs(k, def=null){
    try { return new URL(location.href).searchParams.get(k) ?? def; }
    catch { return def; }
  }
  function clamp(v,a,b){ v = Number(v)||0; return v<a?a:(v>b?b:v); }

  const defaultCfg = {
    run: 'play',       // play|research
    diff: 'normal',    // easy|normal|hard
    style:'mix',       // mix|focus|chaos
    time: 90,
    seed: '',
    hub: ''            // optional
  };

  function loadCfg(){
    let cfg = Object.assign({}, defaultCfg);
    try{
      const saved = JSON.parse(localStorage.getItem(LS_KEY)||'null');
      if (saved && typeof saved==='object') cfg = Object.assign(cfg, saved);
    }catch{}
    // query overrides (if provided)
    const qRun = String(qs('run','')||'').toLowerCase();
    const qDiff= String(qs('diff','')||'').toLowerCase();
    const qStyle=String(qs('style','')||'').toLowerCase();
    const qTime= qs('time', null);
    const qSeed= qs('seed', null);
    const qHub = qs('hub', null);

    if (qRun==='play' || qRun==='research') cfg.run = qRun;
    if (qDiff==='easy' || qDiff==='normal' || qDiff==='hard') cfg.diff = qDiff;
    if (qStyle==='mix' || qStyle==='focus' || qStyle==='chaos') cfg.style = qStyle;
    if (qTime!=null) cfg.time = clamp(qTime, 30, 180);
    if (qSeed!=null) cfg.seed = String(qSeed||'');
    if (qHub!=null) cfg.hub = String(qHub||'');

    return cfg;
  }

  function saveCfg(cfg){
    try{ localStorage.setItem(LS_KEY, JSON.stringify(cfg)); }catch{}
  }

  function chipSet(onId, ids){
    ids.forEach(id=>{
      const el = $(id);
      if (!el) return;
      el.classList.toggle('chip-on', id===onId);
    });
  }

  function setStatus(t){
    $('status').textContent = t || '‡∏û‡∏£‡πâ‡∏≠‡∏° ‚úÖ';
  }

  function buildRunUrl(view){
    // launcher at /herohealth/groups-vr.html
    // run at /herohealth/vr-groups/groups.html
    const cfg = state.cfg;

    const u = new URL('./vr-groups/groups.html', location.href);
    u.searchParams.set('view', view); // pc|mobile|cvr
    u.searchParams.set('run', cfg.run);
    u.searchParams.set('diff', cfg.diff);
    u.searchParams.set('style', cfg.style);
    u.searchParams.set('time', String(clamp(cfg.time,30,180)));

    const seed = String(cfg.seed||'').trim();
    if (seed) u.searchParams.set('seed', seed);

    const hub = String(cfg.hub||'').trim();
    if (hub) u.searchParams.set('hub', hub);

    // passthrough timestamp (helps caching issues)
    u.searchParams.set('ts', String(Date.now()));

    return u.toString();
  }

  async function copyText(text){
    try { await navigator.clipboard.writeText(String(text||'')); return true; }
    catch {
      try{
        const ta = DOC.createElement('textarea');
        ta.value = String(text||'');
        DOC.body.appendChild(ta);
        ta.select();
        DOC.execCommand('copy');
        ta.remove();
        return true;
      }catch{ return false; }
    }
  }

  // ---------------- state ----------------
  const state = { cfg: loadCfg() };

  function syncUI(){
    const cfg = state.cfg;

    // run
    chipSet(cfg.run==='play' ? 'runPlay' : 'runResearch', ['runPlay','runResearch']);

    // diff
    chipSet(
      cfg.diff==='easy' ? 'diffEasy' : (cfg.diff==='hard' ? 'diffHard' : 'diffNormal'),
      ['diffEasy','diffNormal','diffHard']
    );

    // style
    chipSet(
      cfg.style==='focus' ? 'styleFocus' : (cfg.style==='chaos' ? 'styleChaos' : 'styleMix'),
      ['styleMix','styleFocus','styleChaos']
    );

    // time/seed
    $('time').value = String(clamp(cfg.time,30,180));
    $('seed').value = String(cfg.seed||'');

    // hub button
    $('btnHub').style.display = (String(cfg.hub||'').trim()) ? 'inline-flex' : 'none';

    // preview (default view mobile for preview)
    $('preview').textContent = buildRunUrl('mobile');
  }

  function updateCfg(patch){
    state.cfg = Object.assign({}, state.cfg, patch);
    saveCfg(state.cfg);
    syncUI();
  }

  // ---------------- bind chips ----------------
  $('runPlay').addEventListener('click', ()=>{ updateCfg({run:'play'}); setStatus('‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤: play ‚úÖ'); });
  $('runResearch').addEventListener('click', ()=>{
    // research should strongly prefer fixed seed
    let seed = String(state.cfg.seed||'').trim();
    if (!seed) seed = 'research-001';
    updateCfg({run:'research', seed});
    setStatus('‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤: research (seed ‡∏Ñ‡∏á‡∏ó‡∏µ‡πà) ‚úÖ');
  });

  $('diffEasy').addEventListener('click', ()=>{ updateCfg({diff:'easy'}); setStatus('‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤: easy ‚úÖ'); });
  $('diffNormal').addEventListener('click', ()=>{ updateCfg({diff:'normal'}); setStatus('‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤: normal ‚úÖ'); });
  $('diffHard').addEventListener('click', ()=>{ updateCfg({diff:'hard'}); setStatus('‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤: hard ‚úÖ'); });

  $('styleMix').addEventListener('click', ()=>{ updateCfg({style:'mix'}); setStatus('‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤: mix ‚úÖ'); });
  $('styleFocus').addEventListener('click', ()=>{ updateCfg({style:'focus'}); setStatus('‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤: focus ‚úÖ'); });
  $('styleChaos').addEventListener('click', ()=>{ updateCfg({style:'chaos'}); setStatus('‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤: chaos ‚úÖ'); });

  $('time').addEventListener('change', ()=>{
    const v = clamp($('time').value, 30, 180);
    updateCfg({time:v});
    setStatus('‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤: time ‚úÖ');
  });

  $('seed').addEventListener('change', ()=>{
    updateCfg({seed:String($('seed').value||'')});
    setStatus('‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤: seed ‚úÖ');
  });

  $('btnSeedNow').addEventListener('click', ()=>{
    updateCfg({seed:String(Date.now())});
    setStatus('seed = timestamp ‚úÖ');
  });

  $('btnSeedFixed').addEventListener('click', ()=>{
    updateCfg({seed:'research-001'});
    setStatus('seed ‡∏Ñ‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏¥‡∏à‡∏±‡∏¢ ‚úÖ');
  });

  // ---------------- actions: go ----------------
  function go(view, newTab){
    const url = buildRunUrl(view);
    $('preview').textContent = url;
    setStatus('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏Å‡∏°‚Ä¶ üöÄ');

    if (newTab) window.open(url, '_blank', 'noopener');
    else location.href = url;
  }

  $('goPC').addEventListener('click', ()=> go('pc', false));
  $('goMobile').addEventListener('click', ()=> go('mobile', false));
  $('goCardboard').addEventListener('click', ()=> go('cvr', false));
  $('goNewTab').addEventListener('click', ()=> go('mobile', true));

  $('btnCopyLink').addEventListener('click', async ()=>{
    const url = buildRunUrl('mobile');
    $('preview').textContent = url;
    const ok = await copyText(url);
    alert(ok ? '‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå Run ‡πÅ‡∏•‡πâ‡∏ß ‚úÖ' : 'Copy ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
  });

  $('btnHub').addEventListener('click', ()=>{
    const hub = String(state.cfg.hub||'').trim();
    if (!hub){ alert('‡πÑ‡∏°‡πà‡∏°‡∏µ hub=...'); return; }
    location.href = hub;
  });

  $('btnReset').addEventListener('click', ()=>{
    try{ localStorage.removeItem(LS_KEY); }catch{}
    state.cfg = Object.assign({}, defaultCfg, { hub: String(qs('hub','')||'') });
    saveCfg(state.cfg);
    syncUI();
    setStatus('‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÑ‡∏ß‡πâ‡πÅ‡∏•‡πâ‡∏ß ‚úÖ');
  });

  // ---------------- init ----------------
  // If hub exists in query, store it
  const hubQ = String(qs('hub','')||'').trim();
  if (hubQ && hubQ !== String(state.cfg.hub||'').trim()){
    updateCfg({ hub: hubQ });
  } else {
    syncUI();
  }

})();
</script>
</body>
</html>
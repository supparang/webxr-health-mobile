<!-- === /herohealth/hygiene-vr/hygiene-vr.html ===
HygieneVR Run ‚Äî PRODUCTION (HHA Standard)
‚úÖ Loads: particles.js -> hygiene-quiz-bank.js -> vr-ui.js -> hygiene-vr.boot.js (ordered)
‚úÖ Cache-bust via ?v= or ?ts=
‚úÖ IDs match hygiene.safe.js
-->
<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
  <title>Handwash Survival ‚Äî HeroHealth</title>
  <meta name="color-scheme" content="dark" />
  <link rel="icon" href="../favicon.ico"/>

  <!-- Main CSS -->
  <link rel="stylesheet" href="./hygiene-vr.css"/>

  <!-- Optional: config for vr-ui.js -->
  <script>
    // lockPx for cVR aim assist; keep same concept as other games
    window.HHA_VRUI_CONFIG = { lockPx: 28, cooldownMs: 90 };
  </script>
</head>

<body class="hw-body">
  <!-- Banner / toast -->
  <div id="banner" class="hw-banner" aria-live="polite"></div>

  <!-- HUD -->
  <header class="hw-hud" id="hud">
    <div class="hw-card">
      <div class="hw-titleRow">
        <div class="hw-title">
          <span class="hw-emoji">üßº</span>
          <span>Handwash Survival</span>
        </div>
        <div class="hw-sub" id="hudSub">PLAY ‚Ä¢ diff=normal ‚Ä¢ seed=... ‚Ä¢ view=pc</div>
      </div>

      <div class="hw-pills">
        <div class="hw-pill" id="pillStep">STEP 1/7 ü´ß ‡∏ù‡πà‡∏≤‡∏°‡∏∑‡∏≠</div>
        <div class="hw-pill" id="pillHits">HITS 0/6</div>
        <div class="hw-pill" id="pillCombo">COMBO 0</div>

        <div class="hw-pill danger" id="pillMiss">MISS 0 / 3</div>
        <div class="hw-pill warn" id="pillRisk">RISK Incomplete 0% ‚Ä¢ Unsafe 0%</div>
        <div class="hw-pill" id="pillTime">TIME 60</div>
      </div>

      <div class="hw-actions">
        <div class="hw-pill quest" id="pillQuest">QUEST ‡∏ó‡∏≥ STEP ‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å!</div>
        <button class="hw-btn" id="btnPause" type="button">‚è∏ Pause</button>
        <button class="hw-btn ghost" id="btnBack" type="button">‚Ü© HUB</button>
      </div>
    </div>
  </header>

  <!-- Stage -->
  <main id="stage" class="hw-stage" aria-label="playfield"></main>

  <!-- Quiz box -->
  <section id="quizBox" class="hw-quiz" style="display:none">
    <div class="hw-quiz-card">
      <div class="hw-quiz-q" id="quizQ">üß† Quiz: ...</div>
      <div class="hw-quiz-sub" id="quizSub">‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å: ...</div>
    </div>
  </section>

  <!-- Start Overlay -->
  <section id="startOverlay" class="hw-overlay" style="display:grid">
    <div class="hw-overlay-card">
      <div class="hw-overlay-title">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏° üßº</div>
      <div class="hw-card-sub">
        ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö 7 ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏£‡∏∞‡∏ß‡∏±‡∏á ü¶† ‡πÅ‡∏•‡∏∞‡∏≠‡∏¢‡πà‡∏≤‡∏û‡∏•‡∏≤‡∏î‡πÄ‡∏Å‡∏¥‡∏ô 3 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á
      </div>

      <div class="hw-overlay-actions">
        <button class="hw-btn primary" id="btnStart" type="button">‚ñ∂ Start</button>
        <button class="hw-btn" id="btnRestart" type="button">‚Ü∫ Reset</button>
      </div>

      <div class="hw-overlay-foot">
        <small>Tip: ‡∏ñ‡πâ‡∏≤‡∏≠‡∏¢‡∏≤‡∏Å‡∏Å‡∏±‡∏ô cache ‡πÉ‡∏´‡πâ‡πÉ‡∏™‡πà <b>?v=‡πÄ‡∏•‡∏Ç</b> ‡πÄ‡∏ä‡πà‡∏ô <b>?v=20260203</b></small>
      </div>
    </div>
  </section>

  <!-- End Overlay -->
  <section id="endOverlay" class="hw-overlay" style="display:none">
    <div class="hw-overlay-card wide">
      <div class="hw-overlay-title" id="endTitle">‡∏à‡∏ö‡πÄ‡∏Å‡∏° ‚úÖ</div>
      <div class="hw-card-sub" id="endSub">Grade A ‚Ä¢ ...</div>

      <pre class="hw-json" id="endJson">{}</pre>

      <div class="hw-overlay-actions">
        <button class="hw-btn primary" id="btnPlayAgain" type="button">‚ñ∂ Play again</button>
        <button class="hw-btn" id="btnCopyJson" type="button">üìã Copy JSON</button>
        <button class="hw-btn ghost" id="btnBack2" type="button">‚Ü© HUB</button>
      </div>
    </div>
  </section>

  <!-- =========================
       Ordered Loader (cache-bust)
       ========================= -->
  <script>
    (function(){
      'use strict';

      const DOC = document;
      const q = new URLSearchParams(location.search);
      const bust = q.get('v') || q.get('ts') || '';

      function withBust(p){
        if(!bust) return p;
        return p + (p.includes('?') ? '&' : '?') + 'v=' + encodeURIComponent(bust);
      }

      function showBootError(msg){
        console.error('[HygieneHTML]', msg);
        const banner = DOC.getElementById('banner');
        const startOverlay = DOC.getElementById('startOverlay');
        const hudSub = DOC.getElementById('hudSub');
        if(hudSub) hudSub.textContent = 'BOOT ERROR: ' + msg;

        if(banner){
          banner.textContent = '‚ùå ' + msg;
          banner.classList.add('show');
        }
        if(startOverlay){
          const card = startOverlay.querySelector('.hw-card-sub');
          if(card){
            card.innerHTML = `
              <b style="color:#fca5a5">‡πÄ‡∏Å‡∏¥‡∏î‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏Å‡∏°</b><br>
              <span style="color:#94a3b8">${msg}</span><br>
              <span style="color:#94a3b8">‡πÄ‡∏ä‡πá‡∏Ñ Network ‡∏ß‡πà‡∏≤‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå 404 ‡∏´‡∏£‡∏∑‡∏≠‡∏û‡∏≤‡∏ò‡∏ú‡∏¥‡∏î</span>
            `;
          }
          startOverlay.style.display = 'grid';
        }
      }

      function loadScript(src){
        return new Promise((resolve, reject)=>{
          const s = DOC.createElement('script');
          s.defer = true;
          s.src = withBust(src);
          s.onload = ()=>resolve(true);
          s.onerror = ()=>reject(new Error('‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ' + src));
          DOC.head.appendChild(s);
        });
      }

      // ‚úÖ ordered: particles -> quiz bank -> vr-ui -> boot
      Promise.resolve()
        .then(()=>loadScript('../vr/particles.js'))
        .then(()=>loadScript('./hygiene-quiz-bank.js'))  // ‚úÖ ‡∏ä‡∏∑‡πà‡∏≠‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (‡πÑ‡∏°‡πà‡∏°‡∏µ hygiene.quiz-bank.js)
        .then(()=>loadScript('../vr/vr-ui.js'))
        .then(()=>loadScript('./hygiene-vr.boot.js'))
        .catch((err)=>{
          showBootError(err && err.message ? err.message : String(err||'unknown'));
        });
    })();
  </script>
</body>
</html>
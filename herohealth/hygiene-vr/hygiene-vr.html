<!-- === /herohealth/hygiene-vr/hygiene-vr.html ===
HygieneVR RUN ‚Äî PRODUCTION (HHA Standard + Missions BK + Storm/Boss/Shield BL)
‚úÖ Fix: vr-ui.js loaded with defer (avoid appendChild null)
‚úÖ Missions HUD: Goals + Mini quests
‚úÖ BL: Storm phase (EP2/EP3), Boss fight (EP3), Shield powerup
-->
<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>HeroHealth ‚Äî HygieneVR</title>
  <meta name="color-scheme" content="light dark" />
  <link rel="icon" href="../favicon.ico" type="image/x-icon" />

  <link rel="stylesheet" href="./hygiene-vr.css" />

  <!-- Universal VR UI (‚úÖ defer) -->
  <script src="../vr/vr-ui.js" defer></script>

  <!-- Optional shared helpers -->
  <script src="../vr/particles.js" defer></script>

  <!-- AI Packs -->
  <script src="../vr/hha-ai-coach.js" defer></script>
  <script src="../vr/hha-difficulty-director.js" defer></script>
  <script src="../vr/hha-badges.js" defer></script>

  <!-- Engine -->
  <script type="module" src="./hygiene-vr.boot.js"></script>
</head>

<body class="view-pc">
  <div id="gameRoot" class="hw-root">

    <!-- ‚úÖ NEW: Storm FX overlay -->
    <div class="hw-stormfx" id="stormFx" aria-hidden="true"></div>

    <div class="hw-stage" id="stage" aria-label="HygieneVR stage"></div>

    <!-- HUD -->
    <div class="hw-hud">
      <div class="hw-top">

        <!-- ‚úÖ NEW: Boss bar -->
        <div class="hw-bossbar" id="bossBar" style="display:none">
          <div class="hw-boss-title" id="bossTitle">üëë BOSS: Handwash Master</div>
          <div class="hw-boss-track">
            <div class="hw-boss-fill" id="bossFill" style="width:100%"></div>
          </div>
          <div class="hw-boss-sub" id="bossSub">‡∏ó‡∏≥ STEP ‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏≤‡∏ö‡∏ö‡∏≠‡∏™!</div>
        </div>

        <div class="hw-title">üßº Handwash Survival</div>
        <div class="hw-sub" id="hudSub">ready‚Ä¶</div>

        <div class="hw-row">
          <div class="hw-pill" id="pillStep">STEP 1/7 ü´ß ‡∏ù‡πà‡∏≤‡∏°‡∏∑‡∏≠</div>
          <div class="hw-pill" id="pillHits">HITS 0/6</div>
          <div class="hw-pill" id="pillCombo">COMBO 0</div>
          <div class="hw-pill bad" id="pillMiss">MISS 0 / 3</div>
        </div>

        <div class="hw-row">
          <div class="hw-pill good" id="pillGoals">GOALS 0/2</div>
          <div class="hw-pill cyan" id="pillMini">MINI 0/3</div>

          <!-- ‚úÖ NEW: Shield + Storm pills -->
          <div class="hw-pill violet" id="pillShield">SHIELD 0</div>
          <div class="hw-pill warn" id="pillStorm" style="display:none">STORM 0s</div>

          <div class="hw-pill warn" id="pillRisk">RISK Incomplete 0% ‚Ä¢ Unsafe 0%</div>
          <div class="hw-pill" id="pillTime">TIME 70</div>

          <button class="hw-pill btn" id="btnMissions" type="button">üìå Missions</button>
          <button class="hw-pill btn" id="btnPause" type="button">‚è∏ Pause</button>
          <button class="hw-pill btn" id="btnBack" type="button">‚Ü© HUB</button>
        </div>
      </div>

      <div class="hw-banner" id="banner" aria-live="polite"></div>

      <!-- Missions panel -->
      <div class="hw-missions" id="missionsPanel" style="display:none">
        <div class="hw-mis-title">üìå Missions</div>
        <div class="hw-mis-grid">
          <div class="hw-mis-card">
            <div class="hw-mis-h">üéØ GOALS</div>
            <div class="hw-mis-t" id="goalsText">‚Äî</div>
          </div>
          <div class="hw-mis-card">
            <div class="hw-mis-h">‚ö° MINI QUEST (‡∏à‡∏≥‡∏Å‡∏±‡∏î‡πÄ‡∏ß‡∏•‡∏≤)</div>
            <div class="hw-mis-t" id="miniText">‚Äî</div>
            <div class="hw-mis-sub" id="miniTimer">‚Äî</div>
          </div>
        </div>
        <div class="hw-mis-sub">Tip: ‡∏¢‡∏¥‡∏á/‡πÅ‡∏ï‡∏∞ ‚Äúemoji ‡∏Ç‡∏≠‡∏á STEP ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‚Äù ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‚Ä¢ ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á ü¶† ‚Ä¢ ‡πÄ‡∏Å‡πá‡∏ö üõ°Ô∏è ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ö‡∏•‡πá‡∏≠‡∏Å‡πÄ‡∏ä‡∏∑‡πâ‡∏≠</div>
      </div>
    </div>

    <!-- Start Overlay -->
    <div class="hw-overlay" id="startOverlay">
      <div class="hw-card">
        <div class="hw-card-title">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏•‡πâ‡∏≤‡∏á‡∏°‡∏∑‡∏≠ üßº</div>
        <div class="hw-card-sub">
          ‡∏ó‡∏≥‡∏ï‡∏≤‡∏° <b>7 ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô</b> ‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å ‚Ä¢ ‡∏´‡∏•‡∏ö‡πÄ‡∏ä‡∏∑‡πâ‡∏≠ ü¶† ‚Ä¢ ‡πÄ‡∏Å‡πá‡∏ö üõ°Ô∏è ‡πÑ‡∏î‡πâ‡∏ö‡∏•‡πá‡∏≠‡∏Å‡πÄ‡∏ä‡∏∑‡πâ‡∏≠ 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á<br>
          EP2 ‡∏°‡∏µ‡∏û‡∏≤‡∏¢‡∏∏‡πÄ‡∏ä‡∏∑‡πâ‡∏≠ üåÄ ‚Ä¢ EP3 ‡∏°‡∏µ‡∏ö‡∏≠‡∏™ üëë ‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥ STEP ‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡∏ô‡∏∞
        </div>
        <div class="hw-card-row">
          <button class="hw-cta" id="btnStart" type="button">‚ñ∂ Start</button>
          <button class="hw-ghost" id="btnRestart" type="button">‚Üª Restart</button>
        </div>
        <div class="hw-card-sub" style="margin-top:10px">
          EP: <span id="labEp">1</span> ‚Ä¢ Mode: <span id="labMode">play</span> ‚Ä¢ Diff: <span id="labDiff">normal</span> ‚Ä¢ View: <span id="labView">pc</span>
        </div>
      </div>
    </div>

    <!-- End Overlay -->
    <div class="hw-overlay" id="endOverlay" style="display:none">
      <div class="hw-card">
        <div class="hw-card-title" id="endTitle">‡∏à‡∏ö‡πÄ‡∏Å‡∏° ‚úÖ</div>
        <div class="hw-card-sub" id="endSub">‚Äî</div>
        <pre class="hw-pre" id="endJson"></pre>
        <div class="hw-card-row">
          <button class="hw-cta" id="btnPlayAgain" type="button">‚ñ∂ ‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
          <button class="hw-ghost" id="btnCopyJson" type="button">üìã Copy Summary</button>
          <button class="hw-ghost" id="btnBack2" type="button">‚Ü© ‡∏Å‡∏•‡∏±‡∏ö HUB</button>
        </div>
      </div>
    </div>

  </div>

<script>
(function(){
  'use strict';
  const qs = (k,d=null)=>{ try{return new URL(location.href).searchParams.get(k) ?? d;}catch{return d;} };

  function setViewClass(){
    const view = (qs('view','pc')||'pc').toLowerCase();
    document.body.classList.remove('view-pc','view-mobile','view-vr','view-cvr');
    document.body.classList.add(view==='mobile'?'view-mobile':(view==='vr'?'view-vr':(view==='cvr'?'view-cvr':'view-pc')));
    document.getElementById('labView').textContent = view;
  }
  setViewClass();

  document.getElementById('labMode').textContent = (qs('run','play')||'play');
  document.getElementById('labDiff').textContent = (qs('diff','normal')||'normal');
  document.getElementById('labEp').textContent   = (qs('episode','1')||'1');
})();
</script>
</body>
</html>
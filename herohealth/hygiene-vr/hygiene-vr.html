<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>HeroHealth ‚Äî Hygiene VR</title>
  <meta name="color-scheme" content="dark light" />
  <link rel="stylesheet" href="./hygiene-vr.css" />
</head>
<body class="view-mobile">
  <main class="hw-root" id="app">
    <!-- ===== Stage (target playfield) ===== -->
    <div class="hw-stage" id="stage" aria-hidden="true"></div>

    <!-- ===== HUD ===== -->
    <section class="hw-hud" id="hud" aria-label="Game HUD">
      <div class="hw-top" id="hudTop">
        <div class="hw-title">üßº Hygiene Challenge VR</div>
        <div class="hw-sub" id="hudSub">PLAY ‚Ä¢ diff=normal ‚Ä¢ seed=‚Äî ‚Ä¢ view=mobile</div>

        <div class="hw-row">
          <div class="hw-pill cyan" id="pillStep">STEP 1/7 ü´ß ‡∏ù‡πà‡∏≤‡∏°‡∏∑‡∏≠</div>
          <div class="hw-pill" id="pillHits">HITS 0/6</div>
          <div class="hw-pill" id="pillCombo">COMBO 0</div>
          <div class="hw-pill bad" id="pillMiss">MISS 0 / 3</div>
          <div class="hw-pill warn" id="pillRisk">RISK Incomplete 0% ‚Ä¢ Unsafe 0%</div>
          <div class="hw-pill" id="pillTime">TIME 0</div>
        </div>

        <div class="hw-row">
          <div class="hw-pill" id="pillQuest">MISSION ‡∏ó‡∏≥ STEP ‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å!</div>
          <div class="hw-pill power" id="pillPower">POWER üõ°Ô∏è0 ‚Ä¢ üéØOFF ‚Ä¢ ‚ùÑÔ∏èOFF</div>

          <!-- buttons -->
          <button type="button" class="hw-pill btn" id="btnPause">‚è∏ Pause</button>
          <button type="button" class="hw-pill btn" id="btnRestart">‚Ü∫ Reset</button>
          <button type="button" class="hw-pill btn" id="btnBack">‚Üê HUB</button>
        </div>

        <!-- progress -->
        <div class="hw-bars">
          <div class="hw-bar">
            <div class="hw-bar-lab">STEP PROGRESS</div>
            <div class="hw-bar-rail"><div class="hw-bar-fill cyan" id="barStep"></div></div>
          </div>
          <div class="hw-bar">
            <div class="hw-bar-lab">LOOP / MISSION</div>
            <div class="hw-bar-rail"><div class="hw-bar-fill" id="barLoop"></div></div>
          </div>
        </div>

        <!-- quiz -->
        <div class="hw-quiz" id="quizBox" style="display:none">
          <div class="hw-quiz-q" id="quizQ">üß† Quiz: ‚Äî</div>
          <div class="hw-quiz-sub" id="quizSub">‚Äî</div>
        </div>
      </div>

      <div class="hw-banner" id="banner" role="status" aria-live="polite"></div>
    </section>

    <!-- ===== START OVERLAY ===== -->
    <section class="hw-overlay" id="startOverlay" aria-label="Start Game Overlay">
      <div class="hw-card">
        <div class="hw-card-title">üßº Hygiene VR ‚Äî Survival + Analyze + Create</div>
        <div class="hw-card-sub">
          ‡πÄ‡∏Å‡∏°‡∏ô‡∏µ‡πâ‡∏°‡∏µ 3 ‡∏™‡πà‡∏ß‡∏ô‡πÉ‡∏ô‡∏£‡∏≠‡∏ö‡πÄ‡∏î‡∏µ‡∏¢‡∏ß:
          <br>1) <b>Play</b> ‚Äî ‡∏ï‡∏µ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á STEP ‡∏•‡πâ‡∏≤‡∏á‡∏°‡∏∑‡∏≠ 7 ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô
          <br>2) <b>Evaluate</b> ‚Äî ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ‚Äú‡∏à‡∏∏‡∏î‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏∏‡∏î‚Äù ‡∏à‡∏≤‡∏Å Heat map ‡∏°‡∏∑‡∏≠
          <br>3) <b>Create</b> ‚Äî ‡∏ß‡∏≤‡∏á routine ‡∏•‡πâ‡∏≤‡∏á‡∏°‡∏∑‡∏≠ 3 ‡∏Ç‡πâ‡∏≠ ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 30 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
          <br><br>
          <span class="hw-mini">‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢:</span> ‡∏ó‡∏≥ STEP ‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å, ‡∏´‡∏•‡∏ö ü¶†, ‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏Ñ‡∏≠‡∏°‡πÇ‡∏ö ‡πÅ‡∏•‡∏∞‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á
        </div>

        <div class="hw-card-row">
          <button type="button" class="hw-cta" id="btnStart">‚ñ∂ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°</button>
          <button type="button" class="hw-ghost" id="btnPractice">‚è± ‡∏ù‡∏∂‡∏Å 15 ‡∏ß‡∏¥</button>
        </div>

        <div class="hw-eval">
          <div class="hw-eval-title">‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏•‡πà‡∏ô‡∏¢‡πà‡∏≠ (Play)</div>
          <div class="hw-eval-sub">
            ‚Ä¢ ‡πÅ‡∏ï‡∏∞/‡∏¢‡∏¥‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏Ç‡∏≠‡∏á STEP ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô<br>
            ‚Ä¢ ‡πÅ‡∏ï‡∏∞‡∏ú‡∏¥‡∏î STEP = MISS<br>
            ‚Ä¢ ‡πÇ‡∏î‡∏ô ü¶† = MISS (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡πÇ‡∏•‡πà‡∏™‡∏ö‡∏π‡πà‡∏à‡∏∞‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ)<br>
            ‚Ä¢ ‡∏Ñ‡∏£‡∏ö 7 STEP = 1 loop ‡πÅ‡∏•‡∏∞‡∏≠‡∏≤‡∏à‡∏°‡∏µ Quiz/‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à/‡∏û‡∏•‡∏±‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°
          </div>
        </div>

        <div class="hw-create">
          <div class="hw-eval-title">‡πÇ‡∏´‡∏°‡∏î cVR / Cardboard</div>
          <div class="hw-eval-sub">
            ‡πÉ‡∏ä‡πâ crosshair ‡πÄ‡∏•‡πá‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏à‡∏≠ + ‡∏¢‡∏¥‡∏á (event <code>hha:shoot</code>) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢/‡∏ß‡∏á‡∏Å‡∏•‡∏°‡∏ö‡∏ô hand map
          </div>
        </div>
      </div>
    </section>

    <!-- ===== END OVERLAY (scrollable) ===== -->
    <section class="hw-overlay" id="endOverlay" style="display:none" aria-label="End Game Overlay">
      <div class="hw-card">
        <div class="hw-card-title" id="endTitle">‡∏à‡∏ö‡πÄ‡∏Å‡∏° ‚úÖ</div>
        <div class="hw-card-sub" id="endSub">‚Äî</div>

        <div class="hw-card-row">
          <button type="button" class="hw-cta" id="btnPlayAgain">‚Üª ‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
          <button type="button" class="hw-ghost" id="btnCopyJson">üìã Copy JSON</button>
          <button type="button" class="hw-ghost" id="btnBack2">‚Üê ‡∏Å‡∏•‡∏±‡∏ö HUB</button>
        </div>

        <!-- ===== Evaluate (Analyze) ===== -->
        <section class="hw-eval" id="evalBox">
          <div class="hw-eval-title">üß† Evaluate: ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ‚Äú‡∏à‡∏∏‡∏î‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏∏‡∏î‚Äù ‡∏ö‡∏ô‡∏°‡∏∑‡∏≠</div>
          <div class="hw-eval-sub" id="evalSub">
            ‡∏î‡∏π heat map ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏Ñ‡∏¥‡∏î‡∏ß‡πà‡∏≤‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏∏‡∏î‡∏à‡∏≤‡∏Å‡∏£‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô‡∏ô‡∏µ‡πâ ‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏• 1 ‡∏Ç‡πâ‡∏≠
          </div>
          <div class="hw-eval-sub" id="evalHint">
            ‡πÅ‡∏ï‡∏∞‡∏ß‡∏á‡∏Å‡∏•‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
          </div>

          <!-- 2D Hand heat map -->
          <div class="hw-handmap" id="handMap" aria-label="2D hand heat map"></div>

          <div class="hw-eval-row">
            <div class="hw-eval-picked" id="evalPicked">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å: ‚Äî</div>
            <div class="hw-eval-score" id="evalScore">‡∏ú‡∏•‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô: ‚Äî</div>
          </div>

          <div class="hw-eval-sub" style="margin-top:10px;">
            ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏• (1 ‡∏Ç‡πâ‡∏≠)
          </div>
          <div class="hw-reasons" id="evalReasons">
            <button type="button" class="hw-reason" data-reason="wrong-step-high">
              ‡∏™‡∏•‡∏±‡∏ö STEP ‡∏ú‡∏¥‡∏î‡∏ö‡πà‡∏≠‡∏¢ ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ï‡∏Å‡∏´‡∏•‡πà‡∏ô‡∏Å‡∏≤‡∏£‡∏ñ‡∏π‡∏à‡∏∏‡∏î‡∏ô‡∏µ‡πâ
            </button>
            <button type="button" class="hw-reason" data-reason="hazard-contact">
              ‡πÇ‡∏î‡∏ô‡∏™‡∏¥‡πà‡∏á‡∏õ‡∏ô‡πÄ‡∏õ‡∏∑‡πâ‡∏≠‡∏ô/‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡∏ö‡πà‡∏≠‡∏¢ ‡∏à‡∏∂‡∏á‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏∞‡∏™‡∏°
            </button>
            <button type="button" class="hw-reason" data-reason="low-repetition">
              ‡πÅ‡∏ï‡∏∞‡∏à‡∏∏‡∏î‡∏ô‡∏µ‡πâ‡∏ô‡πâ‡∏≠‡∏¢/‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ï‡∏≤‡∏° STEP
            </button>
            <button type="button" class="hw-reason" data-reason="slow-rt">
              ‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á‡∏ä‡πâ‡∏≤ ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏û‡∏•‡∏≤‡∏î‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏∞‡πÉ‡∏ô‡∏à‡∏∏‡∏î‡∏ô‡∏µ‡πâ
            </button>
          </div>

          <div class="hw-card-row">
            <button type="button" class="hw-cta" id="btnEvalConfirm" disabled>‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô</button>
            <button type="button" class="hw-ghost" id="btnEvalSkip">‡∏Ç‡πâ‡∏≤‡∏° Evaluate</button>
          </div>
        </section>

        <!-- ===== Create Routine (30s) ===== -->
        <section class="hw-create" id="createBox" style="display:none">
          <div class="hw-eval-title">üõ† Create: ‡∏ß‡∏≤‡∏á Routine ‡∏•‡πâ‡∏≤‡∏á‡∏°‡∏∑‡∏≠ (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å 3 ‡∏Ç‡πâ‡∏≠ ‡πÉ‡∏ô 30 ‡∏ß‡∏¥)</div>
          <div class="hw-eval-sub">
            ‡∏™‡∏£‡πâ‡∏≤‡∏á routine ‡∏ó‡∏µ‡πà ‚Äú‡∏Ñ‡∏∏‡πâ‡∏°‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á‚Äù ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡πá‡∏Å/‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô
          </div>

          <div class="hw-eval-row">
            <div class="hw-eval-picked" id="createPicked">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß: 0/3</div>
            <div class="hw-eval-score" id="createScore">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: ‚Äî</div>
          </div>

          <div class="hw-eval-sub" style="margin-top:10px;">
            ‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠: <span class="hw-mini" id="createTimer">30</span> ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
          </div>

          <div class="hw-routine" id="routineOpts">
            <button type="button" class="hw-rt" data-rt="‡∏Å‡πà‡∏≠‡∏ô‡∏Å‡∏¥‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£/‡∏Ç‡∏ô‡∏°">‡∏Å‡πà‡∏≠‡∏ô‡∏Å‡∏¥‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£/‡∏Ç‡∏ô‡∏°</button>
            <button type="button" class="hw-rt" data-rt="‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏´‡πâ‡∏≠‡∏á‡∏ô‡πâ‡∏≥">‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏´‡πâ‡∏≠‡∏á‡∏ô‡πâ‡∏≥</button>
            <button type="button" class="hw-rt" data-rt="‡∏´‡∏•‡∏±‡∏á‡∏à‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞/‡∏•‡∏π‡∏Å‡∏ö‡∏¥‡∏î/‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠">‡∏´‡∏•‡∏±‡∏á‡∏à‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞/‡∏•‡∏π‡∏Å‡∏ö‡∏¥‡∏î/‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠</button>
            <button type="button" class="hw-rt" data-rt="‡∏Å‡∏•‡∏±‡∏ö‡∏ñ‡∏∂‡∏á‡∏ö‡πâ‡∏≤‡∏ô‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≤‡∏á‡∏ô‡∏≠‡∏Å">‡∏Å‡∏•‡∏±‡∏ö‡∏ñ‡∏∂‡∏á‡∏ö‡πâ‡∏≤‡∏ô‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≤‡∏á‡∏ô‡∏≠‡∏Å</button>
            <button type="button" class="hw-rt" data-rt="‡∏´‡∏•‡∏±‡∏á‡πÑ‡∏≠/‡∏à‡∏≤‡∏°/‡∏™‡∏±‡πà‡∏á‡∏ô‡πâ‡∏≥‡∏°‡∏π‡∏Å">‡∏´‡∏•‡∏±‡∏á‡πÑ‡∏≠/‡∏à‡∏≤‡∏°/‡∏™‡∏±‡πà‡∏á‡∏ô‡πâ‡∏≥‡∏°‡∏π‡∏Å</button>
            <button type="button" class="hw-rt" data-rt="‡∏Å‡πà‡∏≠‡∏ô‡∏™‡∏±‡∏°‡∏ú‡∏±‡∏™‡∏´‡∏ô‡πâ‡∏≤/‡∏ï‡∏≤/‡∏à‡∏°‡∏π‡∏Å/‡∏õ‡∏≤‡∏Å">‡∏Å‡πà‡∏≠‡∏ô‡∏™‡∏±‡∏°‡∏ú‡∏±‡∏™‡∏´‡∏ô‡πâ‡∏≤/‡∏ï‡∏≤/‡∏à‡∏°‡∏π‡∏Å/‡∏õ‡∏≤‡∏Å</button>
          </div>

          <div class="hw-card-row">
            <button type="button" class="hw-cta" id="btnCreateConfirm" disabled>üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Routine</button>
          </div>
        </section>

        <!-- Raw JSON summary -->
        <pre class="hw-pre" id="endJson" aria-label="Game summary JSON">{}</pre>
      </div>
    </section>
  </main>

  <!-- ===== Boot helper: apply view class from query ===== -->
  <script>
  (function(){
    try{
      const q = new URL(location.href).searchParams;
      const view = (q.get('view') || 'mobile').toLowerCase();
      document.body.classList.remove('view-pc','view-mobile','view-vr','view-cvr');
      document.body.classList.add(
        view === 'cvr' ? 'view-cvr' :
        view === 'vr'  ? 'view-vr'  :
        view === 'pc'  ? 'view-pc'  : 'view-mobile'
      );
    }catch(e){}
  })();
  </script>

  <!-- ===== Optional deps (safe if missing) ===== -->
  <!-- ‚úÖ PATCH: particles ‡∏≠‡∏¢‡∏π‡πà ../vr/particles.js -->
  <script src="../vr/particles.js"></script>

  <!-- HHA modules (global window.*) -->
  <script src="../vr/hha-badges.js"></script>
  <script src="../vr/hha-ai-coach.js"></script>

  <!-- DD ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå => ‡πÑ‡∏°‡πà‡πÇ‡∏´‡∏•‡∏î (‡πÑ‡∏°‡πà‡∏á‡∏±‡πâ‡∏ô 404 ‡πÅ‡∏ô‡πà) -->
  <!-- <script src="../vr/hha-dd.js"></script> -->

  <!-- Quiz bank ‡∏≠‡∏¢‡∏π‡πà‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ -->
  <script src="./hygiene-quiz-bank.js"></script>

  <!-- Debug quick check (optional) -->
  <script>
    try{
      console.log('[HHA deps]', {
        particles: !!window.Particles,
        badges: !!window.HHA_Badges,
        coach:  !!window.HHA_AICoach,
        quiz:   Array.isArray(window.HHA_HYGIENE_QUIZ_BANK) ? window.HHA_HYGIENE_QUIZ_BANK.length : 0
      });
    }catch(e){}
  </script>

  <!-- ===== Main game module ===== -->
  <script type="module">
    import { boot } from './hygiene.safe.js';
    boot();
  </script>
</body>
</html>

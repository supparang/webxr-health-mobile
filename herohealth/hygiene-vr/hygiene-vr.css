/* === PATCH v20260222-scrollfix (mobile end overlay scroll) ===
FIX: end overlay content too tall on mobile -> scrollable card
FIX: touch scroll blocked inside overlay
FIX: sticky action area for confirm buttons
*/

/* overlay ต้องรับ pointer/touch */
.hw-overlay{
  pointer-events: auto;
  overscroll-behavior: contain;
}

/* card ให้เลื่อนได้จริงบนมือถือ */
.hw-card{
  max-height: calc(100dvh - (var(--sat) + var(--sab) + 28px));
  overflow: auto;
  -webkit-overflow-scrolling: touch;
  overscroll-behavior: contain;
  touch-action: pan-y;
}

/* เผื่อ browser ยังไม่รองรับ dvh */
@supports not (height: 100dvh){
  .hw-card{
    max-height: calc(100vh - (var(--sat) + var(--sab) + 28px));
  }
}

/* กล่องย่อยใน end flow อย่า clip เนื้อหา */
.hw-eval,
.hw-create{
  overflow: visible;
}

/* handmap ไม่ให้ดัน layout เกินจอ */
.hw-handmap{
  max-width: 100%;
}

/* ปุ่มยืนยันด้านล่างให้ติดล่างเวลาเลื่อน (ใช้งานง่ายบนมือถือ) */
.hw-card-row{
  position: sticky;
  bottom: calc(0px + var(--sab));
  z-index: 2;
  padding-top: 8px;
  margin-top: 12px;
  background: linear-gradient(to top, rgba(2,6,23,.88), rgba(2,6,23,0));
}

/* ป้องกัน HUD มากิน touch บน overlay (ถึงแม้มี z-index ต่ำกว่า ก็กันไว้ชัวร์) */
.hw-overlay ~ .hw-hud,
.hw-overlay .hw-hud{
  pointer-events: none;
}

/* Mobile tuning */
@media (max-width: 768px){
  .hw-overlay{
    align-items: start;           /* ให้ card เริ่มจากด้านบน จะเห็นหัวข้อก่อน */
    place-items: start center;
    padding-top: calc(10px + var(--sat));
    padding-bottom: calc(10px + var(--sab));
  }

  .hw-card{
    width: min(760px, 100%);
    border-radius: 18px;
    padding: 12px;
    max-height: calc(100dvh - (var(--sat) + var(--sab) + 20px));
  }

  .hw-pre{
    max-height: min(28vh, 220px); /* JSON box อย่ากินพื้นที่มากเกิน */
  }

  .hw-eval-row{
    gap: 8px;
  }

  .hw-eval-picked,
  .hw-eval-score{
    min-width: 0;
    width: 100%;
  }

  .hw-zone{
    width: 50px;
    height: 50px;
  }

  .hw-zone .zlab{ font-size: 11px; }
  .hw-zone .zmini{ font-size: 10px; }
}

/* cVR/mobile บางเครื่องมีปัญหา tap ผ่านชั้น ให้ชั้น interactive ชัดเจน */
.hw-card,
.hw-eval,
.hw-create,
.hw-handmap,
.hw-reasons,
.hw-routine,
.hw-reason,
.hw-rt,
.hw-cta,
.hw-ghost{
  pointer-events: auto;
}
<!-- === /herohealth/vr-goodjunk/goodjunk-vr.html ===
GoodJunkVR RUN (PC/Mobile/VR/cVR) — PRODUCTION
✅ Loads: goodjunk-vr.css + particles + fx-director + cloud-logger + boot(module)
✅ hub fallback: ../hub.html when hub param missing
-->
<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>HeroHealth — GoodJunk VR</title>
  <meta name="color-scheme" content="dark" />
  <link rel="icon" href="../favicon.ico" type="image/x-icon" />

  <link rel="stylesheet" href="./goodjunk-vr.css" />

  <script src="../vr/particles.js" defer></script>
  <script src="../vr/hha-fx-director.js" defer></script>
  <script src="../vr/hha-cloud-logger.js" defer></script>

  <script type="module" src="./goodjunk-vr.boot.js"></script>
</head>

<body class="view-mobile">

  <div class="gj-topbar">
    <div class="left">
      <div class="gj-chip" id="chipMeta">GoodJunkVR</div>
    </div>
    <div class="right">
      <button class="gj-chip btn" id="btnBackHub" type="button">↩ กลับ HUB</button>
    </div>
  </div>

  <div class="gj-warning-ring" aria-hidden="true"></div>

  <div class="vr-mini-hud" id="vrMiniHud">
    <div class="mini-row">
      <div class="mini-pill"><span>SCORE</span><b id="miniScore">0</b></div>
      <div class="mini-pill"><span>TIME</span><b id="miniTime">0</b></div>
      <div class="mini-pill"><span>GRADE</span><b id="miniGrade">—</b></div>
      <button class="mini-btn" id="btnPeek" type="button">Missions</button>
    </div>
  </div>

  <div class="hha-hud" id="hud">
    <div class="hud-top">
      <div class="hud-badge">
        <div class="hud-title">GoodJunkVR</div>
        <div class="hud-sub" id="hudSub">ยิงดีเลี่ยง “ขยะ”</div>

        <div class="viewbar">
          <button class="pill ghost" id="btnMissions" type="button">Missions</button>
          <button class="pill ghost" id="btnHideHud" type="button">Hide HUD</button>
        </div>
      </div>

      <div class="hud-stats">
        <div class="hud-stat"><div class="k">SCORE</div><div class="v" id="hud-score">0</div></div>
        <div class="hud-stat"><div class="k">TIME</div><div class="v" id="hud-time">0</div></div>
        <div class="hud-stat"><div class="k">MISS</div><div class="v" id="hud-miss">0</div></div>
        <div class="hud-stat"><div class="k">GRADE</div><div class="v" id="hud-grade">—</div></div>
      </div>
    </div>

    <div class="hud-mid">
      <div class="hud-quest">
        <div class="q-row">
          <div class="q-title" id="hud-goal">—</div>
          <div class="q-count">
            <span id="hud-goal-cur">0</span>/<span id="hud-goal-target">0</span>
          </div>
        </div>
        <div class="q-progress" id="goalDesc">—</div>

        <div style="height:10px"></div>

        <div class="q-row">
          <div class="q-title mini">MINI</div>
          <div class="q-timer" id="miniTimer">—</div>
        </div>
        <div class="q-progress" id="hud-mini">—</div>

        <div style="display:none" id="hud-combo">0</div>
      </div>
    </div>
  </div>

  <div class="gj-peek" id="peek" aria-hidden="true">
    <div class="peek-card">
      <div class="peek-title">Missions</div>
      <div class="peek-sub" id="peekGoal">—</div>
      <div class="peek-mini" id="peekMini">—</div>
      <div class="peek-tip" id="peekTip">แตะ/ยิงเพื่อปิด</div>
    </div>
  </div>

  <div class="hha-fever" id="feverBox">
    <div class="fever-row">
      <div class="fever-label">FEVER</div>
      <div class="fever-bar"><div class="fever-fill" id="feverFill"></div></div>
      <div class="fever-text" id="feverText">0%</div>
    </div>

    <div class="shield-row">
      <div class="shield-label">SHIELD</div>
      <div class="shield-pills" id="shieldPills">—</div>
    </div>
  </div>

  <div id="gj-stage">
    <div class="gj-eye eye-l">
      <div class="gj-layer" id="gj-layer"></div>
      <div class="gj-crosshair" id="crosshairL"></div>
    </div>

    <div class="gj-eye eye-r">
      <div class="gj-layer" id="gj-layer-r"></div>
      <div class="gj-crosshair" id="crosshairR"></div>
    </div>
  </div>

  <div class="hha-controls">
    <button class="btn-shoot" id="btnShoot" type="button">ยิง / TAP</button>
  </div>

  <div class="gj-lowtime-overlay" id="lowTimeOverlay" aria-hidden="true">
    <div class="gj-lowtime-num" id="gj-lowtime-num">5</div>
  </div>

  <script>
  (function(){
    const qs = (k,d=null)=>{ try{return new URL(location.href).searchParams.get(k) ?? d;}catch{return d;} };
    const byId = (id)=>document.getElementById(id);

    const view = (qs('view','mobile')||'mobile').toLowerCase();
    const run  = qs('run','play');
    const diff = qs('diff','normal');
    const time = qs('time','80');

    const hub = qs('hub', '../hub.html');

    document.body.classList.remove('view-pc','view-mobile','view-vr','view-cvr');
    document.body.classList.add(
      view==='pc'?'view-pc':
      view==='vr'?'view-vr':
      view==='cvr'?'view-cvr':
      'view-mobile'
    );

    const chip = byId('chipMeta');
    if(chip) chip.textContent = `GoodJunkVR · view=${view} · run=${run} · diff=${diff} · time=${time}`;

    byId('btnBackHub')?.addEventListener('click', ()=> location.href = hub);
    byId('btnShoot')?.addEventListener('click', ()=> window.dispatchEvent(new CustomEvent('hha:shoot')));

    const peek = byId('peek');
    peek?.addEventListener('click', ()=> peek.setAttribute('aria-hidden','true'));

    function openPeek(){
      peek?.setAttribute('aria-hidden','false');
      try{
        byId('peekGoal').textContent =
          (byId('hud-goal')?.textContent || '—') + ' ' +
          (byId('hud-goal-cur')?.textContent || '0') + '/' +
          (byId('hud-goal-target')?.textContent || '0');
        byId('peekMini').textContent = byId('hud-mini')?.textContent || '—';
      }catch(_){}
    }

    byId('btnMissions')?.addEventListener('click', openPeek);
    byId('btnPeek')?.addEventListener('click', openPeek);
    byId('btnHideHud')?.addEventListener('click', ()=> document.body.classList.toggle('hud-hidden'));

    setInterval(()=>{
      const s = byId('hud-score')?.textContent || '0';
      const t = byId('hud-time')?.textContent || '0';
      const g = byId('hud-grade')?.textContent || '—';
      byId('miniScore') && (byId('miniScore').textContent = s);
      byId('miniTime')  && (byId('miniTime').textContent  = t);
      byId('miniGrade') && (byId('miniGrade').textContent = g);
    }, 180);

  })();
  </script>

</body>
</html>
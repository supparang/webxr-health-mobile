<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>HeroHealth ‚Äî GoodJunkVR</title>
  <meta name="color-scheme" content="dark" />
  <link rel="icon" href="../favicon.ico" type="image/x-icon" />

  <link rel="stylesheet" href="./goodjunk-vr.css" />

  <style>
    :root{
      --sat: env(safe-area-inset-top, 0px);
      --sar: env(safe-area-inset-right, 0px);
      --sab: env(safe-area-inset-bottom, 0px);
      --sal: env(safe-area-inset-left, 0px);

      /* defaults; ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏ß‡∏±‡∏î HUD ‡πÅ‡∏•‡πâ‡∏ß‡∏ó‡∏±‡∏ö‡∏≠‡∏µ‡∏Å‡∏ó‡∏µ */
      --gj-top-safe: 140px;
      --gj-bottom-safe: 130px;
    }
    html,body{ width:100%; height:100%; margin:0; overflow:hidden; background:#020617; }
    .gj-stage{ position:fixed; inset:0; z-index:10; overflow:hidden; touch-action:manipulation; user-select:none; }
    .gj-layer{ position:absolute; inset:0; pointer-events:auto; }

    /* cVR split */
    body.view-cvr .gj-layer{ width:50%; }
    #gj-layer{ left:0; }
    #gj-layer-r{ right:0; left:auto; display:none; }
    body.view-cvr #gj-layer-r{ display:block; }

    /* cVR strict: ‡∏¢‡∏¥‡∏á‡∏à‡∏≤‡∏Å crosshair (vr-ui.js) */
    body.view-cvr .gj-target{ pointer-events:none !important; }

    .gj-hud{
      position:fixed;
      left: calc(10px + var(--sal));
      right: calc(10px + var(--sar));
      top: calc(10px + var(--sat));
      z-index: 80;
      pointer-events:none;
      font-family: system-ui,-apple-system,"Segoe UI","Noto Sans Thai",sans-serif;
      color:#e5e7eb;
    }
    .gj-hud-row{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
    .gj-pill{
      background: rgba(2,6,23,.62);
      border: 1px solid rgba(148,163,184,.22);
      border-radius: 999px;
      padding: 8px 10px;
      font-weight: 900;
      font-size: 12px;
      backdrop-filter: blur(10px);
      box-shadow: 0 18px 55px rgba(0,0,0,.35);
    }
    .gj-pill strong{ font-size: 14px; }
    .gj-spacer{ flex:1; min-width: 10px; }

    .gj-bars{ margin-top:10px; display:grid; grid-template-columns:1fr; gap:8px; }
    .gj-card{ background: rgba(2,6,23,.58); border:1px solid rgba(148,163,184,.18); border-radius:18px; padding:10px 12px; }
    .gj-card .t{ color:#94a3b8; font-weight:1000; font-size:11px; letter-spacing:.3px; }
    .gj-card .v{ font-weight:1200; font-size:14px; margin-top:4px; }
    .gj-meter{ margin-top:8px; height:10px; border-radius:999px; background: rgba(148,163,184,.16); overflow:hidden; }
    #feverFill{ height:100%; width:0%; background: rgba(34,197,94,.85); }

    #lowTimeOverlay{
      position:fixed; inset:0; z-index:160;
      display:flex; align-items:center; justify-content:center;
      background: radial-gradient(circle at center, rgba(239,68,68,.20), rgba(2,6,23,.0) 60%);
      backdrop-filter: blur(6px);
      pointer-events:none;
    }
    #lowTimeOverlay[aria-hidden="true"]{ display:none; }
    #gj-lowtime-num{ font-size:84px; font-weight:1400; color:rgba(255,255,255,.92); text-shadow:0 18px 55px rgba(0,0,0,.45); }

    a-scene{ position:fixed !important; inset:0 !important; z-index:0 !important; }
  </style>

  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>

  <!-- global modules -->
  <script defer src="../vr/particles.js"></script>
  <script defer src="../vr/hha-cloud-logger.js"></script>
  <script defer src="../vr/vr-ui.js"></script>

  <!-- boot -->
  <script type="module" src="./goodjunk-vr.boot.js"></script>
</head>

<body class="gj">
  <a-scene
    embedded
    vr-mode-ui="enabled:false"
    renderer="colorManagement:true; physicallyCorrectLights:false"
    style="background:transparent;">
    <a-entity camera look-controls="enabled:true" position="0 1.6 0"></a-entity>
  </a-scene>

  <!-- HUD (ids must match goodjunk.safe.js) -->
  <div class="gj-hud" id="gjHud" aria-hidden="false">
    <div class="gj-hud-row">
      <div class="gj-pill">SCORE <strong id="hud-score">0</strong></div>
      <div class="gj-pill">TIME <strong id="hud-time">0</strong></div>
      <div class="gj-pill">MISS <strong id="hud-miss">0</strong></div>
      <div class="gj-spacer"></div>
      <div class="gj-pill">GRADE <strong id="hud-grade">‚Äî</strong></div>
      <div class="gj-pill">üõ°Ô∏è <strong id="shieldPills">‚Äî</strong></div>
    </div>

    <div class="gj-bars">
      <div class="gj-card">
        <div class="t">GOAL</div>
        <div class="v">
          <span id="hud-goal">‚Äî</span>
          <span style="opacity:.8"> (</span><span id="hud-goal-cur">0</span><span style="opacity:.8">/</span><span id="hud-goal-target">0</span><span style="opacity:.8">)</span>
        </div>
        <div class="t" id="goalDesc" style="margin-top:6px;">‚Äî</div>
      </div>

      <div class="gj-card">
        <div class="t">MINI</div>
        <div class="v"><span id="hud-mini">‚Äî</span></div>
        <div class="t" style="margin-top:6px;">TIMER: <span id="miniTimer">‚Äî</span></div>
      </div>

      <div class="gj-card" id="gjHudBot">
        <div class="t">FEVER</div>
        <div class="v"><span id="feverText">0%</span></div>
        <div class="gj-meter"><div id="feverFill"></div></div>
      </div>
    </div>
  </div>

  <div id="lowTimeOverlay" aria-hidden="true">
    <div id="gj-lowtime-num">5</div>
  </div>

  <div class="gj-stage" id="gj-stage">
    <div class="gj-layer" id="gj-layer"></div>
    <div class="gj-layer" id="gj-layer-r"></div>
  </div>

  <!-- ‚úÖ ‡∏ß‡∏±‡∏î HUD ‡πÅ‡∏•‡πâ‡∏ß‡∏ï‡∏±‡πâ‡∏á safe-zone ‡∏Å‡∏±‡∏ô spawn ‡∏ä‡∏ô HUD -->
  <script>
    (function(){
      function px(n){ return Math.max(0, Math.floor(n||0)) + 'px'; }
      function updateSafe(){
        try{
          const sat = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--sat')) || 0;
          const hud = document.getElementById('gjHud');
          const bot = document.getElementById('gjHudBot');
          const topH = (hud?.getBoundingClientRect().height || 0);
          const botH = (bot?.getBoundingClientRect().height || 0);
          document.documentElement.style.setProperty('--gj-top-safe', px(topH + 14 + sat));
          document.documentElement.style.setProperty('--gj-bottom-safe', px(Math.max(90, botH + 18)));
        }catch(_){}
      }
      window.addEventListener('resize', updateSafe, {passive:true});
      window.addEventListener('orientationchange', updateSafe, {passive:true});
      setTimeout(updateSafe, 0);
      setTimeout(updateSafe, 120);
      setTimeout(updateSafe, 350);
    })();
  </script>
</body>
</html>
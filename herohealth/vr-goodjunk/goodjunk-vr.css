/* === /herohealth/vr-goodjunk/goodjunk-vr.css ===
GoodJunkVR (PRODUCTION) — PACK-FAIR UI + FX
✅ Big gameplay area (HUD compact)
✅ Safe-area aware + HUD-safe spawn vars: --gj-top-safe / --gj-bottom-safe
✅ Effects: pop/burst helpers (works with ../vr/particles.js)
✅ Boss/Storm/Rage body pulses (classes from safe.js)
✅ cVR: dual-eye layers (#gj-layer + #gj-layer-r) + view-cvr layout
*/

:root{
  color-scheme: dark;

  --bg:#020617;
  --panel: rgba(2,6,23,.72);
  --panel2: rgba(15,23,42,.62);
  --stroke: rgba(148,163,184,.18);

  --text:#e5e7eb;
  --muted:#94a3b8;

  --good:#22c55e;
  --bad:#ef4444;
  --warn:#f59e0b;
  --cyan:#22d3ee;
  --violet:#a78bfa;

  --r:22px;
  --r2:16px;

  /* safe-area */
  --sat: env(safe-area-inset-top, 0px);
  --sab: env(safe-area-inset-bottom, 0px);
  --sal: env(safe-area-inset-left, 0px);
  --sar: env(safe-area-inset-right, 0px);

  /* spawn-safe vars (set by html + boot safe-measure) */
  --gj-top-safe: calc(130px + var(--sat));
  --gj-bottom-safe: calc(120px + var(--sab));

  /* gameplay padding */
  --field-pad-x: 10px;
  --field-pad-y: 10px;

  /* target feel */
  --t-shadow: 0 10px 28px rgba(0,0,0,.35);
  --t-stroke: rgba(255,255,255,.12);
  --t-pop: 120ms;
}

*{ box-sizing:border-box; }
html,body{
  margin:0;
  width:100%;
  height:100%;
  overflow:hidden;
  background:
    radial-gradient(circle at top left, rgba(34,197,94,.10), transparent 55%),
    radial-gradient(circle at bottom right, rgba(34,211,238,.08), transparent 55%),
    var(--bg);
  color:var(--text);
  font-family: system-ui, -apple-system, "Segoe UI", "Noto Sans Thai", sans-serif;
}

body.gj{
  position:relative;
}

/* ---------- A-Frame scene behind UI ---------- */
a-scene{
  position:fixed !important;
  inset:0 !important;
  z-index:0 !important;
  pointer-events:none !important;
}

/* ---------- TOPBAR (compact) ---------- */
.gj-topbar{
  position:fixed;
  z-index:120;
  top:0; left:0; right:0;
  padding: calc(10px + var(--sat)) calc(12px + var(--sar)) 10px calc(12px + var(--sal));
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  pointer-events:auto;
  background: linear-gradient(to bottom, rgba(2,6,23,.82), rgba(2,6,23,.25));
  backdrop-filter: blur(10px);
  border-bottom: 1px solid rgba(148,163,184,.10);
}

.gj-topbar .left, .gj-topbar .right{
  display:flex;
  align-items:center;
  gap:8px;
}

.gj-chip{
  display:inline-flex;
  align-items:center;
  gap:10px;
  padding: 10px 12px;
  border-radius:999px;
  background: rgba(2,6,23,.55);
  border:1px solid var(--stroke);
  font-weight:1100;
  font-size:12px;
  box-shadow: 0 10px 30px rgba(0,0,0,.25);
}

.gj-btn{
  height:40px;
  padding: 0 12px;
  border-radius: 999px;
  border:1px solid rgba(148,163,184,.20);
  background: rgba(2,6,23,.50);
  color: var(--text);
  font-weight:1100;
  font-size:12px;
  cursor:pointer;
}
.gj-btn:active{ transform: translateY(1px); }
.gj-btn.primary{
  border-color: rgba(34,197,94,.35);
  background: rgba(34,197,94,.14);
  color:#eafff3;
}

/* ---------- HUD (compact, leaves room) ---------- */
.gj-hud-top{
  position:fixed;
  z-index:110;
  top: calc(56px + var(--sat));
  left: 0;
  right: 0;
  padding: 8px calc(12px + var(--sar)) 8px calc(12px + var(--sal));
  pointer-events:none;
}

.hud-row{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
}

.hud-pill{
  pointer-events:none;
  min-width: 88px;
  padding: 10px 12px;
  border-radius: 18px;
  border: 1px solid rgba(148,163,184,.18);
  background: rgba(2,6,23,.50);
  backdrop-filter: blur(10px);
  box-shadow: 0 12px 35px rgba(0,0,0,.25);
}
.hud-pill .hud-label{
  color: var(--muted);
  font-weight:1100;
  font-size:11px;
}
.hud-pill .hud-value{
  margin-top:2px;
  font-weight:1300;
  font-size:18px;
  letter-spacing:.2px;
}
.hud-pill.warn .hud-value{ color: #ffd4d4; }
.hud-pill.grade .hud-value{ color: #e7f7ff; }

.quest-row{
  margin-top:10px;
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap:10px;
}
@media (max-width: 820px){
  .quest-row{ grid-template-columns: 1fr; }
}

.quest-card{
  pointer-events:none;
  border-radius: 18px;
  border: 1px solid rgba(148,163,184,.18);
  background: rgba(15,23,42,.52);
  backdrop-filter: blur(10px);
  padding: 10px 12px;
}
.quest-card .q-title{
  font-weight:1200;
  font-size:12px;
}
.quest-card .q-desc{
  margin-top:4px;
  color: rgba(226,232,240,.92);
  font-weight:1000;
  font-size:12px;
  line-height:1.25;
}
.quest-card .q-bar{
  margin-top:8px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  color: var(--muted);
  font-weight:1000;
  font-size:11px;
}
.quest-card.goal{ border-color: rgba(34,197,94,.20); }
.quest-card.mini{ border-color: rgba(34,211,238,.18); }

/* ---------- HUD Bottom (compact, not too tall) ---------- */
.gj-hud-bot{
  position:fixed;
  z-index:110;
  left:0; right:0;
  bottom:0;
  padding: 10px calc(12px + var(--sar)) calc(10px + var(--sab)) calc(12px + var(--sal));
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  pointer-events:none;
  background: linear-gradient(to top, rgba(2,6,23,.72), rgba(2,6,23,.02));
}

.meter{
  pointer-events:none;
  flex: 1;
  min-width: 260px;
  border-radius: 18px;
  border: 1px solid rgba(148,163,184,.18);
  background: rgba(2,6,23,.52);
  backdrop-filter: blur(10px);
  padding: 10px 12px;
  box-shadow: 0 12px 35px rgba(0,0,0,.25);
}

.meter-title{
  color: var(--muted);
  font-weight:1200;
  font-size:11px;
}
.meter-bar{
  margin-top:8px;
  height: 10px;
  border-radius: 999px;
  background: rgba(148,163,184,.18);
  overflow:hidden;
}
.meter-fill{
  height:100%;
  width:0%;
  border-radius: 999px;
  background: rgba(34,197,94,.95);
  box-shadow: 0 0 0 1px rgba(255,255,255,.06) inset;
}
.meter-num{
  margin-top:8px;
  font-weight:1100;
  font-size:12px;
}
.meter-tip{
  margin-top:6px;
  color: var(--muted);
  font-weight:1000;
  font-size:11px;
}

.meter.shield .meter-shield{
  margin-top:6px;
  font-weight:1200;
  font-size:14px;
}

/* ---------- HUD hidden mode (more gameplay area) ---------- */
body.hud-hidden .gj-hud-top,
body.hud-hidden .gj-hud-bot{
  opacity:0;
  transform: translateY(-6px);
  pointer-events:none;
}
body.hud-hidden .gj-topbar{
  background: linear-gradient(to bottom, rgba(2,6,23,.55), rgba(2,6,23,.12));
}

/* ---------- PLAYFIELD ---------- */
.gj-field{
  position:fixed;
  inset:0;
  z-index:50;
  padding: var(--field-pad-y) var(--field-pad-x);
  pointer-events:none;
}

.gj-layer{
  position:absolute;
  inset:0;
  pointer-events:none;
}

.gj-layer-r{
  display:none;
}

/* cVR split: show right eye clone layer */
body.view-cvr .gj-layer-r{
  display:block;
  opacity:1;
}

/* optional: slight eye offset for depth feel in cVR */
body.view-cvr #gj-layer{ transform: translateX(-0.55%); }
body.view-cvr #gj-layer-r{ transform: translateX(0.55%); }

/* ---------- TARGETS ---------- */
.gj-target{
  position:absolute;
  transform: translate(-50%,-50%) scale(1);
  will-change: transform, opacity, filter;
  pointer-events:auto; /* tap works */
  user-select:none;
  -webkit-user-select:none;
  -webkit-tap-highlight-color: transparent;

  filter: drop-shadow(var(--t-shadow));
  text-shadow: 0 2px 0 rgba(0,0,0,.22);
  transition: transform var(--t-pop) ease, opacity 140ms ease;
}

.gj-target.spawn{
  animation: gjSpawn 160ms ease-out both;
}
@keyframes gjSpawn{
  0%{ transform: translate(-50%,-50%) scale(.72); opacity:.0; }
  100%{ transform: translate(-50%,-50%) scale(1); opacity:1; }
}

.gj-target.gone{
  opacity:0;
  transform: translate(-50%,-50%) scale(.72);
}

/* micro wobble so targets feel alive (not nauseating) */
.gj-target{
  animation: gjFloat 920ms ease-in-out infinite;
}
@keyframes gjFloat{
  0%,100%{ transform: translate(-50%,-50%) scale(1) rotate(-1deg); }
  50%{ transform: translate(-50%,-50%) scale(1.02) rotate(1deg); }
}

/* click feedback (safe.js may add body pulse; this is extra) */
body.gj .gj-target:active{
  transform: translate(-50%,-50%) scale(.92);
}

/* ---------- Missions Peek ---------- */
.gj-peek{
  position:fixed;
  z-index:160;
  left:0; right:0;
  top: calc(58px + var(--sat));
  display:flex;
  justify-content:center;
  padding: 10px calc(12px + var(--sar)) 0 calc(12px + var(--sal));
  pointer-events:none;
  opacity:0;
  transform: translateY(-6px);
  transition: opacity 180ms ease, transform 180ms ease;
}
body.show-missions .gj-peek{
  opacity:1;
  transform: translateY(0);
  pointer-events:auto;
}
.peek-card{
  width:min(620px, 92vw);
  border-radius: 18px;
  border: 1px solid rgba(148,163,184,.20);
  background: rgba(2,6,23,.74);
  backdrop-filter: blur(10px);
  padding: 12px 14px;
  box-shadow: 0 18px 45px rgba(0,0,0,.35);
}
.peek-title{
  font-weight:1300;
  font-size:14px;
}
.peek-sub, .peek-mini{
  margin-top:6px;
  color: rgba(226,232,240,.92);
  font-weight:1000;
  font-size:12px;
}
.peek-tip{
  margin-top:8px;
  color: var(--muted);
  font-weight:900;
  font-size:11px;
}

/* ---------- Low time overlay (<=5s number + ring) ---------- */
.gj-lowtime-overlay{
  position:fixed;
  z-index:170;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  pointer-events:none;
  opacity:0;
  transition: opacity 160ms ease;
}
.gj-lowtime-ring{
  width: 220px;
  height: 220px;
  border-radius: 999px;
  border: 2px solid rgba(255,255,255,.16);
  box-shadow: 0 0 0 10px rgba(239,68,68,.10), 0 30px 90px rgba(0,0,0,.35);
  background: radial-gradient(circle at center, rgba(239,68,68,.08), transparent 60%);
  animation: gjPulseRing 900ms ease-in-out infinite;
}
@keyframes gjPulseRing{
  0%,100%{ transform: scale(.98); opacity:.85; }
  50%{ transform: scale(1.03); opacity:1; }
}
.gj-lowtime-num{
  position:absolute;
  font-weight:1400;
  font-size: 84px;
  line-height:1;
  color:#fff;
  text-shadow: 0 8px 0 rgba(0,0,0,.28);
}
body.gj-lowtime .gj-lowtime-overlay{
  opacity:.0; /* show only at <=5 via aria toggle */
}
body.gj-lowtime5 .gj-lowtime-overlay{
  opacity:1;
}
body.gj-tick .gj-lowtime-num{
  animation: gjTick 120ms ease-out both;
}
@keyframes gjTick{
  0%{ transform: scale(1.0); }
  100%{ transform: scale(1.08); }
}

/* ---------- PACK-FAIR “pulse states” from safe.js ---------- */
body.gj-storm{
  animation: gjStormFlash 420ms ease-out 1;
}
@keyframes gjStormFlash{
  0%{ filter: none; }
  100%{ filter: none; }
}

body.gj-boss{
  animation: gjBossFlash 520ms ease-out 1;
}
@keyframes gjBossFlash{
  0%{ filter: none; }
  100%{ filter: none; }
}

body.gj-rage{
  animation: gjRageFlash 620ms ease-out 1;
}
@keyframes gjRageFlash{
  0%{ filter: none; }
  100%{ filter: none; }
}

body.gj-phase2{
  animation: gjPhase2Flash 520ms ease-out 1;
}
@keyframes gjPhase2Flash{
  0%{ filter: none; }
  100%{ filter: none; }
}

body.gj-mini-clear{
  animation: gjMiniFlash 220ms ease-out 1;
}
@keyframes gjMiniFlash{
  0%{ filter: none; }
  100%{ filter: none; }
}

body.gj-junk-hit{
  animation: gjJunkHit 220ms ease-out 1;
}
@keyframes gjJunkHit{
  0%{ filter: none; }
  100%{ filter: none; }
}

body.gj-good-expire{
  animation: gjExpire 160ms ease-out 1;
}
@keyframes gjExpire{
  0%{ filter: none; }
  100%{ filter: none; }
}

body.gj-end{
  animation: gjEnd 520ms ease-out 1;
}
@keyframes gjEnd{
  0%{ filter: none; }
  100%{ filter: none; }
}

/* ---------- Mobile tuning (keep gameplay open) ---------- */
@media (max-width: 520px){
  .gj-topbar{
    padding: calc(8px + var(--sat)) calc(10px + var(--sar)) 8px calc(10px + var(--sal));
  }
  .gj-btn{ height:38px; padding:0 10px; font-size:11px; }
  .gj-chip{ padding: 9px 10px; font-size:11px; }
  .gj-hud-top{
    top: calc(52px + var(--sat));
    padding: 6px calc(10px + var(--sar)) 6px calc(10px + var(--sal));
  }
  .hud-pill{ padding: 9px 10px; min-width: 78px; }
  .hud-pill .hud-value{ font-size:16px; }
  .meter{ min-width: 220px; }
}

/* ---------- Reduce motion support ---------- */
@media (prefers-reduced-motion: reduce){
  .gj-target, .gj-target.spawn, .gj-lowtime-ring{
    animation:none !important;
    transition:none !important;
  }
}
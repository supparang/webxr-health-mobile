/* === /herohealth/vr-goodjunk/goodjunk-vr.css ===
   GoodJunkVR UI — compact + overlay-lock + z-index FX — v20260217c
   Goals:
   - ลดความแน่นบนมือถือ: 2-col HUD, card compact, collapsible sections
   - เว้นพื้นที่ให้ vr-ui (ENTER VR/RECENTER) ไม่ทับ HUD
   - ล็อก overlay ให้คลิกได้/ไม่ทะลุ
   - z-index ชัด: FX < targets < HUD < overlays < vr-ui
*/

:root{
  --bg0:#060b1a;
  --bg1:#081024;

  --panel: rgba(10, 16, 40, .58);
  --panel2: rgba(10, 16, 40, .72);
  --stroke: rgba(255,255,255,.10);
  --stroke2: rgba(255,255,255,.14);

  --txt: rgba(255,255,255,.92);
  --muted: rgba(255,255,255,.72);

  /* safe-area */
  --sat: env(safe-area-inset-top, 0px);
  --sab: env(safe-area-inset-bottom, 0px);

  /* reserve bottom for vr-ui buttons */
  --vrui-reserve: 84px; /* เพิ่ม/ลดได้ตามความสูงปุ่ม */
  --hud-gap: 10px;

  /* spawn safe zones (used by safe.js) */
  --gj-top-safe: 140px;   /* กันหัว HUD */
  --gj-bottom-safe: 160px;/* กันแถบล่าง + vr-ui */
}

/* ---------- base ---------- */
html,body{
  margin:0; padding:0;
  height:100%;
  background: radial-gradient(1200px 700px at 50% 0%, rgba(90,120,255,.20), transparent 60%),
              linear-gradient(180deg, var(--bg1), var(--bg0));
  color: var(--txt);
  font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans Thai", sans-serif;
  overflow:hidden;
}

*{ box-sizing:border-box; -webkit-tap-highlight-color: transparent; }

a{ color:inherit; }
button{ font: inherit; }

/* ---------- layers/z-index ---------- */
#gj-stage{
  position:relative;
  width:100%;
  height:100%;
  overflow:hidden;
}

/* FX flash / particles (behind) */
#gj-fx, #gj-flash, #mc-flash{
  position:fixed;
  inset:0;
  pointer-events:none;
  z-index: 5;
}

/* target layers */
#gj-layer, #gj-layer-r{
  position:fixed;
  inset:0;
  z-index: 10;
  pointer-events:none; /* targets will override */
}

/* HUD wrapper */
#gj-hud{
  position:fixed;
  left: 10px;
  right: 10px;
  top: calc(10px + var(--sat));
  bottom: calc(10px + var(--sab) + var(--vrui-reserve));
  z-index: 30;
  display:flex;
  flex-direction:column;
  gap: var(--hud-gap);
  pointer-events:none; /* เปิดเฉพาะปุ่ม/การ์ดที่ต้องกด */
}

/* overlay/result */
.gj-overlay{
  position:fixed;
  inset:0;
  z-index: 60;
  display:flex;
  align-items:center;
  justify-content:center;
  background: rgba(0,0,0,.55);
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
  pointer-events:auto; /* lock */
}

/* vr-ui sits highest */
.hha-vrui, #hha-vrui, .vrui{
  z-index: 80 !important;
}

/* ---------- cards ---------- */
.gj-card{
  background: var(--panel);
  border: 1px solid var(--stroke);
  border-radius: 18px;
  box-shadow: 0 12px 28px rgba(0,0,0,.25);
  overflow:hidden;
  pointer-events:auto;
}

.gj-card .hd{
  padding: 10px 12px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
}

.gj-card .bd{
  padding: 10px 12px;
}

.gj-title{
  font-size: 14px;
  letter-spacing:.2px;
  font-weight: 750;
  color: rgba(255,255,255,.94);
}

.gj-sub{
  font-size: 12px;
  color: var(--muted);
}

/* ---------- TOP HUD: 2 columns ---------- */
#gj-topRow{
  display:grid;
  grid-template-columns: 1.1fr .9fr;
  gap: 10px;
  pointer-events:none;
}
#gj-topRow > *{ pointer-events:auto; }

/* left status stack */
#gj-statusCard .bd{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap: 8px 10px;
  padding-top: 8px;
}
.gj-pill{
  background: rgba(255,255,255,.06);
  border: 1px solid rgba(255,255,255,.10);
  border-radius: 14px;
  padding: 8px 10px;
}
.gj-pill .k{
  font-size: 11px;
  color: var(--muted);
  margin-bottom: 2px;
}
.gj-pill .v{
  font-size: 16px;
  font-weight: 800;
  letter-spacing:.2px;
}

/* right action buttons */
#gj-actionsCard .bd{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap: 8px;
}
.gj-btn{
  border-radius: 14px;
  padding: 10px 10px;
  border: 1px solid rgba(255,255,255,.14);
  background: rgba(255,255,255,.06);
  color: rgba(255,255,255,.92);
  font-weight: 750;
}
.gj-btn:active{ transform: scale(.99); }
.gj-btn.primary{
  background: rgba(0,190,120,.18);
  border-color: rgba(0,190,120,.35);
}
.gj-btn.ghost{
  background: rgba(255,255,255,.04);
}

/* ---------- progress bar (thin) ---------- */
#gjProgress{
  height: 10px;
  border-radius: 999px;
  background: rgba(255,255,255,.06);
  border: 1px solid rgba(255,255,255,.10);
  overflow:hidden;
  pointer-events:none;
}
#gjProgressFill{
  height:100%;
  width:0%;
  background: linear-gradient(90deg, rgba(120,200,255,.85), rgba(255,150,80,.9), rgba(255,70,120,.85));
}

/* ---------- QUEST row (compact + readable) ---------- */
#gj-questRow{
  display:grid;
  grid-template-columns: 1fr;
  gap: 10px;
}
#gj-questRow .bd{
  padding-top: 8px;
}
.gj-questLine{
  display:flex;
  align-items:baseline;
  justify-content:space-between;
  gap:10px;
}
.gj-questLine .left{
  min-width: 0;
}
.gj-questLine .right{
  font-weight:800;
  opacity:.95;
  white-space:nowrap;
}
.gj-questDesc{
  margin-top:6px;
  font-size: 12px;
  color: var(--muted);
  line-height: 1.25;
}

/* ---------- FEVER/SHIELD + HOWTO: collapsible ---------- */
.gj-collapser{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  cursor:pointer;
  user-select:none;
}
.gj-collapser .chev{
  opacity:.75;
  font-weight:900;
  transform: translateY(-1px);
}
.gj-collapsed .bd{ display:none; }

.gj-bar{
  height: 12px;
  border-radius: 999px;
  background: rgba(255,255,255,.06);
  border: 1px solid rgba(255,255,255,.10);
  overflow:hidden;
}
.gj-bar > i{
  display:block;
  height:100%;
  width:0%;
  background: linear-gradient(90deg, rgba(80,220,160,.95), rgba(255,210,90,.95), rgba(255,80,120,.95));
}
.gj-row{
  display:flex;
  justify-content:space-between;
  gap:10px;
  font-size: 13px;
  margin-top: 8px;
}
.gj-row .k{ color: var(--muted); }
.gj-row .v{ font-weight: 850; }

.gj-howto{
  font-size: 12px;
  color: var(--muted);
  line-height: 1.35;
}
.gj-howto b{ color: rgba(255,255,255,.92); }

/* ---------- BOSS bar (compact) ---------- */
#bossBar[aria-hidden="true"]{ display:none !important; }
#bossBar .bd{ padding-top: 8px; }

#bossFill{
  height:100%;
  width:0%;
  display:block;
  background: linear-gradient(90deg, rgba(255,90,120,.92), rgba(255,190,90,.92));
}
#bossHint{
  margin-top: 8px;
  font-size: 12px;
  color: var(--muted);
}

/* ---------- targets ---------- */
.gj-target{
  position:absolute;
  transform: translate(-50%,-50%);
  user-select:none;
  pointer-events:auto;
  filter: drop-shadow(0 10px 18px rgba(0,0,0,.35));
  will-change: transform, opacity;
}
.gj-target.spawn{ animation: gjPop .18s ease-out; }
.gj-target.gone{ animation: gjGone .14s ease-in forwards; }

@keyframes gjPop{
  from{ transform: translate(-50%,-50%) scale(.86); opacity:.0; }
  to{ transform: translate(-50%,-50%) scale(1); opacity:1; }
}
@keyframes gjGone{
  from{ transform: translate(-50%,-50%) scale(1); opacity:1; }
  to{ transform: translate(-50%,-50%) scale(.86); opacity:0; }
}

/* ---------- low time overlay (z above HUD) ---------- */
#lowTimeOverlay{
  position:fixed;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  z-index: 55;
  pointer-events:none;
  background: radial-gradient(400px 240px at 50% 40%, rgba(255,80,120,.20), transparent 70%);
}
#lowTimeOverlay[aria-hidden="true"]{ display:none; }
#gj-lowtime-num{
  font-size: 72px;
  font-weight: 950;
  letter-spacing: .5px;
  color: rgba(255,255,255,.92);
  text-shadow: 0 16px 40px rgba(0,0,0,.45);
}

/* ---------- end overlay ---------- */
#endOverlay[aria-hidden="true"]{ display:none; }
#endOverlay .panel{
  width: min(420px, calc(100vw - 28px));
  border-radius: 18px;
  background: rgba(10,16,40,.78);
  border: 1px solid rgba(255,255,255,.14);
  box-shadow: 0 18px 45px rgba(0,0,0,.45);
  padding: 14px;
}
#endOverlay .panel h2{
  margin: 0 0 6px 0;
  font-size: 18px;
}
#endOverlay .panel p{
  margin: 6px 0;
  font-size: 12px;
  color: var(--muted);
}
#endOverlay .grid{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap: 8px;
  margin-top: 10px;
}
#endOverlay .grid .gj-pill .v{ font-size: 15px; }

/* ---------- mode classes ---------- */
body.storm #gjProgressFill{
  filter: saturate(1.25) brightness(1.05);
}
body.boss #bossBar{
  border-color: rgba(255,140,90,.32);
}
body.rage{
  animation: gjRageGlow 1.2s ease-in-out infinite;
}
@keyframes gjRageGlow{
  0%,100%{ filter: none; }
  50%{ filter: saturate(1.15) contrast(1.03); }
}

/* ---------- tick / pulses ---------- */
body.gj-tick #gjProgress{
  box-shadow: 0 0 0 2px rgba(255,80,120,.22);
}
body.gj-junk-hit #gj-hud{ filter: none; }
body.gj-bomb #gj-hud{ filter: none; }

/* ---------- responsive tweaks ---------- */
@media (max-height: 740px){
  :root{
    --hud-gap: 8px;
    --vrui-reserve: 78px;
    --gj-top-safe: 132px;
    --gj-bottom-safe: 150px;
  }
  .gj-card .hd{ padding: 9px 11px; }
  .gj-card .bd{ padding: 9px 11px; }
  .gj-pill .v{ font-size: 15px; }
}

@media (max-height: 670px){
  /* จอเตี้ย: ให้ยุบการ์ดล่างอัตโนมัติ */
  #gj-feverCard .bd,
  #gj-howtoCard .bd{ display:none; }
  #gj-feverCard .hd .chev,
  #gj-howtoCard .hd .chev{ opacity:.6; }
  :root{
    --vrui-reserve: 72px;
    --gj-bottom-safe: 145px;
  }
}

/* ---------- scroll inside HUD (if needed) ---------- */
#gj-hudScroll{
  flex: 1 1 auto;
  min-height: 0;
  overflow:auto;
  padding-bottom: 6px;
  pointer-events:auto;
  scrollbar-width: none;
}
#gj-hudScroll::-webkit-scrollbar{ width:0; height:0; }
/* === /herohealth/vr-goodjunk/goodjunk-vr.css ===
GoodJunkVR CSS — PRODUCTION (targets + fx + pulses + coach UI)
FULL v20260224-fx+coach-restore
*/

:root{
  color-scheme: dark;

  --bg0:#020617;
  --panel: rgba(2,6,23,.68);
  --line: rgba(148,163,184,.18);
  --txt: rgba(229,231,235,.95);

  --good: rgba(16,185,129,.95);
  --bad: rgba(244,63,94,.92);
  --warn: rgba(251,191,36,.96);
  --vio:  rgba(99,102,241,.95);

  /* safe zones used by JS getSafeRect() */
  --gj-top-safe: 140px;
  --gj-bottom-safe: 140px;

  /* safe-area vars */
  --sat: env(safe-area-inset-top, 0px);
  --sar: env(safe-area-inset-right, 0px);
  --sab: env(safe-area-inset-bottom, 0px);
  --sal: env(safe-area-inset-left, 0px);
}

html,body{
  height:100%;
  margin:0;
  background:
    radial-gradient(1200px 800px at 18% 0%, rgba(99,102,241,.18), transparent 55%),
    radial-gradient(900px 700px at 92% 18%, rgba(34,211,238,.14), transparent 55%),
    radial-gradient(900px 700px at 60% 100%, rgba(244,63,94,.10), transparent 55%),
    var(--bg0);
  color: var(--txt);
}

body{
  overflow:hidden;
  -webkit-tap-highlight-color: transparent;
}

/* layers */
#gj-layer, #gj-layer-r{
  position:absolute;
  inset:0;
  overflow:hidden;
  touch-action: manipulation;
}

/* ---------------- targets ---------------- */
.gj-target{
  position:absolute;
  transform: translate(-50%,-50%) translateZ(0);
  will-change: transform, opacity, filter;
  user-select:none;
  cursor:pointer;
  filter: drop-shadow(0 10px 28px rgba(0,0,0,.35));
}

.gj-target.spawn{
  animation: gjSpawn 220ms ease-out forwards;
}
@keyframes gjSpawn{
  0%   { opacity:0; transform: translate(-50%,-50%) scale(.80); }
  100% { opacity:1; transform: translate(-50%,-50%) scale(1.00); }
}

.gj-target.gone{
  animation: gjGone 140ms ease-in forwards;
}
@keyframes gjGone{
  0%   { opacity:1; transform: translate(-50%,-50%) scale(1.00); }
  100% { opacity:0; transform: translate(-50%,-50%) scale(.70); }
}

/* ---------------- subtle vibe per mode ---------------- */
body.storm{
  background:
    radial-gradient(1200px 800px at 18% 0%, rgba(59,130,246,.18), transparent 55%),
    radial-gradient(900px 700px at 92% 18%, rgba(34,211,238,.14), transparent 55%),
    radial-gradient(900px 700px at 60% 100%, rgba(244,63,94,.08), transparent 55%),
    var(--bg0);
}
body.boss{
  background:
    radial-gradient(1200px 800px at 18% 0%, rgba(244,63,94,.14), transparent 55%),
    radial-gradient(900px 700px at 92% 18%, rgba(99,102,241,.12), transparent 55%),
    radial-gradient(900px 700px at 60% 100%, rgba(251,191,36,.06), transparent 55%),
    var(--bg0);
}
body.rage{
  background:
    radial-gradient(1200px 800px at 18% 0%, rgba(244,63,94,.18), transparent 55%),
    radial-gradient(900px 700px at 92% 18%, rgba(251,191,36,.10), transparent 55%),
    radial-gradient(900px 700px at 60% 100%, rgba(99,102,241,.10), transparent 55%),
    var(--bg0);
}

/* little tick on last seconds */
body.gj-tick{ animation: gjTick 120ms ease-out; }
@keyframes gjTick{
  0%{ filter:none; }
  40%{ filter: brightness(1.06); }
  100%{ filter:none; }
}

/* =========================================================
   FX — ANTI-FLASH PATCH
   (fix “flash top-left” + keep popups & shards)
========================================================= */

#gj-fx{
  position:absolute;
  inset:0;
  pointer-events:none;
  overflow:hidden;
  z-index:140;
  contain: layout paint;
  transform: translateZ(0);
}

.gj-fx,
.gj-fx-text{
  position:absolute;
  left:0;
  top:0;
  transform: translate(-50%,-50%) translateZ(0);
  will-change: transform, opacity, filter;
  pointer-events:none;
  opacity: 0;
}

/* ---- BURST ---- */
.gj-fx{
  width: 90px;
  height: 90px;
  border-radius: 999px;
  filter: drop-shadow(0 10px 24px rgba(0,0,0,.35));
  animation: gjFxPop var(--life, 340ms) ease-out forwards;
}

@keyframes gjFxPop{
  0%   { opacity: 0; transform: translate(-50%,-50%) scale(.70); }
  10%  { opacity: .95; transform: translate(-50%,-50%) scale(1.00); }
  100% { opacity: 0; transform: translate(-50%,-50%) scale(1.35); }
}

/* ---- SHARDS ---- */
.gj-fx-shards{
  width: 1px;
  height: 1px;
  filter: drop-shadow(0 10px 24px rgba(0,0,0,.25));
  animation: gjShardWrap var(--life, 520ms) ease-out forwards;
}
@keyframes gjShardWrap{
  0%   { opacity: 0; transform: translate(-50%,-50%) scale(.90); }
  10%  { opacity: 1; }
  100% { opacity: 0; transform: translate(-50%,-50%) scale(1.0); }
}

.gj-fx-shards .gj-shard{
  position:absolute;
  left:0; top:0;
  border-radius: 6px;
  opacity: .95;
  transform: translate(0,0) scale(1);
  animation: gjShardFly var(--life, 520ms) ease-out forwards;
}
@keyframes gjShardFly{
  0%   { opacity: 0; transform: translate(0,0) scale(.8) rotate(0deg); }
  10%  { opacity: .95; }
  100% { opacity: 0; transform: translate(var(--tx, 60px), var(--ty, -40px)) scale(.55) rotate(60deg); }
}

/* ---- FLOATING TEXT ---- */
.gj-fx-text{
  padding: 6px 10px;
  border-radius: 999px;
  border: 1px solid rgba(148,163,184,.18);
  background: rgba(2,6,23,.60);
  color: rgba(229,231,235,.96);
  font-weight: 1000;
  font-size: 14px;
  letter-spacing: .2px;
  text-shadow: 0 12px 30px rgba(0,0,0,.45);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  animation: gjTextFloat 640ms ease-out forwards;
}
@keyframes gjTextFloat{
  0%   { opacity: 0; transform: translate(-50%,-50%) translateY(6px) scale(.98); }
  18%  { opacity: 1; transform: translate(-50%,-50%) translateY(0px) scale(1.00); }
  100% { opacity: 0; transform: translate(-50%,-50%) translateY(-26px) scale(1.02); }
}

/* ---- Color variants ---- */
.gj-fx-good    { box-shadow: 0 0 0 2px rgba(16,185,129,.30) inset; background: radial-gradient(circle at 40% 35%, rgba(16,185,129,.55), rgba(16,185,129,.08) 60%, transparent 72%); }
.gj-fx-junk    { box-shadow: 0 0 0 2px rgba(244,63,94,.32) inset;  background: radial-gradient(circle at 40% 35%, rgba(244,63,94,.55),  rgba(244,63,94,.10) 60%, transparent 72%); }
.gj-fx-block   { box-shadow: 0 0 0 2px rgba(59,130,246,.30) inset; background: radial-gradient(circle at 40% 35%, rgba(59,130,246,.55), rgba(59,130,246,.10) 60%, transparent 72%); }
.gj-fx-star    { box-shadow: 0 0 0 2px rgba(251,191,36,.30) inset; background: radial-gradient(circle at 40% 35%, rgba(251,191,36,.60), rgba(251,191,36,.10) 60%, transparent 72%); }
.gj-fx-shield  { box-shadow: 0 0 0 2px rgba(34,211,238,.30) inset; background: radial-gradient(circle at 40% 35%, rgba(34,211,238,.60), rgba(34,211,238,.10) 60%, transparent 72%); }
.gj-fx-diamond { box-shadow: 0 0 0 2px rgba(167,139,250,.30) inset;background: radial-gradient(circle at 40% 35%, rgba(167,139,250,.60), rgba(167,139,250,.10) 60%, transparent 72%); }
.gj-fx-bomb    { box-shadow: 0 0 0 2px rgba(255,255,255,.18) inset;background: radial-gradient(circle at 40% 35%, rgba(255,255,255,.35), rgba(148,163,184,.08) 60%, transparent 72%); }
.gj-fx-defuse  { box-shadow: 0 0 0 2px rgba(16,185,129,.22) inset; background: radial-gradient(circle at 40% 35%, rgba(16,185,129,.42), rgba(16,185,129,.08) 60%, transparent 72%); }
.gj-fx-skull   { box-shadow: 0 0 0 2px rgba(244,63,94,.30) inset;  background: radial-gradient(circle at 40% 35%, rgba(244,63,94,.45), rgba(2,6,23,.18) 62%, transparent 72%); }
.gj-fx-storm   { box-shadow: 0 0 0 2px rgba(59,130,246,.26) inset; background: radial-gradient(circle at 40% 35%, rgba(59,130,246,.50), rgba(2,6,23,.12) 62%, transparent 72%); }
.gj-fx-boss    { box-shadow: 0 0 0 2px rgba(244,63,94,.34) inset;  background: radial-gradient(circle at 40% 35%, rgba(244,63,94,.50), rgba(2,6,23,.12) 62%, transparent 72%); }
.gj-fx-rage    { box-shadow: 0 0 0 2px rgba(244,63,94,.34) inset;  background: radial-gradient(circle at 40% 35%, rgba(244,63,94,.55), rgba(251,191,36,.10) 62%, transparent 72%); }
.gj-fx-tele    { box-shadow: 0 0 0 2px rgba(251,191,36,.34) inset; background: radial-gradient(circle at 40% 35%, rgba(251,191,36,.55), rgba(2,6,23,.12) 62%, transparent 72%); }
.gj-fx-burst   { box-shadow: 0 0 0 2px rgba(244,63,94,.30) inset;  background: radial-gradient(circle at 40% 35%, rgba(244,63,94,.50), rgba(2,6,23,.10) 62%, transparent 72%); }
.gj-fx-expire  { box-shadow: 0 0 0 2px rgba(244,63,94,.24) inset;  background: radial-gradient(circle at 40% 35%, rgba(244,63,94,.40), rgba(2,6,23,.12) 62%, transparent 72%); }
.gj-fx-miss    { box-shadow: 0 0 0 2px rgba(148,163,184,.22) inset; background: radial-gradient(circle at 40% 35%, rgba(148,163,184,.35), rgba(2,6,23,.12) 62%, transparent 72%); }
.gj-fx-end     { box-shadow: 0 0 0 2px rgba(99,102,241,.30) inset;  background: radial-gradient(circle at 40% 35%, rgba(99,102,241,.55), rgba(2,6,23,.14) 62%, transparent 72%); }
.gj-fx-victory { box-shadow: 0 0 0 2px rgba(16,185,129,.26) inset; background: radial-gradient(circle at 40% 35%, rgba(16,185,129,.55), rgba(2,6,23,.12) 62%, transparent 72%); }
.gj-fx-stomp   { box-shadow: 0 0 0 2px rgba(244,63,94,.30) inset;  background: radial-gradient(circle at 40% 35%, rgba(244,63,94,.55), rgba(2,6,23,.12) 62%, transparent 72%); }
.gj-fx-storm,
.gj-fx-boss,
.gj-fx-rage,
.gj-fx-tele,
.gj-fx-burst{ filter: drop-shadow(0 14px 34px rgba(0,0,0,.45)); }

/* text borders */
.gj-fx-text.t-good   { border-color: rgba(16,185,129,.28); }
.gj-fx-text.t-bad    { border-color: rgba(244,63,94,.30); }
.gj-fx-text.t-block  { border-color: rgba(59,130,246,.30); }
.gj-fx-text.t-star   { border-color: rgba(251,191,36,.30); }
.gj-fx-text.t-shield { border-color: rgba(34,211,238,.30); }
.gj-fx-text.t-diamond{ border-color: rgba(167,139,250,.30); }
.gj-fx-text.t-danger { border-color: rgba(244,63,94,.34); }
.gj-fx-text.t-defuse { border-color: rgba(16,185,129,.26); }
.gj-fx-text.t-storm  { border-color: rgba(59,130,246,.26); }
.gj-fx-text.t-miss   { border-color: rgba(148,163,184,.22); }

/* ---- Body pulse classes used by JS ---- */
body.gj-pulse-hurt    { animation: gjPulseHurt 220ms ease-out; }
body.gj-pulse-block   { animation: gjPulseBlock 120ms ease-out; }
body.gj-pulse-star    { animation: gjPulseStar 120ms ease-out; }
body.gj-pulse-shield  { animation: gjPulseShield 120ms ease-out; }
body.gj-pulse-diamond { animation: gjPulseDiamond 140ms ease-out; }
body.gj-pulse-danger  { animation: gjPulseDanger 260ms ease-out; }
body.gj-pulse-explode { animation: gjPulseExplode 360ms ease-out; }
body.gj-pulse-defuse  { animation: gjPulseDefuse 160ms ease-out; }
body.gj-miss-shot     { animation: gjPulseMiss 120ms ease-out; }
body.gj-storm         { animation: gjPulseStorm 240ms ease-out; }
body.gj-boss          { animation: gjPulseBoss 280ms ease-out; }
body.gj-rage          { animation: gjPulseRage 320ms ease-out; }
body.gj-tele          { animation: gjPulseTele 180ms ease-out; }
body.gj-burst         { animation: gjPulseBurst 240ms ease-out; }
body.gj-boss-down     { animation: gjPulseVictory 260ms ease-out; }
body.gj-stomp         { animation: gjPulseDanger 240ms ease-out; }

@keyframes gjPulseHurt    { 0%{ filter: none; } 30%{ filter: brightness(1.06) saturate(1.10); } 100%{ filter:none; } }
@keyframes gjPulseBlock   { 0%{ filter: none; } 40%{ filter: brightness(1.04); } 100%{ filter:none; } }
@keyframes gjPulseStar    { 0%{ filter: none; } 40%{ filter: brightness(1.05); } 100%{ filter:none; } }
@keyframes gjPulseShield  { 0%{ filter: none; } 40%{ filter: brightness(1.05); } 100%{ filter:none; } }
@keyframes gjPulseDiamond { 0%{ filter: none; } 40%{ filter: brightness(1.06); } 100%{ filter:none; } }
@keyframes gjPulseDanger  { 0%{ filter: none; } 35%{ filter: brightness(1.07) contrast(1.04); } 100%{ filter:none; } }
@keyframes gjPulseExplode { 0%{ filter: none; } 25%{ filter: brightness(1.10) contrast(1.06); } 100%{ filter:none; } }
@keyframes gjPulseDefuse  { 0%{ filter: none; } 40%{ filter: brightness(1.05); } 100%{ filter:none; } }
@keyframes gjPulseMiss    { 0%{ filter: none; } 45%{ filter: brightness(1.03); } 100%{ filter:none; } }
@keyframes gjPulseStorm   { 0%{ filter: none; } 30%{ filter: brightness(1.05); } 100%{ filter:none; } }
@keyframes gjPulseBoss    { 0%{ filter: none; } 30%{ filter: brightness(1.06); } 100%{ filter:none; } }
@keyframes gjPulseRage    { 0%{ filter: none; } 25%{ filter: brightness(1.08) saturate(1.10); } 100%{ filter:none; } }
@keyframes gjPulseTele    { 0%{ filter: none; } 35%{ filter: brightness(1.06); } 100%{ filter:none; } }
@keyframes gjPulseBurst   { 0%{ filter: none; } 30%{ filter: brightness(1.06); } 100%{ filter:none; } }
@keyframes gjPulseVictory { 0%{ filter: none; } 30%{ filter: brightness(1.06); } 100%{ filter:none; } }

/* =========================================================
   COACH overlay (listens hha:coach)
========================================================= */

#gj-coach{
  position: fixed;
  left: calc(var(--sal) + 10px);
  bottom: calc(var(--sab) + 10px);
  z-index: 260;
  pointer-events: none;
  display: flex;
  gap: 10px;
  align-items: flex-end;
  opacity: 0;
  transform: translateY(10px);
  transition: opacity 160ms ease, transform 160ms ease;
}
#gj-coach.is-show{
  opacity: 1;
  transform: translateY(0px);
}

.gj-coach-face{
  width: 64px;
  height: 64px;
  border-radius: 16px;
  border: 1px solid rgba(148,163,184,.18);
  background: rgba(2,6,23,.55);
  box-shadow: 0 12px 32px rgba(0,0,0,.35);
  object-fit: cover;
}

.gj-coach-bubble{
  max-width: min(520px, 78vw);
  border-radius: 16px;
  border: 1px solid rgba(148,163,184,.18);
  background: rgba(2,6,23,.72);
  color: rgba(229,231,235,.95);
  box-shadow: 0 14px 44px rgba(0,0,0,.40);
  padding: 10px 12px;
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
}
.gj-coach-title{
  font-weight: 1000;
  letter-spacing: .2px;
  font-size: 12px;
  opacity: .9;
}
.gj-coach-msg{
  margin-top: 6px;
  font-weight: 900;
  font-size: 13px;
  line-height: 1.25;
}

@media (max-width:520px){
  .gj-coach-face{ width:56px; height:56px; border-radius: 14px; }
  .gj-coach-msg{ font-size: 12.5px; }
}
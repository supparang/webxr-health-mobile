<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>HeroHealth ‚Äî Hydration VR</title>
  <meta name="color-scheme" content="dark" />
  <link rel="icon" href="./favicon.ico" type="image/x-icon" />

  <link rel="stylesheet" href="./hydration-vr/hydration-vr.css" />

  <!-- A-Frame (for ENTER VR / EXIT / RECENTER reliability) -->
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>

  <!-- FX + Universal VR UI -->
  <script src="./vr/particles.js" defer></script>
  <script src="./vr/vr-ui.js" defer></script>
</head>

<body class="hydration">

  <!-- Minimal A-Frame scene: helps WebXR Enter VR on mobile -->
  <a-scene
    embedded
    vr-mode-ui="enabled: false"
    renderer="antialias: true; colorManagement: true"
    style="position:fixed; inset:0; z-index:1; pointer-events:none; opacity:0.0001;">
    <a-entity position="0 0 -1"></a-entity>
  </a-scene>

  <!-- ================== HUD ================== -->
  <header class="hud" id="hud">
    <div class="hud-left">
      <div class="stat">
        <div class="label">SCORE</div>
        <div class="value" id="stat-score">0</div>
      </div>
      <div class="stat">
        <div class="label">COMBO</div>
        <div class="value" id="stat-combo">0</div>
      </div>
      <div class="stat">
        <div class="label">MISS</div>
        <div class="value" id="stat-miss">0</div>
      </div>
    </div>

    <div class="hud-mid">
      <div class="pill">
        <span class="label">TIME</span>
        <span class="value" id="stat-time">0</span>
      </div>
      <div class="pill">
        <span class="label">GRADE</span>
        <span class="value" id="stat-grade">C</span>
      </div>
      <div class="pill">
        <span class="label">STORM</span>
        <span class="value" id="storm-left">0</span>
      </div>
      <div class="pill">
        <span class="label">üõ°Ô∏è</span>
        <span class="value" id="shield-count">0</span>
      </div>
    </div>

    <div class="hud-right water">
      <div class="water-title">
        <span>WATER</span>
        <span class="water-meta"><b id="water-pct">50</b>% ‚Ä¢ <b id="water-zone">GREEN</b></span>
      </div>
      <div class="water-track">
        <div class="water-bar" id="water-bar" style="width:50%"></div>
      </div>
    </div>
  </header>

  <!-- ================== QUEST ================== -->
  <section class="quest" id="quest">
    <div class="quest-title">üéØ Mission</div>
    <div class="quest-line" id="quest-line1">Stage 1/3: ...</div>
    <div class="quest-line" id="quest-line2">...</div>
    <div class="quest-line" id="quest-line3">...</div>
    <div class="quest-line" id="quest-line4">...</div>
  </section>

  <!-- ================== PLAY AREA ================== -->
  <main class="stage" id="stage">
    <!-- PC/Mobile single layer -->
    <div class="playfield" id="playfield">
      <div class="layer" id="hydration-layer"></div>
    </div>

    <!-- Cardboard split layers (hidden until enter VR) -->
    <div class="cb" id="cb">
      <div class="cb-eye" id="cbPlayfield">
        <div class="cb-half cb-left">
          <div class="layer" id="hydration-layerL"></div>
        </div>
        <div class="cb-half cb-right">
          <div class="layer" id="hydration-layerR"></div>
        </div>
      </div>
    </div>
  </main>

  <!-- ================== START OVERLAY ================== -->
  <div class="overlay" id="startOverlay">
    <div class="panel">
      <div class="hero">üíß</div>
      <h2>Hydration VR</h2>
      <p>
        ‡∏¢‡∏¥‡∏á üíß ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏∏‡∏°‡∏ô‡πâ‡∏≥‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà <b>GREEN</b><br/>
        ‡πÄ‡∏Å‡πá‡∏ö üõ°Ô∏è ‡πÑ‡∏ß‡πâ <b>BLOCK</b> ‡∏ä‡πà‡∏ß‡∏á‡∏û‡∏≤‡∏¢‡∏∏ (Storm Mini)<br/>
        ‡∏ä‡πà‡∏ß‡∏á‡∏ó‡πâ‡∏≤‡∏¢‡∏û‡∏≤‡∏¢‡∏∏‡∏à‡∏∞‡∏°‡∏µ <b>BOSS WINDOW</b> (‡∏£‡∏∞‡∏ß‡∏±‡∏á ‚ú® decoy)
      </p>
      <div class="actions">
        <button class="btn primary" id="btnStart">START</button>
        <a class="btn ghost btnBackHub" href="./hub.html">‡∏Å‡∏•‡∏±‡∏ö HUB</a>
      </div>
      <div class="hint">
        * ‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥: PC / Mobile / Cardboard VR (Enter VR)
      </div>
    </div>
  </div>

  <!-- ================== RESULT SUMMARY ================== -->
  <div class="result-backdrop" id="resultBackdrop" hidden>
    <div class="result">
      <div class="result-head">
        <div>
          <div class="result-title">‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•</div>
          <div class="result-sub">Hydration VR ‚Ä¢ Session</div>
        </div>
        <div class="result-tier" id="rTier">Tier: -</div>
      </div>

      <div class="grid">
        <div class="card">
          <div class="k">Score</div><div class="v" id="rScore">0</div>
        </div>
        <div class="card">
          <div class="k">Grade</div><div class="v" id="rGrade">C</div>
        </div>
        <div class="card">
          <div class="k">Accuracy</div><div class="v" id="rAcc">0%</div>
        </div>
        <div class="card">
          <div class="k">Combo Max</div><div class="v" id="rComboMax">0</div>
        </div>
        <div class="card">
          <div class="k">Miss</div><div class="v" id="rMiss">0</div>
        </div>
        <div class="card">
          <div class="k">Goals</div><div class="v" id="rGoals">0/1</div>
        </div>
        <div class="card">
          <div class="k">Minis</div><div class="v" id="rMinis">0/0</div>
        </div>
        <div class="card">
          <div class="k">Green Hold</div><div class="v" id="rGreen">0s</div>
        </div>
        <div class="card">
          <div class="k">Streak Max</div><div class="v" id="rStreak">0</div>
        </div>
        <div class="card">
          <div class="k">Storm</div><div class="v"><span id="rStormOk">0</span>/<span id="rStormCycles">0</span> (<span id="rStormRate">0%</span>)</div>
        </div>
      </div>

      <div class="tips">
        <div class="tips-title">üí° Tips</div>
        <pre class="tips-body" id="rTips"></pre>
        <div class="next">
          <div class="next-title">üéØ Next Goal</div>
          <div class="next-body" id="rNext"></div>
        </div>
      </div>

      <div class="result-actions">
        <button class="btn primary" id="btnRetry">‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
        <button class="btn ghost" id="btnCloseSummary">‡∏õ‡∏¥‡∏î</button>
        <button class="btn ghost" id="btnCopyJSON">Copy JSON</button>
        <button class="btn ghost" id="btnDownloadCSV">Download CSV</button>
        <button class="btn ghost btnBackHub">‡∏Å‡∏•‡∏±‡∏ö HUB</button>
      </div>
    </div>
  </div>

  <!-- ================== BOOT ================== -->
  <script type="module" src="./hydration-vr/hydration-vr.loader.js"></script>
  <script>
    // Start overlay -> start game
    (function(){
      const btn = document.getElementById('btnStart');
      const ov  = document.getElementById('startOverlay');
      if (btn){
        btn.addEventListener('click', ()=>{
          try{ ov.classList.add('hide'); }catch(_){}
          try{ window.dispatchEvent(new CustomEvent('hha:start')); }catch(_){}
        });
      }
    })();
  </script>
</body>
</html>
<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>HeroHealth ‚Äî Hydration Quest VR</title>
  <meta name="color-scheme" content="dark" />
  <link rel="icon" href="../favicon.ico" type="image/x-icon" />

  <!-- Global FX + Logger (IIFE) -->
  <script src="../vr/particles.js" defer></script>
  <script src="../vr/hha-cloud-logger.js" defer></script>

  <style>
    :root{
      --bg:#020617;
      --panel:rgba(2,6,23,.78);
      --panel2:rgba(15,23,42,.70);
      --stroke:rgba(148,163,184,.22);
      --text:#e5e7eb;
      --muted:#94a3b8;
      --accent:#22c55e;
      --warn:#f59e0b;
      --bad:#fb7185;

      --safe-top: env(safe-area-inset-top, 0px);
      --safe-bottom: env(safe-area-inset-bottom, 0px);
      --safe-left: env(safe-area-inset-left, 0px);
      --safe-right: env(safe-area-inset-right, 0px);
    }

    html, body{ height:100%; background:var(--bg); margin:0; }
    body{
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans Thai", sans-serif;
      color: var(--text);
      overflow:hidden;
      touch-action: manipulation;
    }

    /* ===== Bounds (full-screen) ===== */
    #hvr-bounds{
      position:fixed; inset:0;
      overflow:hidden;
    }

    /* ===== VR feel playfield (moves) ===== */
    #hvr-playfield{
      position:absolute; inset:0;
      transform: translate3d(0,0,0);
      will-change: transform;
    }

    /* ===== Spawn Layer ===== */
    #hvr-layer{
      position:absolute;
      inset:0;
      pointer-events:none; /* targets are pointer-events:auto inside */
      transform: translateZ(0);
    }
    #hvr-layer .hvr-target{ pointer-events:auto; }

    /* ===== Crosshair ===== */
    #hvr-crosshair{
      position:fixed;
      left:50%; top:52%;
      transform:translate(-50%,-50%);
      z-index:60;
      width:42px; height:42px;
      border-radius:999px;
      border:2px solid rgba(255,255,255,.35);
      box-shadow: 0 0 0 6px rgba(34,197,94,.10), 0 12px 30px rgba(0,0,0,.35);
      pointer-events:none;
    }
    #hvr-crosshair:before, #hvr-crosshair:after{
      content:"";
      position:absolute;
      left:50%; top:50%;
      transform:translate(-50%,-50%);
      background: rgba(255,255,255,.60);
      border-radius:999px;
    }
    #hvr-crosshair:before{ width:2px; height:18px; }
    #hvr-crosshair:after { width:18px; height:2px; }
    #hvr-crosshair .dot{
      position:absolute; left:50%; top:50%;
      transform:translate(-50%,-50%);
      width:8px; height:8px;
      border-radius:999px;
      background: rgba(250,204,21,.90);
      box-shadow: 0 0 18px rgba(250,204,21,.55);
    }

    /* ===== HUD ===== */
    #hha-hud{
      position:fixed;
      inset:0;
      z-index:70;
      pointer-events:none;
      padding-top: calc(var(--safe-top) + 10px);
      padding-left: calc(var(--safe-left) + 10px);
      padding-right: calc(var(--safe-right) + 10px);
      padding-bottom: calc(var(--safe-bottom) + 10px);
      display:flex;
      flex-direction:column;
      gap:10px;
    }
    .hud-row{
      display:flex;
      gap:10px;
      justify-content:space-between;
      align-items:flex-start;
    }
    .hud-card{
      pointer-events:none;
      background: var(--panel);
      border:1px solid var(--stroke);
      border-radius:16px;
      padding:10px 12px;
      box-shadow: 0 18px 40px rgba(0,0,0,.35);
      backdrop-filter: blur(10px);
    }
    .hud-title{ font-size:12px; color:var(--muted); margin-bottom:6px; }
    .hud-value{ font-size:18px; font-weight:900; letter-spacing:.02em; }

    #hud-left{ display:flex; gap:10px; }
    #hud-right{ display:flex; gap:10px; justify-content:flex-end; }

    /* water gauge */
    #hha-water-card{ min-width:180px; }
    .water-bar{
      width:180px; height:10px;
      background: rgba(255,255,255,.08);
      border-radius:999px;
      overflow:hidden;
      border:1px solid rgba(255,255,255,.10);
      box-shadow: inset 0 10px 18px rgba(0,0,0,.25);
    }
    .water-fill{
      height:100%;
      width:50%;
      background: linear-gradient(90deg, rgba(34,197,94,.92), rgba(34,197,94,.55));
      border-radius:999px;
      transition: width .18s ease;
    }
    .water-zone{
      margin-top:6px;
      font-size:12px;
      color: rgba(255,255,255,.86);
      font-weight:800;
    }

    /* bottom row */
    #hud-bottom{
      margin-top:auto;
      display:flex;
      justify-content:space-between;
      align-items:flex-end;
      gap:10px;
    }
    #hha-coach{
      display:flex;
      gap:10px;
      align-items:flex-end;
      max-width: 64%;
    }
    #coach-bubble{
      background: var(--panel2);
      border:1px solid var(--stroke);
      border-radius:16px;
      padding:10px 12px;
      box-shadow: 0 18px 40px rgba(0,0,0,.35);
      backdrop-filter: blur(10px);
      font-size:14px;
      font-weight:800;
      line-height:1.25;
    }
    #coach-sub{
      margin-top:6px;
      font-size:12px;
      font-weight:700;
      color: var(--muted);
    }

    /* Start overlay */
    #hvr-start{
      position:fixed; inset:0;
      z-index:100;
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 22px;
      background: radial-gradient(1200px 800px at 50% 35%, rgba(34,197,94,.10), rgba(2,6,23,1));
    }
    .start-card{
      width:min(520px, 100%);
      border-radius:22px;
      padding:18px 16px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(2,6,23,.75);
      box-shadow: 0 30px 80px rgba(0,0,0,.55);
      backdrop-filter: blur(12px);
    }
    .start-title{ font-size:20px; font-weight:1000; margin:0 0 6px; }
    .start-desc{ font-size:13px; color:var(--muted); margin:0 0 14px; line-height:1.4; }
    .btn-row{ display:flex; gap:10px; flex-wrap:wrap; }
    .btn{
      pointer-events:auto;
      appearance:none;
      border:none;
      border-radius:14px;
      padding:12px 14px;
      font-weight:900;
      letter-spacing:.02em;
      cursor:pointer;
      background: rgba(34,197,94,.92);
      color:#052e16;
      box-shadow: 0 18px 40px rgba(34,197,94,.20);
    }
    .btn.alt{
      background: rgba(255,255,255,.10);
      color: rgba(255,255,255,.92);
      border: 1px solid rgba(255,255,255,.14);
    }
    .hint{
      margin-top:10px;
      font-size:12px;
      color: rgba(255,255,255,.70);
      line-height:1.35;
    }

    /* End overlay */
    #hvr-end{
      position:fixed; inset:0;
      z-index:110;
      display:none;
      align-items:center;
      justify-content:center;
      padding:22px;
      background: radial-gradient(1200px 800px at 50% 35%, rgba(250,204,21,.10), rgba(2,6,23,1));
    }
    #hvr-end.show{ display:flex; }
    .end-card{
      width:min(560px, 100%);
      border-radius:22px;
      padding:16px 16px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(2,6,23,.76);
      box-shadow: 0 30px 80px rgba(0,0,0,.55);
      backdrop-filter: blur(12px);
    }
    .end-title{ font-size:18px; font-weight:1000; margin:0 0 8px; }
    .end-grid{
      display:grid;
      grid-template-columns: repeat(2, minmax(0,1fr));
      gap:10px;
      margin-top:10px;
    }
    .end-item{
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.06);
      border-radius:16px;
      padding:10px 12px;
    }
    .end-k{ font-size:12px; color:var(--muted); margin-bottom:4px; }
    .end-v{ font-size:18px; font-weight:1000; }

    /* ===== STAMP overlay ===== */
    #hvr-stamp{
      position:fixed;
      left:50%; top:42%;
      transform:translate(-50%,-50%);
      z-index:120;
      pointer-events:none;
      display:none;
    }
    #hvr-stamp.show{ display:block; }
    .stamp-card{
      width:min(520px, 92vw);
      border-radius:26px;
      padding:18px 18px;
      background: rgba(2,6,23,.72);
      border: 1px solid rgba(255,255,255,.14);
      box-shadow: 0 34px 90px rgba(0,0,0,.62);
      backdrop-filter: blur(14px);
      position:relative;
      overflow:hidden;
    }
    .stamp-glow{
      position:absolute;
      inset:-40%;
      background: radial-gradient(circle at 30% 25%, rgba(250,204,21,.22), rgba(34,197,94,.10), rgba(2,6,23,0) 62%);
      filter: blur(10px);
      transform: rotate(12deg);
      pointer-events:none;
    }
    .stamp-row{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:10px;
      position:relative;
      z-index:2;
    }
    .stamp-grade{
      font-size:54px;
      font-weight:1100;
      letter-spacing:.02em;
      line-height:1;
      margin:0;
      text-shadow: 0 16px 34px rgba(0,0,0,.55);
    }
    .stamp-sub{
      font-size:13px;
      color: rgba(255,255,255,.76);
      font-weight:800;
      margin-top:8px;
      line-height:1.25;
    }
    .stamp-badge{
      padding:10px 12px;
      border-radius:18px;
      background: rgba(255,255,255,.08);
      border: 1px solid rgba(255,255,255,.14);
      font-weight:1000;
      letter-spacing:.03em;
      text-align:right;
      min-width: 150px;
      box-shadow: inset 0 1px 0 rgba(255,255,255,.12);
    }
    .stamp-badge .k{ font-size:12px; color:var(--muted); font-weight:900; }
    .stamp-badge .v{ font-size:16px; margin-top:4px; }
  </style>
</head>

<body>
  <!-- bounds (full-screen) -->
  <div id="hvr-bounds">
    <div id="hvr-playfield">
      <div id="hvr-layer"></div>
    </div>
  </div>

  <div id="hvr-crosshair"><div class="dot"></div></div>

  <!-- HUD -->
  <div id="hha-hud">
    <div class="hud-row">
      <div id="hud-left">
        <div id="hha-score-card" class="hud-card" data-hha-exclude="1">
          <div class="hud-title">SCORE</div>
          <div class="hud-value" id="hud-score">0</div>
        </div>
        <div id="hha-combo-card" class="hud-card" data-hha-exclude="1">
          <div class="hud-title">COMBO</div>
          <div class="hud-value" id="hud-combo">0</div>
        </div>
      </div>

      <div id="hud-right">
        <div id="hha-water-card" class="hud-card" data-hha-exclude="1">
          <div class="hud-title">WATER BALANCE</div>
          <div class="water-bar"><div class="water-fill" id="water-fill"></div></div>
          <div class="water-zone" id="water-zone">OK</div>
        </div>
        <div id="hha-time-card" class="hud-card" data-hha-exclude="1">
          <div class="hud-title">TIME</div>
          <div class="hud-value" id="hud-time">60</div>
        </div>
      </div>
    </div>

    <div id="hud-bottom">
      <div id="hha-coach" data-hha-exclude="1">
        <div id="coach-bubble">
          <div id="coach-text">‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥‡πÉ‡∏´‡πâ‡∏™‡∏°‡∏î‡∏∏‡∏•! üíß</div>
          <div id="coach-sub">‡πÅ‡∏ï‡∏∞‡πÄ‡∏õ‡πâ‡∏≤‡∏ô‡πâ‡∏≥ / ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°‡∏´‡∏ß‡∏≤‡∏ô</div>
        </div>
      </div>

      <div class="hud-card" data-hha-exclude="1">
        <div class="hud-title">MISS</div>
        <div class="hud-value" id="hud-miss">0</div>
      </div>
    </div>
  </div>

  <!-- Start overlay -->
  <div id="hvr-start">
    <div class="start-card">
      <h1 class="start-title">Hydration Quest VR üíß</h1>
      <p class="start-desc">
        ‡πÄ‡∏õ‡πâ‡∏≤‡∏à‡∏∞‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏ó‡∏±‡πà‡∏ß‡∏à‡∏≠‡πÅ‡∏ö‡∏ö VR-feel ‡πÅ‡∏•‡πâ‡∏ß‡∏ô‡∏∞ ‚úÖ<br>
        ‚Ä¢ ‡πÅ‡∏ï‡∏∞ ‚Äúüíß‚Äù ‡πÑ‡∏î‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô ‚Ä¢ ‡πÅ‡∏ï‡∏∞ ‚Äúü•§/üç©‚Äù ‡∏à‡∏∞‡πÄ‡∏™‡∏µ‡∏¢‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô<br>
        ‚Ä¢ Perfect ‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á‡πÑ‡∏î‡πâ‡πÇ‡∏ö‡∏ô‡∏±‡∏™ ‚Ä¢ ‡∏°‡∏µ Powerup ‡πÇ‡∏ú‡∏•‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡∏¢‡∏∞
      </p>
      <div class="btn-row">
        <button class="btn" id="btn-start">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô</button>
        <button class="btn alt" id="btn-motion">‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï Motion (iOS)</button>
      </div>
      <div class="hint">
        Tips: ‡∏ñ‡πâ‡∏≤‡πÄ‡∏•‡πà‡∏ô‡∏ö‡∏ô iPhone ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏î ‚Äú‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï Motion‚Äù ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô
      </div>
    </div>
  </div>

  <!-- End overlay -->
  <div id="hvr-end" class="">
    <div class="end-card">
      <div class="end-title">‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•</div>
      <div class="end-grid">
        <div class="end-item"><div class="end-k">Score</div><div class="end-v" id="end-score">0</div></div>
        <div class="end-item"><div class="end-k">Max Combo</div><div class="end-v" id="end-combo">0</div></div>
        <div class="end-item"><div class="end-k">Miss</div><div class="end-v" id="end-miss">0</div></div>
        <div class="end-item"><div class="end-k">Grade</div><div class="end-v" id="end-grade">B</div></div>
      </div>
      <div class="btn-row" style="margin-top:14px;">
        <button class="btn" id="btn-restart">‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
        <button class="btn alt" id="btn-close-end">‡∏õ‡∏¥‡∏î</button>
      </div>
    </div>
  </div>

  <!-- Stamp overlay -->
  <div id="hvr-stamp">
    <div class="stamp-card" id="stamp-card">
      <div class="stamp-glow"></div>
      <div class="stamp-row">
        <div>
          <div class="stamp-grade" id="stamp-grade">SSS</div>
          <div class="stamp-sub" id="stamp-sub">Hydration Master ‚ú®</div>
        </div>
        <div class="stamp-badge">
          <div class="k">SCORE</div>
          <div class="v" id="stamp-score">0</div>
        </div>
      </div>
      <!-- odometer number host (JS will replace) -->
      <div data-stamp-number="1" id="stamp-odo-host"
           style="margin-top:10px; display:flex; justify-content:center; align-items:center;"></div>
    </div>
  </div>

  <!-- Game (module) -->
  <script type="module" src="./hydration.safe.js"></script>
</body>
</html>
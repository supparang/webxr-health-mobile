<!-- === /herohealth/hygiene-vr.html ===
HygieneVR Launcher ‚Äî ROOT (HHA Standard)
PATCH v20260215a
‚úÖ Choose View: pc/mobile/vr/cvr
‚úÖ Choose Run: practice (15s warmup) / play
‚úÖ Choose Diff/Time/Seed
‚úÖ Remembers last settings (localStorage)
‚úÖ Pass-through hub/studyId/phase/conditionGroup/style/log/pid etc.
‚úÖ Sends to: ./hygiene-vr/hygiene-vr.html
-->
<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>HeroHealth ‚Äî HygieneVR Launcher</title>
  <meta name="color-scheme" content="dark" />
  <link rel="icon" href="./favicon.ico" type="image/x-icon" />
  <style>
    :root{
      color-scheme: dark;
      --bg:#020617; --panel:rgba(2,6,23,.78); --stroke:rgba(148,163,184,.18);
      --text:#e5e7eb; --muted:#94a3b8;
      --good:#22c55e; --cyan:#22d3ee; --warn:#f59e0b; --bad:#ef4444;
      --sat: env(safe-area-inset-top, 0px); --sab: env(safe-area-inset-bottom, 0px);
      --sal: env(safe-area-inset-left, 0px); --sar: env(safe-area-inset-right, 0px);
      --r:22px;
    }
    *{box-sizing:border-box}
    html,body{margin:0;height:100%;background:var(--bg);color:var(--text);
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial}
    .wrap{min-height:100%;display:grid;place-items:center;
      padding:calc(18px + var(--sat)) calc(16px + var(--sar)) calc(18px + var(--sab)) calc(16px + var(--sal))}
    .card{
      width:min(860px,100%);
      border:1px solid var(--stroke);
      background: rgba(2,6,23,.72);
      border-radius: var(--r);
      padding: 16px;
      box-shadow: 0 24px 90px rgba(0,0,0,.55);
    }
    .title{font-weight:950;font-size:18px;letter-spacing:.2px}
    .sub{color:rgba(148,163,184,.95);margin-top:6px;font-size:13px;line-height:1.35}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:12px}
    @media (max-width:720px){ .grid{grid-template-columns:1fr;} }
    .box{
      border:1px solid var(--stroke);
      background: rgba(15,23,42,.55);
      border-radius: 18px;
      padding: 12px;
    }
    .box h3{margin:0;font-size:13px;font-weight:950;letter-spacing:.2px}
    .row{display:flex;flex-wrap:wrap;gap:8px;margin-top:10px}
    .chip{
      border-radius: 999px;
      border:1px solid rgba(148,163,184,.18);
      background: rgba(2,6,23,.55);
      color: rgba(229,231,235,.95);
      padding: 8px 10px;
      font-weight:900;
      cursor:pointer;
      user-select:none;
    }
    .chip.on{border-color: rgba(34,211,238,.26); background: rgba(34,211,238,.12);}
    .chip.good.on{border-color: rgba(34,197,94,.30); background: rgba(34,197,94,.14);}
    .chip.warn.on{border-color: rgba(245,158,11,.30); background: rgba(245,158,11,.14);}
    .chip.bad.on{border-color: rgba(239,68,68,.30); background: rgba(239,68,68,.14);}
    .field{display:flex;gap:10px;align-items:center;margin-top:10px;flex-wrap:wrap}
    label{font-size:12px;color:rgba(148,163,184,.95);font-weight:900}
    input{
      background: rgba(2,6,23,.55);
      border:1px solid rgba(148,163,184,.18);
      color: rgba(229,231,235,.95);
      border-radius: 14px;
      padding: 10px 12px;
      font-weight:900;
      width: 160px;
      max-width: 100%;
    }
    .actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:14px}
    .btn{
      border-radius: 16px;
      border:1px solid rgba(148,163,184,.18);
      background: rgba(15,23,42,.72);
      color: rgba(229,231,235,.95);
      padding: 10px 12px;
      font-weight:950;
      cursor:pointer;
    }
    .btn.primary{ background: rgba(34,197,94,.18); border-color: rgba(34,197,94,.28); }
    .btn.cyan{ background: rgba(34,211,238,.14); border-color: rgba(34,211,238,.24); }
    code{color:rgba(34,197,94,.95)}
    .hint{margin-top:10px;font-size:12px;color:rgba(148,163,184,.95);line-height:1.4}
  </style>
</head>
<body>
<div class="wrap">
  <div class="card">
    <div class="title">üßº HygieneVR ‚Äî Handwash Survival (Launcher)</div>
    <div class="sub">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏°‡∏∏‡∏°‡∏°‡∏≠‡∏á + ‡πÇ‡∏´‡∏°‡∏î + ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏Å ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏Å‡∏° (‡∏à‡∏≥‡∏Ñ‡πà‡∏≤‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥)</div>

    <div class="grid">
      <div class="box">
        <h3>VIEW</h3>
        <div class="row" id="viewRow"></div>
        <div class="hint">‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: <code>mobile</code> ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á, <code>cvr</code> ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Cardboard/‡∏¢‡∏¥‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏à‡∏≠</div>
      </div>

      <div class="box">
        <h3>RUN MODE</h3>
        <div class="row" id="runRow"></div>
        <div class="hint"><code>practice</code> = ‡∏ß‡∏≠‡∏£‡πå‡∏°‡∏≠‡∏±‡∏õ 15s ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏Å‡∏°‡∏à‡∏£‡∏¥‡∏á (‡∏•‡∏î‡∏Ñ‡πâ‡∏≤‡∏á/‡∏•‡∏î‡∏á‡∏á)</div>
      </div>

      <div class="box">
        <h3>DIFFICULTY</h3>
        <div class="row" id="diffRow"></div>

        <div class="field">
          <label for="timeInp">TIME (sec)</label>
          <input id="timeInp" type="number" min="20" max="9999" step="1" />
          <label for="seedInp">SEED</label>
          <input id="seedInp" type="number" step="1" />
          <button class="btn" id="btnRandSeed" type="button">‡∏™‡∏∏‡πà‡∏° seed</button>
        </div>
        <div class="hint">‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô <code>research</code> ‡∏Ñ‡∏ß‡∏£‡∏•‡πá‡∏≠‡∏Å seed; ‡∏ñ‡πâ‡∏≤‡πÄ‡∏•‡πà‡∏ô‡∏™‡∏ô‡∏∏‡∏Å ‡∏™‡∏∏‡πà‡∏°‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢</div>
      </div>

      <div class="box">
        <h3>HUB / PASS-THROUGH</h3>
        <div class="hint">
          ‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ run ‡πÄ‡∏ä‡πà‡∏ô
          <code>hub, studyId, phase, conditionGroup, style, log, pid</code>
          (‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏õ‡∏∞‡∏à‡∏≤‡∏Å HUB ‡∏°‡∏≤‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢)
        </div>
      </div>
    </div>

    <div class="actions">
      <button class="btn primary" id="btnGo" type="button">‚ñ∂ ‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏Å‡∏°</button>
      <button class="btn cyan" id="btnGoPractice" type="button">üß™ Practice 15s ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏Å‡∏°‡∏à‡∏£‡∏¥‡∏á</button>
      <button class="btn" id="btnHub" type="button">‚Ü© ‡∏Å‡∏•‡∏±‡∏ö HUB</button>
    </div>

    <div class="hint" id="preview">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏•‡∏¥‡∏á‡∏Å‡πå‚Ä¶</div>
  </div>
</div>

<script>
(function(){
  'use strict';

  const LS_KEY = 'HHA_LAUNCH_HYGIENE_VR';
  const RUN_URL = './hygiene-vr/hygiene-vr.html';

  const qs = (k, d=null)=>{ try{ return new URL(location.href).searchParams.get(k) ?? d; }catch(_){ return d; } };

  const hubDefault = String(qs('hub','./hub.html'));
  const pass = new URL(location.href);

  function detectView(){
    const isTouch = ('ontouchstart' in window) || (navigator.maxTouchPoints|0) > 0;
    const w = Math.max(1, innerWidth||1);
    const h = Math.max(1, innerHeight||1);
    const landscape = w >= h;
    if (isTouch){
      if (landscape && w >= 740) return 'cvr';
      return 'mobile';
    }
    return 'pc';
  }

  function loadState(){
    try{
      const s = localStorage.getItem(LS_KEY);
      if(!s) return null;
      const o = JSON.parse(s);
      return o && typeof o==='object' ? o : null;
    }catch(_){ return null; }
  }
  function saveState(o){
    try{ localStorage.setItem(LS_KEY, JSON.stringify(o)); }catch(_){}
  }

  const state = Object.assign({
    view: detectView(),
    run: 'play',
    diff: 'normal',
    time: 70,
    seed: Date.now()
  }, loadState() || {});

  const viewRow = document.getElementById('viewRow');
  const runRow  = document.getElementById('runRow');
  const diffRow = document.getElementById('diffRow');
  const timeInp = document.getElementById('timeInp');
  const seedInp = document.getElementById('seedInp');
  const preview = document.getElementById('preview');

  const VIEWS = [
    {k:'pc',    t:'üñ•Ô∏è pc'},
    {k:'mobile',t:'üì± mobile'},
    {k:'vr',    t:'ü•Ω vr'},
    {k:'cvr',   t:'üì¶ cvr'}
  ];
  const RUNS = [
    {k:'play',    t:'‚ñ∂ play', cls:'good'},
    {k:'practice',t:'üß™ practice', cls:'cyan'}
  ];
  const DIFFS = [
    {k:'easy',  t:'üôÇ easy', cls:'good'},
    {k:'normal',t:'üòé normal', cls:'cyan'},
    {k:'hard',  t:'üî• hard', cls:'warn'}
  ];

  function mkChip(item, groupKey){
    const b = document.createElement('button');
    b.type='button';
    b.className = 'chip ' + (item.cls || '');
    b.textContent = item.t;
    b.dataset.k = item.k;
    b.addEventListener('click', ()=>{
      state[groupKey] = item.k;
      render();
      persist();
    });
    return b;
  }

  function persist(){
    saveState({ view:state.view, run:state.run, diff:state.diff, time:state.time, seed:state.seed });
  }

  function buildUrl(overrideRun){
    const u = new URL(RUN_URL, location.href);

    // pass-through all params from current URL
    pass.searchParams.forEach((v,k)=> u.searchParams.set(k,v));

    // ensure hub exists
    if(!u.searchParams.get('hub')) u.searchParams.set('hub', hubDefault);

    // apply launcher choices
    u.searchParams.set('view', state.view);
    u.searchParams.set('run', overrideRun || state.run);
    u.searchParams.set('diff', state.diff);
    u.searchParams.set('time', String(Math.max(20, Number(state.time)||70)));
    u.searchParams.set('seed', String(Number(state.seed)||Date.now()));

    return u.toString();
  }

  function render(){
    // rows
    viewRow.innerHTML = '';
    VIEWS.forEach(it=>{
      const c = mkChip(it,'view');
      if(state.view===it.k) c.classList.add('on');
      viewRow.appendChild(c);
    });

    runRow.innerHTML = '';
    RUNS.forEach(it=>{
      const c = mkChip(it,'run');
      if(state.run===it.k) c.classList.add('on');
      runRow.appendChild(c);
    });

    diffRow.innerHTML = '';
    DIFFS.forEach(it=>{
      const c = mkChip(it,'diff');
      if(state.diff===it.k) c.classList.add('on');
      diffRow.appendChild(c);
    });

    timeInp.value = String(state.time);
    seedInp.value = String(state.seed);

    preview.textContent = 'Preview: ' + buildUrl();
  }

  // input binds
  timeInp.addEventListener('change', ()=>{
    state.time = Math.max(20, Number(timeInp.value)||70);
    render(); persist();
  });
  seedInp.addEventListener('change', ()=>{
    state.seed = Number(seedInp.value)||Date.now();
    render(); persist();
  });
  document.getElementById('btnRandSeed')?.addEventListener('click', ()=>{
    state.seed = Date.now();
    render(); persist();
  });

  // actions
  document.getElementById('btnGo')?.addEventListener('click', ()=>{
    persist();
    location.href = buildUrl(state.run);
  });

  document.getElementById('btnGoPractice')?.addEventListener('click', ()=>{
    // force practice first
    persist();
    location.href = buildUrl('practice');
  });

  document.getElementById('btnHub')?.addEventListener('click', ()=>{
    location.href = hubDefault;
  });

  render();
})();
</script>
</body>
</html>
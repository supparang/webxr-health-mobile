<!-- === /herohealth/plate-vr.html === -->
<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>HeroHealth ‚Äî Balanced Plate VR</title>
  <meta name="color-scheme" content="dark light" />
  <link rel="icon" href="./favicon.ico" type="image/x-icon" />

  <!-- Plate CSS -->
  <link rel="stylesheet" href="./plate/plate-vr.css" />

  <!-- A-Frame (minimal scene for Enter VR reliability) -->
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>

  <!-- Universal VR UI (ENTER VR/EXIT/RECENTER + crosshair + tap-to-shoot -> hha:shoot) -->
  <script>
    // allow vr-ui to tune lock/cooldown if you want
    window.HHA_VRUI_CONFIG = { lockPx: 28, cooldownMs: 90 };
  </script>
  <script src="./vr/vr-ui.js" defer></script>

  <!-- Cloud logger (optional, if you use ?log= endpoint) -->
  <script src="./vr/hha-cloud-logger.js" defer></script>

  <!-- Plate engine -->
  <script src="./plate/plate.safe.js" defer></script>

</head>

<body class="view-mobile">

  <!-- ===== A-Frame scene (only for Enter VR) ===== -->
  <a-scene
    embedded
    renderer="colorManagement:true; physicallyCorrectLights:false"
    vr-mode-ui="enabled:false"
    style="position:fixed; inset:0; z-index:0; pointer-events:none;"
  >
    <a-entity camera position="0 1.6 0"></a-entity>
    <a-sky color="#020617"></a-sky>
  </a-scene>

  <!-- ===== Game Play Layer ===== -->
  <div id="plate-layer" aria-label="Plate play layer"></div>

  <!-- FX overlay -->
  <div id="hitFx" aria-hidden="true"></div>

  <!-- ===== HUD TOP (Goal + Mini) ===== -->
  <div id="hudTop" class="hud-top" aria-label="HUD Top">
    <div class="hud-chip hud-goal">
      <div class="hud-title">GOAL</div>
      <div class="hud-row">
        <div id="uiGoalTitle" class="hud-main">‚Äî</div>
        <div id="uiGoalCount" class="hud-count">0/0</div>
      </div>
      <div class="hud-bar">
        <div id="uiGoalFill" class="hud-fill"></div>
      </div>
    </div>

    <div class="hud-chip hud-mini">
      <div class="hud-title">MINI</div>
      <div class="hud-row">
        <div id="uiMiniTitle" class="hud-main">‚Äî</div>
        <div class="hud-right">
          <span id="uiMiniTime" class="hud-count">--</span>
          <span id="uiMiniCount" class="hud-count">0/1</span>
        </div>
      </div>
      <div class="hud-bar">
        <div id="uiMiniFill" class="hud-fill"></div>
      </div>
    </div>
  </div>

  <!-- ===== MINI PANEL (hint) ===== -->
  <div id="miniPanel" class="mini-panel" aria-label="Mini panel">
    <div class="mini-hint">
      <div class="mini-tag">Hint</div>
      <div id="uiHint" class="mini-text">‡πÅ‡∏ï‡∏∞‡πÄ‡∏õ‡πâ‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡πá‡∏ö‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö 5 ‡∏´‡∏°‡∏π‡πà</div>
    </div>
  </div>

  <!-- ===== COACH PANEL ===== -->
  <div id="coachPanel" class="coach-panel" aria-label="Coach panel">
    <div class="coach-card">
      <img id="coachImg" class="coach-img" src="./img/coach-neutral.png" alt="Coach" />
      <div class="coach-bubble">
        <div class="coach-name">Coach</div>
        <div id="coachMsg" class="coach-msg">‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏•‡πà‡∏ô‡πÅ‡∏•‡πâ‡∏ß! üéØ</div>
      </div>
    </div>
  </div>

  <!-- ===== HUD BUTTONS / STATS ===== -->
  <div id="hudBtns" class="hud-btns" aria-label="HUD buttons">
    <div class="stats">
      <div class="stat">
        <div class="k">SCORE</div>
        <div id="uiScore" class="v">0</div>
      </div>
      <div class="stat">
        <div class="k">COMBO</div>
        <div id="uiCombo" class="v">0</div>
      </div>
      <div class="stat">
        <div class="k">MAX</div>
        <div id="uiComboMax" class="v">0</div>
      </div>
      <div class="stat">
        <div class="k">MISS</div>
        <div id="uiMiss" class="v">0</div>
      </div>
      <div class="stat">
        <div class="k">ACC</div>
        <div id="uiAcc" class="v">0%</div>
      </div>
      <div class="stat">
        <div class="k">GRADE</div>
        <div id="uiGrade" class="v">C</div>
      </div>
      <div class="stat">
        <div class="k">TIME</div>
        <div id="uiTime" class="v">0</div>
      </div>
      <div class="stat">
        <div class="k">PLATE</div>
        <div id="uiPlateHave" class="v">0</div>
      </div>
    </div>

    <div class="bars">
      <div class="bar fever">
        <div class="bar-head">
          <span>FEVER</span>
          <span class="muted">üî•</span>
        </div>
        <div class="bar-track">
          <div id="uiFeverFill" class="bar-fill"></div>
        </div>
      </div>

      <div class="bar shield">
        <div class="bar-head">
          <span>SHIELD</span>
          <span class="muted">üõ°Ô∏è x <b id="uiShieldN">0</b></span>
        </div>
      </div>
    </div>

    <div class="groups">
      <div class="g">ü•¶ <span id="uiG1">0</span></div>
      <div class="g">üçé <span id="uiG2">0</span></div>
      <div class="g">üêü <span id="uiG3">0</span></div>
      <div class="g">üçö <span id="uiG4">0</span></div>
      <div class="g">ü•ë <span id="uiG5">0</span></div>
    </div>

    <div class="actions">
      <button id="btnPause" class="btn ghost" type="button">‚è∏ Pause</button>
      <button id="btnRestart" class="btn ghost" type="button">‚Üª Restart</button>
      <button id="btnBackHub" class="btn danger" type="button">‚üµ Back HUB</button>
      <button id="btnEnterVR" class="btn" type="button">Enter VR</button>
    </div>
  </div>

  <!-- ===== PAUSE OVERLAY ===== -->
  <div id="hudPaused" class="overlay" style="display:none;" aria-hidden="true">
    <div class="overlay-card">
      <div class="overlay-title">Paused</div>
      <div class="overlay-text">‡πÅ‡∏ï‡∏∞‡∏õ‡∏∏‡πà‡∏° Pause ‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô‡∏ï‡πà‡∏≠</div>
    </div>
  </div>

  <!-- ===== START OVERLAY ===== -->
  <div id="startOverlay" class="start-overlay" aria-hidden="false">
    <div class="start-card">
      <div class="brand">HeroHealth</div>
      <div class="title">Balanced Plate VR</div>
      <div class="sub">
        <span>Mode: <b id="uiRunPreview">play</b></span>
        <span>Diff: <b id="uiDiffPreview">normal</b></span>
        <span>Time: <b id="uiTimePreview">90</b>s</span>
      </div>

      <div class="tips">
        <div class="tip">üéØ ‡πÅ‡∏ï‡∏∞/‡∏¢‡∏¥‡∏á‡πÄ‡∏õ‡πâ‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡πá‡∏ö ‚Äú‡∏≠‡∏≤‡∏´‡∏≤‡∏£ 5 ‡∏´‡∏°‡∏π‡πà‚Äù ‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö</div>
        <div class="tip">üõ°Ô∏è ‡πÄ‡∏Å‡πá‡∏ö‡πÇ‡∏•‡πà‡πÑ‡∏ß‡πâ‡∏Å‡∏±‡∏ô ‚Äú‡∏Ç‡∏¢‡∏∞‚Äù ‡πÄ‡∏ß‡∏•‡∏≤‡πÇ‡∏´‡∏î</div>
        <div class="tip">üå™Ô∏è ‡∏°‡∏µ STORM ‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏≠‡∏ö ‡πÜ (‡∏ô‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô MINI)</div>
        <div class="tip">üëπ ‡∏°‡∏µ BOSS ‡∏ä‡πà‡∏ß‡∏á‡∏ó‡πâ‡∏≤‡∏¢ (‡πÄ‡∏â‡∏û‡∏≤‡∏∞ play)</div>
      </div>

      <div class="start-actions">
        <button id="btnStart" class="btn primary" type="button">Start</button>
        <button id="btnBackHub2" class="btn ghost" type="button" onclick="location.href=new URL(location.href).searchParams.get('hub')||'./hub.html'">Back HUB</button>
      </div>

      <div class="note">
        <span class="muted">Tip:</span> ‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠/‡∏Ñ‡∏≤‡∏£‡πå‡∏î‡∏ö‡∏≠‡∏£‡πå‡∏î ‡πÉ‡∏ä‡πâ crosshair ‡∏¢‡∏¥‡∏á‡πÑ‡∏î‡πâ (‡πÅ‡∏ï‡∏∞‡∏à‡∏≠)
      </div>
    </div>
  </div>

  <!-- ===== BOSS HUD (IDs must match plate.safe.js) ===== -->
  <div id="bossHud" class="boss-hud" style="display:none;" aria-hidden="true">
    <div class="boss-card">
      <div id="bossTitle" class="boss-title">üëπ BOSS</div>
      <div id="bossHint" class="boss-hint">‡∏´‡πâ‡∏≤‡∏°‡πÇ‡∏î‡∏ô‡∏Ç‡∏¢‡∏∞! ‡πÄ‡∏Å‡πá‡∏ö GOOD ‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤</div>
      <div id="bossProg" class="boss-prog">10s ‚Ä¢ GOOD 0/8</div>
    </div>
  </div>
  <div id="bossFx" class="boss-fx" style="display:none;" aria-hidden="true"></div>

  <!-- ===== STORM HUD (IDs must match plate.safe.js) ===== -->
  <div id="stormHud" class="storm-hud" style="display:none;" aria-hidden="true">
    <div class="storm-card">
      <div id="stormTitle" class="storm-title">üå™Ô∏è STORM</div>
      <div id="stormHint" class="storm-hint">‡πÄ‡∏Å‡πá‡∏ö GOOD ‡πÉ‡∏´‡πâ‡∏ó‡∏±‡∏ô!</div>
      <div id="stormProg" class="storm-prog">6s ‚Ä¢ GOOD 0/9</div>
    </div>
  </div>
  <div id="stormFx" class="storm-fx" style="display:none;" aria-hidden="true"></div>

  <!-- ===== RESULT OVERLAY ===== -->
  <div id="resultBackdrop" class="result-backdrop" style="display:none;" aria-hidden="true">
    <div class="result-card">
      <div class="result-head">
        <div class="result-title">Summary</div>
        <div class="result-mode">Mode: <b id="rMode">play</b></div>
      </div>

      <div class="result-main">
        <div class="grade">GRADE <span id="rGrade" class="grade-badge">C</span></div>
        <div class="grid">
          <div class="cell"><div class="k">Score</div><div id="rScore" class="v">0</div></div>
          <div class="cell"><div class="k">Max Combo</div><div id="rMaxCombo" class="v">0</div></div>
          <div class="cell"><div class="k">Miss</div><div id="rMiss" class="v">0</div></div>
          <div class="cell"><div class="k">Perfect</div><div id="rPerfect" class="v">0%</div></div>
          <div class="cell"><div class="k">Goals</div><div id="rGoals" class="v">0/0</div></div>
          <div class="cell"><div class="k">Minis</div><div id="rMinis" class="v">0/0</div></div>
        </div>

        <div class="plate-break">
          <div class="k">Food Groups</div>
          <div class="groups2">
            <div>ü•¶ <b id="rG1">0</b></div>
            <div>üçé <b id="rG2">0</b></div>
            <div>üêü <b id="rG3">0</b></div>
            <div>üçö <b id="rG4">0</b></div>
            <div>ü•ë <b id="rG5">0</b></div>
            <div class="muted">Total: <b id="rGTotal">0</b></div>
          </div>
        </div>
      </div>

      <div class="result-actions">
        <button id="btnPlayAgain" class="btn primary" type="button">Play Again</button>
        <button id="btnBackHub3" class="btn ghost" type="button" onclick="location.href=new URL(location.href).searchParams.get('hub')||'./hub.html'">Back HUB</button>
      </div>
    </div>
  </div>

</body>
</html>
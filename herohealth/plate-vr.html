<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>HeroHealth ‚Äî Balanced Plate VR</title>
  <meta name="color-scheme" content="dark" />
  <link rel="icon" href="./favicon.ico" type="image/x-icon" />

  <!-- A-Frame -->
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>

  <!-- Global FX + Compat Input + Cloud Logger -->
  <script src="./vr/particles.js" defer></script>
  <script src="./vr/hha-compat-input.js" defer></script>
  <script src="./vr/hha-cloud-logger.js" defer></script>

  <style>
    :root{
      --bg:#020617;
      --panel:rgba(2,6,23,.72);
      --panel2:rgba(15,23,42,.68);
      --stroke:rgba(148,163,184,.22);
      --text:#e5e7eb;
    }
    html,body{ margin:0; height:100%; background:radial-gradient(1200px 700px at 50% 0%, rgba(56,189,248,.08), transparent 55%), var(--bg); color:var(--text); overflow:hidden; }
    a-scene{ position:fixed; inset:0; z-index:1; }

    /* HUD shells (Safezone anchors) */
    #hudTop, #hudLeft, #hudRight, #hudBottom{
      position:fixed; z-index:900;
      pointer-events:none;
    }
    #hudTop{ left:10px; right:10px; top:10px; }
    #hudLeft{ left:10px; top:126px; width:min(560px, 86vw); }
    #hudRight{ right:10px; top:126px; width:160px; }
    #hudBottom{ left:10px; right:10px; bottom:10px; }

    .card{
      background:var(--panel);
      border:1px solid var(--stroke);
      border-radius:18px;
      padding:10px 12px;
      backdrop-filter: blur(10px);
      box-shadow:0 18px 40px rgba(0,0,0,.30);
    }
    .row{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
    .row + .row{ margin-top:10px; }

    .chip{
      display:inline-flex; align-items:center; gap:8px;
      padding:10px 12px;
      border-radius:999px;
      background:rgba(2,6,23,.50);
      border:1px solid rgba(148,163,184,.18);
      font-weight:1000;
      letter-spacing:.02em;
      min-width:140px;
      justify-content:center;
    }
    .chip b{ font-size:18px; }

    .pill{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 10px;
      border-radius:999px;
      background:rgba(2,6,23,.55);
      border:1px solid rgba(148,163,184,.18);
      font-weight:1000;
      letter-spacing:.02em;
    }
    .pill .k{ opacity:.85; }
    .pill .v{ font-size:16px; }

    /* Quest panels */
    .hTitle{
      display:flex; align-items:center; gap:10px;
      font-size:22px; font-weight:1100; letter-spacing:.02em;
      margin-bottom:8px;
    }
    .hTitle .ico{ font-size:22px; }
    .small{ opacity:.85; font-weight:900; line-height:1.25; }

    /* Buttons (right) */
    .btn{
      pointer-events:auto;
      display:flex; align-items:center; justify-content:center; gap:10px;
      width:100%;
      padding:12px 12px;
      border-radius:14px;
      border:1px solid rgba(148,163,184,.20);
      background:rgba(2,6,23,.62);
      color:var(--text);
      font-weight:1100;
      box-shadow:0 18px 40px rgba(0,0,0,.22);
      user-select:none;
    }
    .btn + .btn{ margin-top:10px; }
    #hudPaused{
      margin-top:10px;
      padding:10px 12px;
      border-radius:14px;
      background:rgba(250,204,21,.10);
      border:1px solid rgba(250,204,21,.22);
      font-weight:1100;
      display:none;
      pointer-events:none;
      text-align:center;
    }

    /* Fever bar */
    .barWrap{
      position:relative;
      height:10px;
      border-radius:999px;
      background:rgba(148,163,184,.14);
      border:1px solid rgba(148,163,184,.20);
      overflow:hidden;
      width:100%;
    }
    #hudFever{
      position:absolute; left:0; top:0; bottom:0;
      width:0%;
      background:rgba(250,204,21,.85);
      box-shadow:0 0 20px rgba(250,204,21,.22);
    }

    /* Result overlay */
    #resultBackdrop{
      position:fixed; inset:0;
      display:none;
      z-index:999;
      background:rgba(2,6,23,.72);
      backdrop-filter: blur(8px);
      pointer-events:auto;
    }
    #resultCard{
      position:absolute; left:50%; top:50%;
      transform:translate(-50%,-50%);
      width:min(720px, 92vw);
      background:rgba(2,6,23,.84);
      border:1px solid rgba(148,163,184,.25);
      border-radius:20px;
      box-shadow:0 24px 60px rgba(0,0,0,.45);
      padding:14px 14px;
    }
    .grid{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:10px;
      margin-top:10px;
    }
    .kv{
      padding:10px 12px;
      border-radius:14px;
      border:1px solid rgba(148,163,184,.18);
      background:rgba(15,23,42,.46);
      font-weight:1000;
      display:flex; justify-content:space-between; gap:10px;
    }
    .kv span{ opacity:.85; font-weight:900; }
    .kv b{ font-size:18px; }
    .wide{ grid-column:1 / -1; }
    #btnPlayAgain{ margin-top:12px; }
    #tipCard{ opacity:.92; }

    /* keep bottom VR badge style */
    #vrBadge{
      position:fixed;
      right:12px;
      bottom:92px;
      z-index:905;
      pointer-events:none;
      background:rgba(255,255,255,.92);
      color:#0b1220;
      padding:6px 10px;
      border-radius:10px;
      font-weight:1100;
    }
  </style>
</head>
<body>

  <!-- A-Frame scene (‡πÉ‡∏ä‡πâ‡πÅ‡∏Ñ‡πà‡∏°‡∏∏‡∏°‡∏°‡∏≠‡∏á/‡∏´‡∏°‡∏∏‡∏ô‡∏Å‡∏•‡πâ‡∏≠‡∏á) -->
  <a-scene embedded vr-mode-ui="enabled: true" renderer="colorManagement: true">
    <a-entity id="rig">
      <a-camera id="cam" position="0 1.6 0" look-controls="enabled: true"></a-camera>
    </a-entity>
  </a-scene>

  <!-- HUD TOP -->
  <div id="hudTop">
    <div class="card">
      <div class="row">
        <div class="chip">‚è±Ô∏è TIME <b id="hudTime">--</b></div>
        <div class="chip">‚≠ê SCORE <b id="hudScore">0</b></div>
      </div>

      <div class="row">
        <div class="chip">üî• COMBO <b id="hudCombo">0</b></div>
        <div class="chip">üí• MISS <b id="hudMiss">0</b></div>
      </div>

      <div class="row">
        <div class="pill" style="flex:1; min-width:240px;">
          <span class="k">FEVER</span>
          <div class="barWrap"><div id="hudFever"></div></div>
          <span id="hudFeverPct" class="v">0%</span>
        </div>
        <div class="pill">üèÖ <span class="k">GRADE</span> <span id="hudGrade" class="v">C</span></div>
        <div class="pill">üéØ <span class="k">PERFECT</span> <span id="hudPerfectCount" class="v">0</span></div>
        <div class="pill">üçΩÔ∏è <span class="k">HAVE</span> <span id="hudGroupsHave" class="v">0/5</span></div>
        <!-- ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡πÅ‡∏ñ‡∏ß‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡πâ JS inject SHIELD/LIVES/POWER ‡πÑ‡∏î‡πâ‡πÅ‡∏ô‡πà -->
        <div class="row pills" style="width:100%; gap:8px; margin-top:10px;"></div>
      </div>
    </div>
  </div>

  <!-- HUD LEFT (QUEST) -->
  <div id="hudLeft">
    <div class="card" style="margin-bottom:10px;">
      <div class="hTitle"><span class="ico">üéØ</span> QUEST</div>
      <div id="hudGoalLine" class="small">Goal ‚Ä¶</div>
    </div>

    <div id="miniPanel" class="card">
      <div class="hTitle"><span class="ico">üß©</span> MINI</div>
      <div id="hudMiniLine" class="small">MINI ‚Ä¶</div>
      <div id="hudMiniHint" class="small" style="margin-top:6px;">‚Ä¶</div>
    </div>
  </div>

  <!-- HUD RIGHT (BUTTONS) -->
  <div id="hudRight">
    <button id="btnEnterVR" class="btn">ü•Ω ENTER VR</button>
    <button id="btnPause" class="btn">‚è∏Ô∏è PAUSE</button>
    <button id="btnRestart" class="btn">üîÅ RESTART</button>
    <div id="hudPaused">‚è∏Ô∏è PAUSED</div>
    <div id="vrBadge">VR</div>
  </div>

  <!-- HUD BOTTOM (TIP) -->
  <div id="hudBottom">
    <div id="tipCard" class="card">
      <div class="small"><b>Tip</b></div>
      <div class="small" style="margin-top:6px;">
        ‡πÅ‡∏ï‡∏∞‡∏ï‡∏£‡∏á‡πÑ‡∏´‡∏ô‡∏Å‡πá‡πÑ‡∏î‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏¥‡∏á (Tap-anywhere) ‚Ä¢ ‡∏´‡∏°‡∏∏‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô VR ‚Ä¢ ‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏Ç‡∏¢‡∏∞!
      </div>
    </div>
  </div>

  <!-- RESULT OVERLAY (‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å) -->
  <div id="resultBackdrop">
    <div id="resultCard">
      <div class="hTitle"><span class="ico">üèÅ</span> RESULT</div>

      <div class="grid">
        <div class="kv"><span>MODE</span> <b id="rMode">‚Äî</b></div>
        <div class="kv"><span>GRADE</span> <b id="rGrade">‚Äî</b></div>

        <div class="kv"><span>SCORE</span> <b id="rScore">0</b></div>
        <div class="kv"><span>MAX COMBO</span> <b id="rMaxCombo">0</b></div>

        <div class="kv"><span>MISS</span> <b id="rMiss">0</b></div>
        <div class="kv"><span>PERFECT</span> <b id="rPerfect">0</b></div>

        <div class="kv"><span>GOALS</span> <b id="rGoals">0/2</b></div>
        <div class="kv"><span>MINIS</span> <b id="rMinis">0/7</b></div>

        <div class="kv"><span>G1</span> <b id="rG1">0</b></div>
        <div class="kv"><span>G2</span> <b id="rG2">0</b></div>
        <div class="kv"><span>G3</span> <b id="rG3">0</b></div>
        <div class="kv"><span>G4</span> <b id="rG4">0</b></div>
        <div class="kv"><span>G5</span> <b id="rG5">0</b></div>
        <div class="kv"><span>TOTAL</span> <b id="rGTotal">0</b></div>

        <div class="wide">
          <button id="btnPlayAgain" class="btn">‚ñ∂Ô∏è PLAY AGAIN</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Game module -->
  <script type="module" src="./plate/plate.safe.js"></script>
</body>
</html>
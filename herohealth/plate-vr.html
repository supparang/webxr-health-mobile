<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Hero Health ‚Äî VR Nutrition Hub</title>
  <meta name="color-scheme" content="light dark" />
  <link rel="icon" href="./favicon.ico" type="image/x-icon">

  <style>
    :root{
      color-scheme: dark;
      --bg-main:#020617;
      --panel:#020617;
      --panel-soft:#0b1120;
      --accent:#22c55e;
      --accent-blue:#38bdf8;
      --text-main:#e5e7eb;
      --text-soft:#9ca3af;
      --radius-lg:18px;
      --radius-pill:999px;
    }
    *{ box-sizing:border-box; }

    body{
      margin:0;
      min-height:100vh;
      font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
      background:
        radial-gradient(circle at top left, rgba(56,189,248,0.16), transparent 55%),
        radial-gradient(circle at bottom right, rgba(34,197,94,0.22), transparent 55%),
        var(--bg-main);
      color:var(--text-main);
      padding:16px 10px 24px;
    }

    .shell{ max-width:1120px; margin:0 auto; }
    header{
      display:flex; flex-wrap:wrap; align-items:flex-start; justify-content:space-between;
      gap:12px; margin-bottom:16px;
    }
    .title{ font-size:clamp(1.5rem, 3vw, 1.9rem); font-weight:800; letter-spacing:.04em; text-transform:uppercase; }
    .subtitle{ font-size:13px; color:var(--text-soft); }

    .pill{
      font-size:11px; padding:4px 10px; border-radius:999px;
      border:1px solid rgba(148,163,184,0.45);
      background:rgba(15,23,42,0.9);
      display:inline-flex; align-items:center; gap:6px; color:var(--text-soft);
    }
    .pill span.emoji{ font-size:16px; }

    .card{
      background:linear-gradient(135deg, rgba(15,23,42,0.96), rgba(15,23,42,0.9));
      border-radius:var(--radius-lg);
      border:1px solid rgba(148,163,184,0.26);
      box-shadow:0 20px 40px rgba(15,23,42,0.9);
      padding:14px 16px;
    }

    .zones{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(280px,1fr));
      gap:14px;
      margin-top:16px;
    }

    .zone-header{
      display:flex; justify-content:space-between; align-items:center; gap:8px;
      margin-bottom:10px;
    }
    .zone-title{
      font-size:13px; text-transform:uppercase; letter-spacing:.16em;
      color:var(--text-soft);
    }
    .zone-tag{
      font-size:11px; padding:3px 9px; border-radius:999px;
      border:1px solid rgba(34,197,94,0.7);
      background:rgba(22,163,74,0.16); color:#bbf7d0;
      display:inline-flex; align-items:center; gap:4px;
    }
    .zone-tag.research{
      border-color:rgba(59,130,246,0.8);
      background:rgba(37,99,235,0.18);
      color:#bfdbfe;
    }

    .game-list{ display:flex; flex-direction:column; gap:10px; }

    .game-card{
      border-radius:16px;
      border:1px solid rgba(148,163,184,0.3);
      background:radial-gradient(circle at top left, rgba(34,197,94,0.16), transparent 55%), rgba(15,23,42,0.95);
      padding:8px 10px;
      display:grid;
      grid-template-columns:minmax(0,1.4fr) minmax(0,1.2fr);
      gap:6px 10px;
      align-items:center;
    }
    .game-card.research{
      background:radial-gradient(circle at top left, rgba(59,130,246,0.2), transparent 55%), rgba(15,23,42,0.95);
    }

    .game-name{ font-size:13px; font-weight:600; display:flex; align-items:center; gap:6px; }
    .game-name span.emoji{ font-size:18px; }
    .game-desc{ font-size:11px; color:var(--text-soft); }

    .game-controls{
      display:flex; flex-direction:column; align-items:flex-end; gap:4px; font-size:11px;
    }
    .game-row{ display:flex; gap:6px; align-items:center; justify-content:flex-end; flex-wrap:wrap; }
    .pill-small{
      font-size:10px; padding:2px 7px; border-radius:999px;
      border:1px solid rgba(148,163,184,0.45);
      color:var(--text-soft);
      background:rgba(15,23,42,0.9);
    }
    .select-small{
      width:auto; min-width:90px; max-width:120px;
      font-size:11px; padding:4px 8px; border-radius:999px;
      border:1px solid rgba(30,64,175,0.6);
      background:rgba(15,23,42,0.9);
      color:var(--text-main);
      outline:none;
    }
    .btn{
      border-radius:999px;
      border:1px solid rgba(148,163,184,0.6);
      padding:7px 14px;
      font-size:12px;
      font-weight:600;
      cursor:pointer;
      background:rgba(15,23,42,0.9);
      color:var(--text-main);
      display:inline-flex;
      align-items:center;
      gap:6px;
    }
    .btn-xs{ padding:5px 10px; font-size:11px; }
    .btn-primary{
      border-color:rgba(34,197,94,0.9);
      background:linear-gradient(135deg,#22c55e,#16a34a);
      color:#022c22;
    }
    .btn-research{
      border-color:rgba(59,130,246,0.9);
      background:linear-gradient(135deg,#38bdf8,#2563eb);
      color:#011627;
    }

    .hint-text{ font-size:11px; color:var(--text-soft); margin-top:4px; }
    .footer-note{ margin-top:14px; font-size:10px; color:var(--text-soft); text-align:right; }

    @media (max-width:640px){
      .game-card{ grid-template-columns:1fr; align-items:flex-start; }
      .game-controls{ align-items:flex-start; }
    }
  </style>
</head>
<body>
<div class="shell">
  <header>
    <div>
      <div class="title">Hero Health ‚Äî VR Nutrition Hub</div>
      <div class="subtitle">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏Å‡∏° ‚Ä¢ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö ‚Ä¢ ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô‡πÅ‡∏ö‡∏ö Play ‡∏´‡∏£‡∏∑‡∏≠ Research (‡∏™‡πà‡∏á Google Sheet)</div>
    </div>
    <div style="display:flex; gap:8px; flex-wrap:wrap;">
      <div class="pill"><span class="emoji">ü•¶</span><span>GoodJunk ‚Ä¢ Hydration ‚Ä¢ Plate ‚Ä¢ Groups</span></div>
      <div class="pill"><span class="emoji">üìä</span><span>Research-ready (Google Sheet)</span></div>
    </div>
  </header>

  <section class="card">
    <div style="font-size:13px;font-weight:650;">üîó Google Sheet Logger Endpoint</div>
    <div class="hint-text" style="margin-top:6px;">
      ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å endpoint ‡∏ô‡∏µ‡πâ‡∏•‡∏á <code>sessionStorage.HHA_LOG_ENDPOINT</code> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ó‡∏∏‡∏Å‡πÄ‡∏Å‡∏°‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
    </div>
    <div style="display:flex; gap:10px; flex-wrap:wrap; align-items:center; margin-top:10px;">
      <input id="log-endpoint" style="flex:1; min-width:260px; border-radius:12px; border:1px solid rgba(148,163,184,.35); background:rgba(15,23,42,.9); color:#e5e7eb; padding:8px 10px;"
        value="https://script.google.com/macros/s/AKfycby7IBVmpmEydNDp5BR3CMaSAjvF7ljptaDwvow_L781iDLsbtpuiFmKviGUnugFerDtQg/exec" />
      <button class="btn btn-primary" id="btn-save-endpoint">üíæ Save</button>
    </div>
  </section>

  <div class="zones">

    <!-- PLAY MODE -->
    <section class="card">
      <div class="zone-header">
        <div class="zone-title">Play Mode</div>
        <div class="zone-tag"><span class="emoji">üéÆ</span>‡πÄ‡∏•‡πà‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥</div>
      </div>

      <div class="game-list">

        <div class="game-card">
          <div>
            <div class="game-name"><span class="emoji">ü•¶</span>Good vs Junk VR</div>
            <div class="game-desc">‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏î‡∏µ/‡∏Ç‡∏¢‡∏∞ + Fever + Quest + Combo</div>
          </div>
          <div class="game-controls">
            <div class="game-row">
              <span class="pill-small">‡∏£‡∏∞‡∏î‡∏±‡∏ö</span>
              <select class="select-small" data-game="goodjunk" data-role="diff">
                <option value="easy">‡∏á‡πà‡∏≤‡∏¢</option>
                <option value="normal" selected>‡∏õ‡∏Å‡∏ï‡∏¥</option>
                <option value="hard">‡∏¢‡∏≤‡∏Å</option>
              </select>
            </div>
            <div class="game-row"><span class="pill-small" id="time-label-goodjunk">‡πÄ‡∏ß‡∏•‡∏≤‡πÇ‡∏î‡∏¢‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì: 60 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</span></div>
            <div class="game-row">
              <button class="btn btn-xs btn-primary" data-game="goodjunk" data-run="play">‚ñ∂Ô∏è ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô</button>
            </div>
          </div>
        </div>

        <div class="game-card">
          <div>
            <div class="game-name"><span class="emoji">üíß</span>Hydration VR</div>
            <div class="game-desc">‡∏£‡∏±‡∏Å‡∏©‡∏≤ Water Gauge ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°</div>
          </div>
          <div class="game-controls">
            <div class="game-row">
              <span class="pill-small">‡∏£‡∏∞‡∏î‡∏±‡∏ö</span>
              <select class="select-small" data-game="hydration" data-role="diff">
                <option value="easy">‡∏á‡πà‡∏≤‡∏¢</option>
                <option value="normal" selected>‡∏õ‡∏Å‡∏ï‡∏¥</option>
                <option value="hard">‡∏¢‡∏≤‡∏Å</option>
              </select>
            </div>
            <div class="game-row"><span class="pill-small" id="time-label-hydration">‡πÄ‡∏ß‡∏•‡∏≤‡πÇ‡∏î‡∏¢‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì: 70 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</span></div>
            <div class="game-row">
              <button class="btn btn-xs btn-primary" data-game="hydration" data-run="play">‚ñ∂Ô∏è ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô</button>
            </div>
          </div>
        </div>

        <div class="game-card">
          <div>
            <div class="game-name"><span class="emoji">üçΩÔ∏è</span>Healthy Plate VR</div>
            <div class="game-desc">‡∏à‡∏±‡∏î‡∏à‡∏≤‡∏ô‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö 5 ‡∏´‡∏°‡∏π‡πà ‚Üí Perfect Plate + Mini quest</div>
          </div>
          <div class="game-controls">
            <div class="game-row">
              <span class="pill-small">‡∏£‡∏∞‡∏î‡∏±‡∏ö</span>
              <select class="select-small" data-game="plate" data-role="diff">
                <option value="easy">‡∏á‡πà‡∏≤‡∏¢</option>
                <option value="normal" selected>‡∏õ‡∏Å‡∏ï‡∏¥</option>
                <option value="hard">‡∏¢‡∏≤‡∏Å</option>
              </select>
            </div>
            <div class="game-row"><span class="pill-small" id="time-label-plate">‡πÄ‡∏ß‡∏•‡∏≤‡πÇ‡∏î‡∏¢‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì: 70 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</span></div>
            <div class="game-row">
              <button class="btn btn-xs btn-primary" data-game="plate" data-run="play">‚ñ∂Ô∏è ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô</button>
            </div>
          </div>
        </div>

        <div class="game-card">
          <div>
            <div class="game-name"><span class="emoji">üß©</span>Food Groups VR</div>
            <div class="game-desc">‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏´‡∏°‡∏ß‡∏î</div>
          </div>
          <div class="game-controls">
            <div class="game-row">
              <span class="pill-small">‡∏£‡∏∞‡∏î‡∏±‡∏ö</span>
              <select class="select-small" data-game="groups" data-role="diff">
                <option value="easy">‡∏á‡πà‡∏≤‡∏¢</option>
                <option value="normal" selected>‡∏õ‡∏Å‡∏ï‡∏¥</option>
                <option value="hard">‡∏¢‡∏≤‡∏Å</option>
              </select>
            </div>
            <div class="game-row"><span class="pill-small" id="time-label-groups">‡πÄ‡∏ß‡∏•‡∏≤‡πÇ‡∏î‡∏¢‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì: 70 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</span></div>
            <div class="game-row">
              <button class="btn btn-xs btn-primary" data-game="groups" data-run="play">‚ñ∂Ô∏è ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô</button>
            </div>
          </div>
        </div>

      </div>

      <div class="hint-text">* Play ‡πÇ‡∏´‡∏°‡∏î‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏ã‡∏µ‡πÄ‡∏£‡∏µ‡∏¢‡∏™‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ß‡∏¥‡∏à‡∏±‡∏¢ ‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡∏¢‡∏¥‡∏á event ‡πÑ‡∏î‡πâ‡∏ñ‡πâ‡∏≤‡∏≠‡∏¢‡∏≤‡∏Å‡πÄ‡∏Å‡πá‡∏ö‡∏î‡∏π</div>
    </section>

    <!-- RESEARCH MODE -->
    <section class="card">
      <div class="zone-header">
        <div class="zone-title">Research Mode</div>
        <div class="zone-tag research"><span class="emoji">üß™</span>‡∏™‡πà‡∏á Google Sheet</div>
      </div>

      <div class="game-list">

        <div class="game-card research">
          <div>
            <div class="game-name"><span class="emoji">ü•¶</span>Good vs Junk ‚Äî Research</div>
            <div class="game-desc">Session + Event + RT + Quest + Fever</div>
          </div>
          <div class="game-controls">
            <div class="game-row">
              <span class="pill-small">‡∏£‡∏∞‡∏î‡∏±‡∏ö</span>
              <select class="select-small" data-game="goodjunk" data-role="diff-r">
                <option value="easy">‡∏á‡πà‡∏≤‡∏¢</option>
                <option value="normal" selected>‡∏õ‡∏Å‡∏ï‡∏¥</option>
                <option value="hard">‡∏¢‡∏≤‡∏Å</option>
              </select>
            </div>
            <div class="game-row"><span class="pill-small" id="time-label-goodjunk-r">‡πÄ‡∏ß‡∏•‡∏≤‡πÇ‡∏î‡∏¢‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì: 60 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</span></div>
            <div class="game-row">
              <button class="btn btn-xs btn-research" data-game="goodjunk" data-run="research">üß™ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÇ‡∏´‡∏°‡∏î‡∏ß‡∏¥‡∏à‡∏±‡∏¢</button>
            </div>
          </div>
        </div>

        <div class="game-card research">
          <div>
            <div class="game-name"><span class="emoji">üíß</span>Hydration ‚Äî Research</div>
            <div class="game-desc">Session + Event + Water Gauge</div>
          </div>
          <div class="game-controls">
            <div class="game-row">
              <span class="pill-small">‡∏£‡∏∞‡∏î‡∏±‡∏ö</span>
              <select class="select-small" data-game="hydration" data-role="diff-r">
                <option value="easy">‡∏á‡πà‡∏≤‡∏¢</option>
                <option value="normal" selected>‡∏õ‡∏Å‡∏ï‡∏¥</option>
                <option value="hard">‡∏¢‡∏≤‡∏Å</option>
              </select>
            </div>
            <div class="game-row"><span class="pill-small" id="time-label-hydration-r">‡πÄ‡∏ß‡∏•‡∏≤‡πÇ‡∏î‡∏¢‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì: 70 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</span></div>
            <div class="game-row">
              <button class="btn btn-xs btn-research" data-game="hydration" data-run="research">üß™ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÇ‡∏´‡∏°‡∏î‡∏ß‡∏¥‡∏à‡∏±‡∏¢</button>
            </div>
          </div>
        </div>

        <div class="game-card research">
          <div>
            <div class="game-name"><span class="emoji">üçΩÔ∏è</span>Plate ‚Äî Research</div>
            <div class="game-desc">Session + Event + Perfect plate + Mini</div>
          </div>
          <div class="game-controls">
            <div class="game-row">
              <span class="pill-small">‡∏£‡∏∞‡∏î‡∏±‡∏ö</span>
              <select class="select-small" data-game="plate" data-role="diff-r">
                <option value="easy">‡∏á‡πà‡∏≤‡∏¢</option>
                <option value="normal" selected>‡∏õ‡∏Å‡∏ï‡∏¥</option>
                <option value="hard">‡∏¢‡∏≤‡∏Å</option>
              </select>
            </div>
            <div class="game-row"><span class="pill-small" id="time-label-plate-r">‡πÄ‡∏ß‡∏•‡∏≤‡πÇ‡∏î‡∏¢‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì: 70 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</span></div>
            <div class="game-row">
              <button class="btn btn-xs btn-research" data-game="plate" data-run="research">üß™ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÇ‡∏´‡∏°‡∏î‡∏ß‡∏¥‡∏à‡∏±‡∏¢</button>
            </div>
          </div>
        </div>

        <div class="game-card research">
          <div>
            <div class="game-name"><span class="emoji">üß©</span>Groups ‚Äî Research</div>
            <div class="game-desc">Session + Event + Quest</div>
          </div>
          <div class="game-controls">
            <div class="game-row">
              <span class="pill-small">‡∏£‡∏∞‡∏î‡∏±‡∏ö</span>
              <select class="select-small" data-game="groups" data-role="diff-r">
                <option value="easy">‡∏á‡πà‡∏≤‡∏¢</option>
                <option value="normal" selected>‡∏õ‡∏Å‡∏ï‡∏¥</option>
                <option value="hard">‡∏¢‡∏≤‡∏Å</option>
              </select>
            </div>
            <div class="game-row"><span class="pill-small" id="time-label-groups-r">‡πÄ‡∏ß‡∏•‡∏≤‡πÇ‡∏î‡∏¢‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì: 70 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</span></div>
            <div class="game-row">
              <button class="btn btn-xs btn-research" data-game="groups" data-run="research">üß™ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÇ‡∏´‡∏°‡∏î‡∏ß‡∏¥‡∏à‡∏±‡∏¢</button>
            </div>
          </div>
        </div>

      </div>

      <div class="hint-text">* ‡πÇ‡∏´‡∏°‡∏î‡∏ß‡∏¥‡∏à‡∏±‡∏¢‡∏à‡∏∞‡∏™‡πà‡∏á <code>?run=research</code> ‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡∏° ‡πÅ‡∏•‡∏∞ logger ‡∏à‡∏∞‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏•‡∏á‡∏ä‡∏µ‡∏ï</div>
    </section>

  </div>

  <div class="footer-note">Hero Health VR Hub ‚Ä¢ Hub-2025-12-16</div>
</div>

<script>
  const DIFF_TIME = {
    goodjunk:  { easy: 80, normal: 60, hard: 45 },
    hydration: { easy: 90, normal: 70, hard: 50 },
    plate:     { easy: 90, normal: 70, hard: 50 },
    groups:    { easy: 90, normal: 70, hard: 50 }
  };

  const GAME_URL = {
    goodjunk: './goodjunk-vr.html',
    hydration:'./hydration-vr.html',
    plate:    './plate-vr.html',
    groups:   './groups-vr.html'
  };

  function $(sel){ return document.querySelector(sel); }
  function $all(sel){ return document.querySelectorAll(sel); }

  function updateTimeLabel(gameKey, mode){
    const map = DIFF_TIME[gameKey] || DIFF_TIME.goodjunk;
    const diffSel = document.querySelector(
      mode === 'research'
        ? 'select[data-game="' + gameKey + '"][data-role="diff-r"]'
        : 'select[data-game="' + gameKey + '"][data-role="diff"]'
    );
    if (!diffSel) return 60;
    const diff = diffSel.value || 'normal';
    const t = map[diff] || map.normal || 60;

    const idSuffix = (mode === 'research') ? '-r' : '';
    const labelEl = document.getElementById('time-label-' + gameKey + idSuffix);
    if (labelEl) labelEl.textContent = '‡πÄ‡∏ß‡∏•‡∏≤‡πÇ‡∏î‡∏¢‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì: ' + t + ' ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ';
    return t;
  }

  function initDiffListeners(){
    ['goodjunk','hydration','plate','groups'].forEach(g => {
      updateTimeLabel(g,'play');
      updateTimeLabel(g,'research');
    });
    $all('select[data-role="diff"]').forEach(sel => {
      sel.addEventListener('change', () => updateTimeLabel(sel.dataset.game,'play'));
    });
    $all('select[data-role="diff-r"]').forEach(sel => {
      sel.addEventListener('change', () => updateTimeLabel(sel.dataset.game,'research'));
    });
  }

  function saveEndpoint(){
    const v = ($('#log-endpoint')?.value || '').trim();
    if (!v) { alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà Endpoint'); return; }
    try{
      sessionStorage.setItem('HHA_LOG_ENDPOINT', v);
      alert('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Endpoint ‡πÅ‡∏•‡πâ‡∏ß ‚úÖ');
    }catch(e){
      alert('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ (sessionStorage) ‚ùå');
    }
  }

  function ensureEndpointBeforeLaunch(){
    const input = ($('#log-endpoint')?.value || '').trim();
    const ss = (() => { try { return sessionStorage.getItem('HHA_LOG_ENDPOINT') || ''; } catch(_) { return ''; } })();
    const final = input || ss;
    if (!final){
      alert('‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ Endpoint ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Google Sheet\n‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà Endpoint ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î Save');
      return null;
    }
    try{ sessionStorage.setItem('HHA_LOG_ENDPOINT', final); } catch(_){}
    return final;
  }

  function launchGame(gameKey, runMode){
    const endpoint = ensureEndpointBeforeLaunch();
    if (!endpoint) return;

    const isResearch = (runMode === 'research');

    // diff
    const diffSel = document.querySelector(
      isResearch
        ? 'select[data-game="' + gameKey + '"][data-role="diff-r"]'
        : 'select[data-game="' + gameKey + '"][data-role="diff"]'
    );
    const diff = diffSel ? diffSel.value : 'normal';

    // time
    const map = DIFF_TIME[gameKey] || DIFF_TIME.goodjunk;
    let time = map[diff] || map.normal || 60;
    if (time < 20) time = 20;
    if (time > 180) time = 180;

    const base = GAME_URL[gameKey] || './goodjunk-vr.html';
    const url =
      base +
      '?diff=' + encodeURIComponent(diff) +
      '&time=' + encodeURIComponent(String(time)) +
      '&run=' + encodeURIComponent(runMode);

    window.location.href = url;
  }

  window.addEventListener('DOMContentLoaded', () => {
    // prefill endpoint
    try{
      const ss = sessionStorage.getItem('HHA_LOG_ENDPOINT');
      if (ss && $('#log-endpoint')) $('#log-endpoint').value = ss;
    }catch(e){}

    $('#btn-save-endpoint')?.addEventListener('click', saveEndpoint);

    initDiffListeners();

    $all('button[data-game][data-run]').forEach(btn => {
      btn.addEventListener('click', () => {
        launchGame(btn.dataset.game, btn.dataset.run || 'play');
      });
    });
  });
</script>
</body>
</html>

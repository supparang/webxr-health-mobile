<!-- === /herohealth/plate-vr.html ===
HeroHealth ‚Äî Balanced Plate VR (PRODUCTION)
‚úÖ Layout ‡πÉ‡∏´‡∏°‡πà: Top HUD ‡πÅ‡∏ñ‡∏ß‡πÄ‡∏î‡∏µ‡∏¢‡∏ß + Quest/Mini bottom bar (compact/expand)
‚úÖ ‡∏õ‡∏∏‡πà‡∏°‡∏Ç‡∏ß‡∏≤‡∏•‡πà‡∏≤‡∏á (VR / Pause / Restart)
‚úÖ Research clean mode (‡∏ã‡πà‡∏≠‡∏ô Tip + ‡∏Ñ‡∏∏‡∏°‡πÄ‡∏Ç‡πâ‡∏° UI)
‚úÖ ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö plate.safe.js (ALL-IN / ULTIMATE)
-->

<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>HeroHealth ‚Äî Balanced Plate VR</title>
  <meta name="color-scheme" content="dark" />
  <link rel="icon" href="./favicon.ico" type="image/x-icon" />

  <!-- A-Frame -->
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>

  <!-- FX + Input + Logger -->
  <script src="./vr/particles.js" defer></script>
  <script src="./vr/hha-compat-input.js" defer></script>
  <script src="./vr/hha-cloud-logger.js" defer></script>

  <style>
    :root{
      --bg:#020617;
      --panel:rgba(2,6,23,.70);
      --panel2:rgba(15,23,42,.72);
      --stroke:rgba(148,163,184,.20);
      --text:#e5e7eb;
      --muted:rgba(229,231,235,.72);
      --shadow:0 18px 46px rgba(0,0,0,.35);
      --r:22px;
    }
    html,body{ height:100%; background:var(--bg); color:var(--text); margin:0; }
    *{ box-sizing:border-box; -webkit-tap-highlight-color: transparent; }

    /* A-Frame scene behind UI */
    a-scene{ position:fixed; inset:0; z-index:1; }

    /* HUD zones for safezone calc */
    #hudTop, #hudLeft, #hudRight, #hudBottom{
      position:fixed; z-index:900; pointer-events:none;
    }

    /* --- TOP HUD (single bar) --- */
    #hudTop{
      left:12px; right:12px; top:12px;
    }
    .card{
      background:var(--panel);
      border:1px solid var(--stroke);
      border-radius:var(--r);
      box-shadow:var(--shadow);
      backdrop-filter: blur(10px);
      padding:10px 12px;
    }
    .row{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; }

    .pill{
      display:inline-flex;
      gap:8px;
      align-items:center;
      padding:8px 12px;
      border-radius:999px;
      background:rgba(2,6,23,.55);
      border:1px solid rgba(148,163,184,.18);
      font-weight:900;
      pointer-events:auto;
    }
    .pill .k{ opacity:.85; font-weight:1000; }
    .pill .v{ font-weight:1000; }
    .pill.big{ padding:10px 14px; }
    .pill.right{ margin-left:auto; }

    /* Fever bar inside pill */
    .feverWrap{
      display:inline-flex; align-items:center; gap:8px;
      min-width:160px;
    }
    .feverOuter{
      width:90px; height:10px;
      border-radius:999px;
      overflow:hidden;
      background:rgba(148,163,184,.14);
      border:1px solid rgba(148,163,184,.16);
    }
    .feverInner{
      height:100%; width:0%;
      background:rgba(250,204,21,.85);
      box-shadow:0 0 16px rgba(250,204,21,.18);
    }

    /* Paused badge */
    #hudPaused{
      margin-left:auto;
      padding:8px 12px;
      border-radius:999px;
      background:rgba(251,113,133,.12);
      border:1px solid rgba(251,113,133,.22);
      display:none;
      pointer-events:none;
      font-weight:1000;
    }

    /* --- RIGHT CONTROLS --- */
    #hudRight{
      right:12px;
      bottom:14px;
      display:flex;
      flex-direction:column;
      gap:10px;
      pointer-events:auto;
    }
    .btn{
      width:66px; height:46px;
      border-radius:16px;
      display:grid;
      place-items:center;
      background:var(--panel2);
      border:1px solid var(--stroke);
      color:var(--text);
      font-weight:1000;
      box-shadow:var(--shadow);
      user-select:none;
      cursor:pointer;
      pointer-events:auto;
    }
    .btn:active{ transform:translateY(1px); }

    /* --- BOTTOM QUEST/MINI BAR --- */
    #hudBottom{
      left:12px; right:92px; bottom:14px;
      pointer-events:auto;
    }
    #questPanel, #miniPanel{
      background:var(--panel);
      border:1px solid var(--stroke);
      border-radius:20px;
      box-shadow:var(--shadow);
      backdrop-filter: blur(10px);
      padding:10px 12px;
      margin-top:10px;
      pointer-events:auto;
    }
    .hTitle{
      font-weight:1000;
      opacity:.95;
      display:flex;
      align-items:center;
      gap:8px;
    }
    .hSub{
      margin-top:6px;
      color:var(--muted);
      font-weight:900;
      line-height:1.25;
    }
    .mono{ font-variant-numeric: tabular-nums; }

    /* Compact mode: show 1 line only */
    body.hha-compact #questPanel .hSub,
    body.hha-compact #miniPanel .hSub{ display:none; }
    body.hha-compact #questPanel .hTitle,
    body.hha-compact #miniPanel .hTitle{
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
      font-size:14px;
    }

    /* Tip panel (non-research) */
    #tipPanel{
      position:fixed;
      left:12px; right:12px;
      bottom:132px;
      z-index:880;
      background:rgba(2,6,23,.55);
      border:1px solid rgba(148,163,184,.14);
      border-radius:18px;
      padding:10px 12px;
      color:rgba(229,231,235,.78);
      box-shadow:0 18px 46px rgba(0,0,0,.25);
      backdrop-filter: blur(10px);
    }
    body.hha-research #tipPanel{ display:none; }

    /* Result overlay */
    #resultBackdrop{
      position:fixed; inset:0; z-index:1200;
      display:none;
      background:rgba(2,6,23,.74);
      backdrop-filter: blur(10px);
      pointer-events:auto;
      padding:18px;
    }
    #resultCard{
      max-width:720px;
      margin:8vh auto 0;
      background:rgba(2,6,23,.85);
      border:1px solid rgba(148,163,184,.22);
      border-radius:22px;
      box-shadow:0 18px 46px rgba(0,0,0,.45);
      padding:16px;
    }
    #resultCard h2{ margin:0 0 10px; font-size:20px; }
    .grid{
      display:grid;
      grid-template-columns: repeat(2, minmax(0,1fr));
      gap:10px;
    }
    .stat{
      background:rgba(15,23,42,.60);
      border:1px solid rgba(148,163,184,.16);
      border-radius:16px;
      padding:10px 12px;
      font-weight:900;
    }
    .stat .k{ opacity:.8; font-weight:1000; }
    .stat .v{ font-size:18px; margin-top:2px; }
    #btnPlayAgain{
      margin-top:12px;
      width:100%;
      height:50px;
      border-radius:16px;
      background:rgba(34,197,94,.18);
      border:1px solid rgba(34,197,94,.30);
      color:#e5e7eb;
      font-weight:1000;
      cursor:pointer;
    }

    /* Mobile small tweaks */
    @media (max-width:420px){
      .pill.big{ padding:8px 10px; }
      .feverWrap{ min-width:140px; }
      #hudBottom{ right:88px; }
      #tipPanel{ bottom:140px; }
    }
  </style>
</head>

<body>
  <!-- A-Frame scene (camera for viewOffset in safe.js) -->
  <a-scene embedded xr-mode-ui="enabled: true" renderer="antialias:true; colorManagement:true">
    <a-entity id="rig" position="0 1.6 0">
      <a-camera id="cam" wasd-controls-enabled="false" look-controls="pointerLockEnabled:false"></a-camera>
    </a-entity>
  </a-scene>

  <!-- HUD TOP -->
  <div id="hudTop">
    <div class="card">
      <div class="row">
        <span class="pill big">‚è± <span class="k">TIME</span> <span id="hudTime" class="v mono">0</span></span>
        <span class="pill big">‚≠ê <span class="k">SCORE</span> <span id="hudScore" class="v mono">0</span></span>
        <span class="pill">üî• <span class="k">COMBO</span> <span id="hudCombo" class="v mono">0</span></span>
        <span class="pill">üí• <span class="k">MISS</span> <span id="hudMiss" class="v mono">0</span></span>

        <span class="pill feverWrap">
          <span class="k">FEVER</span>
          <span class="feverOuter"><span id="hudFever" class="feverInner"></span></span>
          <span id="hudFeverPct" class="v mono">0%</span>
        </span>

        <span class="pill">üèÖ <span class="k">GRADE</span> <span id="hudGrade" class="v">C</span></span>
        <span class="pill">üéØ <span class="k">PERF</span> <span id="hudPerfectCount" class="v mono">0</span></span>
        <span class="pill">üçΩÔ∏è <span class="k">HAVE</span> <span id="hudGroupsHave" class="v mono">0/5</span></span>

        <span class="pill right">üß™ <span class="k">MODE</span> <span id="hudMode" class="v">Play</span></span>
        <span class="pill">‚öôÔ∏è <span class="k">DIFF</span> <span id="hudDiff" class="v">Normal</span></span>

        <span id="hudPaused">‚è∏ PAUSED</span>
      </div>
    </div>
  </div>

  <!-- HUD RIGHT (controls) -->
  <div id="hudRight">
    <div id="btnEnterVR" class="btn">ü•Ω</div>
    <div id="btnPause" class="btn">‚è∏Ô∏è</div>
    <div id="btnRestart" class="btn">üîÑ</div>
  </div>

  <!-- HUD BOTTOM (quest/minis) -->
  <div id="hudBottom">
    <div id="questPanel">
      <div class="hTitle">üéØ QUEST ‚Ä¢ <span id="hudGoalLine">‚Ä¶</span></div>
      <div class="hSub">‡∏ó‡∏≥‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏Å‡∏°</div>
    </div>
    <div id="miniPanel">
      <div class="hTitle">üß© MINI ‚Ä¢ <span id="hudMiniLine">‚Ä¶</span></div>
      <div id="hudMiniHint" class="hSub">‚Ä¶</div>
    </div>
  </div>

  <!-- TIP (hide in research) -->
  <div id="tipPanel">
    Tip: ‡πÅ‡∏ï‡∏∞‡∏ï‡∏£‡∏á‡πÑ‡∏´‡∏ô‡∏Å‡πá‡πÑ‡∏î‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏¥‡∏á (Tap-anywhere) ‚Ä¢ ‡∏´‡∏°‡∏∏‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô VR ‚Ä¢ ‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏Ç‡∏¢‡∏∞!
  </div>

  <!-- RESULT OVERLAY -->
  <div id="resultBackdrop">
    <div id="resultCard">
      <h2>‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•</h2>
      <div class="grid">
        <div class="stat"><div class="k">Mode</div><div id="rMode" class="v">Play</div></div>
        <div class="stat"><div class="k">Grade</div><div id="rGrade" class="v">C</div></div>
        <div class="stat"><div class="k">Score</div><div id="rScore" class="v mono">0</div></div>
        <div class="stat"><div class="k">Max Combo</div><div id="rMaxCombo" class="v mono">0</div></div>
        <div class="stat"><div class="k">Miss</div><div id="rMiss" class="v mono">0</div></div>
        <div class="stat"><div class="k">Perfect</div><div id="rPerfect" class="v mono">0</div></div>
        <div class="stat"><div class="k">Goals</div><div id="rGoals" class="v mono">0/2</div></div>
        <div class="stat"><div class="k">Minis</div><div id="rMinis" class="v mono">0/7</div></div>
        <div class="stat"><div class="k">Group 1</div><div id="rG1" class="v mono">0</div></div>
        <div class="stat"><div class="k">Group 2</div><div id="rG2" class="v mono">0</div></div>
        <div class="stat"><div class="k">Group 3</div><div id="rG3" class="v mono">0</div></div>
        <div class="stat"><div class="k">Group 4</div><div id="rG4" class="v mono">0</div></div>
        <div class="stat"><div class="k">Group 5</div><div id="rG5" class="v mono">0</div></div>
        <div class="stat"><div class="k">Total Good</div><div id="rGTotal" class="v mono">0</div></div>
      </div>

      <button id="btnPlayAgain">‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
    </div>
  </div>

  <!-- Module -->
  <script type="module" src="./plate/plate.safe.js"></script>
</body>
</html>
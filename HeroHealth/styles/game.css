/* === Hero Health Academy — styles/game.css (Power-ups + FX + Accessibility + Scrollable Modals) === */

/* --- เดิมของโปรเจ็กต์ (คงพื้นหลังเดิมไว้) --- */
html, body {
  margin:0; padding:0; height:100%; width:100%;
  overflow:hidden; background:#0a0f1a; /* ใช้ของเดิม */
  color:#fff; font-family: ui-rounded, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
}
canvas#c { position:fixed; inset:0; z-index:0; pointer-events:none; }

header.brand { 
  position:fixed; top:0; left:0; right:0; z-index:50;
  display:flex; align-items:center; gap:8px;
  padding:10px 12px; background:linear-gradient(180deg, rgba(8,12,24,.85), rgba(8,12,24,.35));
  backdrop-filter:saturate(120%) blur(6px);
}
header .spacer{ flex:1 1 auto; }
header .btn, .menu .btn, .menu .tag {
  background:#162033; color:#cfe9ff; border:1px solid #26324d; border-radius:10px;
  padding:8px 12px; font-weight:800; cursor:pointer;
}
header .btn:active, .menu .btn:active, .menu .tag:active { transform:translateY(1px); }

.hud {
  position:fixed; z-index:60; top:64px; left:12px; right:12px;
  display:flex; flex-direction:column; gap:6px;
  text-shadow:0 2px 8px #000;
}

.bar { background:#0e1730; border-radius:999px; overflow:hidden; height:10px; border:1px solid #1c2a4d; }
.bar.slim { height:8px; }
#feverBar { height:100%; width:0%; background:linear-gradient(90deg, #ffd54a, #ff6d00); }

.fever { font:900 18px/1 ui-rounded, system-ui; color:#ffd54a; }

/* --- Power-ups bar (ด้านบนซ้าย) --- */
.powerbar {
  display:flex; gap:8px; align-items:center;
  margin-top:4px;
}
.powerbar .pseg {
  position:relative; display:flex; align-items:center; justify-content:center;
  width:40px; height:40px; border-radius:12px;
  background:#15213a; border:1px solid #25365c; cursor:pointer;
  box-shadow:0 2px 10px rgba(0,0,0,.25) inset, 0 2px 10px rgba(0,0,0,.2);
  transition:transform .12s, filter .12s, opacity .12s;
  overflow:hidden;
}
.powerbar .pseg:hover { transform:translateY(-1px) scale(1.03); }
.powerbar .pseg:active { transform:translateY(0) scale(.98); }
.powerbar .pseg[aria-disabled="true"] { opacity:.45; pointer-events:none; }

.powerbar .pseg span { font-size:18px; font-weight:900; }
.powerbar .pseg[data-k="x2"] span { font-size:16px; }

/* แถบสถานะ/คูลดาวน์ (วางทับ) */
.powerbar .pseg i {
  position:absolute; inset:auto 0 0 0; height:0%;
  background:linear-gradient(180deg, rgba(255,213,74,.85), rgba(255,109,0,.85));
  transition:height .2s linear;
}
.powerbar .pseg.busy i { height:100%; }     /* จะลดลงด้วย requestAnimationFrame */
.powerbar .pseg.ready { outline:2px solid #4ade80; }

/* ป้ายเป้าหมาย */
#targetWrap {
  font-weight:800; background:#0d172b; border:1px solid #203155; border-radius:10px;
  padding:6px 10px; display:inline-flex; align-items:center; gap:8px;
  width:max-content;
}

/* --- 3D FX shards/ring/sparks (ใช้กับ main.js) --- */
.fx3d-root{ position:fixed; inset:0; pointer-events:none; z-index:100; }
.burstRing{
  position:fixed; width:10px; height:10px; border-radius:999px; border:3px solid rgba(255,213,74,.95);
  transform:translate(-50%,-50%) scale(0.6); filter:drop-shadow(0 0 10px rgba(255,213,74,.55));
}
@keyframes ringOut { to { transform:translate(-50%,-50%) scale(9); opacity:0; } }

.shard{
  position:fixed; width:12px; height:8px; background:linear-gradient(90deg,#ffd54a,#ff6d00);
  transform:translate(var(--x0),var(--y0)) translateZ(0) rotate(0deg);
  border-radius:3px; box-shadow:0 2px 8px rgba(0,0,0,.3);
}
@keyframes shardFly {
  to { transform:translate(var(--x1),var(--y1)) translateZ(var(--z1)) rotate(var(--rot)); opacity:0; }
}

.spark{
  position:fixed; width:6px; height:6px; border-radius:999px; background:#fff3b0;
  transform:translate(var(--sx0),var(--sy0));
}
@keyframes sparkUp { to { transform:translate(var(--sx1),var(--sy1)); opacity:0; } }

/* --- ไอคอนลวง (Decoy hint) --- */
.decoy-hint{ outline:3px dashed rgba(255,64,64,.45); border-radius:16px; }

/* --- รายการ/ชิ้นเกม (ปุ่ม emoji) --- */
.item{
  user-select:none; -webkit-tap-highlight-color:transparent;
  text-shadow: 0 6px 16px rgba(0,0,0,.35);
  will-change: transform, opacity, filter;
}

/* --- เมนูล่าง/พื้นฐาน --- */
.menu{
  position:fixed; left:0; right:0; bottom:0; z-index:70;
  background:linear-gradient(0deg, rgba(8,12,24,.8), rgba(8,12,24,.3));
  backdrop-filter:saturate(120%) blur(6px);
  padding:8px 12px; display:flex; flex-direction:column; gap:6px;
}
.menu .row{ display:flex; gap:8px; flex-wrap:wrap; align-items:center; }
.modeLabel{ margin-left:auto; opacity:.85; font-weight:800; }

/* === Scrollable Modals & Sticky Footer === */
.modal{
  position:fixed; inset:0; z-index:140;
  display:flex; align-items:center; justify-content:center;
  background:rgba(0,0,0,.5);
}
.modal-card{
  width:min(920px, calc(100vw - 24px));
  max-height: min(88vh, 720px);
  background:linear-gradient(180deg, rgba(12,18,32,.96), rgba(10,16,28,.96));
  border:1px solid #233454;
  border-radius:14px;
  box-shadow:0 10px 36px rgba(0,0,0,.45);
  display:flex; flex-direction:column;
}
.modal-header{
  display:flex; align-items:center; justify-content:space-between; gap:8px;
  padding:12px 14px;
  border-bottom:1px solid #233454;
  position: sticky; top:0;
  background:linear-gradient(180deg, rgba(16,24,42,.98), rgba(16,24,42,.90));
  z-index:1;
}
.modal-header .close-x{ padding:6px 10px; }
.modal-body{
  padding:12px 14px;
  overflow:auto;
  max-height: calc(88vh - 120px); /* เผื่อ header + footer */
  scrollbar-gutter: stable both-edges;
}
.help-section{ margin: 0 0 14px 0; }
.help-section h4{ margin:8px 0 6px; }
.help-section ul{ margin:6px 0 8px 20px; }
.modal-footer{
  padding:10px 14px;
  border-top:1px solid #233454;
  position: sticky; bottom:0;
  background:linear-gradient(0deg, rgba(16,24,42,.98), rgba(16,24,42,.85));
}

/* ป้องกันพื้นหลังเลื่อนตอนเปิด modal */
html.hha-modal-open, body.hha-modal-open{
  overflow: hidden !important;
  touch-action: none;
}
/* === Mini Quest chips === */
.quests{ display:flex; gap:8px; flex-wrap:wrap; align-items:center; }
.questChip{
  display:flex; align-items:center; gap:8px;
  background:#0e1730; border:1px solid #1c2a4d; border-radius:999px;
  padding:6px 10px; font-weight:800;
}
.questChip .qIcon{ font-size:14px; }
.questChip .qLabel{ opacity:.95; }
.questChip .qProg{ opacity:.85; }
.questChip .qBar{ position:relative; width:64px; height:6px; border-radius:999px; background:#0a1430; overflow:hidden; border:1px solid #1b2a4d; }
.questChip .qBar i{ position:absolute; inset:0 auto 0 0; width:0%; background:linear-gradient(90deg,#4ade80,#22c55e); }

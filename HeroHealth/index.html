<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport"
        content="width=device-width, initial-scale=1, viewport-fit=cover, maximum-scale=1, user-scalable=no" />
  <title>Hero Health Academy</title>

  <link rel="stylesheet" href="/webxr-health-mobile/HeroHealth/styles/game.css" />
  <link rel="stylesheet" href="/webxr-health-mobile/HeroHealth/styles/groups.css" />

  <style>
    :root { --safe: env(safe-area-inset-bottom, 0px); }

    /* ‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡πÄ‡∏¢‡∏≠‡∏£‡πå‡∏´‡∏•‡∏±‡∏Å */
    body, html { height:100%; }
    body { margin:0; background:#0e1216; color:#fff; font-family:system-ui,-apple-system,Segoe UI,Roboto,TH Sarabun New,sans-serif; }
    .game-wrap {
      position:relative; width:100%; height:calc(100vh - 120px);
      display:flex; align-items:center; justify-content:center;
      overflow:hidden;
    }
    #stage {
      position:relative; width:min(900px, 96vw); height:min(620px, 68vh);
      border:1px solid rgba(255,255,255,.08); border-radius:14px;
      background:linear-gradient(180deg,#10161b,#0b0f13);
      box-shadow:0 8px 30px rgba(0,0,0,.35);
    }
    #gameLayer { position:absolute; inset:0; }
    #spawnHost { position:absolute; inset:0; pointer-events:auto; }
    .spawn-emoji {
      position:absolute; transform:translate(-50%,-50%);
      font-size:34px; line-height:1; border:none; background:transparent; cursor:pointer;
      filter: drop-shadow(0 3px 8px rgba(0,0,0,.45));
      user-select:none;
    }

    /* Header & menu */
    header.brand { display:flex; gap:8px; align-items:center; padding:8px 12px; border-bottom:1px solid rgba(255,255,255,.08); }
    header .spacer { flex:1; }
    .btn, .tag {
      background:rgba(255,255,255,.08); color:#fff; border:1px solid rgba(255,255,255,.15);
      border-radius:10px; padding:6px 10px; cursor:pointer;
    }
    .menu { padding:10px 12px; padding-bottom:calc(12px + var(--safe)); border-top:1px solid rgba(255,255,255,.08); }
    .menu .row { display:flex; gap:8px; flex-wrap:wrap; align-items:center; margin:6px 0; }
    .modeLabel { opacity:.85; }

    /* HUD */
    #hudWrap { position:fixed; left:0; right:0; top:0; pointer-events:none; z-index:20; }
    .hud .cardlike {
      background: linear-gradient(180deg, rgba(0,0,0,.35), rgba(0,0,0,.5));
      border: 1px solid rgba(255,255,255,.12);
      border-radius: 12px; padding: 6px 10px; backdrop-filter: blur(6px);
      margin:8px auto 0; width:max-content;
    }
    #missionLine { margin-top:8px; text-align:center; }

    /* Toast */
    #toast {
      position:fixed; left:50%; top:64px; transform:translateX(-50%);
      background:rgba(0,0,0,.6); padding:8px 12px; border-radius:10px; z-index:30; display:none;
    }
    #toast.show { display:block; }

    /* Modal basic */
    .modal { position:fixed; inset:0; display:none; align-items:center; justify-content:center; z-index:40;
             background:rgba(0,0,0,.5); padding:16px; }
    .modal .card { background:rgba(22,26,31,.96); border:1px solid rgba(255,255,255,.12); border-radius:14px; padding:14px; max-width:720px; width:min(92vw,720px); }
    .modal .card.scroll { max-height:80vh; overflow:auto; }
    .modal .tbl { width:100%; border-collapse:collapse; }
    .modal .tbl th, .modal .tbl td { padding:6px 8px; border-bottom:1px solid rgba(255,255,255,.1); }

    /* Coach */
    #coachHUD { position:fixed; left:50%; transform:translateX(-50%); top:96px; z-index:25; pointer-events:none; }
    #coachText { background:rgba(0,0,0,.45); padding:6px 10px; border-radius:10px; }

    /* Target / plate / hydro */
    #targetWrap, #plateTracker, #hydroWrap {
      position:fixed; left:50%; transform:translateX(-50%); top:120px; z-index:22; display:none;
      background:rgba(0,0,0,.35); border:1px solid rgba(255,255,255,.12); border-radius:10px; padding:6px 10px;
    }
    #platePills .pill{ display:inline-flex; gap:6px; align-items:center; margin:2px 4px 0 0; padding:4px 6px;
      background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.12); border-radius:999px; }
    #platePills .pill i{ display:block; width:60px; height:6px; background:#1c2630; border-radius:4px; overflow:hidden }
    #platePills .pill i::after{ content:''; display:block; height:100%; background:#29b6f6; width:var(--w,0%); }
    #platePills .ok{ opacity:.6 }

    /* Quests chip */
    .chip { display:inline-flex; gap:8px; align-items:center; padding:6px 10px; border-radius:999px;
            background:rgba(255,255,255,.08); border:1px solid rgba(255,255,255,.12); margin:4px 6px 0 0; }

    /* Block pointer on passive HUD */
    .hud-passive { pointer-events:none !important; }
  </style>

  <!-- Bootloader -->
  <script type="module">
    (async () => {
      const warn = document.createElement('div');
      warn.id = 'bootWarn';
      warn.style.cssText = 'position:fixed;top:0;left:0;right:0;background:#b00020;color:#fff;padding:10px 12px;font-weight:700;z-index:2000;display:none';
      warn.textContent = '‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ‡∏ï‡∏£‡∏ß‡∏à path /webxr-health-mobile/HeroHealth/game/main.js';
      document.addEventListener('DOMContentLoaded', ()=>document.body.appendChild(warn));

      const chip = document.createElement('div');
      chip.id = 'bootChip';
      chip.style.cssText = 'position:fixed;right:12px;bottom:calc(12px + var(--safe));background:#1b5e20;color:#fff;padding:8px 10px;border-radius:999px;font-weight:800;font-size:12px;z-index:2001;display:none;box-shadow:0 2px 8px rgba(0,0,0,.25)';
      chip.textContent = '‚úÖ JS Loaded';
      document.addEventListener('DOMContentLoaded', ()=>document.body.appendChild(chip));

      const url = '/webxr-health-mobile/HeroHealth/game/main.js?v=live&cb=' + Date.now();
      try{
        await import(url);
        setTimeout(()=>{ if(window.__HHA_BOOT_OK){ warn.style.display='none'; chip.style.display='inline-block'; }}, 80);
      }catch(e){
        warn.textContent = '‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ' + (e && e.message ? e.message : e);
        warn.style.display = 'block';
      }
    })();
  </script>
</head>
<body>
  <!-- Header -->
  <header class="brand" role="banner">
    <div id="brandTitle">HERO HEALTH ACADEMY</div>
    <div class="spacer"></div>
    <button id="langToggle"   class="btn" type="button" data-action="lang" data-lang="TH">üáπüá≠ TH/EN</button>
    <button id="gfxToggle"    class="btn" type="button">üéõÔ∏è ‡∏Å‡∏£‡∏≤‡∏ü‡∏¥‡∏Å: ‡∏õ‡∏Å‡∏ï‡∏¥</button>
    <button id="soundToggle"  class="btn" type="button">üîä ‡πÄ‡∏™‡∏µ‡∏¢‡∏á: ‡πÄ‡∏õ‡∏¥‡∏î</button>
    <button id="hapticToggle" class="btn" type="button">üì≥ ‡∏™‡∏±‡πà‡∏ô: ‡πÄ‡∏õ‡∏¥‡∏î</button>
  </header>

  <!-- HUD (id ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö main.js) -->
  <section id="hudWrap" class="hud" role="region" aria-label="HUD">
    <div class="cardlike">
      <span id="t_score">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</span>: <b id="score">0</b> |
      <span id="t_combo">‡∏Ñ‡∏≠‡∏°‡πÇ‡∏ö</span>: <b id="combo">x0</b> |
      <span id="t_time">‡πÄ‡∏ß‡∏•‡∏≤</span>: <b id="time">60</b>s
    </div>

    <div id="feverBarWrap" class="bar slim"><div id="feverBar"></div></div>
    <div id="fever" class="fever" style="display:none">FEVER!</div>

    <div id="powerBar" class="powerbar" aria-label="Power-ups">
      <div class="pseg" data-k="x2"><span>√ó2</span><i></i></div>
      <div class="pseg" data-k="freeze"><span>üßä</span><i></i></div>
      <div class="pseg" data-k="sweep"><span>üß≤</span><i></i></div>
    </div>

    <div id="questChips" class="quests" aria-live="polite"></div>

    <div id="targetWrap" style="display:none">üéØ <span id="t_target">‡∏´‡∏°‡∏ß‡∏î</span>: <span id="targetBadge">‚Äî</span></div>
    <div id="plateTracker" style="display:none">üç± <span id="t_quota">‡πÇ‡∏Ñ‡∏ß‡∏ï‡∏≤</span>: <span id="platePills"></span></div>
    <div id="hydroWrap" style="display:none">
      üíß <span id="t_hydro">‡∏™‡∏°‡∏î‡∏∏‡∏•‡∏ô‡πâ‡∏≥</span>:
      <span id="hydroLabel">‚Äî</span>
      <div class="bar"><div id="hydroBar"></div></div>
    </div>

    <div id="coachHUD" class="coach under-fever" style="display:flex">
      <div id="coachText">‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÑ‡∏´‡∏°? ‡∏™‡∏π‡πâ‡πÜ!</div>
    </div>

    <div id="missionLine" class="mission-line" style="display:none">‚Äî</div>
    <div id="toast" aria-live="polite"></div>
  </section>

  <!-- ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏° (id ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö main.js) -->
  <main class="game-wrap" role="main" aria-label="Game area">
    <div id="stage" aria-label="Stage">
      <div id="gameLayer" aria-hidden="false"></div>
      <div id="spawnHost" aria-live="off"></div>
    </div>
  </main>

  <!-- ‡πÄ‡∏°‡∏ô‡∏π (‡∏õ‡∏£‡∏±‡∏ö data-action/data-attr ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö main.js) -->
  <section id="menuBar" class="menu" role="navigation" aria-label="‡πÇ‡∏´‡∏°‡∏î‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°">
    <div class="row">
      <!-- ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô data-action="mode" + data-mode="..." -->
      <button class="tag" data-action="mode" data-mode="goodjunk"  id="m_goodjunk"  type="button">ü•ó ‡∏î‡∏µ vs ‡∏Ç‡∏¢‡∏∞</button>
      <button class="tag" data-action="mode" data-mode="groups"    id="m_groups"    type="button">üçΩÔ∏è ‡∏à‡∏≤‡∏ô 5 ‡∏´‡∏°‡∏π‡πà</button>
      <button class="tag" data-action="mode" data-mode="hydration" id="m_hydration" type="button">üíß ‡∏™‡∏°‡∏î‡∏∏‡∏•‡∏ô‡πâ‡∏≥</button>
      <button class="tag" data-action="mode" data-mode="plate"     id="m_plate"     type="button">üç± ‡∏à‡∏±‡∏î‡∏à‡∏≤‡∏ô‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û</button>
    </div>
    <div class="row">
      <!-- ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô data-action="difficulty" + data-diff="..." -->
      <button class="tag" data-action="difficulty" data-diff="Easy"   id="d_easy"   type="button">‡∏á‡πà‡∏≤‡∏¢</button>
      <button class="tag" data-action="difficulty" data-diff="Normal" id="d_normal" type="button">‡∏õ‡∏Å‡∏ï‡∏¥</button>
      <button class="tag" data-action="difficulty" data-diff="Hard"   id="d_hard"   type="button">‡∏¢‡∏≤‡∏Å</button>
      <span class="modeLabel">
        <span id="t_mode">‡πÇ‡∏´‡∏°‡∏î</span>: <b id="modeName">‡∏î‡∏µ vs ‡∏Ç‡∏¢‡∏∞</b> ‚Ä¢
        <span id="t_diff">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏Å</span>: <b id="difficulty">‡∏õ‡∏Å‡∏ï‡∏¥</b>
      </span>
    </div>
    <div class="row">
      <button class="btn" data-action="start"    id="btn_start"    type="button">‚ñ∂ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°</button>
      <button class="btn" data-action="restart"  id="btn_restart"  type="button">‚Üª ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà</button>
      <!-- help ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö main.js = howto -->
      <button class="btn" data-action="howto"    id="btn_help"     type="button">‚ùì ‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏•‡πà‡∏ô</button>
      <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏≠‡∏∑‡πà‡∏ô ‡πÜ main.js ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏à‡∏á‡πÉ‡∏à‡∏õ‡∏¥‡∏î‡πÑ‡∏ß‡πâ‡∏Å‡πà‡∏≠‡∏ô -->
      <!-- <button class="btn" data-action="pause" id="btn_pause" type="button">‚è∏ ‡∏û‡∏±‡∏Å</button> -->
      <!-- <button class="btn" data-action="helpScene" id="btn_helpScene" type="button">üìò ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏£‡∏ß‡∏°</button> -->
      <button class="btn" data-action="export"   id="btn_export"   type="button">‚¨ÜÔ∏è Export</button>
      <button class="btn" data-action="import"   id="btn_import"   type="button">‚¨áÔ∏è Import</button>
      <button class="btn" data-action="reset"    id="btn_reset"    type="button">üóëÔ∏è Reset</button>
    </div>
  </section>

  <!-- Help (individual) -->
  <div id="help" class="modal" role="dialog" aria-modal="true" aria-labelledby="h_help" style="display:none">
    <div class="card">
      <h3 id="h_help">‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏•‡πà‡∏ô</h3>
      <pre id="helpBody">‚Äî</pre>
      <button class="btn" data-action="helpClose" id="btn_ok" type="button">‡πÇ‡∏≠‡πÄ‡∏Ñ</button>
    </div>
  </div>

  <!-- Result (id ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á main.js) -->
  <div id="resultModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="h_summary" style="display:none">
    <div class="card">
      <h3 id="h_summary">‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•</h3>
      <div id="resultBody">‚Äî</div>
      <div style="margin-top:12px; display:flex; gap:8px; flex-wrap:wrap;">
        <button class="btn" data-action="restart" id="btn_replay" type="button">‚Üª ‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
        <button class="btn" data-action="back"    id="btn_home"   type="button">üè† ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
      </div>
    </div>
  </div>

  <!-- SFX -->
  <audio id="sfx-good"     preload="auto" src="/webxr-health-mobile/HeroHealth/assets/sfx/good.mp3"></audio>
  <audio id="sfx-bad"      preload="auto" src="/webxr-health-mobile/HeroHealth/assets/sfx/bad.mp3"></audio>
  <audio id="sfx-perfect"  preload="auto" src="/webxr-health-mobile/HeroHealth/assets/sfx/perfect.mp3"></audio>
  <audio id="sfx-tick"     preload="auto" src="/webxr-health-mobile/HeroHealth/assets/sfx/tick.mp3"></audio>
  <audio id="sfx-powerup"  preload="auto" src="/webxr-health-mobile/HeroHealth/assets/sfx/powerup.mp3"></audio>

  <noscript>
    <div style="position:fixed;top:0;left:0;right:0;background:#b00020;color:#fff;padding:10px 12px;font-weight:700;z-index:2000">
      ‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô JavaScript ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°
    </div>
  </noscript>
</body>
</html>

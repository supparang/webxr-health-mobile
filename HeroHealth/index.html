<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <meta name="color-scheme" content="light dark"/>
  <meta name="theme-color" content="#0b1324"/>
  <title>Hero Health — Good vs Junk</title>

  <!-- Styles (external + minimal fallback) -->
  <link rel="preload" as="script" href="./game/main.js"/>
  <link rel="stylesheet" href="./styles/game.css"/>
  <style>
    /* Fallback ถ้า styles/game.css ยังไม่มา */
    :root{--bg:#0b1324;--fg:#e8f0ff;--card:#111a33;--muted:#7ea8ff;}
    *{box-sizing:border-box} html,body{height:100%}
    body{margin:0;background:var(--bg);color:var(--fg);font-family:system-ui,Segoe UI,Inter,Arial}
    .wrap{min-height:100%;display:flex;flex-direction:column}
    header.appbar{display:flex;justify-content:space-between;align-items:center;gap:16px;padding:10px 14px;background:var(--card);position:sticky;top:0;z-index:50}
    .brand{display:flex;gap:10px;align-items:center}
    .brand .title{font-weight:800;letter-spacing:.3px}
    .hud-bar{display:flex;gap:14px;align-items:center;flex-wrap:wrap}
    .hud-pill{background:#1b2752;border-radius:999px;padding:6px 10px;font-weight:700}
    .btn{appearance:none;border:0;border-radius:12px;padding:10px 16px;font-weight:800;cursor:pointer;background:#2e8b57;color:white}
    .btn:disabled{opacity:.6;cursor:not-allowed}
    main{flex:1;display:flex;flex-direction:column;gap:10px;padding:10px 14px}
    .game-wrap{position:relative;flex:1;min-height:60vh;border-radius:14px;background:#0c1736;overflow:hidden;box-shadow:0 6px 24px rgba(0,0,0,.25)}
    /* Host หลาย id เพื่อรองรับโค้ดเดิม */
    #gameLayer, #spawnHost{position:absolute;inset:0}
    /* Mission */
    #missionWrap{display:flex;gap:10px;align-items:center}
    #missionText{opacity:.95}
    .mission-bar{flex:1;height:12px;background:#1b2752;border-radius:999px;overflow:hidden}
    #missionBar{height:100%;width:0%;background:linear-gradient(90deg,#3ddc84,#23a4ff)}
    /* Result modal */
    #resultModal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.55);backdrop-filter:blur(6px);z-index:9999}
    .result-card{max-width:560px;margin:10vh auto;background:var(--card);border-radius:18px;padding:18px 18px 14px}
    .res-banner{margin:0 0 6px 0;font-size:24px}
    .res-grid{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:6px}
    footer.appfoot{padding:10px 14px;opacity:.75}
    .tip{font-size:13px;color:#b9d0ff}
  </style>
</head>
<body>
  <noscript>ต้องเปิดใช้งาน JavaScript เพื่อเล่นเกมนี้</noscript>

  <div class="wrap">
    <!-- App Bar / HUD -->
    <header class="appbar">
      <div class="brand">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="#7ea8ff" aria-hidden="true"><path d="M12 2l3 6 6 .9-4.5 4.3L17 20l-5-2.6L7 20l1.5-6.8L4 8.9 10 8z"/></svg>
        <div class="title">Hero Health • Good vs Junk</div>
      </div>
      <div class="hud-bar" role="status" aria-live="polite">
        <span class="hud-pill">เวลา: <b id="hudTime">60</b>s</span>
        <span class="hud-pill">คะแนน: <b id="hudScore">0</b></span>
        <span class="hud-pill">คอมโบ: <b id="hudCombo">x1</b></span>
        <span class="hud-pill">สถานะ: <b id="hudStatus">READY</b></span>
        <button data-action="start" id="startBtn" class="btn">เริ่มเกม</button>
      </div>
    </header>

    <!-- Mission -->
    <main>
      <section id="missionWrap" aria-label="mission">
        <div id="missionText">ภารกิจ: เก็บอาหารดีให้ครบ</div>
        <div class="mission-bar"><div id="missionBar"></div></div>
      </section>

      <!-- Game Host -->
      <section class="game-wrap" aria-label="game area">
        <!-- โค้ดรองรับ host ได้ทั้งสองแบบ -->
        <div id="spawnHost"></div>
        <div id="gameLayer"></div>
      </section>
    </main>

    <!-- Result Modal -->
    <div id="resultModal" role="dialog" aria-modal="true" aria-labelledby="resultTitle">
      <div class="result-card">
        <h2 id="resultTitle" class="res-banner">RESULT</h2>
        <div class="res-grid">
          <div>คะแนน: <b class="res-score">0</b></div>
          <div>เวลา: <b class="res-time">0s</b></div>
          <div>ดาว: <b class="res-stars">★☆☆☆☆</b></div>
          <div class="res-detail">Good 0 | Junk 0 | MaxCombo x1 | Mission 0/0</div>
        </div>
        <div style="display:flex;gap:10px;justify-content:flex-end;margin-top:12px">
          <button class="btn" onclick="document.getElementById('resultModal').style.display='none'">ปิด</button>
          <button class="btn" data-action="start">เล่นอีกครั้ง</button>
        </div>
      </div>
    </div>

    <footer class="appfoot">
      <div class="tip">หากเสียงไม่ดัง ให้คลิก “เริ่มเกม” หนึ่งครั้งก่อน (นโยบาย Autoplay ของเบราว์เซอร์)</div>
    </footer>
  </div>

  <!-- App Scripts -->
  <!-- ถ้ามี bundler/paths ต่างออกไป สามารถแก้ path ได้ตามโครงที่คุณใช้อยู่ -->
  <script type="module">
    // โหลด HUD/Coach ถ้าใช้แบบ ES Modules ในโปรเจกต์ของคุณ ให้ปรับ path เป็น './game/core/hud.js' และ './game/core/coach.js'
    // ในหลายโปรเจกต์ HUD/Coach อาจถูก bundle เข้ามากับ main.js อยู่แล้ว
  </script>
  <script type="module" src="./game/main.js"></script>
</body>
</html>

<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Hero Health Academy</title>

  <!-- ‡∏ñ‡πâ‡∏≤‡πÇ‡∏Æ‡∏™‡∏ï‡πå‡∏ó‡∏µ‡πà GitHub Pages ‡πÅ‡∏ö‡∏ö user site: https://supparang.github.io/webxr-health-mobile/HeroHealth/ -->
  <!-- ‡πÉ‡∏´‡πâ‡∏Ñ‡∏á base ‡πÅ‡∏ö‡∏ö absolute path ‡πÑ‡∏ß‡πâ (‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ "/" ‡∏õ‡∏¥‡∏î‡∏ó‡πâ‡∏≤‡∏¢) -->
  <base href="/webxr-health-mobile/HeroHealth/">

  <link rel="stylesheet" href="styles/game.css" />
  <!-- ‡πÉ‡∏ä‡πâ bootloader ‡πÅ‡∏ö‡∏ö dynamic import + fallback ‡πÅ‡∏ó‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏µ‡πâ‡∏ï‡∏£‡∏á -->
  <script type="module">
    // ----- HHA Bootloader (resilient) -----
    window.__HHA_BOOT_OK = false;

    const candidates = [];
    // ‡∏•‡∏≠‡∏á‡∏≠‡∏¥‡∏á‡∏ï‡∏≤‡∏° <base>, ‡∏ï‡∏≤‡∏°‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô, ‡πÅ‡∏•‡∏∞ URL ‡∏Ñ‡∏á‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á GitHub Pages
    const baseURIs = [
      document.baseURI,
      new URL('./', location.href).href,
      'https://supparang.github.io/webxr-health-mobile/HeroHealth/'
    ];
    const paths = [
      'game/main.js?v=live',
      'game/main.js',
      './game/main.js'
    ];
    for (const b of baseURIs) {
      for (const p of paths) {
        candidates.push(new URL(p, b).href);
      }
    }

    let loaded = false;
    let lastErr = null;
    for (const url of candidates) {
      try {
        // ‡∏Å‡∏±‡∏ô cache ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ó‡∏î‡∏™‡∏≠‡∏ö
        const withBust = url.includes('?') ? url + '&cb=' + Date.now() : url + '?cb=' + Date.now();
        await import(withBust);
        loaded = true;
        window.__HHA_BOOT_OK = true;
        console.info('[HHA] boot ok via', url);
        break;
      } catch (e) {
        lastErr = e;
        console.warn('[HHA] boot try fail:', url, e);
      }
    }

    if (!loaded) {
      const w = document.getElementById('bootWarn');
      if (w) {
        w.textContent = '‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ‡∏ï‡∏£‡∏ß‡∏à path / ‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå game/main.js (‡∏ï‡∏±‡∏ß‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏•‡πá‡∏Å/‡πÉ‡∏´‡∏ç‡πà) ‚Ä¢ ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î: ' +
                        (lastErr && (lastErr.message || lastErr.toString()));
        w.style.display = 'block';
      }
    }
  </script>
</head>
<body>
  <!-- Brand / Toggles -->
  <header class="brand">
    <div id="brandTitle">HERO HEALTH ACADEMY</div>
    <div class="spacer"></div>
    <button id="langToggle"   class="btn" type="button">üáπüá≠ TH/EN</button>
    <button id="gfxToggle"    class="btn" type="button">üéõÔ∏è ‡∏Å‡∏£‡∏≤‡∏ü‡∏¥‡∏Å: ‡∏õ‡∏Å‡∏ï‡∏¥</button>
    <button id="soundToggle"  class="btn" type="button">üîä ‡πÄ‡∏™‡∏µ‡∏¢‡∏á: ‡πÄ‡∏õ‡∏¥‡∏î</button>
  </header>

  <!-- Render Surface -->
  <canvas id="c"></canvas>

  <!-- HUD (‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô/‡∏Ñ‡∏≠‡∏°‡πÇ‡∏ö/‡πÄ‡∏ß‡∏•‡∏≤ + Fever Bar + Target + Plate + Hydration) -->
  <section class="hud">
    <div>
      <span id="t_score">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</span>: <b id="score">0</b> |
      <span id="t_combo">‡∏Ñ‡∏≠‡∏°‡πÇ‡∏ö</span>: <b id="combo">x0</b> |
      <span id="t_time">‡πÄ‡∏ß‡∏•‡∏≤</span>: <b id="time">60</b>s
    </div>

    <!-- Fever Progress Bar -->
    <div id="feverBarWrap" class="bar slim">
      <div id="feverBar" style="width:0%"></div>
    </div>

    <!-- ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏´‡∏°‡∏ß‡∏î‡∏≠‡∏≤‡∏´‡∏≤‡∏£ (‡πÇ‡∏´‡∏°‡∏î groups/plate) -->
    <div id="targetWrap" style="display:none">
      üéØ <span id="t_target">‡∏´‡∏°‡∏ß‡∏î</span>:
      <span id="targetBadge">‚Äî</span>
    </div>

    <!-- ‡πÇ‡∏Ñ‡∏ß‡∏ï‡∏≤‡∏≠‡∏≤‡∏´‡∏≤‡∏£ (‡πÇ‡∏´‡∏°‡∏î plate) -->
    <div id="plateTracker" style="display:none">
      üç± <span id="t_quota">‡πÇ‡∏Ñ‡∏ß‡∏ï‡∏≤</span>:
      <span id="platePills"></span>
    </div>

    <!-- ‡∏™‡∏°‡∏î‡∏∏‡∏•‡∏ô‡πâ‡∏≥ (‡πÇ‡∏´‡∏°‡∏î hydration) -->
    <div id="hydroWrap" style="display:none">
      üíß <span id="t_hydro">‡∏™‡∏°‡∏î‡∏∏‡∏•‡∏ô‡πâ‡∏≥</span>:
      <span id="hydroLabel">‚Äî</span>
      <div class="bar"><div id="hydroBar"></div></div>
    </div>

    <!-- Fever Label -->
    <div id="fever" class="fever" style="display:none">FEVER!</div>
  </section>

  <!-- ‡πÇ‡∏Ñ‡πâ‡∏ä (‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥/‡πÉ‡∏´‡πâ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏à) -->
  <div id="coachHUD" class="coach" style="display:none">
    <div id="coachText">...</div>
  </div>

  <!-- ‡πÄ‡∏°‡∏ô‡∏π‡∏•‡πà‡∏≤‡∏á‡∏à‡∏≠ -->
  <section id="menuBar" class="menu">
    <div class="row">
      <button class="tag" data-action="mode" data-value="goodjunk"  id="m_goodjunk"  type="button">ü•ó ‡∏î‡∏µ vs ‡∏Ç‡∏¢‡∏∞</button>
      <button class="tag" data-action="mode" data-value="groups"    id="m_groups"    type="button">üçΩÔ∏è ‡∏à‡∏≤‡∏ô 5 ‡∏´‡∏°‡∏π‡πà</button>
      <button class="tag" data-action="mode" data-value="hydration" id="m_hydration" type="button">üíß ‡∏™‡∏°‡∏î‡∏∏‡∏•‡∏ô‡πâ‡∏≥</button>
      <button class="tag" data-action="mode" data-value="plate"     id="m_plate"     type="button">üç± ‡∏à‡∏±‡∏î‡∏à‡∏≤‡∏ô‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û</button>
    </div>

    <div class="row">
      <button class="tag" data-action="diff" data-value="Easy"   id="d_easy"   type="button">‡∏á‡πà‡∏≤‡∏¢</button>
      <button class="tag" data-action="diff" data-value="Normal" id="d_normal" type="button">‡∏õ‡∏Å‡∏ï‡∏¥</button>
      <button class="tag" data-action="diff" data-value="Hard"   id="d_hard"   type="button">‡∏¢‡∏≤‡∏Å</button>

      <span class="modeLabel">
        <span id="t_mode">‡πÇ‡∏´‡∏°‡∏î</span>: <b id="modeName">‡∏î‡∏µ vs ‡∏Ç‡∏¢‡∏∞</b> ‚Ä¢
        <span id="t_diff">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏Å</span>: <b id="difficulty">‡∏õ‡∏Å‡∏ï‡∏¥</b>
      </span>
    </div>

    <div class="row">
      <button class="btn" data-action="start"   id="btn_start"   type="button">‚ñ∂ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°</button>
      <button class="btn" data-action="pause"   id="btn_pause"   type="button">‚è∏ ‡∏û‡∏±‡∏Å</button>
      <button class="btn" data-action="restart" id="btn_restart" type="button">‚Üª ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà</button>
      <button class="btn" data-action="help"    id="btn_help"    type="button">‚ùì ‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏•‡πà‡∏ô</button>
    </div>
  </section>

  <!-- Help Modal -->
  <div id="help" class="modal" style="display:none">
    <div class="card">
      <h3 id="h_help">‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏•‡πà‡∏ô</h3>
      <pre id="helpBody">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏´‡∏°‡∏î ‚Üí ‡πÄ‡∏Å‡πá‡∏ö‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‚Üí ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏Å‡∏±‡∏ö‡∏î‡∏±‡∏Å</pre>
      <button class="btn" data-action="helpClose" id="btn_ok" type="button">‡πÇ‡∏≠‡πÄ‡∏Ñ</button>
    </div>
  </div>

  <!-- Result Modal -->
  <div id="result" class="modal" style="display:none">
    <div class="card">
      <h3 id="h_summary">‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•</h3>
      <div id="resCore"></div>
      <div id="resBreakdown"></div>
      <div id="resBoard"></div>
      <div style="margin-top:12px; display:flex; gap:8px; flex-wrap:wrap;">
        <button class="btn" data-result="replay" id="btn_replay" type="button">‚Üª ‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
        <button class="btn" data-result="home"   id="btn_home"   type="button">üè† ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
      </div>
    </div>
  </div>

  <!-- SFX (‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ id ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏ó‡∏µ‡πà main.js ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ) -->
  <audio id="sfx-good"     preload="auto" src="./assets/sfx/good.mp3"></audio>
  <audio id="sfx-bad"      preload="auto" src="./assets/sfx/bad.mp3"></audio>
  <audio id="sfx-perfect"  preload="auto" src="./assets/sfx/perfect.mp3"></audio>
  <audio id="sfx-tick"     preload="auto" src="./assets/sfx/tick.mp3"></audio>
  <audio id="sfx-powerup"  preload="auto" src="./assets/sfx/powerup.mp3"></audio>

  <!-- ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠ main.js ‡πÑ‡∏°‡πà‡πÇ‡∏´‡∏•‡∏î -->
  <script>
    (function(){
      const w=document.createElement('div');
      w.id='bootWarn';
      w.style.cssText='position:fixed;top:0;left:0;right:0;background:#b00020;color:#fff;padding:10px 12px;font-weight:700;z-index:1000;display:none';
      w.textContent='‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ‡∏ï‡∏£‡∏ß‡∏à path ./game/main.js';
      document.body.appendChild(w);
      // ‡∏ñ‡πâ‡∏≤ bootloader ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡∏ï‡∏±‡πâ‡∏á __HHA_BOOT_OK ‡πÅ‡∏•‡πâ‡∏ß ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á
      setTimeout(()=>{ if(!window.__HHA_BOOT_OK){ w.style.display='block'; } }, 2200);
    })();
  </script>

  <noscript>
    <div style="position:fixed;top:0;left:0;right:0;background:#b00020;color:#fff;padding:10px 12px;font-weight:700;z-index:1000">
      ‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô JavaScript ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°
    </div>
  </noscript>
  <!-- Help Scene (‡∏£‡∏ß‡∏°‡∏ó‡∏∏‡∏Å‡πÄ‡∏Å‡∏°) -->
<div id="helpScene" class="modal" style="display:none">
  <div class="card" style="max-width:960px; width:90%;">
    <div style="display:flex; align-items:center; justify-content:space-between; gap:12px;">
      <h3 id="hs_title" style="margin:0">‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏£‡∏ß‡∏°</h3>
      <button class="btn" data-action="helpSceneClose" id="btn_helpSceneClose" type="button">‚úñ ‡∏õ‡∏¥‡∏î</button>
    </div>
    <div id="hs_body" class="hs-grid" style="margin-top:12px;"></div>
  </div>
</div>

</body>
</html>

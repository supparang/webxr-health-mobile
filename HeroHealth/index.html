<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Hero Health Academy</title>

  <!-- ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö GitHub Pages -->
  <base href="/webxr-health-mobile/HeroHealth/">

  <link rel="stylesheet" href="styles/game.css" />
  <link rel="stylesheet" href="styles/groups.css" />

  <!-- Bootloader: ‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏° import ./game/main.js ‡∏´‡∏•‡∏≤‡∏¢ path ‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ -->
  <script type="module">
  (async () => {
    const warn = document.createElement('div');
    warn.id = 'bootWarn';
    warn.style.cssText = 'position:fixed;top:0;left:0;right:0;background:#b00020;color:#fff;padding:10px 12px;font-weight:700;z-index:2000;display:none';
    warn.textContent = '‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ‡∏ï‡∏£‡∏ß‡∏à path ./game/main.js';
    document.addEventListener('DOMContentLoaded', ()=>document.body.appendChild(warn));

    const chip = document.createElement('div');
    chip.id = 'bootChip';
    chip.style.cssText = 'position:fixed;right:12px;bottom:12px;background:#1b5e20;color:#fff;padding:8px 10px;border-radius:999px;font-weight:800;font-size:12px;z-index:2001;display:none;box-shadow:0 2px 8px rgba(0,0,0,.25)';
    chip.textContent = '‚úÖ JS Loaded';
    document.addEventListener('DOMContentLoaded', ()=>document.body.appendChild(chip));

    const bases = [
      document.baseURI,
      new URL('./', location.href).href,
      location.origin + '/webxr-health-mobile/HeroHealth/',
      'https://supparang.github.io/webxr-health-mobile/HeroHealth/'
    ];
    const paths = ['game/main.js', './game/main.js', 'game/main.js?v=live'];
    const cands = [];
    for (const b of bases) for (const p of paths) cands.push(new URL(p, b).href);

    let ok=false, lastErr=null, tried=[];
    for (const u of cands){
      try{
        const probe = await fetch(u + (u.includes('?')?'&':'?') + 'cb=' + Date.now(), { method:'GET' });
        tried.push(`${probe.status} ${u}`);
        if (!probe.ok) continue;

        const code = await probe.text();
        const blob = new Blob([code], { type:'text/javascript' });
        const blobUrl = URL.createObjectURL(blob);
        await import(blobUrl);
        URL.revokeObjectURL(blobUrl);

        ok=true;
        setTimeout(()=>{ if(window.__HHA_BOOT_OK){ warn.style.display='none'; chip.style.display='inline-block'; }}, 80);
        break;
      }catch(e){
        lastErr = e;
        tried.push(`ERR ${e?.message||e}`);
      }
    }

    if(!ok){
      warn.textContent = '‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ‡∏ï‡∏£‡∏ß‡∏à path / ‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå game/main.js ‚Ä¢ ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î: ' +
        (lastErr?.message || 'not found') + '\nTried:\n' + tried.join('\n');
      warn.style.whiteSpace = 'pre-wrap';
      warn.style.display='block';
    }
  })();
  </script>
  <style>
    /* ‡∏ó‡∏≥‡πÉ‡∏´‡πâ modal/‡∏™‡∏£‡∏∏‡∏õ/‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏•‡∏≤‡∏á‡∏à‡∏≠ + ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏£‡∏ß‡∏°‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏î‡∏π‡πÑ‡∏î‡πâ */
    .modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;z-index:140;background:rgba(0,0,0,.55)}
    .modal .card{max-width:720px;max-height:78vh;overflow:auto;background:#0e1526;border:1px solid #26324d;border-radius:16px;padding:16px 16px 14px;color:#cfe9ff;box-shadow:0 6px 24px rgba(0,0,0,.35)}
    .modal .card h3{margin:0 0 8px 0;font:900 20px/1.2 ui-rounded,system-ui}
    #helpBody{white-space:pre-wrap}
    #helpSceneBody{max-height:66vh;overflow:auto}
    #result .card{max-width:560px}
    .help-icon{font-size:20px;margin-right:6px}
  </style>
</head>
<body>
  <header class="brand" role="banner">
    <div id="brandTitle">HERO HEALTH ACADEMY</div>
    <div class="spacer"></div>
    <button id="langToggle"   class="btn" type="button" aria-pressed="false">üáπüá≠ TH/EN</button>
    <button id="gfxToggle"    class="btn" type="button" aria-pressed="false">üéõÔ∏è ‡∏Å‡∏£‡∏≤‡∏ü‡∏¥‡∏Å: ‡∏õ‡∏Å‡∏ï‡∏¥</button>
    <button id="soundToggle"  class="btn" type="button" aria-pressed="true">üîä ‡πÄ‡∏™‡∏µ‡∏¢‡∏á: ‡πÄ‡∏õ‡∏¥‡∏î</button>
    <button id="hapticToggle" class="btn" type="button" aria-pressed="true">üì≥ ‡∏™‡∏±‡πà‡∏ô: ‡πÄ‡∏õ‡∏¥‡∏î</button>
  </header>

  <!-- ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á/‡πÄ‡∏£‡∏ô‡πÄ‡∏î‡∏≠‡∏£‡πå -->
  <canvas id="c" aria-hidden="true"></canvas>

  <!-- HUD -->
  <section class="hud" role="region" aria-label="HUD">
    <div>
      <span id="t_score">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</span>: <b id="score">0</b> |
      <span id="t_combo">‡∏Ñ‡∏≠‡∏°‡πÇ‡∏ö</span>: <b id="combo">x0</b> |
      <span id="t_time">‡πÄ‡∏ß‡∏•‡∏≤</span>: <b id="time">60</b>s
    </div>

    <!-- Fever bar -->
    <div id="feverBarWrap" class="bar slim"><div id="feverBar"></div></div>
    <div id="fever" class="fever" style="display:none">FEVER!</div>

    <!-- Power-ups -->
    <div id="powerBar" class="powerbar" aria-label="Power-ups">
      <div class="pseg" data-k="x2"><span>√ó2</span><i></i></div>
      <div class="pseg" data-k="freeze"><span>üßä</span><i></i></div>
      <div class="pseg" data-k="sweep"><span>üß≤</span><i></i></div>
    </div>

    <!-- Mini-Quest chips -->
    <div id="questChips" class="quests" aria-live="polite"></div>

    <!-- Target / Plate / Hydration -->
    <div id="targetWrap" style="display:none">üéØ <span id="t_target">‡∏´‡∏°‡∏ß‡∏î</span>: <span id="targetBadge">‚Äî</span></div>
    <div id="plateTracker" style="display:none">üç± <span id="t_quota">‡πÇ‡∏Ñ‡∏ß‡∏ï‡∏≤</span>: <span id="platePills"></span></div>
    <div id="hydroWrap" style="display:none">
      üíß <span id="hydroLabel">‚Äî</span>
      <div class="bar"><div id="hydroBar"></div></div>
    </div>

    <!-- Coach -->
    <div id="coachHUD" class="coach under-fever" style="display:flex">
      <div id="coachText">‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÑ‡∏´‡∏°? ‡∏™‡∏π‡πâ‡πÜ!</div>
    </div>

    <!-- Mission line -->
    <div id="missionLine" class="mission-line" style="display:none">‚Äî</div>
  </section>

  <!-- ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÇ‡∏´‡∏°‡∏î -->
  <main class="game-wrap" role="main" aria-label="Game area">
    <div id="modeRoot" tabindex="0" aria-label="Mode root"></div>
  </main>

  <!-- ‡πÄ‡∏°‡∏ô‡∏π -->
  <section id="menuBar" class="menu" role="navigation" aria-label="‡πÇ‡∏´‡∏°‡∏î‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°">
    <div class="row">
      <!-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏´‡∏°‡∏î: ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏° ‡∏à‡∏ô‡∏Å‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏Å‡∏î Start -->
      <button class="tag" data-action="ui:start:goodjunk"  id="m_goodjunk"  type="button">ü•ó ‡∏î‡∏µ vs ‡∏Ç‡∏¢‡∏∞</button>
      <button class="tag" data-action="ui:start:groups"    id="m_groups"    type="button">üçΩÔ∏è ‡∏à‡∏≤‡∏ô 5 ‡∏´‡∏°‡∏π‡πà</button>
      <button class="tag" data-action="ui:start:hydration" id="m_hydration" type="button">üíß ‡∏™‡∏°‡∏î‡∏∏‡∏•‡∏ô‡πâ‡∏≥</button>
      <button class="tag" data-action="ui:start:plate"     id="m_plate"     type="button">üç± ‡∏à‡∏±‡∏î‡∏à‡∏≤‡∏ô‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û</button>
    </div>
    <div class="row">
      <button class="tag" data-action="diff" data-value="Easy"   id="d_easy"   type="button">‡∏á‡πà‡∏≤‡∏¢</button>
      <button class="tag" data-action="diff" data-value="Normal" id="d_normal" type="button">‡∏õ‡∏Å‡∏ï‡∏¥</button>
      <button class="tag" data-action="diff" data-value="Hard"   id="d_hard"   type="button">‡∏¢‡∏≤‡∏Å</button>
      <span class="modeLabel">
        <span id="t_mode">‡πÇ‡∏´‡∏°‡∏î</span>: <b id="modeName">‡∏î‡∏µ vs ‡∏Ç‡∏¢‡∏∞</b> ‚Ä¢
        <span id="t_diff">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏Å</span>: <b id="difficulty">‡∏õ‡∏Å‡∏ï‡∏¥</b>
      </span>
    </div>
    <div class="row">
      <button class="btn" data-action="start"   id="btn_start"   type="button">‚ñ∂ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°</button>
      <button class="btn" data-action="pause"   id="btn_pause"   type="button">‚è∏ ‡∏û‡∏±‡∏Å</button>
      <button class="btn" data-action="restart" id="btn_restart" type="button">‚Üª ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà</button>
      <button class="btn" data-action="help"      id="btn_help"      type="button">‚ùì ‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏•‡πà‡∏ô (‡πÇ‡∏´‡∏°‡∏î‡∏ô‡∏µ‡πâ)</button>
      <button class="btn" data-action="helpScene" id="btn_helpScene" type="button">üìò ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏£‡∏ß‡∏°</button>
    </div>
  </section>

  <!-- Help (per-mode) -->
  <div id="help" class="modal" style="display:none" role="dialog" aria-modal="true" aria-labelledby="h_help">
    <div class="card">
      <h3 id="h_help"><span class="help-icon">‚ùì</span>‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏•‡πà‡∏ô</h3>
      <div id="helpBody">‚Äî</div>
      <div style="margin-top:12px; display:flex; gap:8px; flex-wrap:wrap;">
        <button class="btn" data-action="helpClose" id="btn_ok" type="button">‡πÇ‡∏≠‡πÄ‡∏Ñ</button>
      </div>
    </div>
  </div>

  <!-- Help Scene (all modes) -->
  <div id="helpScene" class="modal" style="display:none" role="dialog" aria-modal="true" aria-labelledby="h_scene">
    <div class="card">
      <h3 id="h_scene"><span class="help-icon">üìò</span>‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏£‡∏ß‡∏°</h3>
      <div id="helpSceneBody">
        <!-- main.js ‡∏à‡∏∞‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÉ‡∏´‡πâ ‡πÅ‡∏•‡∏∞ container ‡∏ô‡∏µ‡πâ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏•‡∏á‡πÑ‡∏î‡πâ -->
      </div>
      <div style="margin-top:12px; display:flex; gap:8px; flex-wrap:wrap;">
        <button class="btn" data-action="helpSceneClose" id="btn_ok_scene" type="button">‡πÇ‡∏≠‡πÄ‡∏Ñ</button>
      </div>
    </div>
  </div>

  <!-- Result Modal -->
  <div id="result" class="modal" style="display:none" role="dialog" aria-modal="true" aria-labelledby="h_summary">
    <div class="card">
      <h3 id="h_summary">‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•</h3>
      <div id="resCore"></div>
      <div id="resBreakdown"></div>
      <div id="resBoard"></div>
      <div style="margin-top:12px; display:flex; gap:8px; flex-wrap:wrap;">
        <button class="btn" data-result="replay" id="btn_replay" type="button">‚Üª ‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
        <button class="btn" data-result="home"   id="btn_home"   type="button">üè† ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
      </div>
    </div>
  </div>

  <!-- SFX -->
  <audio id="sfx-good"     preload="auto" src="./assets/sfx/good.mp3"></audio>
  <audio id="sfx-bad"      preload="auto" src="./assets/sfx/bad.mp3"></audio>
  <audio id="sfx-perfect"  preload="auto" src="./assets/sfx/perfect.mp3"></audio>
  <audio id="sfx-tick"     preload="auto" src="./assets/sfx/tick.mp3"></audio>
  <audio id="sfx-powerup"  preload="auto" src="./assets/sfx/powerup.mp3"></audio>

  <noscript>
    <div style="position:fixed;top:0;left:0;right:0;background:#b00020;color:#fff;padding:10px 12px;font-weight:700;z-index:2000">
      ‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô JavaScript ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°
    </div>
  </noscript>
</body>
</html>

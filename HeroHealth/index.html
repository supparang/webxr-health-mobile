<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Hero Health Academy</title>

  <!-- р╕кр╕│р╕Др╕▒р╕Н: р╕Хр╕▒р╣Йр╕З base р╣Гр╕лр╣Йр╣Ар╕кр╣Йр╕Щр╕Чр╕▓р╕З assets/module р╕Цр╕╣р╕Бр╕Ър╕Щ GitHub Pages -->
  <base href="/webxr-health-mobile/HeroHealth/">
  <link rel="stylesheet" href="styles/game.css" />
  <link rel="stylesheet" href="styles/groups.css" />

  <!-- Bootloader -->
  <script type="module">
    (async () => {
      const warn = document.createElement('div');
      warn.id = 'bootWarn';
      warn.style.cssText = 'position:fixed;top:0;left:0;right:0;background:#b00020;color:#fff;padding:10px 12px;font-weight:700;z-index:2000;display:none';
      warn.textContent = 'р╣Вр╕лр╕ер╕Фр╕кр╕Др╕гр╕┤р╕Ыр╕Хр╣Мр╣Др╕бр╣Ир╕кр╕│р╣Ар╕гр╣Зр╕И: р╕Хр╕гр╕зр╕И path ./game/main.js';
      document.addEventListener('DOMContentLoaded', ()=>document.body.appendChild(warn));

      const chip = document.createElement('div');
      chip.id = 'bootChip';
      chip.style.cssText = 'position:fixed;right:12px;bottom:12px;background:#1b5e20;color:#fff;padding:8px 10px;border-radius:999px;font-weight:800;font-size:12px;z-index:2001;display:none;box-shadow:0 2px 8px rgba(0,0,0,.25)';
      chip.textContent = 'тЬЕ JS Loaded';
      document.addEventListener('DOMContentLoaded', ()=>document.body.appendChild(chip));

      const bases = [document.baseURI, new URL('./', location.href).href, 'https://supparang.github.io/webxr-health-mobile/HeroHealth/'];
      const paths = ['game/main.js', './game/main.js', 'game/main.js?v=live'];
      const cands = []; for (const b of bases) for (const p of paths) cands.push(new URL(p,b).href);
      let ok=false, last=null;
      for (const u of cands){
        try{
          await import(u+(u.includes('?')?'&':'?')+'cb='+Date.now());
          ok=true;
          setTimeout(()=>{ if(window.__HHA_BOOT_OK){ warn.style.display='none'; chip.style.display='inline-block'; }}, 80);
          break;
        } catch(e){ last=e; }
      }
      if(!ok){
        warn.textContent='р╣Вр╕лр╕ер╕Фр╕кр╕Др╕гр╕┤р╕Ыр╕Хр╣Мр╣Др╕бр╣Ир╕кр╕│р╣Ар╕гр╣Зр╕И: р╕Хр╕гр╕зр╕И path / р╕Кр╕╖р╣Ир╕нр╣Др╕Яр╕ер╣М game/main.js (р╕Хр╕▒р╕зр╕Юр╕┤р╕бр╕Юр╣Мр╣Ар╕ер╣Зр╕Б/р╣Гр╕лр╕Нр╣И) тАв р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Ф: '+(last?.message||String(last));
        warn.style.display='block';
      }
    })();
  </script>
</head>
<body>
  <header class="brand" role="banner">
    <div id="brandTitle">HERO HEALTH ACADEMY</div>
    <div class="spacer"></div>
    <button id="langToggle"   class="btn" type="button" aria-pressed="false">ЁЯЗ╣ЁЯЗн TH/EN</button>
    <button id="gfxToggle"    class="btn" type="button" aria-pressed="false">ЁЯОЫя╕П р╕Бр╕гр╕▓р╕Яр╕┤р╕Б: р╕Ыр╕Бр╕Хр╕┤</button>
    <button id="soundToggle"  class="btn" type="button" aria-pressed="true">ЁЯФК р╣Ар╕кр╕╡р╕вр╕З: р╣Ар╕Ыр╕┤р╕Ф</button>
    <button id="hapticToggle" class="btn" type="button" aria-pressed="true">ЁЯУ│ р╕кр╕▒р╣Ир╕Щ: р╣Ар╕Ыр╕┤р╕Ф</button>
    <button id="contrastToggle" class="btn" type="button" aria-pressed="false">ЁЯОп р╕Др╕нр╕Щр╕Чр╕гр╕▓р╕кр╕Хр╣М: р╕Ыр╕Бр╕Хр╕┤</button>
  </header>

  <!-- р╕Юр╕╖р╣Йр╕Щр╕лр╕ер╕▒р╕З/р╣Ар╕нр╕Яр╣Ар╕Яр╕Бр╕Хр╣Мр╣Ар╕гр╕Щр╣Ар╕Фр╕нр╕гр╣М 3D (р╕Др╕Зр╣Др╕зр╣Йр╕Хр╕▓р╕бр╣Ар╕Фр╕┤р╕б) -->
  <canvas id="c" aria-hidden="true"></canvas>

  <!-- HUD -->
  <section class="hud" role="region" aria-label="HUD">
    <div>
      <span id="t_score">р╕Др╕░р╣Бр╕Щр╕Щ</span>: <b id="score">0</b> |
      <span id="t_combo">р╕Др╕нр╕бр╣Вр╕Ъ</span>: <b id="combo">x0</b> |
      <span id="t_time">р╣Ар╕зр╕ер╕▓</span>: <b id="time">60</b>s
    </div>

    <!-- Fever bar -->
    <div id="feverBarWrap" class="bar slim"><div id="feverBar"></div></div>
    <div id="fever" class="fever" style="display:none">FEVER!</div>

    <!-- Power-ups bar -->
    <div id="powerBar" class="powerbar" aria-label="Power-ups">
      <div class="pseg" data-k="x2"     title="р╕Др╕░р╣Бр╕Щр╕Щ x2 р╕кр╕│р╕лр╕гр╕▒р╕Ър╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕в" aria-disabled="false"><span>├Ч2</span><i></i></div>
      <div class="pseg" data-k="freeze" title="р╕лр╕вр╕╕р╕Фр╣Ар╕зр╕ер╕▓р╕лр╕бр╕зр╕Фр╕Кр╕▒р╣Ир╕зр╕Др╕гр╕▓р╕з"     aria-disabled="false"><span>ЁЯзК</span><i></i></div>
      <div class="pseg" data-k="sweep"  title="Magnet р╕Кр╕┤р╣Йр╕Щр╕Цр╕╣р╕Бр╕Др╕гр╕▒р╣Йр╕Зр╕Цр╕▒р╕Фр╣Др╕Ы" aria-disabled="false"><span>ЁЯз▓</span><i></i></div>
    </div>

    <!-- Mini-Quest chips -->
    <div id="questChips" class="quests" aria-live="polite"></div>

    <!-- Target/Plate/Hydration -->
    <div id="targetWrap" style="display:none">ЁЯОп <span id="t_target">р╕лр╕бр╕зр╕Ф</span>: <span id="targetBadge">тАФ</span></div>
    <div id="plateTracker" style="display:none">ЁЯН▒ <span id="t_quota">р╣Вр╕Др╕зр╕Хр╕▓</span>: <span id="platePills"></span></div>
    <div id="hydroWrap" style="display:none">
      ЁЯТз <span id="t_hydro">р╕кр╕бр╕Фр╕╕р╕ер╕Щр╣Йр╕│</span>:
      <span id="hydroLabel">тАФ</span>
      <div class="bar"><div id="hydroBar"></div></div>
    </div>

    <!-- Coach -->
    <div id="coachHUD" class="coach under-fever" style="display:flex">
      <div id="coachText">р╕Юр╕гр╣Йр╕нр╕бр╣Др╕лр╕б? р╕кр╕╣р╣Йр╣Ж!</div>
    </div>

    <div id="missionLine" class="mission-line" style="display:none">тАФ</div>
  </section>

  <!-- р╕Ир╕╕р╕Ф Mount р╕кр╕│р╕лр╕гр╕▒р╕Ъ UI р╕Вр╕нр╕Зр╣Вр╕лр╕бр╕Ф -->
  <main class="game-wrap" role="main" aria-label="Game area">
    <div id="modeRoot" tabindex="0" aria-label="Mode root"></div>
  </main>

  <!-- р╣Ар╕бр╕Щр╕╣р╕ер╣Ир╕▓р╕З -->
  <section id="menuBar" class="menu" role="navigation" aria-label="р╣Вр╕лр╕бр╕Фр╣Бр╕ер╕░р╕Бр╕▓р╕гр╕Др╕зр╕Ър╕Др╕╕р╕б">
    <div class="row">
      <button class="tag" data-action="ui:start:goodjunk"  id="m_goodjunk"  type="button">ЁЯеЧ р╕Фр╕╡ vs р╕Вр╕вр╕░</button>
      <button class="tag" data-action="ui:start:groups"    id="m_groups"    type="button">ЁЯН╜я╕П р╕Ир╕▓р╕Щ 5 р╕лр╕бр╕╣р╣И</button>
      <button class="tag" data-action="ui:start:hydration" id="m_hydration" type="button">ЁЯТз р╕кр╕бр╕Фр╕╕р╕ер╕Щр╣Йр╕│</button>
      <button class="tag" data-action="ui:start:plate"     id="m_plate"     type="button">ЁЯН▒ р╕Ир╕▒р╕Фр╕Ир╕▓р╕Щр╕кр╕╕р╕Вр╕ар╕▓р╕Ю</button>
    </div>
    <div class="row">
      <button class="tag" data-action="diff" data-value="Easy"   id="d_easy"   type="button">р╕Зр╣Ир╕▓р╕в</button>
      <button class="tag" data-action="diff" data-value="Normal" id="d_normal" type="button">р╕Ыр╕Бр╕Хр╕┤</button>
      <button class="tag" data-action="diff" data-value="Hard"   id="d_hard"   type="button">р╕вр╕▓р╕Б</button>
      <span class="modeLabel">
        <span id="t_mode">р╣Вр╕лр╕бр╕Ф</span>: <b id="modeName">р╕Фр╕╡ vs р╕Вр╕вр╕░</b> тАв
        <span id="t_diff">р╕Др╕зр╕▓р╕бр╕вр╕▓р╕Б</span>: <b id="difficulty">р╕Ыр╕Бр╕Хр╕┤</b>
      </span>
    </div>
    <div class="row">
      <button class="btn" data-action="start"   id="btn_start"   type="button">тЦ╢ р╣Ар╕гр╕┤р╣Ир╕бр╣Ар╕Бр╕б</button>
      <button class="btn" data-action="pause"   id="btn_pause"   type="button">тП╕ р╕Юр╕▒р╕Б</button>
      <button class="btn" data-action="restart" id="btn_restart" type="button">тЖ╗ р╣Ар╕гр╕┤р╣Ир╕бр╣Гр╕лр╕бр╣И</button>
      <button class="btn" data-action="help"    id="btn_help"    type="button">тЭУ р╕зр╕┤р╕Шр╕╡р╣Ар╕ер╣Ир╕Щ</button>
      <button class="btn" data-action="helpScene" id="btn_helpScene" type="button">ЁЯУШ р╕Др╕╣р╣Ир╕бр╕╖р╕нр╕гр╕зр╕б</button>
    </div>
  </section>

<!-- Help Modal (TH/EN + icons for all modes) -->
<div id="help" class="modal" style="display:none" role="dialog" aria-modal="true" aria-labelledby="h_help">
  <div class="card" style="max-width:760px">
    <h3 id="h_help" style="display:flex;align-items:center;gap:8px">
      <span>ЁЯУШ</span> <span>р╕зр╕┤р╕Шр╕╡р╣Ар╕ер╣Ир╕Щ / How to Play</span>
    </h3>

    <!-- Mode icon strip -->
    <div class="help-modes">
      <div class="mode"><span>ЁЯеЧ</span><b>р╕Фр╕╡ vs р╕Вр╕вр╕░</b><small>Good vs Junk</small></div>
      <div class="mode"><span>ЁЯН╜я╕П</span><b>р╕Ир╕▓р╕Щ 5 р╕лр╕бр╕╣р╣И</b><small>Food Group Frenzy</small></div>
      <div class="mode"><span>ЁЯТз</span><b>р╕кр╕бр╕Фр╕╕р╕ер╕Щр╣Йр╕│</b><small>Hydration</small></div>
      <div class="mode"><span>ЁЯН▒</span><b>р╕Ир╕▒р╕Фр╕Ир╕▓р╕Щр╕кр╕╕р╕Вр╕ар╕▓р╕Ю</b><small>Healthy Plate</small></div>
    </div>

    <!-- р╣Ар╕Щр╕╖р╣Йр╕нр╕лр╕▓р╣Бр╕Ър╕Ър╕кр╕ер╕▒р╕Ър╕ар╕▓р╕йр╕▓ -->
    <div id="helpBody" class="help-body" aria-live="polite"></div>

    <div style="display:flex; gap:8px; margin-top:12px; flex-wrap:wrap; justify-content:flex-end">
      <button class="btn" data-action="helpClose" type="button">р╣Вр╕нр╣Ар╕Д</button>
    </div>
  </div>
</div>

<!-- Templates: TH / EN -->
<script type="application/json" id="helpTH">
{
  "sections": [
    {
      "icon":"ЁЯеЧ",
      "h":"р╕Фр╕╡ vs р╕Вр╕вр╕░ (Good vs Junk)",
      "b":[
        "тЬЕ р╣Ар╕Бр╣Зр╕Ър╕нр╕▓р╕лр╕▓р╕гр╕Фр╕╡ р╣Ар╕Юр╕╖р╣Ир╕нр╕Др╕░р╣Бр╕Щр╕Щр╣Бр╕ер╕░р╕Др╕нр╕бр╣Вр╕Ъ",
        "тЭМ р╣Ар╕ер╕╡р╣Ир╕вр╕Зр╕нр╕▓р╕лр╕▓р╕гр╕Вр╕вр╕░ р╕бр╕┤р╕Йр╕░р╕Щр╕▒р╣Йр╕Щр╕Др╕нр╕бр╣Вр╕Ър╕лр╕ер╕╕р╕Ф",
        "ЁЯФе р╕кр╕░р╕кр╕б FEVER р╣Гр╕лр╣Йр╣Ар╕Хр╣Зр╕бр╣Ар╕Юр╕╖р╣Ир╕нр╕Др╕╣р╕Ур╕Др╕░р╣Бр╕Щр╕Щр╕Кр╣Ир╕зр╕Зр╕кр╕▒р╣Йр╕Щр╣Ж"
      ]
    },
    {
      "icon":"ЁЯН╜я╕П",
      "h":"р╕Ир╕▓р╕Щ 5 р╕лр╕бр╕╣р╣И (Food Group Frenzy)",
      "b":[
        "ЁЯОп р╕кр╕▒р╕Зр╣Ар╕Бр╕Х \"р╕лр╕бр╕зр╕Фр╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕в\" р╕бр╕╕р╕бр╕Лр╣Йр╕▓р╕вр╕Ър╕Щ (1тАУ3 р╕лр╕бр╕зр╕Ф/р╕гр╕нр╕Ъ)",
        "ЁЯСЖ р╣Бр╕Хр╕░р╣Др╕нр╕Др╕нр╕Щр╣Гр╕лр╣Йр╕Хр╕гр╕Зр╕лр╕бр╕зр╕Ф: р╕Ьр╕ер╣Др╕бр╣Й / р╕Ьр╕▒р╕Б / р╣Вр╕Ыр╕гр╕Хр╕╡р╕Щ / р╕Шр╕▒р╕Нр╕Юр╕╖р╕К",
        "ЁЯУИ р╕Др╕гр╕Ър╣Вр╕Др╕зр╕Хр╕▓р╣Бр╕Хр╣Ир╕ер╕░р╕лр╕бр╕зр╕Ф тЖТ р╕кр╕╕р╣Ир╕бр╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕вр╣Гр╕лр╕бр╣И",
        "ЁЯЯб р╣Др╕нр╕Др╕нр╕Щр╕Чр╕нр╕З = р╣Вр╕Ър╕Щр╕▒р╕кр╕Юр╕┤р╣Ар╕ир╕й"
      ]
    },
    {
      "icon":"ЁЯТз",
      "h":"р╕кр╕бр╕Фр╕╕р╕ер╕Щр╣Йр╕│ (Hydration)",
      "b":[
        "ЁЯЪ░ р╕Фр╕╖р╣Ир╕бр╕Щр╣Йр╕│р╣Гр╕лр╣Йр╕Юр╕нр╕Фр╕╡р╕Хр╕▓р╕бр╕Бр╕┤р╕Ир╕Бр╕гр╕гр╕б/р╕нр╕▓р╕Бр╕▓р╕и",
        "ЁЯФ╗ р╕бр╕▓р╕Бр╣Др╕Ы/р╕Щр╣Йр╕нр╕вр╣Др╕Ы = р╣Ар╕кр╕╡р╕вр╕Др╕░р╣Бр╕Щр╕Щ",
        "ЁЯЯй р╕гр╕▒р╕Бр╕йр╕▓р╣Бр╕Цр╕Ър╣Гр╕лр╣Йр╕нр╕вр╕╣р╣Ир╣Вр╕Лр╕Щр╕кр╕╡р╣Ар╕Вр╕╡р╕вр╕з"
      ]
    },
    {
      "icon":"ЁЯН▒",
      "h":"р╕Ир╕▒р╕Фр╕Ир╕▓р╕Щр╕кр╕╕р╕Вр╕ар╕▓р╕Ю (Healthy Plate)",
      "b":[
        "ЁЯУж р╕зр╕▓р╕Зр╕нр╕▓р╕лр╕▓р╕гр╕ер╕Зр╕Ир╕▓р╕Щр╣Гр╕лр╣Йр╕Др╕гр╕Ър╣Вр╕Др╕зр╕Хр╕▓р╣Бр╕Хр╣Ир╕ер╕░р╕лр╕бр╕зр╕Ф",
        "тЪЦя╕П р╕Ър╕▓р╕ер╕▓р╕Щр╕Лр╣Мр╕Ьр╕▒р╕БтАУр╕Ьр╕ер╣Др╕бр╣ЙтАУр╣Вр╕Ыр╕гр╕Хр╕╡р╕ЩтАУр╕Шр╕▒р╕Нр╕Юр╕╖р╕К",
        "тЬи р╕зр╕▓р╕Зр╕Цр╕╣р╕Бр╕Хр╣Ир╕нр╣Ар╕Щр╕╖р╣Ир╕нр╕Зр╣Др╕Фр╣Йр╕Др╕нр╕бр╣Вр╕Ъ"
      ]
    },
    {
      "icon":"ЁЯОп",
      "h":"р╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕вр╕вр╣Ир╕нр╕в (Mini Quests)",
      "b":[
        "ЁЯО▓ р╕кр╕╕р╣Ир╕б 3 р╣Ар╕Др╕зр╕кр╕Ир╕▓р╕Б 5 р╕нр╕вр╣Ир╕▓р╕Зр╣Гр╕Щр╣Бр╕Хр╣Ир╕ер╕░р╣Ар╕Бр╕б",
        "ЁЯзй р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕З: р╣Ар╕Бр╣Зр╕Ър╕Ьр╕ер╣Др╕бр╣Й 5 | р╣Вр╕Ыр╕гр╕Хр╕╡р╕Щ 3 р╕Кр╕┤р╣Йр╕Щр╕Хр╕┤р╕Фр╕Бр╕▒р╕Щ | р╣Др╕бр╣Ир╕Юр╕ер╕▓р╕Ф 10 р╕зр╕┤",
        "ЁЯПЕ р╕Чр╕│р╕Др╕гр╕Ър╕гр╕▒р╕Ър╣Вр╕Ър╕Щр╕▒р╕кр╕Др╕░р╣Бр╕Щр╕Щ/р╣Ар╕зр╕ер╕▓"
      ]
    },
    {
      "icon":"ЁЯз░",
      "h":"р╕Юр╕ер╕▒р╕Зр╕Юр╕┤р╣Ар╕ир╕й (Power-ups)",
      "b":[
        "тЭДя╕П Freeze: р╕лр╕вр╕╕р╕Ф TTL р╕Кр╕▒р╣Ир╕зр╕Др╕гр╕▓р╕з",
        "ЁЯз▓ Magnet: р╣Ар╕Юр╕┤р╣Ир╕бр╣Вр╕нр╕Бр╕▓р╕кр╣Ар╕Бр╕┤р╕Фр╣Др╕нр╕Др╕нр╕Щр╕Хр╕▓р╕бр╕лр╕бр╕зр╕Фр╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕в",
        "тЬЦ2 Score: р╕Др╕╣р╕Ур╕Др╕░р╣Бр╕Щр╕Щр╕Кр╣Ир╕зр╕Зр╕кр╕▒р╣Йр╕Щ р╣Ж",
        "тП│ р╕Ыр╕╕р╣Ир╕бр╕Фр╣Йр╕▓р╕Щр╕Ър╕Щр╕Лр╣Йр╕▓р╕вр╕бр╕╡р╕Др╕╣р╕ер╕Фр╕▓р╕зр╕Щр╣М р╣Бр╕Цр╕Ър╕Ир╕░р╕Др╣Ир╕нр╕в р╣Ж р╕ер╕Ф"
      ]
    },
    {
      "icon":"ЁЯТе",
      "h":"р╕Др╕░р╣Бр╕Щр╕Щ тАв р╕Др╕нр╕бр╣Вр╕Ъ тАв FEVER",
      "b":[
        "тЬЕ р╕Цр╕╣р╕Б = р╕Др╕░р╣Бр╕Щр╕Щ+р╕Др╕нр╕бр╣Вр╕Ъ | тЭМ р╕Юр╕ер╕▓р╕Ф = р╕Др╕нр╕бр╣Вр╕Ър╕гр╕╡р╣Ар╕Лр╣Зр╕Х",
        "ЁЯУИ р╕Др╕нр╕бр╣Вр╕Ър╕кр╕╣р╕З = р╕Хр╕▒р╕зр╕Др╕╣р╕Ур╕Др╕░р╣Бр╕Щр╕Щр╕кр╕╣р╕З",
        "ЁЯФе FEVER р╣Ар╕Юр╕┤р╣Ир╕бр╕Хр╕▒р╕зр╕Др╕╣р╕Ур╕гр╕░р╕вр╕░р╕кр╕▒р╣Йр╕Щ"
      ]
    },
    {
      "icon":"тЪЩя╕П",
      "h":"р╕Др╕зр╕▓р╕бр╕вр╕▓р╕Б & р╕Юр╕гр╕╡р╣Ар╕Лр╣Зр╕Х",
      "b":[
        "р╕Зр╣Ир╕▓р╕в / р╕Ыр╕Бр╕Хр╕┤ / р╕вр╕▓р╕Б р╕бр╕╡р╕Ьр╕ер╕Хр╣Ир╕нр╕Др╕зр╕▓р╕бр╕Цр╕╡р╣Ир╣Ар╕Бр╕┤р╕Фр╣Бр╕ер╕░ TTL",
        "More Presets: Arcade / Kids / Timed Rush (р╣Гр╕Кр╣Йр╣Др╕Фр╣Йр╕Чр╕╕р╕Бр╣Вр╕лр╕бр╕Ф)"
      ]
    },
    {
      "icon":"ЁЯОЦя╕П",
      "h":"р╣Ар╕ер╣Ар╕зр╕е тАв р╕бр╕┤р╕Кр╕Кр╕▒р╕Щ тАв р╣Бр╕Ър╕Фр╕Ир╣М",
      "b":[
        "ЁЯЧ║я╕П р╕Чр╕│р╕бр╕┤р╕Кр╕Кр╕▒р╕Щр╕гр╕░р╕вр╕░р╕вр╕▓р╕зр╣Ар╕Юр╕╖р╣Ир╕нр╕нр╕▒р╕Ыр╣Ар╕ер╣Ар╕зр╕е",
        "ЁЯПЖ р╣Ар╕Бр╣Зр╕Ър╣Бр╕Ър╕Фр╕Ир╣Мр╕Юр╕┤р╣Ар╕ир╕й р╣Ар╕Кр╣Ир╕Щ Golden Streak, Perfect Combo",
        "ЁЯУК р╕Фр╕╣р╕Др╕зр╕▓р╕бр╕Др╕╖р╕Ър╕лр╕Щр╣Йр╕▓р╣Гр╕Щ Hero Health Academy Hub"
      ]
    },
    {
      "icon":"ЁЯХ╣я╕П",
      "h":"р╕Бр╕▓р╕гр╕Др╕зр╕Ър╕Др╕╕р╕б (Controls)",
      "b":[
        "ЁЯУ▒ р╕бр╕╖р╕нр╕Цр╕╖р╕н: р╣Бр╕Хр╕░р╣Др╕нр╕Др╕нр╕Щ",
        "ЁЯЦ▒я╕П р╣Ар╕Фр╕кр╕Бр╣Мр╕Чр╣Зр╕нр╕Ы: р╕Др╕ер╕┤р╕Бр╣Ар╕бр╕▓р╕кр╣М",
        "ЁЯФК р╣Ар╕Ыр╕┤р╕Ф/р╕Ыр╕┤р╕Фр╣Ар╕кр╕╡р╕вр╕Зр╣Бр╕ер╕░р╕кр╕▒р╣Ир╕Щр╣Др╕Фр╣Йр╕Чр╕╡р╣Ир╕бр╕╕р╕бр╕Вр╕зр╕▓р╕Ър╕Щ"
      ]
    }
  ]
}
</script>

<script type="application/json" id="helpEN">
{
  "sections": [
    {
      "icon":"ЁЯеЧ",
      "h":"Good vs Junk",
      "b":[
        "тЬЕ Collect healthy items for score and combo.",
        "тЭМ Avoid junk or your combo resets.",
        "ЁЯФе Fill FEVER to gain a temporary multiplier."
      ]
    },
    {
      "icon":"ЁЯН╜я╕П",
      "h":"Food Group Frenzy",
      "b":[
        "ЁЯОп Watch target groups (top-left), 1тАУ3 per round.",
        "ЁЯСЖ Tap icons matching Fruits / Vegetables / Protein / Grains.",
        "ЁЯУИ Clear quotas to roll new targets.",
        "ЁЯЯб Golden icon = bonus."
      ]
    },
    {
      "icon":"ЁЯТз",
      "h":"Hydration",
      "b":[
        "ЁЯЪ░ Drink the right amount based on activity/climate.",
        "ЁЯФ╗ Too much/too little reduces score.",
        "ЁЯЯй Keep the bar in the green zone."
      ]
    },
    {
      "icon":"ЁЯН▒",
      "h":"Healthy Plate",
      "b":[
        "ЁЯУж Place foods onto the plate to meet each groupтАЩs quota.",
        "тЪЦя╕П Balance fruitsтАУveggiesтАУproteinтАУgrains.",
        "тЬи Streak of correct placements builds combo."
      ]
    },
    {
      "icon":"ЁЯОп",
      "h":"Mini Quests",
      "b":[
        "ЁЯО▓ Each run picks 3 of 5 quests.",
        "ЁЯзй Examples: collect 5 fruits | 3 proteins in a row | avoid mistakes 10s.",
        "ЁЯПЕ Finish for bonus score/time."
      ]
    },
    {
      "icon":"ЁЯз░",
      "h":"Power-ups",
      "b":[
        "тЭДя╕П Freeze: pause icon TTL.",
        "ЁЯз▓ Magnet: increase target spawn chance.",
        "тЬЦ2 Score: temporary score x2.",
        "тП│ Top-left buttons have cooldown with filling bar."
      ]
    },
    {
      "icon":"ЁЯТе",
      "h":"Scoring тАв Combo тАв FEVER",
      "b":[
        "тЬЕ Correct = score+combo | тЭМ Wrong = combo reset.",
        "ЁЯУИ Higher combo = higher multiplier.",
        "ЁЯФе FEVER grants extra multiplier briefly."
      ]
    },
    {
      "icon":"тЪЩя╕П",
      "h":"Difficulty & Presets",
      "b":[
        "Easy / Normal / Hard affect spawn & TTL.",
        "More Presets: Arcade / Kids / Timed Rush (all modes)."
      ]
    },
    {
      "icon":"ЁЯОЦя╕П",
      "h":"Level тАв Missions тАв Badges",
      "b":[
        "ЁЯЧ║я╕П Complete long-term missions to level up.",
        "ЁЯПЖ Earn badges like Golden Streak, Perfect Combo.",
        "ЁЯУК Track in the Hero Health Academy Hub."
      ]
    },
    {
      "icon":"ЁЯХ╣я╕П",
      "h":"Controls",
      "b":[
        "ЁЯУ▒ Mobile: Tap icons.",
        "ЁЯЦ▒я╕П Desktop: Click.",
        "ЁЯФК Toggle sound/haptics top-right."
      ]
    }
  ]
}
</script>

<!-- Render logic for both Help & HelpScene buttons -->
<script>
(() => {
  const $ = s => document.querySelector(s);
  const helpBody = $('#helpBody');
  const TH = JSON.parse($('#helpTH').textContent);
  const EN = JSON.parse($('#helpEN').textContent);

  function renderHelp(lang){
    const D = (lang === 'EN') ? EN : TH;
    helpBody.innerHTML = D.sections.map(sec => `
      <section class="help-sec">
        <div class="help-sec-h">
          <span class="ico">${sec.icon}</span>
          <span>${sec.h}</span>
        </div>
        <ul class="help-list">
          ${sec.b.map(x=>`<li>${x}</li>`).join('')}
        </ul>
      </section>
    `).join('');
  }

  function openHelp(){
    const lang = localStorage.getItem('hha_lang') || 'TH';
    renderHelp(lang);
    const modal = $('#help');
    if (modal) modal.style.display = 'flex';
  }

  // р╕Ьр╕╣р╕Бр╕Бр╕▒р╕Ър╕Чр╕▒р╣Йр╕Зр╕Ыр╕╕р╣Ир╕б тЭУ р╣Бр╕ер╕░ ЁЯУШ
  $('#btn_help')?.addEventListener('click', openHelp, {passive:true});
  document.querySelector('[data-action="helpScene"]')?.addEventListener('click', openHelp, {passive:true});

  // р╕нр╕▒р╕Ыр╣Ар╕Фр╕Хр╕ар╕▓р╕йр╕▓р╣Ар╕бр╕╖р╣Ир╕нр╕Бр╕Ф TH/EN р╕Цр╣Йр╕▓ modal р╣Ар╕Ыр╕┤р╕Фр╕нр╕вр╕╣р╣И
  $('#langToggle')?.addEventListener('click', () => {
    setTimeout(() => {
      const modal = $('#help');
      if (modal && modal.style.display === 'flex') {
        const lang = localStorage.getItem('hha_lang') || 'TH';
        renderHelp(lang);
      }
    }, 0);
  }, {passive:true});
})();
</script>



  <!-- Result Modal -->
  <div id="result" class="modal" style="display:none" role="dialog" aria-modal="true" aria-labelledby="h_summary">
    <div class="card">
      <h3 id="h_summary">р╕кр╕гр╕╕р╕Ыр╕Ьр╕е</h3>
      <div id="resCore"></div>
      <div id="resBreakdown"></div>
      <div id="resBoard"></div>
      <div style="margin-top:12px; display:flex; gap:8px; flex-wrap:wrap;">
        <button class="btn" data-result="replay" id="btn_replay" type="button">тЖ╗ р╣Ар╕ер╣Ир╕Щр╕нр╕╡р╕Бр╕Др╕гр╕▒р╣Йр╕З</button>
        <button class="btn" data-result="home"   id="btn_home"   type="button">ЁЯПа р╕лр╕Щр╣Йр╕▓р╕лр╕ер╕▒р╕Б</button>
      </div>
    </div>
  </div>

  <!-- SFX -->
  <audio id="sfx-good"     preload="auto" src="./assets/sfx/good.mp3"></audio>
  <audio id="sfx-bad"      preload="auto" src="./assets/sfx/bad.mp3"></audio>
  <audio id="sfx-perfect"  preload="auto" src="./assets/sfx/perfect.mp3"></audio>
  <audio id="sfx-tick"     preload="auto" src="./assets/sfx/tick.mp3"></audio>
  <audio id="sfx-powerup"  preload="auto" src="./assets/sfx/powerup.mp3"></audio>

  <noscript>
    <div style="position:fixed;top:0;left:0;right:0;background:#b00020;color:#fff;padding:10px 12px;font-weight:700;z-index:2000">
      р╕Ир╕│р╣Ар╕Ыр╣Зр╕Щр╕Хр╣Йр╕нр╕Зр╣Ар╕Ыр╕┤р╕Фр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ JavaScript р╣Ар╕Юр╕╖р╣Ир╕нр╣Ар╕ер╣Ир╕Щр╣Ар╕Бр╕б
    </div>
  </noscript>
</body>
</html>

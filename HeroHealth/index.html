<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Hero Health Academy</title>

  <!-- base ‡πÄ‡∏î‡∏¥‡∏°‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡πÑ‡∏ß‡πâ ‡πÅ‡∏ï‡πà‡πÄ‡∏£‡∏≤‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏û‡∏∂‡πà‡∏á base ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏´‡∏•‡∏±‡∏Å‡∏≠‡∏µ‡∏Å‡∏ï‡πà‡∏≠‡πÑ‡∏õ -->
  <base href="/webxr-health-mobile/HeroHealth/">

  <link rel="stylesheet" href="styles/game.css" />
  <style>
    /* ‡πÉ‡∏´‡πâ canvas ‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏•‡∏¥‡∏Å ‡πÅ‡∏•‡∏∞‡∏ä‡∏±‡πâ‡∏ô UI ‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏ô‡∏™‡∏∏‡∏î‡∏≠‡πà‡∏≤‡∏ô‡∏ä‡∏±‡∏î */
    #c{position:fixed;inset:0;z-index:1;pointer-events:none}
    .hud,.menu,.modal,.coach,.item{z-index:200;pointer-events:auto}
    .hud{font-size:18px;font-weight:800;text-shadow:0 2px 6px #000}
    .item{font-size: clamp(44px, 6vw, 72px)}
    #statusLine{
      position:fixed;top:76px;left:50%;transform:translateX(-50%);
      background:rgba(0,0,0,.45);color:#fff;padding:6px 12px;border-radius:10px;
      font-weight:900;z-index:300
    }
    #bootWarn{
      position:fixed;top:0;left:0;right:0;background:#b00020;color:#fff;
      padding:10px 12px;font-weight:700;z-index:9999;display:none;white-space:pre-wrap
    }
  </style>
  <!-- ‡∏ß‡∏≤‡∏á‡πÅ‡∏ó‡∏ô‡πÅ‡∏ó‡πá‡∏Å‡πÄ‡∏î‡∏¥‡∏° -->
<script type="module" src="https://supparang.github.io/webxr-health-mobile/HeroHealth/game/main.js?v=live"></script>

<!-- Fallback ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ñ‡πâ‡∏≤ main.js ‡πÑ‡∏°‡πà‡∏£‡∏±‡∏ô -->
<script>
  (function(){
    const w=document.createElement('div');
    w.id='bootWarn';
    w.style.cssText='position:fixed;top:0;left:0;right:0;background:#b00020;color:#fff;padding:10px 12px;font-weight:700;z-index:9999;display:none;white-space:pre-wrap';
    w.textContent='‚ö†Ô∏è ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ‡∏ï‡∏£‡∏ß‡∏à URL main.js?v=live';
    document.body.appendChild(w);
    setTimeout(()=>{ if(!window.__HHA_BOOT_OK){ w.style.display='block'; } }, 1500);
  })();
</script>

</head>
<body>
  <div id="bootWarn">‚ö†Ô∏è ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏•‡∏≠‡∏á‡∏û‡∏≤‡∏ò‡∏™‡∏≥‡∏£‡∏≠‡∏á‚Ä¶</div>

  <!-- Header -->
  <header class="brand">
    <div id="brandTitle">HERO HEALTH ACADEMY</div>
    <div class="spacer"></div>
    <button id="langToggle" class="btn">üáπüá≠ TH/EN</button>
    <button id="gfxToggle" class="btn">üéõÔ∏è ‡∏Å‡∏£‡∏≤‡∏ü‡∏¥‡∏Å: ‡∏õ‡∏Å‡∏ï‡∏¥</button>
    <button id="soundToggle" class="btn">üîä ‡πÄ‡∏™‡∏µ‡∏¢‡∏á: ‡πÄ‡∏õ‡∏¥‡∏î</button>
  </header>

  <!-- Render Surface -->
  <canvas id="c"></canvas>

  <!-- HUD -->
  <section class="hud">
    <div class="hud-line">
      <span id="t_score">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</span>: <b id="score">0</b> |
      <span id="t_combo">‡∏Ñ‡∏≠‡∏°‡πÇ‡∏ö</span>: <b id="combo">x0</b> |
      <span id="t_time">‡πÄ‡∏ß‡∏•‡∏≤</span>: <b id="time">60</b>s
    </div>
    <div id="feverBarWrap" class="bar slim"><div id="feverBar" style="width:0%"></div></div>
    <div id="missionLine" style="display:none; font-weight:800;">‚Äî</div>
  </section>

  <div id="statusLine">‡πÇ‡∏´‡∏°‡∏î: ‡∏î‡∏µ vs ‡∏Ç‡∏¢‡∏∞ ‚Ä¢ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏Å: ‡∏õ‡∏Å‡∏ï‡∏¥</div>

  <!-- Coach bubble -->
  <div id="coachHUD" class="coach" style="display:none"><div id="coachText">...</div></div>

  <!-- Menu (‡∏•‡πà‡∏≤‡∏á‡∏ã‡πâ‡∏≤‡∏¢) -->
  <section id="menuBar" class="menu">
    <div class="row">
      <button class="tag" data-action="mode" data-value="goodjunk"  id="m_goodjunk">ü•ó ‡∏î‡∏µ vs ‡∏Ç‡∏¢‡∏∞</button>
      <button class="tag" data-action="mode" data-value="groups"    id="m_groups">üçΩÔ∏è ‡∏à‡∏≤‡∏ô 5 ‡∏´‡∏°‡∏π‡πà</button>
      <button class="tag" data-action="mode" data-value="hydration" id="m_hydration">üíß ‡∏™‡∏°‡∏î‡∏∏‡∏•‡∏ô‡πâ‡∏≥</button>
      <button class="tag" data-action="mode" data-value="plate"     id="m_plate">üç± ‡∏à‡∏±‡∏î‡∏à‡∏≤‡∏ô‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û</button>
    </div>
    <div class="row">
      <button class="tag" data-action="diff" data-value="Easy"   id="d_easy">‡∏á‡πà‡∏≤‡∏¢</button>
      <button class="tag" data-action="diff" data-value="Normal" id="d_normal">‡∏õ‡∏Å‡∏ï‡∏¥</button>
      <button class="tag" data-action="diff" data-value="Hard"   id="d_hard">‡∏¢‡∏≤‡∏Å</button>
      <span class="modeLabel"><span id="t_mode">‡πÇ‡∏´‡∏°‡∏î</span>: <b id="modeName">‡∏î‡∏µ vs ‡∏Ç‡∏¢‡∏∞</b> ‚Ä¢
        <span id="t_diff">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏Å</span>: <b id="difficulty">‡∏õ‡∏Å‡∏ï‡∏¥</b></span>
    </div>
    <div class="row">
      <button class="btn" data-action="start"   id="btn_start">‚ñ∂ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°</button>
      <button class="btn" data-action="pause"   id="btn_pause">‚è∏ ‡∏û‡∏±‡∏Å</button>
      <button class="btn" data-action="restart" id="btn_restart">‚Üª ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà</button>
      <button class="btn" data-action="help"    id="btn_help">‚ùì ‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏•‡πà‡∏ô</button>
    </div>
  </section>

  <!-- Help -->
  <div id="help" class="modal" style="display:none">
    <div class="card">
      <h3 id="h_help">‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏•‡πà‡∏ô</h3>
      <pre id="helpBody">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏´‡∏°‡∏î ‚Üí ‡πÄ‡∏Å‡πá‡∏ö‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‚Üí ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏Å‡∏±‡∏ö‡∏î‡∏±‡∏Å</pre>
      <button class="btn" id="btn_ok">‡πÇ‡∏≠‡πÄ‡∏Ñ</button>
    </div>
  </div>

  <!-- Result -->
  <div id="result" class="modal" style="display:none">
    <div class="card">
      <h3>‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•</h3>
      <div id="resCore"></div>
      <div style="margin-top:12px;display:flex;gap:8px;">
        <button class="btn" id="btn_replay">‚Üª ‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
        <button class="btn" id="btn_home">üè† ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
      </div>
    </div>
  </div>

  <!-- SFX -->
  <audio id="sfx-good"     preload="auto" src="assets/sfx/good.mp3"></audio>
  <audio id="sfx-bad"      preload="auto" src="assets/sfx/bad.mp3"></audio>
  <audio id="sfx-perfect"  preload="auto" src="assets/sfx/perfect.mp3"></audio>
  <audio id="sfx-tick"     preload="auto" src="assets/sfx/tick.mp3"></audio>
  <audio id="sfx-powerup"  preload="auto" src="assets/sfx/powerup.mp3"></audio>

  <!-- ===== Boot Loader: ‡∏•‡∏≠‡∏á‡πÇ‡∏´‡∏•‡∏î main.js ‡∏´‡∏•‡∏≤‡∏¢‡∏û‡∏≤‡∏ò + ‡πÅ‡∏Ñ‡∏ä‡∏ö‡∏±‡∏™‡∏ï‡πå + ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏ ===== -->
  <script type="module">
    // ‡∏ñ‡πâ‡∏≤‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏à‡∏£‡∏¥‡∏á‡∏£‡∏±‡∏ô‡πÑ‡∏î‡πâ ‡∏à‡∏∞‡πÄ‡∏ã‡πá‡∏ï‡∏Ñ‡πà‡∏≤‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô true
    window.__HHA_BOOT_OK = false;

    const tries = [
      // 1) Absolute URL ‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ß‡πà‡∏≤‡∏ñ‡∏π‡∏Å
      'https://supparang.github.io/webxr-health-mobile/HeroHealth/game/main.js?v=live',
      // 2) ‡∏ï‡∏≤‡∏° base href
      new URL('game/main.js?v=live', document.baseURI).href,
      // 3) ‡πÅ‡∏ö‡∏ö relative ‡∏õ‡∏Å‡∏ï‡∏¥ (‡πÄ‡∏ú‡∏∑‡πà‡∏≠ base ‡∏ñ‡∏π‡∏Å‡∏õ‡∏¥‡∏î‡πÇ‡∏î‡∏¢ host)
      'game/main.js?v=live'
    ];

    const warn = document.getElementById('bootWarn');

    (async () => {
      let ok = false, logs = [];
      for (const url of tries) {
        try {
          logs.push('‡∏•‡∏≠‡∏á‡πÇ‡∏´‡∏•‡∏î: ' + url);
          await import(url);
          ok = true;
          break;
        } catch (e) {
          logs.push('‚ùå ' + url + ' -> ' + (e?.message || e));
        }
      }
      if (!ok || !window.__HHA_BOOT_OK) {
        warn.style.display = 'block';
        warn.textContent =
          '‚ö†Ô∏è ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à\n' +
          '‡∏•‡∏≠‡∏á URL ‡πÄ‡∏´‡∏•‡πà‡∏≤‡∏ô‡∏µ‡πâ‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:\n- ' + tries.join('\n- ') +
          '\n\nTips:\n‚Ä¢ ‡∏ï‡∏£‡∏ß‡∏à‡∏ß‡πà‡∏≤‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå /HeroHealth/game/main.js ‡∏à‡∏£‡∏¥‡∏á (‡∏ï‡∏±‡∏ß‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ï‡∏£‡∏á)\n' +
          '‚Ä¢ ‡∏ñ‡πâ‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏á push ‡πÉ‡∏´‡πâ‡∏£‡∏≠ GitHub Pages deploy ‡∏™‡∏±‡πâ‡∏ô ‡πÜ ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î Ctrl/Cmd+F5\n' +
          '‚Ä¢ ‡πÄ‡∏õ‡∏¥‡∏î DevTools > Network ‡∏î‡∏π‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞/‡∏ä‡∏ô‡∏¥‡∏î MIME ‡∏Ç‡∏≠‡∏á main.js ‡∏ï‡πâ‡∏≠‡∏á 200 + javascript\n\n' +
          logs.join('\n');
      } else {
        // ‡πÄ‡∏™‡∏£‡∏¥‡∏°: ‡∏ú‡∏π‡∏Å‡∏õ‡∏∏‡πà‡∏° Start ‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÅ‡∏ô‡πà ‡πÜ (‡∏Å‡∏±‡∏ô‡∏Ñ‡∏•‡∏¥‡∏Å‡πÑ‡∏°‡πà‡∏ï‡∏¥‡∏î)
        const b = document.getElementById('btn_start');
        if (b) {
          const clone = b.cloneNode(true);
          b.parentNode.replaceChild(clone, b);
          clone.addEventListener('click', (e) => {
            e.preventDefault(); e.stopPropagation();
            try {
              if (window.preStartFlow) window.preStartFlow();
              else if (window.start) window.start();
            } catch (err) { console.error('[Start error]', err); }
          }, {capture:true});
        }
      }
    })();
  </script>
</body>
</html>

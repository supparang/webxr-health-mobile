<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Hero Health Academy</title>
  <link rel="stylesheet" href="./styles/game.css"/>

  <style>
    :root{
      --z-menu: 20;
      --z-game: 30;
      --z-hud:  90;
      --z-modal: 120;
    }
    html,body{height:100%}
    body{margin:0;background:#0a1520;color:#fff;font-family:system-ui,'Prompt',sans-serif;overflow:hidden}
    /* ---- Menu ---- */
    #menuBar{
      display:flex;flex-wrap:wrap;gap:10px;align-items:center;justify-content:center;
      padding:12px;background:#13233c;border-bottom:2px solid #223b64;z-index:var(--z-menu);position:relative
    }
    .tile{background:#1f3558;border-radius:12px;padding:12px 16px;font-weight:700;cursor:pointer}
    .tile:hover,.tile.active{background:#2e548c}
    .chip{background:#2e548c;border-radius:999px;padding:6px 12px;cursor:pointer}
    .chip.active{outline:2px solid #8ab4ff}
    #btn_start{padding:8px 14px;border-radius:10px;border:0;background:#38bdf8;color:#001b2e;font-weight:800;cursor:pointer}
    #langToggle{padding:6px 10px;border-radius:10px;border:0;background:#0ea5e9;color:#fff;cursor:pointer}
    body.in-game #menuBar{display:none!important}

    /* ---- Game layer ---- */
    #gameLayer{position:relative;width:100%;height:calc(100vh - 64px);z-index:var(--z-game)}
    #spawnHost{position:absolute;inset:0;overflow:hidden}

    /* ---- HUD (fixed, always on top) ---- */
    #hudWrap{position:fixed;inset:0;pointer-events:none;z-index:var(--z-hud);display:none}
    body.in-game #hudWrap{display:block}

    /* top-left score box */
    .hud-box{position:fixed;top:8px;left:8px;background:#000a;padding:8px 12px;border-radius:10px;font-weight:800}
    .hud-row{display:flex;gap:10px;align-items:center}
    .badge{background:#1f3558;border-radius:8px;padding:4px 8px;min-width:70px;text-align:center}

    /* center-top quest bar */
    #questBar{position:fixed;top:8px;left:50%;transform:translateX(-50%);display:flex;gap:6px}
    #questChips{list-style:none;margin:0;padding:0;display:flex;gap:6px}
    #questChips li{background:#0b2a52a0;border:1px solid #2a69f5a0;border-radius:999px;padding:4px 10px;font-weight:700}

    /* hydration & target */
    #hydroWrap{position:fixed;top:50px;left:50%;transform:translateX(-50%);display:none}
    #targetWrap{position:fixed;top:50px;right:12px;display:none}
    #targetBadge{background:#000a;padding:6px 10px;border-radius:10px}
    #plateTracker{position:fixed;top:86px;right:12px;display:none}
    #platePills{display:flex;flex-direction:column;gap:6px;min-width:200px}
    #platePills .pill{background:#000a;border-radius:10px;padding:6px 10px;position:relative}
    #platePills .pill i{position:absolute;left:0;bottom:0;height:4px;background:#22d3ee;width:0;border-bottom-left-radius:10px;border-bottom-right-radius:10px}
    #platePills .pill.ok{outline:2px solid #22c55e}

    /* coach */
    #coachHUD{position:fixed;bottom:12%;left:50%;transform:translateX(-50%);font-size:22px;font-weight:900;text-shadow:0 2px 10px #000}

    /* toast & mission line */
    #missionLine{position:fixed;top:120px;left:50%;transform:translateX(-50%);display:none;background:#000a;padding:6px 10px;border-radius:10px}
    .toast{position:fixed;bottom:12%;left:50%;transform:translateX(-50%);background:#000a;padding:8px 16px;border-radius:12px;opacity:0;transition:.25s}
    .toast.show{opacity:1}

    /* result modal */
    #resultModal{position:fixed;inset:0;background:#0009;display:none;align-items:center;justify-content:center;z-index:var(--z-modal)}
    #resultCard{background:#10223b;border:1px solid #355e98;border-radius:16px;padding:18px 22px;min-width:260px;text-align:center;pointer-events:auto}
    #resultCard button{margin:6px 8px;padding:8px 14px;border:0;border-radius:10px;font-weight:800;cursor:pointer}

    /* clickable emoji items */
    .spawn-emoji{
      position:absolute; background:#ffffff0d;border:1px solid #ffffff20;border-radius:12px;
      padding:6px 10px;font-size:28px;line-height:1; cursor:pointer; pointer-events:auto;
      box-shadow:0 4px 14px #0008; transform:translateZ(0) rotateX(0deg) rotateY(0deg);
    }
    .flash-danger{animation:fd .18s}
    @keyframes fd{from{filter:brightness(1)}50%{filter:brightness(2)}to{filter:brightness(1)}}
  </style>
</head>
<body data-mode="goodjunk" data-diff="Normal">
  <!-- Menu -->
  <div id="menuBar">
    <div id="m_goodjunk" class="tile active">ü•¶ Good vs Junk</div>
    <div id="m_groups" class="tile">üç± 5 Groups</div>
    <div id="m_hydration" class="tile">üíß Hydration</div>
    <div id="m_plate" class="tile">üçΩÔ∏è Healthy Plate</div>
    <div style="flex-basis:100%;height:0"></div>
    <div class="chip" id="d_easy">Easy</div>
    <div class="chip active" id="d_normal">Normal</div>
    <div class="chip" id="d_hard">Hard</div>
    <button id="btn_start">‚ñ∂ Start</button>
    <button id="langToggle">TH</button>
  </div>

  <!-- Game Layer -->
  <div id="gameLayer">
    <div id="spawnHost"></div>
  </div>

  <!-- HUD (always on top while in-game) -->
  <div id="hudWrap" aria-live="polite">
    <div class="hud-box">
      <div class="hud-row">
        <span class="badge">Score: <b id="score">0</b></span>
        <span class="badge">Combo: <b id="combo">0</b></span>
        <span class="badge">Time: <b id="time">45</b>s</span>
        <span class="badge">Fever: <b id="fever">‚Äì</b></span>
      </div>
    </div>

    <!-- Mini Quest -->
    <div id="questBar"><ul id="questChips"></ul></div>

    <!-- Hydration -->
    <div id="hydroWrap"></div>

    <!-- Target badge (Groups) -->
    <div id="targetWrap"><span id="targetBadge">‚Äî</span></div>

    <!-- Plate pills -->
    <div id="plateTracker">
      <div id="platePills"></div>
    </div>

    <!-- Coach -->
    <div id="coachHUD"></div>

    <!-- Mission line + toast -->
    <div id="missionLine"></div>
    <div id="toast" class="toast"></div>
  </div>

  <!-- Result -->
  <div id="resultModal">
    <div id="resultCard">
      <h3 style="margin:.2rem 0 1rem">Result</h3>
      <div>Score: <b id="resScore">0</b></div>
      <div>Best Combo: <b id="resCombo">0</b></div>
      <div style="margin-top:12px">
        <button id="btn_home">üè† Home</button>
        <button id="btn_replay">‚ü≤ Replay</button>
      </div>
    </div>
  </div>

  <audio id="sfx-good" src="./sounds/good.mp3" preload="auto"></audio>
  <audio id="sfx-bad" src="./sounds/bad.mp3" preload="auto"></audio>
  <audio id="sfx-perfect" src="./sounds/perfect.mp3" preload="auto"></audio>

  <script type="module" src="./game/main.js"></script>
</body>
</html>

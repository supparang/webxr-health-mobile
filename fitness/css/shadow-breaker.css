/* === /fitness/css/shadow-breaker.css ===
Shadow Breaker (DOM) — PRODUCTION CSS PATCH
Focus:
✅ Fix “layout แน่น” บนมือถือ
✅ HUD/Meta ไม่บังพื้นที่เล่น (stage ได้พื้นที่มากขึ้น)
✅ Safe-zone vars สำหรับ spawn (ใช้ร่วมกับ DomRendererShadow)
✅ Meta card auto-collapse บนจอเล็ก
✅ Targets + expire เนียน
✅ Responsive typography + spacing
*/

:root{
  --sb-bg0:#070b16;
  --sb-bg1:#0b1226;
  --sb-card:rgba(15,23,42,.58);
  --sb-card2:rgba(2,6,23,.62);
  --sb-border:rgba(148,163,184,.18);
  --sb-text:#e5e7eb;
  --sb-dim:#a7b0c0;

  /* --- Layout sizing (tuned to reduce cramped feeling) --- */
  --sb-maxw: 1040px;
  --sb-pad: 12px;
  --sb-gap: 10px;

  /* Header height influence */
  --sb-header-pad: 10px;

  /* Stage height control (mobile gets more stage) */
  --sb-stage-min: 360px;

  /* Safe-zone vars used by dom-renderer-shadow.js */
  --sb-safe-pad: 18;   /* base pad */
  --sb-safe-top: 10;   /* extra from HUD top */
  --sb-safe-side: 12;  /* side breathing */
  --sb-safe-bot: 14;   /* avoid fever bottom */

  /* Target & FX */
  --sb-target-shadow: 0 10px 26px rgba(0,0,0,.35);
  --sb-radius: 16px;
}

*{ box-sizing:border-box; }
html,body{ height:100%; }
body{
  margin:0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans Thai", sans-serif;
  color:var(--sb-text);
  background:
    radial-gradient(1100px 520px at 20% 10%, rgba(56,189,248,.12), transparent 60%),
    radial-gradient(900px 480px at 80% 0%, rgba(244,114,182,.10), transparent 60%),
    linear-gradient(180deg, var(--sb-bg0), var(--sb-bg1));
  overflow-x:hidden;
}

/* Shell */
.sb-wrap{
  max-width: var(--sb-maxw);
  margin: 0 auto;
  padding: var(--sb-pad);
}

/* Header */
.sb-header{
  display:flex;
  gap: var(--sb-gap);
  align-items:flex-end;
  justify-content:space-between;
  padding: var(--sb-header-pad) 4px;
}
.sb-header-left{ min-width: 0; }
.sb-kicker{
  font-size: 12px;
  color: var(--sb-dim);
  letter-spacing:.3px;
}
.sb-title{
  margin: 4px 0 2px;
  font-size: 22px;
  line-height:1.1;
}
.sb-sub{
  font-size: 13px;
  color: var(--sb-dim);
  max-width: 52ch;
}
.sb-header-right{
  display:flex;
  flex-direction:column;
  gap:6px;
  align-items:flex-end;
}
.sb-tip{
  font-size: 12px;
  color: var(--sb-dim);
  padding: 6px 10px;
  border:1px solid var(--sb-border);
  border-radius: 999px;
  background: rgba(2,6,23,.35);
}
.sb-tip code{
  font-family: ui-monospace, SFMono-Regular, Menlo, monospace;
  font-size: 12px;
  background: rgba(148,163,184,.12);
  padding: 1px 6px;
  border-radius: 8px;
  border:1px solid rgba(148,163,184,.18);
}
.sb-links{ display:flex; gap:8px; }
.sb-link{
  color: var(--sb-text);
  text-decoration:none;
  font-size: 13px;
  opacity:.9;
  border:1px solid var(--sb-border);
  background: rgba(2,6,23,.35);
  padding: 7px 10px;
  border-radius: 12px;
}
.sb-link:active{ transform: translateY(1px); }

/* Views */
.sb-main{ padding-top: 6px; }
.sb-view{ display:none; }
.sb-view.is-active{ display:block; }

/* Panels (Menu/Result) */
.sb-panel{
  border:1px solid var(--sb-border);
  background: var(--sb-card);
  backdrop-filter: blur(10px);
  border-radius: calc(var(--sb-radius) + 2px);
  padding: 14px;
}

/* Menu */
.sb-mode-row{
  display:flex;
  gap:10px;
  margin-bottom: 10px;
}
.sb-mode-btn{
  flex: 1;
  padding: 10px 12px;
  border-radius: 14px;
  border:1px solid var(--sb-border);
  background: rgba(2,6,23,.35);
  color: var(--sb-text);
  font-weight: 800;
  letter-spacing:.2px;
}
.sb-mode-btn.is-active{
  outline: 2px solid rgba(56,189,248,.35);
  background: rgba(56,189,248,.10);
}
.sb-mode-desc{
  font-size: 13px;
  color: var(--sb-dim);
  margin: 6px 0 12px;
}
.sb-form{
  display:grid;
  gap: 10px;
}
.sb-field{ display:grid; gap:6px; }
.sb-label{
  font-size: 12px;
  color: var(--sb-dim);
}
.sb-input{
  width:100%;
  padding: 10px 12px;
  border-radius: 14px;
  border:1px solid var(--sb-border);
  background: rgba(2,6,23,.35);
  color: var(--sb-text);
  font-size: 14px;
  outline:none;
}
.sb-actions{
  display:flex;
  gap:10px;
  margin-top: 6px;
}
.sb-btn{
  border:1px solid var(--sb-border);
  background: rgba(2,6,23,.35);
  color: var(--sb-text);
  border-radius: 14px;
  padding: 10px 12px;
  font-weight: 800;
  cursor:pointer;
}
.sb-btn:active{ transform: translateY(1px); }
.sb-btn-primary{
  background: rgba(56,189,248,.14);
  border-color: rgba(56,189,248,.25);
}
.sb-btn-ghost{
  background: transparent;
}
.sb-howto{
  display:none;
  margin-top: 8px;
  padding: 10px 12px;
  border-radius: 14px;
  border:1px solid var(--sb-border);
  background: rgba(2,6,23,.35);
  color: var(--sb-text);
}
.sb-howto.is-on{ display:block; }
.sb-howto ul{ margin:0; padding-left: 18px; }
.sb-mini-note{
  font-size: 12px;
  color: var(--sb-dim);
  border-top: 1px dashed rgba(148,163,184,.22);
  padding-top: 10px;
}
.sb-mini-note code{
  font-family: ui-monospace, SFMono-Regular, Menlo, monospace;
  font-size: 12px;
  background: rgba(148,163,184,.12);
  padding: 1px 6px;
  border-radius: 8px;
  border:1px solid rgba(148,163,184,.18);
}

/* Play view */
.sb-play{}

/* HUD (top row) */
.sb-hud{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap: 10px;
  padding: 10px 12px;
  border:1px solid var(--sb-border);
  background: rgba(2,6,23,.40);
  border-radius: var(--sb-radius);
}

/* Left stats compact */
.sb-hud-left{
  display:flex;
  gap: 10px;
  flex-wrap:wrap;
  min-width: 0;
}
.sb-stat{
  display:flex;
  gap: 6px;
  align-items:baseline;
  padding: 6px 10px;
  border-radius: 12px;
  border:1px solid rgba(148,163,184,.14);
  background: rgba(2,6,23,.25);
}
.sb-stat .k{ font-size: 11px; color: var(--sb-dim); }
.sb-stat .v{ font-size: 14px; font-weight: 900; }

/* Center boss name */
.sb-hud-center{
  min-width: 0;
  text-align:center;
  flex: 1;
}
.sb-boss-name{
  font-weight: 950;
  font-size: 14px;
  letter-spacing:.2px;
  opacity:.95;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}

/* Right controls */
.sb-hud-right{
  display:flex;
  align-items:center;
  gap: 10px;
}
.sb-toggle{
  display:flex;
  gap: 8px;
  align-items:center;
  font-size: 12px;
  color: var(--sb-dim);
  user-select:none;
}
.sb-toggle input{ transform: translateY(1px); }

/* Bars */
.sb-bars{
  display:flex;
  gap: 10px;
  margin-top: 10px;
}
.sb-bars-top{ margin-bottom: 10px; }
.sb-bars-bottom{ margin-top: 10px; }

.sb-bar{
  flex: 1;
  display:flex;
  align-items:center;
  gap: 10px;
  padding: 8px 10px;
  border-radius: var(--sb-radius);
  border:1px solid var(--sb-border);
  background: rgba(2,6,23,.35);
}
.sb-bar-label{
  font-size: 12px;
  color: var(--sb-dim);
  width: 42px;
  flex: 0 0 auto;
}
.sb-bar-track{
  position:relative;
  height: 10px;
  flex: 1;
  border-radius: 999px;
  background: rgba(148,163,184,.14);
  overflow:hidden;
}
.sb-bar-fill{
  height:100%;
  width:100%;
  transform-origin:left center;
  background: rgba(56,189,248,.65);
}
.sb-bar-fill.boss{
  background: rgba(244,114,182,.62);
}

/* Stage (main play area) */
.sb-stage{
  position: relative;
  border-radius: calc(var(--sb-radius) + 2px);
  border:1px solid var(--sb-border);
  background: rgba(2,6,23,.30);
  overflow:hidden;

  /* ✅ gives more room on mobile */
  min-height: var(--sb-stage-min);
}

/* Center message overlay (non-blocking) */
.sb-center-msg{
  position:absolute;
  inset: 0;
  display:flex;
  align-items:center;
  justify-content:center;
  pointer-events:none;
  z-index: 3;
}
.sb-msg-main{
  font-weight: 950;
  letter-spacing:.2px;
  padding: 10px 14px;
  border-radius: 999px;
  border:1px solid rgba(148,163,184,.18);
  background: rgba(2,6,23,.35);
  box-shadow: 0 12px 30px rgba(0,0,0,.25);
  font-size: 14px;
  opacity:.92;
}
.sb-msg-main.good{ border-color: rgba(56,189,248,.30); }
.sb-msg-main.perfect{ border-color: rgba(250,204,21,.35); }
.sb-msg-main.bad, .sb-msg-main.miss{ border-color: rgba(248,113,113,.35); }

/* Target layer is full stage */
.sb-target-layer{
  position:absolute;
  inset: 0;
  z-index: 2;
}

/* Meta card (right side) */
.sb-meta{
  position:absolute;
  right: 10px;
  top: 10px;
  width: 220px;
  border-radius: var(--sb-radius);
  border:1px solid var(--sb-border);
  background: rgba(2,6,23,.42);
  backdrop-filter: blur(10px);
  z-index: 4;
  box-shadow: 0 14px 32px rgba(0,0,0,.22);
}
.sb-meta-rowtop{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding: 10px 10px 8px;
  gap: 10px;
}
.sb-meta-emoji{
  font-size: 20px;
}
.sb-meta-toggle{
  border:1px solid rgba(148,163,184,.18);
  background: rgba(148,163,184,.10);
  color: var(--sb-text);
  border-radius: 10px;
  padding: 6px 10px;
  font-weight: 900;
  cursor:pointer;
}
.sb-meta-body{
  padding: 0 10px 10px;
}
.sb-meta-name{
  font-weight: 950;
  font-size: 13px;
  margin-bottom: 4px;
}
.sb-meta-desc{
  font-size: 12px;
  color: var(--sb-dim);
  line-height: 1.3;
  margin-bottom: 8px;
}
.sb-meta-row{
  display:flex;
  justify-content:space-between;
  align-items:center;
  font-size: 12px;
  color: var(--sb-dim);
  padding: 6px 0;
  border-top: 1px dashed rgba(148,163,184,.18);
}
.sb-meta-row b{
  color: var(--sb-text);
  font-weight: 950;
}

/* Fever block (bottom left) */
.sb-fever{
  flex: 1.3;
  border:1px solid var(--sb-border);
  background: rgba(2,6,23,.35);
  border-radius: var(--sb-radius);
  padding: 10px 10px 10px;
}
.sb-fever-head{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap: 10px;
  margin-bottom: 8px;
}
.sb-fever-head .k{ font-size: 12px; color: var(--sb-dim); }
.sb-fever-head .v{ font-size: 12px; font-weight: 950; }
#sb-label-fever.on{ color: #facc15; }
.sb-fever-btn{
  border:1px solid rgba(250,204,21,.25);
  background: rgba(250,204,21,.10);
  color: var(--sb-text);
  border-radius: 14px;
  padding: 8px 10px;
  font-weight: 950;
  cursor:pointer;
}
.sb-fever-track{
  height: 10px;
  background: rgba(148,163,184,.14);
  border-radius: 999px;
  overflow:hidden;
}
.sb-fever-fill{
  height:100%;
  width:100%;
  transform-origin:left center;
  background: rgba(250,204,21,.55);
  transform: scaleX(0);
}
.sb-fever-hint{
  font-size: 12px;
  color: var(--sb-dim);
  margin-top: 8px;
}

/* Compact block (phase/shield + bottom bars) */
.sb-bars-compact{
  flex: .9;
  border:1px solid var(--sb-border);
  background: rgba(2,6,23,.35);
  border-radius: var(--sb-radius);
  padding: 10px;
  display:grid;
  gap: 8px;
}
.sb-bars-compact .sb-row{
  display:flex;
  justify-content:space-between;
  align-items:center;
  font-size: 12px;
  color: var(--sb-dim);
}
.sb-bars-compact .sb-row .v{
  color: var(--sb-text);
  font-weight: 950;
}

/* Targets */
.sb-target{
  position:absolute;
  display:flex;
  align-items:center;
  justify-content:center;
  border-radius: 999px;
  border: 1px solid rgba(148,163,184,.22);
  background: rgba(2,6,23,.40);
  box-shadow: var(--sb-target-shadow);
  cursor:pointer;
  user-select:none;
  touch-action: manipulation;

  /* ✅ pop in */
  transform: scale(.92);
  opacity: .0;
  animation: sb-popin 120ms ease-out forwards;
}
@keyframes sb-popin{
  to{ transform: scale(1); opacity: 1; }
}

/* Type accents */
.sb-target--normal{ border-color: rgba(56,189,248,.25); }
.sb-target--decoy{ border-color: rgba(148,163,184,.24); filter: saturate(.9); }
.sb-target--bomb{ border-color: rgba(248,113,113,.28); }
.sb-target--heal{ border-color: rgba(74,222,128,.28); }
.sb-target--shield{ border-color: rgba(59,130,246,.30); }
.sb-target--bossface{
  border-color: rgba(250,204,21,.30);
  background: rgba(2,6,23,.50);
}

/* ✅ Expire animation (soft fade + slight shrink) */
.sb-target.is-expiring{
  transition: transform 180ms ease, opacity 180ms ease;
  transform: scale(.85);
  opacity: 0;
}

/* Result view */
.sb-result-title{ margin: 0 0 10px; }
.sb-result-grid{
  display:grid;
  grid-template-columns: repeat(4, minmax(0, 1fr));
  gap: 10px;
}
.sb-result-card{
  border:1px solid var(--sb-border);
  background: rgba(2,6,23,.35);
  border-radius: var(--sb-radius);
  padding: 10px;
}
.sb-result-card .k{
  font-size: 12px;
  color: var(--sb-dim);
}
.sb-result-card .v{
  font-size: 16px;
  font-weight: 950;
  margin-top: 4px;
}
.sb-result-actions{
  display:flex;
  gap: 10px;
  flex-wrap:wrap;
  margin-top: 12px;
}

/* =========================
   ✅ Responsive / Mobile compact
   ========================= */
@media (max-width: 860px){
  :root{ --sb-maxw: 960px; }
  .sb-header{
    flex-direction:column;
    align-items:flex-start;
  }
  .sb-header-right{
    width:100%;
    align-items:flex-start;
  }
  .sb-bars{ flex-direction:column; }
  .sb-result-grid{ grid-template-columns: repeat(2, minmax(0, 1fr)); }
}

/* Mobile: make play area bigger + collapse meta + tighten HUD */
@media (max-width: 520px){
  :root{
    --sb-pad: 10px;
    --sb-gap: 8px;

    /* ✅ give stage more real space */
    --sb-stage-min: 430px;

    /* ✅ safe-zone tighter but still avoids HUD/meta */
    --sb-safe-pad: 14;
    --sb-safe-top: 8;
    --sb-safe-side: 10;
    --sb-safe-bot: 10;
  }

  .sb-title{ font-size: 20px; }
  .sb-sub{ font-size: 12px; }

  .sb-hud{
    padding: 8px 10px;
    align-items:flex-start;
  }
  .sb-hud-left{ gap: 8px; }
  .sb-stat{ padding: 5px 8px; }
  .sb-stat .v{ font-size: 13px; }
  .sb-boss-name{ font-size: 13px; }

  /* ✅ Meta auto-collapse (smaller footprint) */
  .sb-meta{
    width: 160px;
    right: 8px;
    top: 8px;
  }
  .sb-meta-body{
    display:none; /* collapsed by default on mobile */
  }

  /* Fever + compact stacked already, but reduce padding */
  .sb-fever{ padding: 10px; }
  .sb-bars-compact{ padding: 10px; }
}

/* Ultra small */
@media (max-width: 380px){
  :root{
    --sb-stage-min: 420px;
    --sb-safe-pad: 12;
    --sb-safe-side: 8;
  }
  .sb-meta{ width: 150px; }
}

/* =========================
   FX classes used by fx-burst.js
   (colors are handled in that module typically)
   ========================= */
.sb-fx-hit{}
.sb-fx-fever{}
.sb-fx-miss{}
.sb-fx-bomb{}
.sb-fx-heal{}
.sb-fx-shield{}
/* === /fitness/css/shadow-breaker.css ===
Shadow Breaker — FULL CSS PATCH (v20260219-full)
Focus:
✅ layout ไม่แน่น (grid/responsive)
✅ HUD/Meta ไม่บังพื้นที่เล่น
✅ safe-zone สำหรับ spawn (engine/renderer อ่านจาก CSS vars)
✅ mobile compact (พับ meta, ลด padding, HUD แถวเดียว)
✅ expire เนียน (fade+shrink)
*/

:root{
  --sb-bg: #070a12;
  --sb-panel: rgba(15, 23, 42, .72);
  --sb-panel2: rgba(2, 6, 23, .70);
  --sb-stroke: rgba(148, 163, 184, .22);
  --sb-stroke2: rgba(148, 163, 184, .14);
  --sb-text: #e5e7eb;
  --sb-muted: rgba(226, 232, 240, .72);

  --sb-radius: 18px;
  --sb-radius2: 14px;
  --sb-shadow: 0 18px 50px rgba(0,0,0,.45);

  /* ✅ SAFE ZONE vars used by dom-renderer-shadow.js */
  --sb-safe-pad: 18;  /* base pad inside target-layer */
  --sb-safe-top: 14;
  --sb-safe-side: 14;
  --sb-safe-bot: 14;

  /* Layout scales */
  --sb-maxw: 1080px;
  --sb-gap: 14px;
  --sb-pad: 14px;

  /* HUD sizing */
  --sb-hud-h: 56px;
  --sb-bars-h: 58px;
  --sb-meta-w: 240px;

  /* Target feel */
  --sb-target-outline: rgba(255,255,255,.14);
}

*{ box-sizing:border-box; }
html,body{ height:100%; }
body{
  margin:0;
  font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans Thai", sans-serif;
  color: var(--sb-text);
  background:
    radial-gradient(1200px 900px at 30% -10%, rgba(99,102,241,.18), transparent 55%),
    radial-gradient(1000px 800px at 110% 20%, rgba(34,211,238,.14), transparent 56%),
    radial-gradient(900px 700px at -10% 100%, rgba(244,114,182,.10), transparent 60%),
    var(--sb-bg);
  overflow-x:hidden;
}

code{
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
  font-size: .92em;
  background: rgba(148,163,184,.12);
  border:1px solid rgba(148,163,184,.14);
  padding: .08em .36em;
  border-radius: 10px;
}

a{ color:inherit; }

/* Wrapper */
.sb-wrap{
  max-width: var(--sb-maxw);
  margin: 0 auto;
  padding: 14px;
}

/* Header */
.sb-header{
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
  gap: var(--sb-gap);
  padding: 12px 12px;
  border: 1px solid var(--sb-stroke2);
  border-radius: var(--sb-radius);
  background: rgba(2,6,23,.50);
  box-shadow: var(--sb-shadow);
}

.sb-kicker{
  font-size: 12px;
  opacity:.8;
  letter-spacing:.2px;
}
.sb-title{
  margin: 4px 0 2px;
  font-size: 22px;
  line-height:1.1;
}
.sb-sub{
  font-size: 13px;
  opacity:.82;
  max-width: 52ch;
}

.sb-header-right{
  text-align:right;
  display:flex;
  flex-direction:column;
  gap: 10px;
}
.sb-tip{
  font-size: 12px;
  opacity:.75;
}
.sb-links{ display:flex; justify-content:flex-end; gap: 8px; }
.sb-link{
  font-size: 13px;
  text-decoration:none;
  padding: 8px 10px;
  border:1px solid rgba(148,163,184,.18);
  border-radius: 12px;
  background: rgba(15,23,42,.45);
}

/* Main */
.sb-main{
  margin-top: 12px;
}

/* Views */
.sb-view{ display:none; }
.sb-view.is-active{ display:block; }

/* Panels */
.sb-panel{
  padding: 14px;
  border:1px solid var(--sb-stroke2);
  border-radius: var(--sb-radius);
  background: var(--sb-panel);
  box-shadow: var(--sb-shadow);
}

/* Menu */
.sb-mode-row{
  display:flex;
  gap: 10px;
  margin-bottom: 10px;
}
.sb-mode-btn{
  flex:1;
  padding: 10px 12px;
  border-radius: 14px;
  border: 1px solid rgba(148,163,184,.18);
  background: rgba(2,6,23,.55);
  color: var(--sb-text);
  font-weight: 700;
  cursor:pointer;
}
.sb-mode-btn.is-active{
  border-color: rgba(99,102,241,.45);
  box-shadow: 0 0 0 2px rgba(99,102,241,.12) inset;
}
.sb-mode-desc{
  font-size: 13px;
  opacity:.82;
  margin: 8px 0 12px;
}

.sb-form{
  display:grid;
  grid-template-columns: repeat(3, minmax(0, 1fr));
  gap: 12px;
  align-items:end;
}
.sb-field{ display:flex; flex-direction:column; gap: 6px; }
.sb-label{ font-size: 12px; opacity:.8; }
.sb-input{
  width:100%;
  padding: 10px 12px;
  border-radius: 14px;
  border: 1px solid rgba(148,163,184,.18);
  background: rgba(2,6,23,.62);
  color: var(--sb-text);
  outline:none;
}
.sb-actions{
  grid-column: 1 / -1;
  display:flex;
  gap: 10px;
  flex-wrap:wrap;
  margin-top: 2px;
}
.sb-btn{
  padding: 10px 12px;
  border-radius: 14px;
  border: 1px solid rgba(148,163,184,.18);
  background: rgba(15,23,42,.50);
  color: var(--sb-text);
  font-weight: 800;
  cursor:pointer;
}
.sb-btn-primary{
  border-color: rgba(34,211,238,.40);
  background: rgba(34,211,238,.14);
}
.sb-btn-ghost{
  background: rgba(2,6,23,.35);
}
.sb-mini-note{
  grid-column: 1 / -1;
  font-size: 12px;
  opacity:.72;
  padding-top: 8px;
  border-top: 1px dashed rgba(148,163,184,.18);
}

.sb-howto{
  grid-column: 1 / -1;
  display:none;
  margin-top: 10px;
  padding: 10px 12px;
  border:1px solid rgba(148,163,184,.16);
  border-radius: 16px;
  background: rgba(2,6,23,.50);
  font-size: 13px;
  opacity:.9;
}
.sb-howto.is-on{ display:block; }
.sb-howto ul{ margin:0; padding-left: 18px; }
.sb-howto li{ margin: 6px 0; }

/* =========================
   PLAY VIEW (ลดแน่น)
   ========================= */
.sb-play{
  border-radius: var(--sb-radius);
  overflow:hidden;
}

/* HUD */
.sb-hud{
  display:grid;
  grid-template-columns: 1fr minmax(140px, 1.2fr) auto;
  align-items:center;
  gap: 10px;
  padding: 10px 12px;
  background: rgba(2,6,23,.55);
  border: 1px solid rgba(148,163,184,.14);
  border-radius: var(--sb-radius);
  box-shadow: 0 8px 24px rgba(0,0,0,.22);
}

.sb-hud-left{
  display:flex;
  gap: 10px;
  flex-wrap:wrap;
  align-items:center;
}
.sb-stat{
  display:flex;
  gap: 6px;
  align-items:baseline;
  padding: 6px 10px;
  border-radius: 14px;
  border:1px solid rgba(148,163,184,.14);
  background: rgba(15,23,42,.45);
  min-width: 118px;
}
.sb-stat .k{ font-size: 12px; opacity:.78; }
.sb-stat .v{ font-size: 14px; font-weight: 900; }

.sb-hud-center{ text-align:center; }
.sb-boss-name{
  font-weight: 900;
  letter-spacing:.2px;
  font-size: 14px;
  opacity:.92;
  padding: 8px 10px;
  border-radius: 14px;
  background: rgba(99,102,241,.10);
  border:1px solid rgba(99,102,241,.22);
  display:inline-block;
}

.sb-hud-right{
  display:flex;
  gap: 10px;
  align-items:center;
  justify-content:flex-end;
}
.sb-toggle{
  display:flex;
  gap: 8px;
  align-items:center;
  font-size: 13px;
  opacity:.9;
  padding: 8px 10px;
  border-radius: 14px;
  border:1px solid rgba(148,163,184,.14);
  background: rgba(15,23,42,.40);
}
.sb-toggle input{ transform: translateY(1px); }

/* Bars (Top/Bottom) */
.sb-bars{
  margin-top: 10px;
  display:flex;
  gap: 10px;
  flex-wrap:wrap;
}
.sb-bars-top{ margin-top: 10px; }
.sb-bars-bottom{ margin-top: 10px; }

.sb-bar{
  flex:1;
  min-width: 240px;
  display:flex;
  align-items:center;
  gap: 10px;
  padding: 10px 12px;
  border-radius: var(--sb-radius);
  background: rgba(2,6,23,.45);
  border:1px solid rgba(148,163,184,.14);
}
.sb-bar-label{
  width: 44px;
  font-size: 12px;
  opacity:.75;
  font-weight: 900;
  letter-spacing:.3px;
}
.sb-bar-track{
  flex:1;
  height: 10px;
  border-radius: 999px;
  background: rgba(148,163,184,.10);
  overflow:hidden;
}
.sb-bar-fill{
  height:100%;
  width:100%;
  transform-origin:left;
  transform: scaleX(1);
  background: rgba(34,211,238,.60);
}
.sb-bar-fill.boss{
  background: rgba(244,114,182,.58);
}

/* Stage */
.sb-stage{
  position:relative;
  margin-top: 10px;
  border-radius: var(--sb-radius);
  background: rgba(2,6,23,.35);
  border:1px solid rgba(148,163,184,.12);
  overflow:hidden;
  box-shadow: 0 18px 40px rgba(0,0,0,.35);
  min-height: 420px;
}

/* Message center */
.sb-center-msg{
  position:absolute;
  inset: 0;
  display:flex;
  align-items:center;
  justify-content:center;
  pointer-events:none;
  z-index: 4;
}
.sb-msg-main{
  padding: 10px 14px;
  border-radius: 16px;
  font-weight: 900;
  font-size: 14px;
  background: rgba(2,6,23,.55);
  border:1px solid rgba(148,163,184,.16);
  box-shadow: 0 10px 24px rgba(0,0,0,.25);
  opacity:.95;
}
.sb-msg-main.good{ border-color: rgba(34,211,238,.35); }
.sb-msg-main.perfect{ border-color: rgba(99,102,241,.40); }
.sb-msg-main.bad, .sb-msg-main.miss{ border-color: rgba(244,114,182,.35); }

/* Target layer */
.sb-target-layer{
  position:relative;
  width:100%;
  height: clamp(420px, 56vh, 560px);
  overflow:hidden;
}

/* ✅ Meta card: float right but NOT blocking too much */
.sb-meta{
  position:absolute;
  right: 10px;
  top: 10px;
  width: min(var(--sb-meta-w), 48vw);
  border-radius: 18px;
  background: rgba(2,6,23,.62);
  border:1px solid rgba(148,163,184,.16);
  box-shadow: 0 14px 34px rgba(0,0,0,.30);
  z-index: 5;
  backdrop-filter: blur(8px);
}

.sb-meta-rowtop{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap: 10px;
  padding: 10px 12px;
}
.sb-meta-emoji{
  font-size: 22px;
  line-height:1;
}
.sb-meta-toggle{
  width: 34px;
  height: 34px;
  border-radius: 12px;
  border: 1px solid rgba(148,163,184,.14);
  background: rgba(15,23,42,.42);
  color: var(--sb-text);
  cursor:pointer;
  font-weight: 900;
}

.sb-meta-body{
  padding: 0 12px 12px;
}
.sb-meta-name{
  font-weight: 900;
  margin: 2px 0 4px;
}
.sb-meta-desc{
  font-size: 12px;
  opacity:.8;
  margin-bottom: 8px;
}
.sb-meta-row{
  display:flex;
  justify-content:space-between;
  align-items:center;
  font-size: 12px;
  opacity:.88;
  padding: 6px 0;
  border-top: 1px dashed rgba(148,163,184,.16);
}

/* Fever block */
.sb-fever{
  flex: 1.2;
  min-width: 280px;
  padding: 10px 12px;
  border-radius: var(--sb-radius);
  border:1px solid rgba(148,163,184,.14);
  background: rgba(2,6,23,.45);
}
.sb-fever-head{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap: 10px;
}
.sb-fever-head .k{ font-size: 12px; opacity:.75; font-weight: 900; }
.sb-fever-head .v{ font-size: 12px; font-weight: 900; opacity:.92; }
.sb-fever-btn{
  padding: 8px 10px;
  border-radius: 14px;
  border:1px solid rgba(99,102,241,.35);
  background: rgba(99,102,241,.14);
  color: var(--sb-text);
  font-weight: 900;
  cursor:pointer;
}
.sb-fever-track{
  height: 10px;
  border-radius: 999px;
  background: rgba(148,163,184,.10);
  overflow:hidden;
  margin-top: 10px;
}
.sb-fever-fill{
  height:100%;
  width:100%;
  transform-origin:left;
  transform: scaleX(0);
  background: rgba(99,102,241,.55);
}
.sb-fever-hint{
  font-size: 12px;
  opacity:.72;
  margin-top: 8px;
}

#sb-label-fever.on{
  color: rgba(34,211,238,.95);
  text-shadow: 0 0 16px rgba(34,211,238,.20);
}

/* Compact right block (phase/shield + bottom bars) */
.sb-bars-compact{
  flex: .9;
  min-width: 240px;
  padding: 10px 12px;
  border-radius: var(--sb-radius);
  border:1px solid rgba(148,163,184,.14);
  background: rgba(2,6,23,.45);
}
.sb-bars-compact .sb-row{
  display:flex;
  justify-content:space-between;
  font-size: 12px;
  opacity:.9;
  padding: 6px 0;
  border-bottom: 1px dashed rgba(148,163,184,.14);
}
.sb-bars-compact .sb-row .k{ opacity:.75; font-weight: 900; }
.sb-bars-compact .sb-row .v{ font-weight: 900; }

/* =========================
   Targets
   ========================= */
.sb-target{
  position:absolute;
  display:flex;
  align-items:center;
  justify-content:center;
  user-select:none;
  touch-action: manipulation;
  cursor:pointer;

  border-radius: 999px;
  border: 1px solid var(--sb-target-outline);
  background:
    radial-gradient(140% 140% at 30% 20%, rgba(255,255,255,.12), transparent 60%),
    radial-gradient(120% 120% at 70% 80%, rgba(34,211,238,.10), transparent 58%),
    rgba(15,23,42,.35);
  box-shadow:
    0 16px 32px rgba(0,0,0,.35),
    inset 0 0 0 1px rgba(255,255,255,.06);

  transition: transform .12s ease, filter .12s ease, opacity .18s ease;
  will-change: transform, opacity;
  font-size: clamp(22px, 3.2vw, 34px);
}

.sb-target:active{
  transform: scale(.96);
  filter: brightness(1.08);
}

.sb-target--decoy{
  background:
    radial-gradient(130% 130% at 30% 20%, rgba(244,114,182,.14), transparent 60%),
    rgba(15,23,42,.34);
}
.sb-target--bomb{
  background:
    radial-gradient(130% 130% at 30% 20%, rgba(239,68,68,.16), transparent 60%),
    rgba(15,23,42,.34);
}
.sb-target--heal{
  background:
    radial-gradient(130% 130% at 30% 20%, rgba(34,197,94,.16), transparent 60%),
    rgba(15,23,42,.34);
}
.sb-target--shield{
  background:
    radial-gradient(130% 130% at 30% 20%, rgba(59,130,246,.16), transparent 60%),
    rgba(15,23,42,.34);
}
.sb-target--bossface{
  border-color: rgba(99,102,241,.35);
  background:
    radial-gradient(150% 150% at 30% 20%, rgba(99,102,241,.18), transparent 62%),
    rgba(15,23,42,.34);
}

/* ✅ expire smooth */
.sb-target.is-expiring{
  opacity: 0;
  transform: scale(.78);
  filter: blur(.3px);
}

/* =========================
   Result
   ========================= */
.sb-result-title{
  margin: 0 0 12px;
  font-size: 18px;
}
.sb-result-grid{
  display:grid;
  grid-template-columns: repeat(4, minmax(0, 1fr));
  gap: 10px;
}
.sb-result-card{
  padding: 10px 12px;
  border-radius: 16px;
  border:1px solid rgba(148,163,184,.14);
  background: rgba(2,6,23,.45);
}
.sb-result-card .k{ font-size: 12px; opacity:.72; }
.sb-result-card .v{ font-size: 16px; font-weight: 900; margin-top: 2px; }

.sb-result-actions{
  margin-top: 12px;
  display:flex;
  flex-wrap:wrap;
  gap: 10px;
}

/* =========================
   FX helper classes (FxBurst uses these)
   ========================= */
.sb-fx-hit{ }
.sb-fx-fever{ }
.sb-fx-miss{ }
.sb-fx-bomb{ }
.sb-fx-heal{ }
.sb-fx-shield{ }

/* =========================
   Responsive (แก้แน่นหนัก ๆ)
   ========================= */
@media (max-width: 920px){
  .sb-header{
    flex-direction:column;
    align-items:stretch;
    text-align:left;
  }
  .sb-header-right{ text-align:left; }

  .sb-form{
    grid-template-columns: 1fr;
  }

  .sb-hud{
    grid-template-columns: 1fr;
    gap: 8px;
  }
  .sb-hud-right{
    justify-content:flex-start;
    flex-wrap:wrap;
  }

  .sb-result-grid{
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }

  /* ✅ ลด meta บังจอ */
  :root{
    --sb-meta-w: 220px;
    --sb-safe-side: 10;
    --sb-safe-top: 12;
  }
}

@media (max-width: 520px){
  :root{
    --sb-pad: 10px;
    --sb-gap: 10px;

    /* ✅ เพิ่ม safe-zone บนมือถือ: กัน HUD/meta */
    --sb-safe-pad: 16;
    --sb-safe-top: 12;
    --sb-safe-side: 12;
    --sb-safe-bot: 16;
  }

  .sb-wrap{ padding: 10px; }
  .sb-title{ font-size: 20px; }
  .sb-sub{ font-size: 12px; }

  /* HUD: ทำให้ไม่กินพื้นที่ */
  .sb-stat{ min-width: 0; padding: 6px 8px; }
  .sb-hud-left{ gap: 8px; }
  .sb-boss-name{ font-size: 13px; padding: 7px 9px; }

  .sb-stage{
    min-height: 380px;
  }
  .sb-target-layer{
    height: clamp(380px, 56vh, 520px);
  }

  /* ✅ Meta: ย่อ + โปร่ง + ชิดมุม */
  .sb-meta{
    right: 8px;
    top: 8px;
    width: 170px;
    border-radius: 16px;
    opacity: .92;
  }
  .sb-meta-desc{ display:none; } /* mobile compact */
  .sb-meta-body{ padding-bottom: 10px; }

  .sb-bar{ min-width: 0; }
  .sb-fever{ min-width: 0; }
  .sb-bars-compact{ min-width: 0; }
}

/* Ultra-compact: very small height (landscape phones) */
@media (max-height: 560px){
  .sb-target-layer{
    height: clamp(320px, 52vh, 420px);
  }
  :root{
    --sb-safe-bot: 10;
    --sb-safe-top: 10;
  }
}
/* === /fitness/rhythm-boxer.css ===
   Rhythm Boxer UI — PRODUCTION
   ✅ hit line is controlled by --rb-hitline-y (px from bottom)
   ✅ notes anchor at top:0 and fall with translateY
*/

:root{
  --bg0:#050a15;
  --bg1:#0b1733;
  --panel:rgba(9,16,36,.72);
  --stroke:rgba(148,163,184,.18);
  --text:#e5e7eb;
  --muted:#94a3b8;
  --accent:#22c55e;
  --gold:rgba(255, 214, 74, .9);

  --radius:22px;
  --pad:16px;

  --lane-gap:12px;
  --lane-radius:18px;

  /* ✅ ปรับตรงนี้เพื่อยก/ลดเส้นเหลือง (เส้นตี) */
  --rb-hitline-y: 84px;

  /* safe area */
  --sat: env(safe-area-inset-top, 0px);
  --sar: env(safe-area-inset-right, 0px);
  --sab: env(safe-area-inset-bottom, 0px);
  --sal: env(safe-area-inset-left, 0px);
}

*{ box-sizing:border-box; }
html,body{
  height:100%;
  margin:0;
  background: radial-gradient(1200px 700px at 20% 0%, rgba(128,64,255,.18), transparent 55%),
              radial-gradient(900px 600px at 90% 20%, rgba(0,255,200,.12), transparent 55%),
              linear-gradient(180deg, var(--bg0), var(--bg1));
  color:var(--text);
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
}

.hidden{ display:none !important; }

/* page shell */
.rb-page{
  min-height:100vh;
  padding: calc(var(--pad) + var(--sat)) calc(var(--pad) + var(--sar))
           calc(var(--pad) + var(--sab)) calc(var(--pad) + var(--sal));
}

.rb-title{
  font-size:34px;
  font-weight:800;
  letter-spacing:.2px;
  margin: 10px 0 6px;
}

.rb-sub{
  color:var(--muted);
  margin:0 0 14px;
  line-height:1.35;
}

/* HUD card */
.rb-hud{
  background: var(--panel);
  border: 1px solid var(--stroke);
  border-radius: 26px;
  padding: 16px 16px 14px;
  box-shadow: 0 10px 30px rgba(0,0,0,.35);
  backdrop-filter: blur(10px);
}

.rb-hud-row{
  display:flex;
  flex-wrap:wrap;
  gap:10px;
  margin-bottom:10px;
}

.rb-pill{
  display:flex;
  align-items:center;
  gap:8px;
  padding:10px 14px;
  border-radius:999px;
  border:1px solid rgba(148,163,184,.18);
  background: rgba(2,6,23,.22);
  box-shadow: inset 0 0 0 1px rgba(0,0,0,.18);
  font-weight:650;
}

.rb-pill b{
  font-weight:850;
}

.rb-pill .k{
  color:rgba(226,232,240,.9);
  font-weight:750;
}
.rb-pill .v{
  color:rgba(226,232,240,1);
}

.rb-pill.ai{
  background: rgba(34,197,94,.06);
  border-color: rgba(34,197,94,.25);
}

.rb-coach{
  width:100%;
  padding: 12px 14px;
  border-radius: 18px;
  border: 1px dashed rgba(148,163,184,.35);
  background: rgba(2,6,23,.18);
  color: rgba(226,232,240,.95);
  min-height: 46px;
}

/* bars */
.rb-bars{
  display:grid;
  grid-template-columns: 1fr;
  gap:10px;
  margin-top:10px;
}

.rb-bar{
  display:flex;
  align-items:center;
  gap:10px;
}

.rb-bar .label{
  width:70px;
  font-weight:800;
  letter-spacing:.6px;
  color: rgba(226,232,240,.75);
}

.rb-bar .track{
  position:relative;
  flex:1;
  height:12px;
  border-radius:999px;
  background: rgba(148,163,184,.12);
  overflow:hidden;
  border:1px solid rgba(148,163,184,.12);
}

.rb-bar .fill{
  position:absolute;
  left:0;
  top:0;
  bottom:0;
  width:0%;
  border-radius:999px;
  background: linear-gradient(90deg, rgba(34,197,94,.9), rgba(59,130,246,.9));
}

.rb-bar .status{
  width:66px;
  text-align:right;
  font-weight:800;
  color: rgba(226,232,240,.75);
}

.rb-bar.prog .status{
  width:52px;
}

/* playfield */
.rb-field{
  margin-top:14px;
  background: rgba(9,16,36,.55);
  border: 1px solid rgba(148,163,184,.16);
  border-radius: 26px;
  padding: 16px;
  box-shadow: 0 14px 34px rgba(0,0,0,.34);
  backdrop-filter: blur(10px);
}

/* lanes wrap */
.rb-lanes{
  display:grid;
  grid-template-columns: repeat(5, 1fr);
  gap: var(--lane-gap);
  align-items:stretch;
  min-height: 380px;
}

.rb-lanes.l3{
  grid-template-columns: repeat(3, 1fr);
}

.rb-lane{
  position:relative;
  border-radius: var(--lane-radius);
  border: 1px solid rgba(148,163,184,.16);
  background: linear-gradient(180deg, rgba(2,6,23,.28), rgba(2,6,23,.08));
  overflow:hidden;

  /* ✅ เส้นตีใช้ตัวแปรเดียวกับ engine */
  --rb-hitline-y: var(--rb-hitline-y);
}

/* subtle inner lines */
.rb-lane::before{
  content:"";
  position:absolute;
  inset: 10px;
  border-radius: 16px;
  border:1px solid rgba(148,163,184,.10);
  pointer-events:none;
}

/* hit line (yellow) */
.rb-hitline{
  position:absolute;
  left: 12%;
  right: 12%;
  height: 2px;
  bottom: var(--rb-hitline-y);
  background: var(--gold);
  box-shadow: 0 0 12px rgba(255,214,74,.35);
  pointer-events:none;
}

/* lane label button bottom */
.rb-lane-btn{
  position:absolute;
  left:50%;
  transform:translateX(-50%);
  bottom: 12px;
  width: 56px;
  height: 46px;
  border-radius: 999px;
  border: 1px solid rgba(148,163,184,.18);
  background: rgba(2,6,23,.35);
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:900;
  color: rgba(226,232,240,.75);
  pointer-events:none;
}

/* ✅ NOTE: anchor at top:0 then translateY in JS */
.rb-note{
  position:absolute;
  left:50%;
  top:0;
  transform: translate(-50%, -9999px);
  width: 64px;
  height: var(--rb-note-len, 160px);
  border-radius: 16px;
  background: linear-gradient(180deg, rgba(96,165,250,.95), rgba(168,85,247,.25));
  box-shadow: 0 10px 18px rgba(0,0,0,.25);
  border: 1px solid rgba(255,255,255,.12);
  pointer-events:none;
  will-change: transform;
  overflow:hidden;
}

/* note head */
.rb-note::before{
  content:"";
  position:absolute;
  left:0;
  top:0;
  right:0;
  height: 44px;
  border-radius: 16px 16px 14px 14px;
  background: rgba(0,0,0,.18);
}

/* note icon */
.rb-note-ico{
  position:absolute;
  left:50%;
  top: 9px;
  transform:translateX(-50%);
  font-size: 22px;
  filter: drop-shadow(0 4px 8px rgba(0,0,0,.28));
}

/* footer hint text */
.rb-hint{
  margin-top:12px;
  color: rgba(226,232,240,.70);
  line-height:1.35;
  font-weight:650;
}

/* responsive: mobile tighten */
@media (max-width: 460px){
  .rb-title{ font-size:30px; }
  .rb-field{ padding: 14px; }
  .rb-lanes{ min-height: 340px; }
  .rb-lane-btn{ width:54px; height:44px; }
  .rb-note{ width: 58px; }
}

/* 3-lane helper (ถ้าใช้ 3 เลน) */
.rb-lanes[data-lanes="3"]{
  grid-template-columns: repeat(3, 1fr);
}
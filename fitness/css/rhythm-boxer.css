/* === /fitness/css/rhythm-boxer.css === */
:root{
  color-scheme: dark;
  --bg:#020617;
  --panel:rgba(2,6,23,.78);
  --panel2:rgba(15,23,42,.72);
  --stroke:rgba(148,163,184,.18);
  --text:#e5e7eb;
  --muted:#94a3b8;
  --accent:#22d3ee;
  --violet:#a78bfa;
  --good:#22c55e;
  --warn:#f59e0b;
  --bad:#fb7185;

  --radius:22px;
  --pill:999px;

  --sat: env(safe-area-inset-top,0px);
  --sab: env(safe-area-inset-bottom,0px);

  /* note tail length (default) */
  --rb-note-len: 140px;
}

*{ box-sizing:border-box; }

html,body{
  margin:0; padding:0; height:100%;
  font-family: system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
  background:
    radial-gradient(circle at top left,rgba(168,85,247,0.24),transparent 55%),
    radial-gradient(circle at bottom right,rgba(34,211,238,0.22),transparent 55%),
    var(--bg);
  color:var(--text);
}

.rb-view{ min-height:100vh; padding: calc(16px + var(--sat)) 14px calc(22px + var(--sab)); }
.hidden{ display:none !important; }

#rb-wrap{ width:100%; max-width:1100px; margin:0 auto; }

.rb-header{
  display:flex;
  align-items:flex-start;
  justify-content:space-between;
  gap:16px;
}

.rb-head-main{ max-width:720px; }

.rb-pill{
  display:inline-flex;
  padding:4px 10px;
  border-radius:999px;
  border:1px solid rgba(148,163,184,.22);
  background:rgba(15,23,42,.70);
  color:var(--muted);
  font-size:.78rem;
}

.rb-title{ margin:8px 0 0; font-size:2rem; letter-spacing:.2px; }
.rb-sub{ margin:6px 0 0; color:var(--muted); font-size:.92rem; line-height:1.35; }
.rb-sub-small{ display:inline-block; margin-top:6px; color:rgba(226,232,240,.75); font-size:.78rem; }

.rb-back{
  color:var(--muted);
  text-decoration:none;
  padding:8px 12px;
  border-radius:999px;
  border:1px solid rgba(148,163,184,.18);
  background:rgba(15,23,42,.55);
}
.rb-back:hover{ color:var(--text); background:rgba(15,23,42,.8); }

.rb-section{ margin-top:14px; }
.rb-grid-2{
  display:grid;
  grid-template-columns:repeat(2,minmax(0,1fr));
  gap:14px;
}
@media (max-width:860px){
  .rb-grid-2{ grid-template-columns:1fr; }
}

.rb-research-box{
  border-radius:22px;
  background:rgba(15,23,42,.74);
  border:1px solid rgba(148,163,184,.18);
  box-shadow:0 18px 42px rgba(0,0,0,.60);
  padding:14px;
}

.rb-section-title{ margin:0 0 8px; font-size:1.05rem; }
.rb-section-title-sm{ margin:0 0 6px; font-size:.98rem; color:rgba(226,232,240,.9); }
.rb-section-subtitle{ margin:0 0 10px; font-size:.82rem; color:var(--muted); }

.rb-mode-toggle{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
}

.rb-mode-btn{
  display:inline-flex;
  align-items:center;
  gap:8px;
  padding:10px 12px;
  border-radius:18px;
  border:1px solid rgba(148,163,184,.22);
  background:rgba(2,6,23,.55);
  cursor:pointer;
  user-select:none;
  font-size:.86rem;
}
.rb-mode-btn input{ accent-color:#22d3ee; }

.rb-mode-desc{ margin:10px 0 0; color:var(--muted); font-size:.82rem; }

.rb-field{ display:flex; flex-direction:column; gap:6px; margin-top:10px; }
.rb-field label{ font-size:.8rem; color:rgba(226,232,240,.82); }
.rb-field input{
  padding:10px 12px;
  border-radius:14px;
  border:1px solid rgba(148,163,184,.22);
  background:rgba(2,6,23,.7);
  color:var(--text);
  outline:none;
}
.rb-field input:focus{ border-color:rgba(34,211,238,.55); box-shadow:0 0 0 3px rgba(34,211,238,.12); }

.rb-hint-inline{ margin:10px 0 0; color:rgba(226,232,240,.70); font-size:.78rem; line-height:1.35; }

.rb-hint-block{
  margin-top:12px;
  border-radius:18px;
  border:1px solid rgba(148,163,184,.14);
  background:rgba(2,6,23,.45);
  padding:10px 12px;
}
.rb-hint-title{ margin:0; color:rgba(226,232,240,.92); font-size:.86rem; }
.rb-hint-list{ margin:8px 0 0 18px; color:rgba(226,232,240,.70); font-size:.78rem; line-height:1.4; }

.rb-btn{
  border-radius:999px;
  border:1px solid rgba(148,163,184,.22);
  background:rgba(2,6,23,.55);
  color:var(--text);
  padding:10px 14px;
  cursor:pointer;
  font-size:.9rem;
  display:inline-flex;
  align-items:center;
  justify-content:center;
  gap:8px;
  transition: transform .1s, filter .1s, box-shadow .1s, background .1s;
}
.rb-btn:hover{ background:rgba(2,6,23,.75); transform:translateY(-1px); }
.rb-btn-primary{
  background:linear-gradient(135deg,#22d3ee,#a78bfa);
  color:#020617;
  border-color:transparent;
  box-shadow:0 14px 32px rgba(0,0,0,.55);
}
.rb-btn-primary:hover{ filter:brightness(1.05); }
.rb-btn-ghost{ background:rgba(2,6,23,.35); color:var(--muted); }
.rb-btn-sm{ padding:8px 12px; font-size:.84rem; }

.rb-play-header{
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
  gap:12px;
}
.rb-title-sm{ margin:0; font-size:1.35rem; }
.rb-sub-sm{ margin:4px 0 0; color:var(--muted); font-size:.82rem; }

.rb-hud{ margin-top:12px; }
.rb-hud-row{
  display:flex;
  flex-wrap:wrap;
  gap:8px;
  margin-bottom:8px;
}
.rb-chip{
  display:inline-flex;
  align-items:center;
  gap:6px;
  border-radius:999px;
  padding:6px 10px;
  border:1px solid rgba(148,163,184,.16);
  background:rgba(2,6,23,.50);
  color:rgba(226,232,240,.88);
  font-size:.82rem;
}
.rb-chip b{ color:var(--text); }

.rb-hud-row-ai .rb-chip-ai{
  border-color: rgba(34,211,238,.22);
  background: rgba(34,211,238,.06);
}
.rb-chip-tip{
  width:100%;
  justify-content:flex-start;
}
.rb-chip-tip-label{
  color:rgba(226,232,240,.72);
}

.rb-bars{
  display:grid;
  grid-template-columns:repeat(2,minmax(0,1fr));
  gap:10px;
  margin-top:10px;
}
@media (max-width:640px){
  .rb-bars{ grid-template-columns:1fr; }
}

.rb-bar-block{ display:flex; align-items:center; gap:10px; }
.rb-bar-label{
  font-size:.78rem; color:rgba(226,232,240,.75);
  width:54px;
}
.rb-bar{
  flex:1;
  height:10px;
  border-radius:999px;
  background:rgba(148,163,184,.14);
  overflow:hidden;
  border:1px solid rgba(148,163,184,.18);
}
.rb-bar-fill{
  height:100%;
  width:100%;
  transform-origin:left;
  transform:scaleX(0);
}
.rb-bar-fever{ background:linear-gradient(90deg,#facc15,#fb7185); }
.rb-bar-progress{ background:linear-gradient(90deg,#22d3ee,#a78bfa); }
.rb-bar-status{
  font-size:.78rem;
  color:rgba(226,232,240,.78);
  width:54px;
  text-align:right;
}
.rb-bar-status.on{ color:#facc15; text-shadow:0 0 12px rgba(250,204,21,.45); }

.rb-field-wrap{ margin-top:12px; }
#rb-field{
  position:relative;
  border-radius:22px;
  border:1px solid rgba(148,163,184,.18);
  background:rgba(2,6,23,.55);
  overflow:hidden;
  box-shadow:0 18px 52px rgba(0,0,0,.62);
}
.rb-feedback{
  position:absolute;
  left:12px;
  top:12px;
  padding:8px 12px;
  border-radius:999px;
  border:1px solid rgba(148,163,184,.18);
  background:rgba(2,6,23,.70);
  color:rgba(226,232,240,.9);
  font-weight:700;
  font-size:.92rem;
  z-index:6;
}
.rb-feedback.perfect{ color:#facc15; }
.rb-feedback.great{ color:#22d3ee; }
.rb-feedback.good{ color:#22c55e; }
.rb-feedback.miss{ color:#fb7185; }

.rb-lanes{
  display:grid;
  grid-template-columns:repeat(5, minmax(0,1fr));
  height:420px;
  gap:0;
}
@media (max-width:720px){
  .rb-lanes{ height:360px; }
}
.rb-lane{
  position:relative;
  border-left:1px solid rgba(148,163,184,.10);
  user-select:none;
  touch-action:manipulation;
}
.rb-lane:first-child{ border-left:none; }
.rb-lane-label{
  position:absolute;
  bottom:10px;
  left:50%;
  transform:translateX(-50%);
  font-size:.78rem;
  color:rgba(226,232,240,.70);
  opacity:.75;
  z-index:2;
}
.rb-lane::after{
  content:'';
  position:absolute;
  left:0; right:0;
  bottom:42px; /* strike line */
  height:2px;
  background:rgba(34,211,238,.28);
  box-shadow:0 0 14px rgba(34,211,238,.20);
  z-index:1;
}

.rb-note{
  position:absolute;
  left:50%;
  transform:translate(-50%, -100%);
  width:64px;
  height: var(--rb-note-len);
  border-radius:999px;
  background:linear-gradient(180deg, rgba(34,211,238,.22), rgba(167,139,250,.12));
  border:1px solid rgba(148,163,184,.18);
  box-shadow:0 12px 26px rgba(0,0,0,.35);
  display:flex;
  align-items:flex-end;
  justify-content:center;
  padding-bottom:8px;
}
.rb-note-inner{
  width:44px;
  height:44px;
  border-radius:999px;
  display:flex;
  align-items:center;
  justify-content:center;
  background:rgba(2,6,23,.68);
  border:1px solid rgba(148,163,184,.18);
  font-size:1.35rem;
}

#rb-flash{
  position:fixed;
  inset:0;
  pointer-events:none;
  opacity:0;
  background:rgba(251,113,133,.15);
  transition:opacity .12s ease;
  z-index:999;
}
#rb-flash.active{ opacity:1; }

.rb-score-fx{
  position:fixed;
  transform:translate(-50%,-50%);
  font-weight:900;
  font-size:1.1rem;
  opacity:0;
  z-index:9999;
  text-shadow:0 10px 24px rgba(0,0,0,.55);
}
.rb-score-fx.is-live{
  opacity:1;
  animation: rb-pop .42s ease-out forwards;
}
@keyframes rb-pop{
  0%{ transform:translate(-50%,-50%) scale(.92); }
  100%{ transform:translate(-50%,-70%) scale(1.08); opacity:0; }
}
.rb-score-perfect{ color:#facc15; }
.rb-score-great{ color:#22d3ee; }
.rb-score-good{ color:#22c55e; }
.rb-score-miss{ color:#fb7185; }

.rb-frag{
  position:fixed;
  transform:translate(-50%,-50%);
  border-radius:999px;
  opacity:.95;
  z-index:9998;
  animation: rb-frag var(--life,520ms) ease-out forwards;
}
@keyframes rb-frag{
  0%{ transform:translate(-50%,-50%); opacity:.95; }
  100%{ transform:translate(calc(-50% + var(--dx,0px)), calc(-50% + var(--dy,0px))); opacity:0; }
}
.rb-frag-perfect{ background:rgba(250,204,21,.95); }
.rb-frag-great{ background:rgba(34,211,238,.95); }
.rb-frag-good{ background:rgba(34,197,94,.95); }
.rb-frag-miss{ background:rgba(251,113,133,.90); }

.rb-howto-inline{
  margin:10px 4px 0;
  color:rgba(226,232,240,.70);
  font-size:.78rem;
  text-align:center;
}

/* ===== Result ===== */
.rb-result-grid{
  display:grid;
  grid-template-columns:repeat(2,minmax(0,1fr));
  gap:14px;
  margin-top:12px;
}
@media (max-width:860px){
  .rb-result-grid{ grid-template-columns:1fr; }
}
.rb-result-card{
  border-radius:22px;
  background:rgba(15,23,42,.74);
  border:1px solid rgba(148,163,184,.18);
  padding:14px;
  box-shadow:0 18px 42px rgba(0,0,0,.55);
}
.rb-result-title{ margin:0 0 10px; font-size:1.02rem; }
.rb-result-row{
  display:flex;
  justify-content:space-between;
  gap:12px;
  padding:7px 0;
  border-bottom:1px dashed rgba(148,163,184,.16);
  font-size:.86rem;
}
.rb-result-row:last-child{ border-bottom:none; }
.rb-result-row span{ color:rgba(226,232,240,.74); }
.rb-result-row b{ color:var(--text); }

.rb-quality-note{
  margin:12px 4px 0;
  color:rgba(251,113,133,.88);
  font-weight:700;
  text-align:center;
}

.rb-btn-row{
  display:flex;
  flex-wrap:wrap;
  gap:10px;
  justify-content:center;
  margin-top:12px;
}

/* ===== Cardboard VR (view=cvr) helpers: 3-lane pad + crosshair ===== */
body.view-cvr #rb-wrap{ --rb-note-len: 240px; }

body.view-cvr #rb-field{ padding-bottom: 110px; }
body.view-cvr .rb-lanes{ pointer-events:none; }
body.view-cvr .rb-lane-label{ opacity:.35; }
body.view-cvr .rb-lane.is-selected{
  outline:2px solid rgba(34,211,238,.5);
  outline-offset:-2px;
}

/* cVR = 3 lanes (L/C/R): hide outer lanes and reflow grid */
body.view-cvr .rb-lanes{
  grid-template-columns:repeat(3,minmax(0,1fr));
}
body.view-cvr .rb-lane[data-lane="0"],
body.view-cvr .rb-lane[data-lane="4"]{
  display:none;
}

.rb-cvr-pad{
  position:absolute;
  left:50%;
  bottom:10px;
  transform:translateX(-50%);
  display:flex;
  gap:10px;
  z-index:7;
  pointer-events:auto;
}
.rb-cvr-btn{
  min-width:76px;
  padding:10px 12px;
  border-radius:999px;
  border:1px solid rgba(148,163,184,.22);
  background:rgba(2,6,23,.68);
  color:rgba(226,232,240,.92);
  font-weight:800;
  letter-spacing:.5px;
}
.rb-cvr-btn:active{ transform: translateY(1px) scale(0.99); }

.rb-cvr-crosshair{
  position:absolute;
  left:50%;
  top:50%;
  width:14px;
  height:14px;
  transform:translate(-50%,-50%);
  border-radius:999px;
  border:2px solid rgba(34,211,238,.85);
  box-shadow:0 0 18px rgba(34,211,238,.35);
  opacity:.75;
  z-index:7;
  pointer-events:none;
}

body.view-cvr .rb-lane-label{ opacity:0.15; }
body.view-cvr .rb-howto-inline{ display:none; }
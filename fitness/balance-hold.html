<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Balance Hold ‚Äî VR Fitness (DOM)</title>
  <meta name="color-scheme" content="dark" />

  <style>
    :root{
      --bg:#050814;
      --card: rgba(12,16,30,.70);
      --bd: rgba(255,255,255,.10);
      --txt: rgba(248,250,252,.95);
      --mut: rgba(148,163,184,.92);
      --sab: env(safe-area-inset-bottom, 0px);
      --sat: env(safe-area-inset-top, 0px);
    }
    *{ box-sizing:border-box; }
    html,body{ height:100%; margin:0; }
    body{
      font-family: system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans Thai", sans-serif;
      background:
        radial-gradient(900px 700px at 15% 0%, rgba(59,130,246,.18), transparent 60%),
        radial-gradient(900px 700px at 90% 20%, rgba(34,197,94,.12), transparent 60%),
        var(--bg);
      color: var(--txt);
      overflow-x:hidden;
    }
    .hidden{ display:none !important; }

    .app{
      width:min(1040px, 100%);
      margin:0 auto;
      padding: calc(12px + var(--sat)) 12px calc(14px + var(--sab));
      display:grid;
      gap:12px;
    }

    .card{
      border:1px solid var(--bd);
      background: linear-gradient(180deg, rgba(15,23,42,.78), rgba(2,6,23,.66));
      border-radius: 16px;
      padding: 12px;
      box-shadow: 0 10px 30px rgba(0,0,0,.25);
    }
    h1,h2,h3{ margin:0; }
    .title{ font-size:1.1rem; font-weight:900; letter-spacing:.2px; }
    .sub{ margin:.35rem 0 0; color:var(--mut); line-height:1.35; font-size:.92rem; }

    .grid2{
      display:grid; gap:12px;
      grid-template-columns: 1fr;
    }
    @media (min-width: 820px){
      .grid2{ grid-template-columns: 1fr 1fr; }
    }

    .field-row{
      display:grid;
      grid-template-columns: 120px 1fr;
      gap:8px;
      align-items:center;
      margin-top:10px;
    }
    .field-row label{ color:var(--mut); font-size:.9rem; }
    select,input{
      width:100%;
      min-height:40px;
      border-radius: 12px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(2,6,23,.70);
      color: var(--txt);
      padding: 8px 10px;
      font: inherit;
      outline:none;
    }

    .btn{
      appearance:none;
      border:1px solid rgba(255,255,255,.18);
      background: rgba(255,255,255,.08);
      color:#fff;
      border-radius: 12px;
      padding: 10px 14px;
      cursor:pointer;
      font-weight:700;
      line-height:1.1;
    }
    .btn:hover{ background: rgba(255,255,255,.12); }
    .btn:active{ transform: translateY(1px); }
    .btn-primary{ background: rgba(59,130,246,.22); border-color: rgba(59,130,246,.40); }
    .btn-danger{ background: rgba(239,68,68,.18); border-color: rgba(239,68,68,.40); }
    .actions{ display:flex; gap:8px; flex-wrap:wrap; margin-top:10px; }

    /* ---------- HUD ---------- */
    .hud-panel{
      display:flex; flex-direction:column; gap:8px;
      padding:10px;
      border-radius:14px;
      background: rgba(8,12,24,.62);
      border:1px solid rgba(255,255,255,.09);
      backdrop-filter: blur(8px);
    }
    .hud-row{ display:flex; flex-wrap:wrap; gap:8px; align-items:center; }
    .pill{
      padding:7px 10px;
      border-radius: 999px;
      background: rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.10);
      font-size:.9rem;
      white-space:nowrap;
    }
    .hud-stabilitybar{
      display:flex; align-items:center; gap:10px;
      min-width:220px; flex:1;
      padding:6px 10px; border-radius:999px;
      background:rgba(255,255,255,.05);
      border:1px solid rgba(255,255,255,.10);
    }
    .hud-stabilitybar-track{
      position:relative; height:10px; flex:1;
      border-radius:999px; overflow:hidden;
      background:rgba(255,255,255,.10);
    }
    .hud-stabilitybar-fill{
      height:100%; width:0%;
      border-radius:999px;
      background:linear-gradient(90deg, #22c55e, #38bdf8);
      transition: width .12s linear;
    }
    .hud-stabilitybar-label{ font-size:.78rem; opacity:.9; }

    /* ---------- PLAY AREA ---------- */
    #playArea{
      position:relative;
      min-height: 420px;
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.10);
      background:
        radial-gradient(700px 320px at 50% 0%, rgba(59,130,246,.12), transparent 70%),
        linear-gradient(180deg, rgba(15,23,42,.56), rgba(2,6,23,.72));
      overflow:hidden;
      touch-action:none;
      user-select:none;
    }
    body.view-mobile #playArea{ min-height: 460px; }
    body.view-cvr #playArea{ min-height: 520px; }

    .safe-zone-overlay{
      position:absolute; left:50%; top:50%;
      width:72%; height:28px;
      transform:translate(-50%,-50%);
      border-radius:999px;
      background:rgba(255,255,255,.06);
      border:1px dashed rgba(255,255,255,.18);
      pointer-events:none;
    }
    .safe-zone-inner{
      position:absolute; left:50%; top:50%;
      width:28%; height:16px;
      transform:translate(-50%,-50%);
      border-radius:999px;
      background:rgba(34,197,94,.22);
      border:1px solid rgba(34,197,94,.45);
      transition: width .2s ease;
    }

    #centerPulse{
      position:absolute; left:50%; top:50%;
      width:18px; height:18px; border-radius:50%;
      transform:translate(-50%,-50%);
      background:rgba(255,255,255,.18);
      border:1px solid rgba(255,255,255,.35);
      pointer-events:none;
      z-index: 2;
    }
    #centerPulse.good{
      background:rgba(34,197,94,.35);
      border-color:rgba(34,197,94,.65);
      animation:centerPulseGlow .8s ease-out infinite;
    }
    @keyframes centerPulseGlow{
      0%{ box-shadow:0 0 0 0 rgba(34,197,94,.35); }
      100%{ box-shadow:0 0 0 12px rgba(34,197,94,0); }
    }

    #platform-wrap{
      position:absolute;
      left:50%;
      bottom: 120px;
      width:min(86vw, 560px);
      height:140px;
      transform:translateX(-50%);
      display:grid;
      place-items:center;
      z-index: 3;
      pointer-events:none;
    }
    #platform{
      width:100%;
      height:22px;
      border-radius:999px;
      background: linear-gradient(180deg, rgba(226,232,240,.96), rgba(148,163,184,.92));
      border:1px solid rgba(255,255,255,.22);
      box-shadow: 0 10px 26px rgba(0,0,0,.28);
      transform-origin:center center;
      position:relative;
    }
    #indicator{
      position:absolute;
      left:50%;
      top:-22px;
      width:34px; height:34px;
      border-radius:50%;
      transform: translateX(0) translateY(0);
      background: radial-gradient(circle at 35% 30%, #fff, rgba(59,130,246,.95) 45%, rgba(29,78,216,.95));
      border:1px solid rgba(255,255,255,.26);
      box-shadow: 0 14px 28px rgba(0,0,0,.30);
      z-index: 4;
    }

    #obstacle-layer{
      position:absolute;
      inset:0;
      z-index: 6;
      pointer-events:none;
    }
    .obstacle{
      position:absolute;
      top:8%;
      transform: translateX(-50%);
      font-size: 30px;
      line-height:1;
      user-select:none;
      pointer-events:none;
      filter: drop-shadow(0 4px 6px rgba(0,0,0,.35));
      animation: obFall 1.25s linear forwards;
      opacity:.95;
    }
    .obstacle.telegraph{
      animation: obFallTele 1.25s linear forwards;
    }
    .obstacle.avoid{ filter: drop-shadow(0 0 10px rgba(34,197,94,.65)); }
    .obstacle.hit{  filter: drop-shadow(0 0 10px rgba(239,68,68,.8)); }

    @keyframes obFall{
      0%   { transform:translateX(-50%) translateY(0) scale(.9); opacity:.65; }
      20%  { opacity:1; }
      100% { transform:translateX(-50%) translateY(260px) scale(1.08); opacity:.95; }
    }
    @keyframes obFallTele{
      0%   { transform:translateX(-50%) translateY(0) scale(.8); opacity:.35; }
      20%  { opacity:1; }
      100% { transform:translateX(-50%) translateY(260px) scale(1.08); opacity:.95; }
    }

    .fx-float{
      position:absolute;
      transform: translate(-50%,-50%);
      font-weight:900;
      font-size:.95rem;
      pointer-events:none;
      user-select:none;
      animation: fxFloat .8s ease-out forwards;
      text-shadow: 0 1px 4px rgba(0,0,0,.5);
      z-index: 10;
    }
    .fx-float.good{ color:#86efac; }
    .fx-float.gold{ color:#fde68a; }
    .fx-float.bad { color:#fca5a5; }
    @keyframes fxFloat{
      0%   { opacity:0; transform:translate(-50%,-40%) scale(.92); }
      15%  { opacity:1; }
      100% { opacity:0; transform:translate(-50%,-140%) scale(1.03); }
    }

    .shake-hit{ animation:shakeHit .22s linear; }
    @keyframes shakeHit{
      0%,100%{ transform:translateX(0); }
      25%{ transform:translateX(-4px); }
      50%{ transform:translateX(4px); }
      75%{ transform:translateX(-3px); }
    }

    /* ---------- Coach ---------- */
    .coach-wrap{ display:grid; gap:8px; justify-items:center; }
    #coachLabel{ color:var(--mut); font-size:.92rem; text-align:center; margin:0; }
    #coachBubble{
      max-width: min(96vw, 760px);
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(2,6,23,.72);
      padding: 10px 12px;
      line-height: 1.35;
      text-align:center;
      box-shadow: 0 14px 34px rgba(0,0,0,.28);
    }

    /* ---------- Controls ---------- */
    .play-controls{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      margin-top: 10px;
    }

    /* ---------- cVR overlay ---------- */
    #cvrOverlay{
      position:absolute;
      inset:0;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      gap:10px;
      pointer-events:none;
      z-index: 7;
    }
    #cvrOverlay .crosshair{
      width:26px; height:26px; border-radius:50%;
      border:2px solid rgba(255,255,255,.9);
      box-shadow:0 0 0 2px rgba(0,0,0,.25) inset;
      position:relative;
    }
    #cvrOverlay .crosshair::before,
    #cvrOverlay .crosshair::after{
      content:""; position:absolute; left:50%; top:50%;
      background:rgba(255,255,255,.9);
      transform:translate(-50%,-50%);
    }
    #cvrOverlay .crosshair::before{ width:2px; height:18px; }
    #cvrOverlay .crosshair::after{ width:18px; height:2px; }
    #cvrOverlay .cvr-tip{
      font-size:.78rem;
      padding:4px 10px;
      border-radius:999px;
      background:rgba(0,0,0,.35);
      border:1px solid rgba(255,255,255,.15);
      color:rgba(248,250,252,.92);
    }

    /* ---------- Overlay (Tutorial / End Modal) ---------- */
    .overlay{
      position:fixed;
      inset:0;
      z-index: 50;
      display:flex;
      align-items:center;
      justify-content:center;
      background: rgba(2,6,23,.62);
      padding: 16px;
    }
    .overlay-card{
      width: min(720px, 96vw);
      border-radius: 18px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(10,14,28,.96);
      padding: 16px;
      box-shadow: 0 20px 50px rgba(0,0,0,.45);
    }
    .overlay-actions{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      justify-content:flex-end;
      margin-top: 12px;
    }
    .tutorial-list{
      margin:0;
      padding-left:18px;
      display:grid;
      gap:6px;
      color:rgba(226,232,240,.92);
      line-height:1.35;
    }
    .checkbox-row{
      margin-top:10px;
      display:flex;
      gap:8px;
      align-items:flex-start;
      color:rgba(226,232,240,.92);
      opacity:.95;
    }

    /* ---------- Result ---------- */
    .result-hero{
      display:grid;
      gap:10px;
      margin-bottom:12px;
      padding:12px;
      border-radius:16px;
      background: rgba(255,255,255,.04);
      border:1px solid rgba(255,255,255,.08);
    }
    .result-hero-main{ display:flex; gap:12px; align-items:flex-start; }
    .rank-badge{
      width:64px; height:64px;
      border-radius: 16px;
      display:grid;
      place-items:center;
      font-size:1.65rem;
      font-weight:900;
      border:1px solid rgba(255,255,255,.18);
      background: rgba(255,255,255,.06);
    }
    .rank-S{ background:rgba(250,204,21,.16); border-color:rgba(250,204,21,.45); color:#fde68a; }
    .rank-A{ background:rgba(34,197,94,.15); border-color:rgba(34,197,94,.4); color:#86efac; }
    .rank-B{ background:rgba(56,189,248,.14); border-color:rgba(56,189,248,.38); color:#93c5fd; }
    .rank-C{ background:rgba(251,191,36,.14); border-color:rgba(251,191,36,.38); color:#fde68a; }
    .rank-D{ background:rgba(239,68,68,.12); border-color:rgba(239,68,68,.35); color:#fca5a5; }
    .rank-pop{ animation:rankPop .35s ease-out; }
    @keyframes rankPop{
      0%{ transform:scale(.85) rotate(-6deg); opacity:.7; }
      100%{ transform:scale(1) rotate(0); opacity:1; }
    }

    .hero-insight{
      margin-top:8px;
      padding:10px 12px;
      border-radius: 12px;
      border:1px solid rgba(255,255,255,.08);
      background: rgba(255,255,255,.04);
      color: rgba(226,232,240,.92);
      line-height:1.35;
    }

    .result-hero-stats{
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap:8px;
    }
    .stat-card{
      padding:10px;
      border-radius: 12px;
      border:1px solid rgba(255,255,255,.06);
      background: rgba(255,255,255,.03);
      display:grid;
      gap:4px;
    }
    .stat-card span{ font-size:.78rem; opacity:.85; }
    .stat-card strong{ font-size:1rem; }

    .mini-badges{ display:flex; flex-wrap:wrap; gap:8px; }
    .mini-badge{
      padding:7px 10px;
      border-radius: 999px;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      font-size:.82rem;
    }
    .mini-badge.good{ border-color:rgba(34,197,94,.35); background:rgba(34,197,94,.09); }
    .mini-badge.warn{ border-color:rgba(251,191,36,.35); background:rgba(251,191,36,.08); }

    .result-grid{
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap:8px;
    }
    .result-item{
      padding:10px 12px;
      border-radius: 12px;
      border:1px solid rgba(255,255,255,.06);
      background: rgba(255,255,255,.03);
      display:flex;
      justify-content:space-between;
      gap:10px;
    }

    .result-actions{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      margin-top: 12px;
    }

    @media (max-width: 640px){
      .field-row{ grid-template-columns: 1fr; }
      #platform-wrap{ bottom: 140px; width:min(92vw, 560px); }
      .pill{ font-size:.84rem; padding:6px 8px; }
      .btn{ padding:9px 12px; }
    }
  </style>
</head>

<body>
  <div class="app">

    <!-- =========================
         VIEW: MENU
         ========================= -->
    <section id="view-menu" class="card">
      <div>
        <h1 class="title">‚öñÔ∏è Balance Hold</h1>
        <p class="sub">
          ‡πÄ‡∏Å‡∏°‡∏ù‡∏∂‡∏Å‡∏ó‡∏£‡∏á‡∏ï‡∏±‡∏ß: ‡∏•‡∏≤‡∏Å‡∏ã‡πâ‡∏≤‡∏¢‚Äì‡∏Ç‡∏ß‡∏≤‡πÉ‡∏´‡πâ‡πÅ‡∏ó‡πà‡∏ô‡∏™‡∏°‡∏î‡∏∏‡∏• ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô safe zone ‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ‡∏ô‡∏≤‡∏ô ‡πÅ‡∏•‡∏∞‡∏´‡∏•‡∏ö obstacle (üí®/üí£) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏∞‡∏™‡∏° Score/Combo/Rank
        </p>
      </div>

      <div class="grid2" style="margin-top:12px;">
        <div class="card">
          <h2 class="title" style="font-size:1rem;">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏Å‡∏°</h2>

          <div class="field-row">
            <label for="difficulty">Difficulty</label>
            <select id="difficulty">
              <option value="easy">Easy</option>
              <option value="normal" selected>Normal</option>
              <option value="hard">Hard</option>
            </select>
          </div>

          <div class="field-row">
            <label for="sessionDuration">Duration</label>
            <select id="sessionDuration">
              <option value="30">30</option>
              <option value="45">45</option>
              <option value="60" selected>60</option>
              <option value="80">80</option>
              <option value="90">90</option>
              <option value="120">120</option>
            </select>
          </div>

          <div class="field-row">
            <label for="viewMode">View</label>
            <select id="viewMode">
              <option value="pc" selected>PC</option>
              <option value="mobile">Mobile</option>
              <option value="cvr">Cardboard / cVR</option>
            </select>
          </div>

          <div class="actions">
            <button type="button" class="btn btn-primary" data-action="start-normal">‚ñ∂ Start Play</button>
            <button type="button" class="btn" data-action="goto-research">üß™ Research Mode</button>
            <button type="button" class="btn" data-action="export-sessions-csv">‚¨á Export Sessions CSV</button>
            <button type="button" class="btn" data-action="export-release-debug">üß™ Export Debug JSON</button>
          </div>

          <p class="sub" style="margin-top:10px;">
            Tip: ‡πÄ‡∏õ‡∏¥‡∏î‡∏î‡πâ‡∏ß‡∏¢ URL ‡πÄ‡∏ä‡πà‡∏ô <code>?run=play&diff=normal&time=80&seed=...&view=mobile</code>
          </p>
        </div>

        <div class="card">
          <h2 class="title" style="font-size:1rem;">‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏•‡πà‡∏ô</h2>
          <ul class="sub" style="margin:.5rem 0 0 1.1rem; padding:0;">
            <li>‡∏•‡∏≤‡∏Å‡∏ã‡πâ‡∏≤‡∏¢‚Äì‡∏Ç‡∏ß‡∏≤‡πÉ‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏∏‡∏°‡πÅ‡∏ó‡πà‡∏ô</li>
            <li>‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô safe zone ‡πÉ‡∏´‡πâ‡∏ô‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î (Stability ‡∏™‡∏π‡∏á‡∏Ç‡∏∂‡πâ‡∏ô)</li>
            <li>‡∏´‡∏•‡∏ö obstacle ‡∏ï‡∏≠‡∏ô impact (Avoid) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</li>
            <li>‡∏Ñ‡∏∏‡∏°‡πÉ‡∏Å‡∏•‡πâ‡∏Å‡∏•‡∏≤‡∏á‡∏°‡∏≤‡∏Å ‡πÜ ‡∏ï‡∏≠‡∏ô impact = Perfect ‚ú®</li>
            <li>‡πÇ‡∏î‡∏ô‡∏ä‡∏ô = Hit ‚ùå ‡∏Ñ‡∏≠‡∏°‡πÇ‡∏ö‡πÅ‡∏ï‡∏Å + ‡πÄ‡∏™‡∏µ‡∏¢‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- =========================
         VIEW: RESEARCH
         ========================= -->
    <section id="view-research" class="card hidden">
      <h2 class="title">üß™ Research Mode</h2>
      <p class="sub">‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏° ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î Start Research</p>

      <div class="field-row">
        <label for="researchId">Player ID</label>
        <input id="researchId" type="text" placeholder="‡πÄ‡∏ä‡πà‡∏ô P001" />
      </div>

      <div class="field-row">
        <label for="researchGroup">Group</label>
        <input id="researchGroup" type="text" placeholder="‡πÄ‡∏ä‡πà‡∏ô control / exp" />
      </div>

      <div class="field-row">
        <label for="researchPhase">Phase</label>
        <input id="researchPhase" type="text" placeholder="‡πÄ‡∏ä‡πà‡∏ô pre / post / wk2" />
      </div>

      <div class="actions">
        <button type="button" class="btn btn-primary" data-action="start-research">‚ñ∂ Start Research</button>
        <button type="button" class="btn" data-action="back-menu">‚Üê Back Menu</button>
      </div>
    </section>

    <!-- =========================
         VIEW: PLAY
         ========================= -->
    <section id="view-play" class="card hidden">
      <div class="hud-panel" id="playHud">
        <div class="hud-row">
          <div class="pill">Mode: <span id="hud-mode">Play</span></div>
          <div class="pill">Diff: <span id="hud-diff">normal</span></div>
          <div class="pill">Dur: <span id="hud-dur">60</span>s</div>
          <div class="pill">Time: <span id="hud-time">60.0</span></div>
        </div>

        <div class="hud-row">
          <div class="pill">Phase: <span id="hud-phase">Main</span></div>
          <div class="pill">Status: <span id="hud-status">Ready</span></div>
          <div class="pill">Stability: <span id="hud-stability">0%</span></div>
          <div class="pill">Obstacles: <span id="hud-obs">0 / 0</span></div>
          <!-- legacy mirror -->
          <span id="hud-obstacles" class="hidden" aria-hidden="true">0 / 0</span>
        </div>

        <div class="hud-row">
          <div class="pill">Score: <span id="hud-score">0</span></div>
          <div class="pill">Combo: <span id="hud-combo">0</span></div>

          <div class="hud-stabilitybar" aria-label="stability progress">
            <div class="hud-stabilitybar-track">
              <div id="stabilityFill" class="hud-stabilitybar-fill" style="width:0%"></div>
            </div>
            <span class="hud-stabilitybar-label">Center Hold</span>
          </div>
        </div>
      </div>

      <div class="coach-wrap" style="margin-top:10px;">
        <p id="coachLabel">‡∏à‡∏±‡∏ö/‡πÅ‡∏ï‡∏∞‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏õ‡∏ã‡πâ‡∏≤‡∏¢‚Äì‡∏Ç‡∏ß‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏™‡∏°‡∏î‡∏∏‡∏• / Drag left‚Äìright to balance</p>
        <div id="coachBubble" class="hidden">‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏£‡∏á‡∏ï‡∏±‡∏ß‡πÅ‡∏•‡πâ‡∏ß‡∏ô‡∏∞ ‚ú®</div>
      </div>

      <div id="playArea" style="margin-top:10px;">
        <div id="centerPulse" aria-hidden="true"></div>

        <div class="safe-zone-overlay" aria-hidden="true">
          <div class="safe-zone-inner"></div>
        </div>

        <div id="platform-wrap">
          <div id="platform">
            <div id="indicator" aria-hidden="true"></div>
          </div>
        </div>

        <div id="obstacle-layer" aria-hidden="true"></div>

        <div id="cvrOverlay" class="hidden" aria-hidden="true">
          <div class="crosshair" aria-hidden="true"></div>
          <div class="cvr-tip">cVR mode ‚Ä¢ drag to balance ‚Ä¢ use recenter if needed</div>
        </div>
      </div>

      <div class="play-controls">
        <button type="button" class="btn" data-action="pause">‚è∏ Pause</button>
        <button type="button" class="btn hidden" data-action="resume">‚ñ∂ Resume</button>
        <button type="button" class="btn btn-danger" data-action="stop">‚õî Stop</button>

        <button type="button" class="btn" data-action="cvr-recenter">üéØ Recenter</button>
        <button type="button" class="btn" data-action="cvr-calibrate-left">‚¨Ö Cal L</button>
        <button type="button" class="btn" data-action="cvr-calibrate-right">Cal R ‚û°</button>
        <button type="button" class="btn" data-action="cvr-toggle-strict">
          cVR Strict: <span id="cvrStrictLabel">OFF</span>
        </button>

        <button type="button" class="btn" data-action="back-menu">‚Üê Menu</button>
      </div>
    </section>

    <!-- =========================
         VIEW: RESULT
         ========================= -->
    <section id="view-result" class="card hidden">
      <h2 class="title">üìä Result</h2>
      <p class="sub">‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•: Stability/Obstacle/Score/Rank + ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</p>

      <section class="result-hero" style="margin-top:10px;">
        <div class="result-hero-main">
          <div id="rankBadge" class="rank-badge rank-D">D</div>
          <div>
            <div id="resultHeroSub" class="sub">-</div>
            <div id="heroInsight" class="hero-insight">-</div>
          </div>
        </div>

        <div class="result-hero-stats">
          <div class="stat-card"><span>Score</span><strong id="res-score">0</strong></div>
          <div class="stat-card"><span>Rank</span><strong id="res-rank">D</strong></div>
          <div class="stat-card"><span>Perfect</span><strong id="res-perfect">0</strong></div>
          <div class="stat-card"><span>Max Combo</span><strong id="res-maxCombo">0</strong></div>
          <div class="stat-card"><span>Date</span><strong id="res-daily">-</strong></div>
        </div>

        <div id="heroBadges" class="mini-badges"></div>
        <div id="heroMissionChips" class="mini-badges"></div>
      </section>

      <div class="result-grid" style="margin-top:10px;">
        <div class="result-item">Mode <strong id="res-mode">-</strong></div>
        <div class="result-item">Difficulty <strong id="res-diff">-</strong></div>
        <div class="result-item">Duration <strong id="res-dur">-</strong></div>
        <div class="result-item">End <strong id="res-end">-</strong></div>
        <div class="result-item">Stability <strong id="res-stability">-</strong></div>
        <div class="result-item">Mean Tilt <strong id="res-meanTilt">-</strong></div>
        <div class="result-item">RMS Tilt <strong id="res-rmsTilt">-</strong></div>
        <div class="result-item">Avoid <strong id="res-avoid">-</strong></div>
        <div class="result-item">Hit <strong id="res-hit">-</strong></div>
        <div class="result-item">Avoid Rate <strong id="res-avoidRate">-</strong></div>
        <div class="result-item">Fatigue <strong id="res-fatigue">-</strong></div>
        <div class="result-item">Samples <strong id="res-samples">-</strong></div>
      </div>

      <div class="hero-insight" style="margin-top:10px;">
        <strong>AI Coach Tip:</strong> <span id="res-aiTip">-</span>
      </div>

      <div class="result-actions">
        <button type="button" class="btn btn-primary" data-action="result-play-again">üîÅ Play Again</button>
        <button type="button" class="btn" data-action="result-back-hub">üè† Back HUB</button>
        <button type="button" class="btn" data-action="export-sessions-csv">‚¨á Export Sessions CSV</button>
        <button type="button" class="btn" data-action="export-release-debug">üß™ Export Debug JSON</button>
      </div>
    </section>

  </div><!-- /.app -->

  <!-- =========================
       Tutorial Overlay
       ========================= -->
  <div id="tutorialOverlay" class="overlay hidden" aria-hidden="true">
    <div class="overlay-card">
      <h3>‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏•‡πà‡∏ô Balance Hold</h3>
      <ol class="tutorial-list">
        <li>‡∏•‡∏≤‡∏Å‡∏ã‡πâ‡∏≤‡∏¢‚Äì‡∏Ç‡∏ß‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏∏‡∏°‡πÅ‡∏ó‡πà‡∏ô‡πÉ‡∏´‡πâ‡∏™‡∏°‡∏î‡∏∏‡∏•</li>
        <li>‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô safe zone ‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ‡∏ô‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î (Stability ‡∏™‡∏π‡∏á‡∏Ç‡∏∂‡πâ‡∏ô)</li>
        <li>‡∏´‡∏•‡∏ö obstacle (üí®/üí£) ‡πÇ‡∏î‡∏¢‡∏Ñ‡∏∏‡∏°‡∏™‡∏°‡∏î‡∏∏‡∏•‡∏ï‡∏≠‡∏ô impact</li>
        <li>Perfect ‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏∏‡∏°‡πÉ‡∏Å‡∏•‡πâ‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏°‡∏≤‡∏Å ‡πÜ ‡∏ï‡∏≠‡∏ô impact</li>
        <li>‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡∏¥‡∏î Practice ‡∏à‡∏∞‡∏°‡∏µ Countdown ‚Üí Practice ‚Üí Main</li>
      </ol>
      <label class="checkbox-row">
        <input type="checkbox" id="tutorialDontShowAgain" />
        <span>‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ö‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ô‡∏µ‡πâ</span>
      </label>
      <div class="overlay-actions">
        <button type="button" class="btn" data-action="tutorial-skip">Skip</button>
        <button type="button" class="btn btn-primary" data-action="tutorial-start">Start</button>
      </div>
    </div>
  </div>

  <!-- =========================
       End Modal
       ========================= -->
  <div id="endModal" class="overlay hidden" aria-hidden="true">
    <div class="overlay-card">
      <div style="display:flex; gap:12px; align-items:center;">
        <div id="endModalRank" class="rank-badge rank-D">D</div>
        <div>
          <h3 style="margin:0;">Session Complete</h3>
          <p class="sub" style="margin:.25rem 0 0;">Score: <strong id="endModalScore">0</strong></p>
        </div>
      </div>

      <div id="endModalInsight" class="hero-insight" style="margin-top:12px;">
        ‡∏ó‡∏≥‡πÑ‡∏î‡πâ‡∏î‡∏µ‡∏°‡∏≤‡∏Å! ‡∏•‡∏≠‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏™‡∏°‡∏î‡∏∏‡∏•‡πÉ‡∏Å‡∏•‡πâ‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏≠‡πà‡∏≤‡∏ô‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏∞ obstacle ‡πÉ‡∏´‡πâ‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô
      </div>

      <div class="overlay-actions">
        <button type="button" class="btn" data-action="close-end-modal">Close</button>
        <button type="button" class="btn" data-action="end-retry">Play Again</button>
        <button type="button" class="btn" data-action="end-next-mission">Next Mission</button>
        <button type="button" class="btn btn-primary" data-action="end-back-hub">Back HUB</button>
      </div>
    </div>
  </div>

  <!-- JS (T) -->
  <script src="./js/balance-hold.js"></script>
</body>
</html>
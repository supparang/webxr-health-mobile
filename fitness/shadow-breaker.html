<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
  <title>VR Fitness ‚Äî Shadow Breaker</title>
  <meta name="color-scheme" content="light dark"/>
  <link rel="icon" href="./favicon.ico"/>
  <link rel="stylesheet" href="./css/shadow-breaker.css"/>

  <style>
    /* ===== Transition & Animation (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°) ===== */
    section {
      opacity: 0;
      transform: translateY(24px);
      transition: opacity .6s ease, transform .6s ease;
    }
    section.active {
      opacity: 1;
      transform: translateY(0);
    }
    section.hidden { display: none; }
    .fade-in {
      animation: fadeIn .6s ease forwards;
    }
    @keyframes fadeIn {
      from { opacity:0; transform:translateY(24px); }
      to { opacity:1; transform:translateY(0); }
    }
  </style>
</head>

<body>
  <!-- ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á + layout ‡∏ï‡∏≤‡∏° hub -->
  <div class="sb-shell">
    <!-- Header ‡πÅ‡∏ö‡∏ö‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö hub -->
    <header class="sb-header">
      <div class="sb-brand">
        <div class="sb-logo-pill">VR</div>
        <div class="sb-brand-text">
          <div class="sb-brand-title">VR Fitness Lab</div>
          <div class="sb-brand-subtitle">Shadow Breaker</div>
        </div>
      </div>
      <a href="./hub.html" class="sb-back-link">‚Üê ‡∏Å‡∏•‡∏±‡∏ö Hub</a>
    </header>

    <!-- Card ‡∏Å‡∏•‡∏≤‡∏á‡∏à‡∏≠ -->
    <div class="sb-card">
      <div class="sb-wrap" id="sb-wrap">
        
        <!-- ========== MENU VIEW ========== -->
        <section id="view-menu" class="active">
          <h1 class="title">ü•ä Shadow Breaker üéØ</h1>
          <p class="subtitle">
            ‡πÄ‡∏Å‡∏°‡∏ï‡∏µ‡πÄ‡∏õ‡πâ‡∏≤‡πÅ‡∏ö‡∏ö Boss Fight ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ù‡∏∂‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÅ‡∏Ç‡∏ô‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏ß‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á
          </p>

          <div class="menu-grid">
            <div class="menu-left">
              <div class="menu-block">
                <label>‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏Å</label>
                <select id="difficulty">
                  <option value="easy">Easy ‚Äî ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</option>
                  <option value="normal" selected>Normal ‚Äî ‡∏™‡∏°‡∏î‡∏∏‡∏•</option>
                  <option value="hard">Hard ‚Äî ‡∏ó‡πâ‡∏≤‡∏ó‡∏≤‡∏¢</option>
                </select>
              </div>

              <div class="menu-block">
                <label>‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏•‡πà‡∏ô‡∏ï‡πà‡∏≠‡∏£‡∏≠‡∏ö</label>
                <select id="duration">
                  <option value="45">45 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</option>
                  <option value="60" selected>60 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</option>
                  <option value="75">75 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</option>
                </select>
              </div>

              <button data-action="start-normal" class="btn-main">
                ‚ö° ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏•‡∏¢
              </button>

              <div class="research-entry">
                <button data-action="start-research" class="btn-sub">
                  üìã ‡πÇ‡∏´‡∏°‡∏î‡∏ß‡∏¥‡∏à‡∏±‡∏¢ (Research Mode)
                </button>
                <p class="hint">‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå CSV ‡πÑ‡∏î‡πâ</p>
              </div>
            </div>

            <div class="menu-right">
              <div class="preview-panel">
                <p class="preview-title">Shadow Breaker ‚Äî Boss Fight Mode</p>
                <p class="preview-text">
                  ‡∏ï‡∏µ‡πÄ‡∏õ‡πâ‡∏≤‡πÉ‡∏´‡πâ‡∏ó‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏≤‡∏¢‡πÑ‡∏õ ‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏Ñ‡∏≠‡∏°‡πÇ‡∏ö‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î<br/>
                  ‡∏ö‡∏≠‡∏™‡∏à‡∏∞‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô Phase ‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏Å‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô
                </p>
                <ul class="preview-list">
                  <li>‚óè HP Player / Boss ‡πÅ‡∏¢‡∏Å 2 ‡πÅ‡∏ñ‡∏ö</li>
                  <li>‚óè FEVER Gauge ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ä‡πà‡∏ß‡∏á‡πÇ‡∏ö‡∏ô‡∏±‡∏™</li>
                  <li>‚óè ‡πÄ‡∏Å‡πá‡∏ö Reaction Time ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏á‡∏≤‡∏ô‡∏ß‡∏¥‡∏à‡∏±‡∏¢</li>
                  <li>‚óè ‡∏õ‡∏£‡∏±‡∏ö‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏Å: Easy / Normal / Hard</li>
                </ul>
              </div>
            </div>
          </div>
        </section>

        <!-- ========== RESEARCH FORM ========== -->
        <section id="view-research-form" class="hidden">
          <h2 class="section-title">‡πÇ‡∏´‡∏°‡∏î‡∏ß‡∏¥‡∏à‡∏±‡∏¢ (Research Mode)</h2>
          <p class="section-desc">
            ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏Å‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô (CSV)
          </p>

          <div class="form-grid">
            <div class="form-block">
              <label>‡∏£‡∏´‡∏±‡∏™‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°</label>
              <input id="research-id" placeholder="P001"/>
            </div>

            <div class="form-block">
              <label>‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏î‡∏•‡∏≠‡∏á</label>
              <input id="research-group" placeholder="A / B / C"/>
            </div>

            <div class="form-block full">
              <label>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</label>
              <input id="research-note" placeholder="‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (‡πÄ‡∏ä‡πà‡∏ô ‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤ / ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û)"/>
            </div>
          </div>

          <div class="form-btns">
            <button data-action="back-to-menu" class="btn-ghost">‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
            <button data-action="research-begin-play" class="btn-main">
              ‚ñ∂ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô
            </button>
          </div>
        </section>

        <!-- ========== PLAY VIEW ========== -->
        <section id="view-play" class="hidden">
          <!-- HUD ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô -->
          <div class="hud">
            <div class="stat-left">
              <div class="hp-row">
                <span class="hp-label">PLAYER</span>
                <div class="hp-bar">
                  <div id="player-fill" class="bar green"></div>
                </div>
              </div>
              <div class="hp-row">
                <span class="hp-label">BOSS</span>
                <div class="hp-bar">
                  <div id="boss-fill" class="bar red"></div>
                </div>
              </div>
            </div>

            <div class="stat-right">
              <div class="stat-item">TIME <span id="stat-time">00:00</span></div>
              <div class="stat-item">SCORE <span id="stat-score">0</span></div>
              <div class="stat-item">COMBO <span id="stat-combo">0</span></div>
              <div class="stat-item">PHASE <span id="stat-phase">1</span></div>
            </div>
          </div>

          <!-- Boss portrait -->
          <div class="boss-portrait" id="boss-portrait">
            <div id="boss-portrait-emoji" class="emoji">üê£</div>
            <div class="boss-meta">
              <div id="boss-portrait-name" class="name">Bubble Glove</div>
              <div id="boss-portrait-hint" class="hint">‡πÇ‡∏ü‡∏Å‡∏±‡∏™‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πâ‡∏≤‡∏ü‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß‡∏ï‡∏µ‡πÉ‡∏´‡πâ‡∏ó‡∏±‡∏ô</div>
            </div>
          </div>

          <!-- Target layer -->
          <div id="target-layer" class="target-layer">
            <!-- ‡πÄ‡∏õ‡πâ‡∏≤‡πÄ‡∏Å‡∏°‡∏à‡∏∞ spawn ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ -->
          </div>

          <!-- FEVER HUD -->
          <div class="fever-hud">
            <div class="fever-label">FEVER</div>
            <div class="fever-bar">
              <div id="fever-fill" class="bar fever"></div>
            </div>
            <div id="fever-status" class="status">Ready</div>
          </div>

          <!-- Feedback -->
          <div id="sb-feedback" class="sb-feedback">
            ‡∏ï‡∏µ‡πÄ‡∏õ‡πâ‡∏≤‡πÉ‡∏´‡πâ‡∏ó‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏≤‡∏¢‡πÑ‡∏õ ‡πÅ‡∏•‡πâ‡∏ß‡∏î‡∏π‡∏ß‡πà‡∏≤‡∏Ñ‡∏≠‡∏°‡πÇ‡∏ö‡∏à‡∏∞‡∏¢‡∏≤‡∏ß‡πÅ‡∏Ñ‡πà‡πÑ‡∏´‡∏ô!
          </div>

          <div class="play-controls">
            <button data-action="stop-early" class="btn-ghost">
              ‚èπ ‡∏´‡∏¢‡∏∏‡∏î‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏ß‡∏•‡∏≤
            </button>
          </div>
        </section>

        <!-- ========== RESULT VIEW ========== -->
        <section id="view-result" class="hidden">
          <h2 class="section-title">üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô</h2>

          <div class="result-layout">
            <div class="result-main">
              <table class="result-table">
                <tr><td>‡πÇ‡∏´‡∏°‡∏î</td><td id="res-mode">-</td></tr>
                <tr><td>‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏Å</td><td id="res-diff">-</td></tr>
                <tr><td>‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡∏à‡∏ö‡πÄ‡∏Å‡∏°</td><td id="res-endreason">-</td></tr>
                <tr><td>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°</td><td id="res-score">0</td></tr>
                <tr><td>‡∏Ñ‡∏≠‡∏°‡πÇ‡∏ö‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î</td><td id="res-maxcombo">0</td></tr>
                <tr><td>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏û‡∏•‡∏≤‡∏î</td><td id="res-miss">0</td></tr>
                <tr><td>‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥</td><td id="res-accuracy">0%</td></tr>
                <tr><td>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏õ‡πâ‡∏≤‡∏ñ‡∏π‡∏Å‡∏ï‡∏µ</td><td id="res-totalhits">0</td></tr>
                <tr><td>Reaction Time (‡∏õ‡∏Å‡∏ï‡∏¥)</td><td id="res-rt-normal">-</td></tr>
                <tr><td>Reaction Time (‡∏´‡∏•‡∏≠‡∏Å)</td><td id="res-rt-decoy">-</td></tr>
                <tr><td>‡πÄ‡∏Å‡∏£‡∏î</td><td id="res-grade">-</td></tr>
                <tr><td>‚è± ‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏ô FEVER ‡∏£‡∏ß‡∏°</td><td id="res-fever-time">0.0 s</td></tr>
                <tr><td>üí• ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ö‡∏≠‡∏™‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô</td><td id="res-bosses">0</td></tr>
                <tr><td>‚ù§Ô∏è‚Äçüî• ‡πÄ‡∏ß‡∏•‡∏≤ HP ‡∏ï‡πà‡∏≥‡∏£‡∏ß‡∏°</td><td id="res-lowhp-time">0.0 s</td></tr>
                <tr><td>‚öôÔ∏è ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏°‡∏ô‡∏π ‚Üí ‡πÄ‡∏•‡πà‡∏ô‡∏à‡∏£‡∏¥‡∏á</td><td id="res-menu-latency">-</td></tr>
              </table>
            </div>

            <aside class="result-side">
              <h3>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°</h3>
              <p>‡∏£‡∏´‡∏±‡∏™: <span id="res-participant">-</span></p>

              <div class="csv-btns">
                <button data-action="download-csv-events" class="btn-sub">
                  üìÑ ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î Event CSV
                </button>
                <button data-action="download-csv-session" class="btn-sub">
                  üìä ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î Session CSV
                </button>
              </div>
            </aside>
          </div>

          <div class="result-btns">
            <button data-action="play-again" class="btn-main">
              üîÅ ‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á
            </button>
            <button data-action="back-to-menu" class="btn-ghost">
              üè† ‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏°‡∏ô‡∏π
            </button>
          </div>
        </section>

        <!-- Boss Intro -->
        <div id="boss-intro" class="boss-intro hidden">
          <div id="boss-intro-emoji" class="emoji">üê£</div>
          <div id="boss-intro-name" class="name">Bubble Glove</div>
          <div id="boss-intro-title" class="title">‡∏ö‡∏≠‡∏™‡∏°‡∏∑‡∏≠‡πÉ‡∏´‡∏°‡πà‡∏™‡∏≤‡∏¢‡∏ü‡∏≠‡∏á</div>
          <div id="boss-intro-desc" class="desc">‡∏ï‡∏µ‡πÄ‡∏õ‡πâ‡∏≤‡πÉ‡∏´‡πâ‡πÅ‡∏ï‡∏Å‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏≤‡∏¢‡πÑ‡∏õ!</div>
          <p class="tap-hint">‡πÅ‡∏ï‡∏∞‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏π‡πâ!</p>
        </div>

      </div><!-- /.sb-wrap -->
    </div><!-- /.sb-card -->
  </div><!-- /.sb-shell -->

  <!-- ========== Scripts ========== -->
  <script type="module" src="./js/shadow-breaker.js"></script>
  <script type="module" src="./js/engine.js"></script>
  <script type="module" src="./js/dom-renderer.js"></script>
  <script type="module" src="./js/event-logger.js"></script>
  <script type="module" src="./js/session-logger.js"></script>
  <script type="module" src="./js/particle.js"></script>

  <!-- Inline Script ‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ type="module" -->
  <script>
  window.addEventListener('DOMContentLoaded', () => {
    const sections = {
      menu: document.getElementById('view-menu'),
      play: document.getElementById('view-play'),
      result: document.getElementById('view-result'),
      research: document.getElementById('view-research-form')
    };

    function show(view) {
      Object.values(sections).forEach(sec => sec.classList.add('hidden'));
      const el = sections[view];
      el.classList.remove('hidden');
      el.classList.add('fade-in');
    }

    document.querySelector('[data-action="start-normal"]')
      ?.addEventListener('click', () => show('play'));

    document.querySelector('[data-action="start-research"]')
      ?.addEventListener('click', () => show('research'));

    document.querySelectorAll('[data-action="back-to-menu"]')
      .forEach(btn => btn.addEventListener('click', () => show('menu')));

    document.querySelector('[data-action="play-again"]')
      ?.addEventListener('click', () => show('play'));

    document.querySelector('[data-action="stop-early"]')
      ?.addEventListener('click', () => show('result'));
  });
  </script>

  <!-- SFX -->
  <audio id="sfx-hit" src="./sfx/hit.mp3" preload="auto"></audio>
  <audio id="sfx-boss" src="./sfx/boss-intro.mp3" preload="auto"></audio>
  <audio id="sfx-fever" src="./sfx/fever.mp3" preload="auto"></audio>
</body>
</html>

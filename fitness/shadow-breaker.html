<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
  <title>‚ö° Shadow Breaker ‚Äî VR Fitness Academy ‚ö°</title>
  <meta name="color-scheme" content="light dark"/>
  <link rel="icon" href="./favicon.ico"/>
  <link rel="stylesheet" href="./css/shadow-breaker.css"/>

  <style>
    /* ===== GLOBAL THEME ===== */
    :root {
      --c-bg1: #020617;
      --c-bg2: rgba(17, 24, 39, 0.85);
      --c-accent1: #a855f7;
      --c-accent2: #6366f1;
      --c-text: #e5e7eb;
      --c-muted: #94a3b8;
      --radius: 18px;
    }

    body {
      margin: 0;
      font-family: "Segoe UI", system-ui, sans-serif;
      background:
        radial-gradient(circle at top left, rgba(147,197,253,0.15), transparent 60%),
        radial-gradient(circle at bottom right, rgba(192,132,252,0.22), transparent 60%),
        var(--c-bg1);
      color: var(--c-text);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .sb-wrap {
      width: min(460px, 90%);
      background: var(--c-bg2);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: var(--radius);
      padding: 36px 24px 48px;
      box-shadow: 0 0 36px rgba(0,0,0,0.5);
      backdrop-filter: blur(10px);
      text-align: center;
    }

    /* ===== MENU VIEW ===== */
    h1.title {
      font-size: 2rem;
      margin: 0 0 28px;
      color: #fafafa;
      text-shadow: 0 0 10px rgba(168,85,247,0.55);
    }

    label {
      display: block;
      margin-top: 12px;
      margin-bottom: 4px;
      font-size: 0.95rem;
      color: var(--c-muted);
      text-align: left;
    }

    select, input {
      width: 100%;
      padding: 10px;
      border-radius: 10px;
      border: 1px solid rgba(255,255,255,0.15);
      background: rgba(255,255,255,0.08);
      color: var(--c-text);
      font-size: 1rem;
    }

    .btn-main {
      width: 100%;
      background: linear-gradient(90deg, var(--c-accent1), var(--c-accent2));
      border: none;
      border-radius: 12px;
      padding: 14px 16px;
      font-size: 1.05rem;
      font-weight: 600;
      color: #fff;
      margin-top: 26px;
      cursor: pointer;
      box-shadow: 0 6px 14px rgba(0,0,0,0.35);
      transition: transform 0.15s ease, box-shadow 0.2s ease;
    }
    .btn-main:hover { transform: translateY(-2px); }

    .btn-sub {
      width: 100%;
      margin-top: 18px;
      border: 1px solid rgba(255,255,255,0.25);
      border-radius: 10px;
      background: transparent;
      color: var(--c-muted);
      padding: 10px;
      font-size: 0.95rem;
      cursor: pointer;
    }

    hr {
      margin: 28px 0;
      border: none;
      border-top: 1px solid rgba(255,255,255,0.1);
    }

    .hint {
      font-size: 0.85rem;
      color: var(--c-muted);
      margin-top: 10px;
    }

    /* ===== PLAY VIEW ===== */
    #view-play .hud {
      display: flex;
      justify-content: space-between;
      margin-bottom: 16px;
      font-size: 0.9rem;
    }
    .bar {
      width: 180px;
      height: 8px;
      border-radius: 6px;
      background: rgba(255,255,255,0.08);
      overflow: hidden;
      margin-top: 4px;
    }
    .bar.green { background: linear-gradient(90deg,#22c55e,#16a34a); }
    .bar.red { background: linear-gradient(90deg,#f87171,#ef4444); }
    .bar.fever { background: linear-gradient(90deg,#facc15,#fbbf24); }

    #view-play .boss-portrait {
      margin: 18px 0;
    }

    .sb-feedback {
      margin-top: 12px;
      font-size: 0.9rem;
      color: #cbd5e1;
    }

    /* ===== RESULT VIEW ===== */
    #view-result {
      text-align: left;
    }
    #view-result h2 {
      text-align: center;
      margin-bottom: 12px;
    }
    .result-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.95rem;
    }
    .result-table td {
      padding: 6px 4px;
      border-bottom: 1px solid rgba(255,255,255,0.08);
    }
    .result-btns, .csv-btns {
      display: flex;
      gap: 8px;
      margin-top: 14px;
      justify-content: center;
    }
    .result-btns button, .csv-btns button {
      border-radius: 10px;
      padding: 10px 12px;
      font-size: 0.9rem;
      cursor: pointer;
    }

    /* ===== BOSS INTRO ===== */
    .boss-intro {
      position: fixed;
      inset: 0;
      background: rgba(2,6,23,0.9);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      color: #fff;
      z-index: 999;
      transition: opacity 0.4s;
    }
    .boss-intro.hidden { display: none; }
    .boss-intro .emoji { font-size: 4rem; margin-bottom: 10px; }
    .boss-intro .name { font-size: 1.5rem; margin-bottom: 6px; }
    .boss-intro .title { color: #c084fc; margin-bottom: 6px; }
    .boss-intro .desc { font-size: 1rem; color: #e2e8f0; margin-bottom: 14px; }
    .tap-hint { font-size: 0.9rem; color: #93c5fd; }
  </style>
</head>

<body>
  <div class="sb-wrap" id="sb-wrap">
    <!-- MENU -->
    <section id="view-menu">
      <h1 class="title">‚ö° Shadow Breaker ‚ö°</h1>

      <label>‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏Å</label>
      <select id="difficulty">
        <option value="easy">Easy ‚Äî ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</option>
        <option value="normal" selected>Normal ‚Äî ‡∏õ‡∏Å‡∏ï‡∏¥</option>
        <option value="hard">Hard ‚Äî ‡∏ó‡πâ‡∏≤‡∏ó‡∏≤‡∏¢</option>
      </select>

      <label>‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏•‡πà‡∏ô‡∏ï‡πà‡∏≠‡∏£‡∏≠‡∏ö</label>
      <select id="duration">
        <option value="45">45 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</option>
        <option value="60" selected>60 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</option>
        <option value="75">75 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</option>
      </select>

      <button data-action="start-normal" class="btn-main">‚ö†Ô∏è ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏•‡∏¢</button>
      <hr/>
      <button data-action="start-research" class="btn-sub">üìã ‡πÄ‡∏•‡πà‡∏ô‡πÉ‡∏ô‡πÇ‡∏´‡∏°‡∏î‡∏ß‡∏¥‡∏à‡∏±‡∏¢</button>
      <p class="hint">‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏õ‡πá‡∏ô CSV ‡πÑ‡∏î‡πâ</p>
    </section>

    <!-- PLAY -->
    <section id="view-play" class="hidden">
      <div class="hud">
        <div>PLAYER<div id="player-fill" class="bar green"></div></div>
        <div>BOSS<div id="boss-fill" class="bar red"></div></div>
      </div>
      <div class="stat-right">
        TIME <span id="stat-time">00:00</span> | SCORE <span id="stat-score">0</span> | COMBO <span id="stat-combo">0</span>
      </div>

      <div class="boss-portrait" id="boss-portrait">
        <div id="boss-portrait-emoji" class="emoji">üê£</div>
        <div id="boss-portrait-name" class="name">Bubble Glove</div>
        <div id="boss-portrait-hint" class="hint">‡πÇ‡∏ü‡∏Å‡∏±‡∏™‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πâ‡∏≤‡∏ü‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß‡∏ï‡∏µ‡πÉ‡∏´‡πâ‡∏ó‡∏±‡∏ô!</div>
      </div>

      <div id="target-layer" class="target-layer"></div>

      <div class="fever-hud">
        <div class="label">FEVER</div>
        <div id="fever-fill" class="bar fever"></div>
        <div id="fever-status" class="status">Ready</div>
      </div>

      <div class="sb-feedback" id="sb-feedback">‡∏ï‡∏µ‡πÄ‡∏õ‡πâ‡∏≤‡πÉ‡∏´‡πâ‡∏ó‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏≤‡∏¢‡πÑ‡∏õ ‡πÅ‡∏•‡πâ‡∏ß‡∏î‡∏π‡∏ß‡πà‡∏≤‡∏Ñ‡∏≠‡∏°‡πÇ‡∏ö‡∏à‡∏∞‡∏¢‡∏≤‡∏ß‡πÅ‡∏Ñ‡πà‡πÑ‡∏´‡∏ô!</div>
      <div class="play-controls"><button data-action="stop-early">‚èπ ‡∏´‡∏¢‡∏∏‡∏î‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏ß‡∏•‡∏≤</button></div>
    </section>

    <!-- RESULT -->
    <section id="view-result" class="hidden">
      <h2>üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô</h2>
      <table class="result-table">
        <tr><td>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°</td><td id="res-score">0</td></tr>
        <tr><td>‡∏Ñ‡∏≠‡∏°‡πÇ‡∏ö‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î</td><td id="res-maxcombo">0</td></tr>
        <tr><td>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏û‡∏•‡∏≤‡∏î</td><td id="res-miss">0</td></tr>
        <tr><td>‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥</td><td id="res-accuracy">0%</td></tr>
        <tr><td>‚è± FEVER TIME</td><td id="res-fever-time">0.0 s</td></tr>
        <tr><td>üí• ‡∏ö‡∏≠‡∏™‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô</td><td id="res-bosses">0</td></tr>
      </table>
      <div class="result-btns">
        <button data-action="play-again">üîÅ ‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
        <button data-action="back-to-menu">üè† ‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏°‡∏ô‡∏π</button>
      </div>
    </section>

    <!-- BOSS INTRO -->
    <div id="boss-intro" class="boss-intro hidden">
      <div class="emoji" id="boss-intro-emoji">üê£</div>
      <div class="name" id="boss-intro-name">Bubble Glove</div>
      <div class="title" id="boss-intro-title">‡∏ö‡∏≠‡∏™‡∏°‡∏∑‡∏≠‡πÉ‡∏´‡∏°‡πà‡∏™‡∏≤‡∏¢‡∏ü‡∏≠‡∏á</div>
      <div class="desc" id="boss-intro-desc">‡∏ï‡∏µ‡πÄ‡∏õ‡πâ‡∏≤‡πÉ‡∏´‡πâ‡πÅ‡∏ï‡∏Å‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏≤‡∏¢‡πÑ‡∏õ!</div>
      <p class="tap-hint">‡πÅ‡∏ï‡∏∞‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏π‡πâ!</p>
    </div>
  </div>

  <!-- Scripts -->
  <script type="module" src="./js/shadow-breaker.js"></script>
  <script type="module" src="./js/engine.js"></script>
  <script type="module" src="./js/dom-renderer.js"></script>
  <script type="module" src="./js/event-logger.js"></script>
  <script type="module" src="./js/session-logger.js"></script>
  <script type="module" src="./js/particle.js"></script>

  <!-- SFX -->
  <audio id="sfx-hit" src="./sfx/hit.mp3" preload="auto"></audio>
  <audio id="sfx-boss" src="./sfx/boss-intro.mp3" preload="auto"></audio>
  <audio id="sfx-fever" src="./sfx/fever.mp3" preload="auto"></audio>
</body>
</html>
